#!/usr/bin/env node
import {g,p,h,q,j,i,u as u$1,r,m as m$1,b as b$1,l,k}from'./chunk-2IEF2V43.js';import {Command}from'commander';import {promises,existsSync,statSync}from'fs';import*as b from'path';import b__default,{join,basename}from'path';import {green,cyan,yellow,red}from'kleur/colors';import Ps from'ora';import xe from'deepmerge';import Vn,{homedir,tmpdir}from'os';import js from'stringify-object';import {Project,SyntaxKind,ScriptKind,QuoteKind}from'ts-morph';import G from'fs-extra';import Bt from'prompts';import Ct,{z as z$1}from'zod';import {cosmiconfig}from'cosmiconfig';import Ge from'fast-glob';import {loadConfig,createMatchPath}from'tsconfig-paths';import {transformFromAstSync}from'@babel/core';import {parse}from'@babel/parser';import yi from'@babel/plugin-transform-typescript';import*as at from'recast';import {HttpsProxyAgent}from'https-proxy-agent';import qi from'node-fetch';import {createHash}from'crypto';import v from'postcss';import fn from'postcss/lib/at-rule';import {detect}from'@antfu/ni';import {execa}from'execa';import*as pe from'fs/promises';import pe__default from'fs/promises';var rr={version:"1.0.0"};var u={error:red,warn:yellow,info:cyan,success:green};function R(e,t){return Ps({text:e,isSilent:t?.silent})}async function ir(e,t,r){if(!e||(r={silent:false,tailwindVersion:"v3",...r},r.tailwindVersion==="v4"))return;let s=b__default.relative(t.resolvedPaths.cwd,t.resolvedPaths.tailwindConfig),i=R(`Updating ${u.info(s)}`,{silent:r.silent}).start(),n=await promises.readFile(t.resolvedPaths.tailwindConfig,"utf8"),o=await $s(n,e,t);await promises.writeFile(t.resolvedPaths.tailwindConfig,o,"utf8"),i?.succeed();}async function $s(e,t,r){let s=await ze(e,r),i=s.getDescendantsOfKind(SyntaxKind.ObjectLiteralExpression).find(o=>o.getProperties().some(a=>a.isKind(SyntaxKind.PropertyAssignment)&&a.getName()==="content"));if(!i)return e;let n=kt(i);return As(i,{name:"darkMode",value:"class"},{quoteChar:n}),t.plugins?.forEach(o=>{Ds(i,o);}),t.theme&&await Fs(i,t.theme),s.getFullText()}function As(e,t,{quoteChar:r}){let s=e.getProperty("darkMode");if(!s){let i={name:t.name,initializer:`[${r}${t.value}${r}]`};return t.name==="darkMode"?(e.insertPropertyAssignment(0,i),e):(e.addPropertyAssignment(i),e)}if(s.isKind(SyntaxKind.PropertyAssignment)){let i=s.getInitializer(),n=`${r}${t.value}${r}`;if(i?.isKind(SyntaxKind.StringLiteral)){let o=i.getText();return i.replaceWithText(`[${o}, ${n}]`),e}if(i?.isKind(SyntaxKind.ArrayLiteralExpression)){if(i.getElements().map(o=>o.getText()).includes(n))return e;i.addElement(n);}return e}return e}async function Fs(e,t){e.getProperty("theme")||e.addPropertyAssignment({name:"theme",initializer:"{}"}),Tt(e);let s=(e.getPropertyOrThrow("theme")?.asKindOrThrow(SyntaxKind.PropertyAssignment)).getInitializer();if(s?.isKind(SyntaxKind.ObjectLiteralExpression)){let i=s.getText(),n=await Ls(i),o=xe(n,t,{arrayMerge:(l,c)=>c}),a=js(o).replace(/\'\.\.\.(.*)\'/g,"...$1").replace(/\'\"/g,"'").replace(/\"\'/g,"'").replace(/\'\[/g,"[").replace(/\]\'/g,"]").replace(/\'\\\'/g,"'").replace(/\\\'/g,"'").replace(/\\\'\'/g,"'").replace(/\'\'/g,"'");s.replaceWithText(a);}jt(e);}function Ds(e,t){let r=e.getProperty("plugins");if(!r)return e.addPropertyAssignment({name:"plugins",initializer:`[${t}]`}),e;if(r.isKind(SyntaxKind.PropertyAssignment)){let s=r.getInitializer();if(s?.isKind(SyntaxKind.ArrayLiteralExpression)){if(s.getElements().map(i=>i.getText().replace(/["']/g,"")).includes(t.replace(/["']/g,"")))return e;s.addElement(t);}return e}return e}async function ze(e,t){let r=await promises.mkdtemp(b__default.join(tmpdir(),"uidesu-")),s=t?.resolvedPaths?.tailwindConfig||"tailwind.config.ts",i=b__default.join(r,`uidesu-${b__default.basename(s)}`);return new Project({compilerOptions:{}}).createSourceFile(i,e,{scriptKind:b__default.extname(s)===".ts"?ScriptKind.TS:ScriptKind.JS})}function kt(e){return e.getFirstDescendantByKind(SyntaxKind.StringLiteral)?.getQuoteKind()===QuoteKind.Single?"'":'"'}function Tt(e){let t=e.getProperties();for(let r=0;r<t.length;r++){let s=t[r];if(s.isKind(SyntaxKind.SpreadAssignment)){let i=s.asKindOrThrow(SyntaxKind.SpreadAssignment),n=i.getExpression().getText();e.insertPropertyAssignment(r,{name:`"___${n.replace(/^\.\.\./,"")}"`,initializer:`"...${n.replace(/^\.\.\./,"")}"`}),i.remove();}else if(s.isKind(SyntaxKind.PropertyAssignment)){let n=s.asKindOrThrow(SyntaxKind.PropertyAssignment).getInitializer();n&&n.isKind(SyntaxKind.ObjectLiteralExpression)?Tt(n.asKindOrThrow(SyntaxKind.ObjectLiteralExpression)):n&&n.isKind(SyntaxKind.ArrayLiteralExpression)&&nr(n.asKindOrThrow(SyntaxKind.ArrayLiteralExpression));}}}function nr(e){let t=e.getElements();for(let r=0;r<t.length;r++){let s=t[r];if(s.isKind(SyntaxKind.ObjectLiteralExpression))Tt(s.asKindOrThrow(SyntaxKind.ObjectLiteralExpression));else if(s.isKind(SyntaxKind.ArrayLiteralExpression))nr(s.asKindOrThrow(SyntaxKind.ArrayLiteralExpression));else if(s.isKind(SyntaxKind.SpreadElement)){let i=s.getText();e.removeElement(r),e.insertElement(r,`"${i}"`);}}}function jt(e){let t=e.getProperties();for(let r=0;r<t.length;r++){let s=t[r];if(s.isKind(SyntaxKind.PropertyAssignment)){let i=s,n=i.getInitializer();if(n&&n.isKind(SyntaxKind.StringLiteral)){let o=n.asKindOrThrow(SyntaxKind.StringLiteral).getLiteralValue();o.startsWith("...")&&(e.insertSpreadAssignment(r,{expression:o.slice(3)}),i.remove());}else n?.isKind(SyntaxKind.ObjectLiteralExpression)?jt(n):n&&n.isKind(SyntaxKind.ArrayLiteralExpression)&&or(n.asKindOrThrow(SyntaxKind.ArrayLiteralExpression));}}}function or(e){let t=e.getElements();for(let r=0;r<t.length;r++){let s=t[r];if(s.isKind(SyntaxKind.ObjectLiteralExpression))jt(s.asKindOrThrow(SyntaxKind.ObjectLiteralExpression));else if(s.isKind(SyntaxKind.ArrayLiteralExpression))or(s.asKindOrThrow(SyntaxKind.ArrayLiteralExpression));else if(s.isKind(SyntaxKind.StringLiteral)){let i=s.getText(),n=/(?:^['"])(\.\.\..*)(?:['"]$)/g;n.test(i)&&(e.removeElement(r),e.insertElement(r,i.replace(n,"$1")));}}}async function Ls(e){let r=(await ze(`const theme = ${e}`,null)).getStatements()[0];if(r?.getKind()===SyntaxKind.VariableStatement){let i=(r.getDeclarationList()?.getDeclarations()[0]).getInitializer();if(i?.isKind(SyntaxKind.ObjectLiteralExpression))return await We(i)}throw new Error("Invalid input: not an object literal")}function We(e){let t={};for(let r of e.getProperties())if(r.isKind(SyntaxKind.PropertyAssignment)){let s=r.getName().replace(/\'/g,"");r.getInitializer()?.isKind(SyntaxKind.ObjectLiteralExpression)?t[s]=We(r.getInitializer()):r.getInitializer()?.isKind(SyntaxKind.ArrayLiteralExpression)?t[s]=ar(r.getInitializer()):t[s]=Ot(r.getInitializer());}return t}function ar(e){let t=[];for(let r of e.getElements())r.isKind(SyntaxKind.ObjectLiteralExpression)?t.push(We(r.asKindOrThrow(SyntaxKind.ObjectLiteralExpression))):r.isKind(SyntaxKind.ArrayLiteralExpression)?t.push(ar(r.asKindOrThrow(SyntaxKind.ArrayLiteralExpression))):t.push(Ot(r));return t}function Ot(e){switch(e.getKind()){case SyntaxKind.StringLiteral:return e.getText();case SyntaxKind.NumericLiteral:return Number(e.getText());case SyntaxKind.TrueKeyword:return  true;case SyntaxKind.FalseKeyword:return  false;case SyntaxKind.NullKeyword:return null;case SyntaxKind.ArrayLiteralExpression:return e.getElements().map(Ot);case SyntaxKind.ObjectLiteralExpression:return We(e);default:return e.getText()}}function lr(e){let t={};for(let r of Object.keys(e)){let s=r.split("-"),i=s[0],n=s.slice(1).join("-");n===""?typeof t[i]=="object"?t[i].DEFAULT=`hsl(var(--${r}))`:t[i]=`hsl(var(--${r}))`:(typeof t[i]!="object"&&(t[i]={DEFAULT:`hsl(var(--${i}))`}),t[i][n]=`hsl(var(--${r}))`);}for(let[r,s]of Object.entries(t))typeof s=="object"&&s.DEFAULT===`hsl(var(--${r}))`&&!(r in e)&&delete s.DEFAULT;return t}async function fr(e,t,r){if(!e)return;r={silent:false,...r};let s=b__default.relative(t.resolvedPaths.cwd,t.resolvedPaths.tailwindConfig),i=R(`Updating ${u.info(s)}`,{silent:r.silent}).start(),n=await promises.readFile(t.resolvedPaths.tailwindConfig,"utf8"),o=await _s(n,e,t);await promises.writeFile(t.resolvedPaths.tailwindConfig,o,"utf8"),i?.succeed();}async function _s(e,t,r){let s=await ze(e,r),i=s.getDescendantsOfKind(SyntaxKind.ObjectLiteralExpression).find(n=>n.getProperties().some(o=>o.isKind(SyntaxKind.PropertyAssignment)&&o.getName()==="content"));return i?(zs(i,t),s.getFullText()):e}async function zs(e,t){let r=kt(e),s=e.getProperty("content");if(!s){let i={name:"content",initializer:`[${r}${t.join(`${r}, ${r}`)}${r}]`};return e.addPropertyAssignment(i),e}if(s.isKind(SyntaxKind.PropertyAssignment)){let i=s.getInitializer();if(i?.isKind(SyntaxKind.ArrayLiteralExpression))for(let n of t){let o=`${r}${n}${r}`;i.getElements().map(a=>a.getText()).includes(o)||i.addElement(o);}return e}return e}var Pe={"next-app":{name:"next-app",label:"Next.js",links:{installation:"https://ui.aodesu.com/docs/installation/next",tailwind:"https://tailwindcss.com/docs/guides/nextjs"}},"next-pages":{name:"next-pages",label:"Next.js",links:{installation:"https://ui.aodesu.com/docs/installation/next",tailwind:"https://tailwindcss.com/docs/guides/nextjs"}},vite:{name:"vite",label:"vite",links:{installation:"https://ui.aodesu.com/docs/installation/vite",tailwind:"https://tailwindcss.com/docs/guides/vite"}},manual:{name:"manual",label:"Manual",links:{installation:"https://ui.aodesu.com/docs/installation/manual",tailwind:"https://tailwindcss.com/docs/installation"}}};var ke=process.env.REGISTRY_URL??"https://ui.aodesu.com/r",Ke="aodesu",mr=[{name:"neutral",label:"Neutral"}],O={"@uidesu":`${ke}/styles/{style}/{name}.json`},Me=[{name:"toast",deprecatedBy:"sonner",message:"The toast component is deprecated. Use the sonner component instead."},{name:"toaster",deprecatedBy:"sonner",message:"The toaster component is deprecated. Use the sonner component instead."}];async function z(e,t){return createMatchPath(t.absoluteBaseUrl,t.paths)(e,void 0,()=>true,[".ts",".tsx",".jsx",".js",".css"])}var pr="@/components",dr="@/lib/utils",ur="app/globals.css",gr="tailwind.config.js";var Bs=cosmiconfig("components",{searchPlaces:["components.json"]});async function V(e){let t=await Gs(e);return t?(t.iconLibrary||(t.iconLibrary=t.style==="aodesu"?"radix":"lucide"),await ue(e,t)):null}async function ue(e,t){t.registries={...O,...t.registries||{}};let r=await loadConfig(e);if(r.resultType==="failed")throw new Error(`Failed to load ${t.tsx?"tsconfig":"jsconfig"}.json ${r.message??""}`.trim());return q.parse({...t,resolvedPaths:{cwd:e,tailwindConfig:t.tailwind.config?b__default.resolve(e,t.tailwind.config):"",tailwindCss:b__default.resolve(e,t.tailwind.css),utils:await z(t.aliases.utils,r),components:await z(t.aliases.components,r),ui:t.aliases.ui?await z(t.aliases.ui,r):b__default.resolve(await z(t.aliases.components,r)??e,"ui"),lib:t.aliases.lib?await z(t.aliases.lib,r):b__default.resolve(await z(t.aliases.utils,r)??e,".."),hooks:t.aliases.hooks?await z(t.aliases.hooks,r):b__default.resolve(await z(t.aliases.components,r)??e,"..","hooks")}})}async function Gs(e){try{let t=await Bs.search(e);if(!t)return null;let r=p.parse(t.config);if(r.registries){for(let s of Object.keys(r.registries))if(s in O)throw new Error(`"${s}" is a built-in registry and cannot be overriden.`)}return r}catch(t){let r=`${e}/components.json`;throw t instanceof Error&&t.message.includes("reserved registry")?t:new Error(`Invalid configuration found in ${u.info(r)}`)}}async function hr(e){let t={};for(let s of Object.keys(e.aliases)){if(!Hs(s,e))continue;let i=e.resolvedPaths[s],n=await Js(e.resolvedPaths.cwd,i);if(!n){t[s]=e;continue}t[s]=await V(n);}let r$1=r.safeParse(t);return r$1.success?r$1.data:null}async function Js(e,t){let r=Ys(e,t),s=b__default.relative(r,t),n=(await Ge.glob("**/package.json",{cwd:r,deep:3,ignore:["**/node_modules/**","**/dist/**","**/build/**","**/public/**"]})).map(o=>b__default.dirname(o)).find(o=>s.startsWith(o));return n?b__default.join(r,n):null}function Hs(e,t){return Object.keys(t.resolvedPaths).filter(r=>r!=="utils").includes(e)}function Ys(e,t){let r=e.split(b__default.sep),s=t.split(b__default.sep),i=[];for(let n=0;n<Math.min(r.length,s.length)&&r[n]===s[n];n++)i.push(r[n]);return i.join(b__default.sep)}async function yr(e,t){return (await N(e))?.tailwindVersion==="v4"?"aodesu":t}function Be(e){let t={resolvedPaths:{cwd:process.cwd(),tailwindConfig:"",tailwindCss:"",utils:"",components:"",ui:"",lib:"",hooks:""},style:"",tailwind:{config:"",css:"",baseColor:"",cssVariables:false},rsc:false,tsx:true,aliases:{components:"",utils:""},registries:{...O}};return e?{...t,...e,resolvedPaths:{...t.resolvedPaths,...e.resolvedPaths||{}},tailwind:{...t.tailwind,...e.tailwind||{}},aliases:{...t.aliases,...e.aliases||{}},registries:{...t.registries,...e.registries||{}}}:t}function Q(e="",t=true){let r=b__default.join(e,"package.json");return G.readJSONSync(r,{throws:t})}var Je=["**/node_modules/**",".next","public","dist","build"];z$1.object({compilerOptions:z$1.object({paths:z$1.record(z$1.string().or(z$1.array(z$1.string())))})});async function N(e){let[t,r,s,i,n,o,a,l]=await Promise.all([Ge.glob("**/{vite,app,next}.config.*|gatsby-config.*|composer.json|react-router.config.*",{cwd:e,deep:3,ignore:Je}),G.pathExists(b__default.resolve(e,"src")),si(e),ti(e),ei(e),wr(e),ri(e),Q(e,false)]),c=await G.pathExists(b__default.resolve(e,`${r?"src/":""}app`)),f={framework:Pe.manual,isSrcDir:r,isRSC:false,isTsx:s,tailwindConfigFile:i,tailwindCssFile:n,tailwindVersion:o,frameworkVersion:null,aliasPrefix:a};return t.find(p=>p.startsWith("next.config."))?.length?(f.framework=c?Pe["next-app"]:Pe["next-pages"],f.isRSC=c,f.frameworkVersion=await Xs(f.framework,l),f):(t.find(p=>p.startsWith("vite.config."))?.length&&(f.framework=Pe.vite),f)}async function Xs(e,t){if(!t||!["next-app","next-pages"].includes(e.name))return null;let r=t.dependencies?.next||t.devDependencies?.next;if(!r)return null;let s=r.match(/^[\^~]?(\d+\.\d+\.\d+)/);if(s)return s[1];let i=r.match(/(\d+\.\d+\.\d+)/);return i?i[1]:r}async function wr(e){let[t,r]=await Promise.all([Q(e,false),V(e)]);return r?.tailwind?.config===""?"v4":!t?.dependencies?.tailwindcss&&!t?.devDependencies?.tailwindcss?null:/^(?:\^|~)?3(?:\.\d+)*(?:-.*)?$/.test(t?.dependencies?.tailwindcss||t?.devDependencies?.tailwindcss||"")?"v3":"v4"}async function ei(e){let[t,r]=await Promise.all([Ge.glob(["**/*.css","**/*.scss"],{cwd:e,deep:5,ignore:Je}),wr(e)]);if(!t.length)return null;for(let s of t){let i=await G.readFile(b__default.resolve(e,s),"utf8");if(i.includes('@import "tailwindcss"')||i.includes("@import 'tailwindcss'")||i.includes("@tailwind base"))return s}return null}async function ti(e){let t=await Ge.glob("tailwind.config.*",{cwd:e,deep:3,ignore:Je});return t.length?t[0]:null}async function ri(e){let t=await loadConfig(e);if(t?.resultType==="failed"||!Object.entries(t?.paths).length)return null;for(let[r,s]of Object.entries(t.paths))if(s.includes("./*")||s.includes("./src/*")||s.includes("./app/*")||s.includes("./resources/js/*"))return r.replace(/\/\*$/,"")??null;return Object.keys(t?.paths)?.[0].replace(/\/\*$/,"")??null}async function si(e){return (await Ge.glob("tsconfig.*",{cwd:e,deep:1,ignore:Je})).length>0}async function xr(e,t=null){let[r,s]=await Promise.all([V(e),t?Promise.resolve(t):N(e)]);if(r)return r;if(!s||!s.tailwindCssFile||s.tailwindVersion==="v3"&&!s.tailwindConfigFile)return null;let i={$schema:"https://ui.aodesu.com/schema.json",rsc:s.isRSC,tsx:s.isTsx,style:"aodesu",tailwind:{config:s.tailwindConfigFile??"",baseColor:"zinc",css:s.tailwindCssFile,cssVariables:true,prefix:""},iconLibrary:"lucide",aliases:{components:`${s.aliasPrefix}/components`,ui:`${s.aliasPrefix}/components/ui`,hooks:`${s.aliasPrefix}/hooks`,lib:`${s.aliasPrefix}/lib`,utils:`${s.aliasPrefix}/lib/utils`}};return await ue(e,i)}async function X(e){if(!e.resolvedPaths?.cwd)return "v3";let t=await N(e.resolvedPaths.cwd);return t?.tailwindVersion?t.tailwindVersion:null}var m={error(...e){console.log(u.error(e.join(" ")));},warn(...e){console.log(u.warn(e.join(" ")));},info(...e){console.log(u.info(e.join(" ")));},success(...e){console.log(u.success(e.join(" ")));},log(...e){console.log(e.join(" "));},break(){console.log("");}};async function vr(e){let t={};if(!G.existsSync(e.cwd)||!G.existsSync(b__default.resolve(e.cwd,"package.json")))return t["1"]=true,{errors:t,projectInfo:null};let r=R("Preflight checks.",{silent:e.silent}).start();G.existsSync(b__default.resolve(e.cwd,"components.json"))&&!e.force&&(r?.fail(),m.break(),m.error(`A ${u.info("components.json")} file already exist at ${u.info(e.cwd)}. 
To start over, remove the ${u.info("components.json")} file and run ${u.info("init")} again.`),m.break(),process.exit(1)),r?.succeed();let s=R("Verifying framework.",{silent:e.silent}).start(),i=await N(e.cwd);(!i||i?.framework.name==="manual")&&(t["7"]=true,s?.fail(),m.break(),i?.framework.links.installation&&m.error(`We could not detect a supported framework at ${u.info(e.cwd)}.
Visit ${u.info(i?.framework.links.installation)} to manually configure your project. 
Once configured, you can use the cli to add components.`),m.break(),process.exit(1)),s?.succeed(`Verifying framework. Found ${u.info(i.framework.label)}.`);let n="Validating Tailwind CSS.";i.tailwindVersion==="v4"&&(n=`Validating Tailwind CSS config. Found ${u.info("v4")}.`);let o=R(n,{silent:e.silent}).start();i.tailwindVersion==="v3"&&(!i?.tailwindConfigFile||!i?.tailwindCssFile)?(t["5"]=true,o?.fail()):i.tailwindVersion==="v4"&&!i?.tailwindCssFile?(t["5"]=true,o?.fail()):i.tailwindVersion?o?.succeed():(t["5"]=true,o?.fail());let a=R("Validating import alias.",{silent:e.silent}).start();return i?.aliasPrefix?a?.succeed():(t["6"]=true,a?.fail()),Object.keys(t).length>0&&(t["5"]&&(m.break(),m.error(`No Tailwind CSS configuration found at ${u.info(e.cwd)}.`),m.error("It is likely you do not have Tailwind CSS installed or have an invalid configuration."),m.error("Install Tailwind CSS then try again."),i?.framework.links.tailwind&&m.error(`Visit ${u.info(i?.framework.links.tailwind)} to get started.`)),t["6"]&&(m.break(),m.error("No import alias found in your tsconfig.json file."),i?.framework.links.installation&&m.error(`Visit ${u.info(i?.framework.links.installation)} to learn how to set an import alias.`)),m.break(),process.exit(1)),{errors:t,projectInfo:i}}var K={NOT_FOUND:"NOT_FOUND",UNAUTHORIZED:"UNAUTHORIZED",FORBIDDEN:"FORBIDDEN",FETCH_ERROR:"FETCH_ERROR",NOT_CONFIGURED:"NOT_CONFIGURED",MISSING_ENV_VARS:"MISSING_ENV_VARS",LOCAL_FILE_ERROR:"LOCAL_FILE_ERROR",PARSE_ERROR:"PARSE_ERROR",UNKNOWN_ERROR:"UNKNOWN_ERROR"},A=class extends Error{code;statusCode;context;suggestion;timestamp;cause;constructor(t,r={}){super(t),this.name="RegistryError",this.code=r.code||K.UNKNOWN_ERROR,this.statusCode=r.statusCode,this.cause=r.cause,this.context=r.context,this.suggestion=r.suggestion,this.timestamp=new Date,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor);}toJSON(){return {name:this.name,message:this.message,code:this.code,statusCode:this.statusCode,context:this.context,suggestion:this.suggestion,timestamp:this.timestamp,stack:this.stack}}},Te=class extends A{constructor(r,s){let i=`The item at ${r} was not found. It may not exist at the registry.`;super(i,{code:K.NOT_FOUND,statusCode:404,cause:s,context:{url:r},suggestion:"Check if the item name is correct and the registry URL is accessible."});this.url=r;this.name="RegistryNotFoundError";}},Ye=class extends A{constructor(r,s){let i=`You are not authorized to access the item at ${r}. If this is a remote registry, you may need to authenticate.`;super(i,{code:K.UNAUTHORIZED,statusCode:401,cause:s,context:{url:r},suggestion:"Check your authentication credentials and environment variables."});this.url=r;this.name="RegistryUnauthorizedError";}},qe=class extends A{constructor(r,s){let i=`You are not authorized to access the item at ${r}. If this is a remote registry, you may need to authenticate.`;super(i,{code:K.FORBIDDEN,statusCode:403,cause:s,context:{url:r},suggestion:"Check your authentication credentials and environment variables."});this.url=r;this.name="RegistryForbiddenError";}},Ze=class extends A{constructor(r,s,i,n){let o=s?`Failed to fetch from registry (${s}): ${r}`:`Failed to fetch from registry: ${r}`,a=typeof n=="string"&&n?`${o} - ${n}`:o,l="Check your network connection and try again.";s===404?l="The requested resource was not found. Check the URL or item name.":s===500?l="The registry server encountered an error. Try again later.":s&&s>=400&&s<500&&(l="There was a client error. Check your request parameters.");super(a,{code:K.FETCH_ERROR,statusCode:s,cause:n,context:{url:r,responseBody:i},suggestion:l});this.url=r;this.responseBody=i;this.name="RegistryFetchError";}},J=class extends A{constructor(r){let s=r?`Unknown registry "${r}". Make sure it is defined in components.json as follows:
{
  "registries": {
    "${r}": "[URL_TO_REGISTRY]"
  }
}`:'Unknown registry. Make sure it is defined in components.json under "registries".';super(s,{code:K.NOT_CONFIGURED,context:{registryName:r},suggestion:"Add the registry configuration to your components.json file. Consult the registry documentation for the correct format."});this.registryName=r;this.name="RegistryNotConfiguredError";}},je=class extends A{constructor(r,s){super(`Failed to read local registry file: ${r}`,{code:K.LOCAL_FILE_ERROR,cause:s,context:{filePath:r},suggestion:"Check if the file exists and you have read permissions."});this.filePath=r;this.name="RegistryLocalFileError";}},U=class extends A{constructor(r,s){let i=`Failed to parse registry item: ${r}`;s instanceof z$1.ZodError&&(i=`Failed to parse registry item: ${r}
${s.errors.map(n=>`  - ${n.path.join(".")}: ${n.message}`).join(`
`)}`);super(i,{code:K.PARSE_ERROR,cause:s,context:{item:r},suggestion:"The registry item may be corrupted or have an invalid format. Please make sure it returns a valid JSON object. See https://ui.aodesu.com/schema/registry-item.json."});this.item=r;this.parseError=s,this.name="RegistryParseError";}parseError},Qe=class extends A{constructor(r,s){let i=`Registry "${r}" requires the following environment variables:

`+s.map(n=>`  \u2022 ${n}`).join(`
`);super(i,{code:K.MISSING_ENV_VARS,context:{registryName:r,missingVars:s},suggestion:"Set the required environment variables to your .env or .env.local file."});this.registryName=r;this.missingVars=s;this.name="RegistryMissingEnvironmentVariablesError";}};var Xe=class extends A{parseError;constructor(t){let r="Failed to parse registries index";if(t instanceof z$1.ZodError){let s=t.errors.filter(i=>i.path.length>0).map(i=>`"${i.path[0]}"`).filter((i,n,o)=>o.indexOf(i)===n);s.length>0?r=`Failed to parse registries index. Invalid registry namespace(s): ${s.join(", ")}
${t.errors.map(i=>`  - ${i.path.join(".")}: ${i.message}`).join(`
`)}`:r=`Failed to parse registries index:
${t.errors.map(i=>`  - ${i.path.join(".")}: ${i.message}`).join(`
`)}`;}super(r,{code:K.PARSE_ERROR,cause:t,context:{parseError:t},suggestion:"The registries index may be corrupted or have invalid registry namespace format. Registry names must start with @ (e.g., @aodesu, @example)."}),this.parseError=t,this.name="RegistriesIndexParseError";}};function T(e){if(m.break(),m.error("Something went wrong. Please check the error below for more details."),m.error("If the problem persist, please open an issue on GitHub."),m.error(""),typeof e=="string"&&(m.error(e),m.break(),process.exit(1)),e instanceof A&&(e.message&&(m.error(e.cause?"Error":"Message:"),m.error(e.message)),e.cause&&(m.error(`
Message:`),m.error(e.cause)),e.suggestion&&(m.error(`
Suggestion:`),m.error(e.suggestion)),m.break(),process.exit(1)),e instanceof Ct.ZodError){m.error("Validation failed:");for(let[t,r]of Object.entries(e.flatten().fieldErrors))m.error(`- ${u.info(t)}: ${r}`);m.break(),process.exit(1);}e instanceof Error&&(m.error(e.message),m.break(),process.exit(1)),m.break(),process.exit(1);}function Oe(e){return e.replace(/\${(\w+)}/g,(t,r)=>process.env[r]||"")}function Ne(e){let t=[],r=/\${(\w+)}/g,s;for(;(s=r.exec(e))!==null;)t.push(s[1]);return t}var oi=/^(@[a-zA-Z0-9](?:[a-zA-Z0-9-_]*[a-zA-Z0-9])?)\/(.+)$/;function M(e){if(!e.startsWith("@"))return {registry:null,item:e};let t=e.match(oi);return t?{registry:t[1],item:t[2]}:{registry:null,item:e}}function Cr(e,t,r={}){let{ignoreImports:s=false}=r,i=e.replace(/\r\n/g,`
`).trim(),n=t.replace(/\r\n/g,`
`).trim();if(i===n)return  true;if(!s)return  false;let o=/^(import\s+(?:type\s+)?(?:\*\s+as\s+\w+|\{[^}]*\}|\w+)?(?:\s*,\s*(?:\{[^}]*\}|\w+))?\s+from\s+["'])([^"']+)(["'])/gm,a=f=>f.replace(o,(p,d,g,w)=>{if(g.startsWith("."))return `${d}${g}${w}`;let S=g.split("/"),h=S[S.length-1];return `${d}@normalized/${h}${w}`}),l=a(i),c=a(n);return l===c}function ae(e){let t=b__default.basename(e);return /^\.env(\.|$)/.test(t)}function et(e){let t=[".env.local",".env",".env.development.local",".env.development"];for(let r of t){let s=b__default.join(e,r);if(existsSync(s))return s}return null}function he(e){let t=e.split(`
`),r={};for(let s of t){let i=s.trim();if(!i||i.startsWith("#"))continue;let n=i.indexOf("=");if(n===-1)continue;let o=i.substring(0,n).trim(),a=i.substring(n+1).trim();o&&(r[o]=a.replace(/^["']|["']$/g,""));}return r}function tt(e,t){let r=he(e),s=he(t),i=[];for(let n of Object.keys(s))n in r||i.push(n);return i}function rt(e,t){let r=he(e),s=he(t),i=e.trimEnd();i&&!i.endsWith(`
`)&&(i+=`
`);let n=[];for(let[o,a]of Object.entries(s))o in r||n.push(`${o}=${a}`);return n.length>0?(i&&(i+=`
`),i+=n.join(`
`),i+`
`):i&&!i.endsWith(`
`)?i+`
`:i}var st=async({sourceFile:e,config:t,baseColor:r})=>(t.tailwind?.cssVariables||!r?.inlineColors||e.getDescendantsOfKind(SyntaxKind.StringLiteral).forEach(s=>{let i=s.getLiteralText(),n=fi(i,r.inlineColors).trim();n!==i&&s.setLiteralValue(n);}),e);function Ft(e){if(!e.includes("/")&&!e.includes(":"))return [null,e,null];let t=[],[r,s]=e.split("/");if(!r.includes(":"))return [null,r,s];let i=r.split(":"),n=i.pop(),o=i.join(":");return t.push(o??null,n??null,s??null),t}var ci=["bg-","text-","border-","ring-offset-","ring-"];function fi(e,t){e.includes(" border ")&&(e=e.replace(" border "," border border-border "));let r=e.split(" "),s=new Set,i=new Set;for(let n of r){let[o,a,l]=Ft(n),c=ci.find(p=>a?.startsWith(p));if(!c){s.has(n)||s.add(n);continue}let f=a?.replace(c,"");if(f&&f in t.light){s.add([o,`${c}${t.light[f]}`].filter(Boolean).join(":")+(l?`/${l}`:"")),i.add(["dark",o,`${c}${t.dark[f]}`].filter(Boolean).join(":")+(l?`/${l}`:""));continue}s.has(n)||s.add(n);}return [...Array.from(s),...Array.from(i)].join(" ").trim()}var it={lucide:{name:"lucide-react",package:"lucide-react",import:"lucide-react"},radix:{name:"@radix-ui/react-icons",package:"@radix-ui/react-icons",import:"@radix-ui/react-icons"}};var Ir="lucide",nt=async({sourceFile:e,config:t})=>{if(!t.iconLibrary||!(t.iconLibrary in it))return e;let r=await Pr(),s=Ir,i=t.iconLibrary;if(s===i)return e;let n=[];for(let o of e.getImportDeclarations()??[])if(o.getModuleSpecifier()?.getText()===`"${it[Ir].import}"`){for(let a of o.getNamedImports()??[]){let l=a.getName(),c=r[l]?.[i];!c||n.includes(c)||(n.push(c),a.remove(),e.getDescendantsOfKind(SyntaxKind.JsxSelfClosingElement).filter(f=>f.getTagNameNode()?.getText()===l).forEach(f=>f.getTagNameNode()?.replaceWithText(c)));}o.getNamedImports()?.length===0&&o.remove();}if(n.length>0){let o=e.addImportDeclaration({moduleSpecifier:it[i]?.import,namedImports:n.map(a=>({name:a}))});pi(e)||o.replaceWithText(o.getText().replace(";",""));}return e};function pi(e){return e.getImportDeclarations()?.[0]?.getText().endsWith(";")??false}var ot=async({sourceFile:e,config:t,isRemote:r})=>{let s=t.aliases?.utils,n=`${typeof s=="string"&&s.includes("/")?s.split("/")[0]:"@"}/lib/utils`;if(![".tsx",".ts",".jsx",".js"].includes(e.getExtension()))return e;for(let o of e.getImportStringLiterals()){let a=ui(o.getLiteralValue(),t,r);if(o.setLiteralValue(a),n===a||a==="@/lib/utils"){if(!o.getFirstAncestorByKind(SyntaxKind.ImportDeclaration)?.getNamedImports().some(f=>f.getName()==="cn")||!t.aliases.utils)continue;o.setLiteralValue(n===a?a.replace(n,t.aliases.utils):t.aliases.utils);}}return e};function ui(e,t,r=false){if(!e.startsWith("@/")&&!r)return e;if(r&&e.startsWith("@/")&&(e=e.replace(/^@\//,"@/registry/aodesu/")),!e.startsWith("@/registry/")){let s=t.aliases.components.split("/")[0];return e.replace(/^@\//,`${s}/`)}return e.match(/^@\/registry\/(.+)\/ui/)?e.replace(/^@\/registry\/(.+)\/ui/,t.aliases.ui??`${t.aliases.components}/ui`):t.aliases.components&&e.match(/^@\/registry\/(.+)\/components/)?e.replace(/^@\/registry\/(.+)\/components/,t.aliases.components):t.aliases.lib&&e.match(/^@\/registry\/(.+)\/lib/)?e.replace(/^@\/registry\/(.+)\/lib/,t.aliases.lib):t.aliases.hooks&&e.match(/^@\/registry\/(.+)\/hooks/)?e.replace(/^@\/registry\/(.+)\/hooks/,t.aliases.hooks):e.replace(/^@\/registry\/[^/]+/,t.aliases.components)}var wi={sourceType:"module",allowImportExportEverywhere:true,allowReturnOutsideFunction:true,startLine:1,tokens:true,plugins:["asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","classStaticBlock","decimal","decorators-legacy","doExpressions","dynamicImport","exportDefaultFrom","exportNamespaceFrom","functionBind","functionSent","importAssertions","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{proposal:"minimal"}],["recordAndTuple",{syntaxType:"hash"}],"throwExpressions","topLevelAwait","v8intrinsic","typescript","jsx"]},kr=async({sourceFile:e,config:t})=>{let r=e.getFullText();if(t.tsx)return r;let s=at.parse(r,{parser:{parse:n=>parse(n,wi)}}),i=transformFromAstSync(s,r,{cloneInputAst:false,code:false,ast:true,plugins:[yi],configFile:false});if(!i||!i.ast)throw new Error("Failed to transform JSX");return at.print(i.ast).code};var bi=/^["']use client["']$/g,lt=async({sourceFile:e,config:t})=>{if(t.rsc)return e;let r=e.getFirstChildByKind(SyntaxKind.ExpressionStatement);return r&&bi.test(r.getText())&&r.remove(),e};var ct=async({sourceFile:e,config:t})=>{if(!t.tailwind?.prefix)return e;let r=await X(t);return e.getDescendantsOfKind(SyntaxKind.CallExpression).filter(s=>s.getExpression().getText()==="cva").forEach(s=>{if(s.getArguments()[0]?.isKind(SyntaxKind.StringLiteral)){let i=s.getArguments()[0];i&&i.replaceWithText(`"${ee(i.getText()?.replace(/"|'/g,""),t.tailwind.prefix,r)}"`);}s.getArguments()[1]?.isKind(SyntaxKind.ObjectLiteralExpression)&&s.getArguments()[1]?.getDescendantsOfKind(SyntaxKind.PropertyAssignment).find(i=>i.getName()==="variants")?.getDescendantsOfKind(SyntaxKind.PropertyAssignment).forEach(i=>{i.getDescendantsOfKind(SyntaxKind.PropertyAssignment).forEach(n=>{let o=n.getInitializerIfKind(SyntaxKind.StringLiteral);o&&o?.replaceWithText(`"${ee(o.getText()?.replace(/"|'/g,""),t.tailwind.prefix,r)}"`);});});}),e.getDescendantsOfKind(SyntaxKind.JsxAttribute).forEach(s=>{if(s.getNameNode().getText()==="className"){if(s.getInitializer()?.isKind(SyntaxKind.StringLiteral)){let i=s.getInitializer();i&&i.replaceWithText(`"${ee(i.getText()?.replace(/"|'/g,""),t.tailwind.prefix,r)}"`);}if(s.getInitializer()?.isKind(SyntaxKind.JsxExpression)){let i=s.getInitializer()?.getDescendantsOfKind(SyntaxKind.CallExpression).find(n=>n.getExpression().getText()==="cn");i&&i.getArguments().forEach(n=>{(n.isKind(SyntaxKind.ConditionalExpression)||n.isKind(SyntaxKind.BinaryExpression))&&n.getChildrenOfKind(SyntaxKind.StringLiteral).forEach(o=>{o.replaceWithText(`"${ee(o.getText()?.replace(/"|'/g,""),t.tailwind.prefix,r)}"`);}),n.isKind(SyntaxKind.StringLiteral)&&n.replaceWithText(`"${ee(n.getText()?.replace(/"|'/g,""),t.tailwind.prefix,r)}"`);});}}s.getNameNode().getText()==="classNames"&&s.getInitializer()?.isKind(SyntaxKind.JsxExpression)&&s.getDescendantsOfKind(SyntaxKind.PropertyAssignment).forEach(i=>{if(i.getInitializer()?.isKind(SyntaxKind.CallExpression)){let n=i.getInitializerIfKind(SyntaxKind.CallExpression);n&&n.getArguments().forEach(o=>{o.isKind(SyntaxKind.ConditionalExpression)&&o.getChildrenOfKind(SyntaxKind.StringLiteral).forEach(a=>{a.replaceWithText(`"${ee(a.getText()?.replace(/"|'/g,""),t.tailwind.prefix,r)}"`);}),o.isKind(SyntaxKind.StringLiteral)&&o.replaceWithText(`"${ee(o.getText()?.replace(/"|'/g,""),t.tailwind.prefix,r)}"`);});}if(i.getInitializer()?.isKind(SyntaxKind.StringLiteral)&&i.getNameNode().getText()!=="variant"){let n=i.getInitializer();n&&n.replaceWithText(`"${ee(n.getText()?.replace(/"|'/g,""),t.tailwind.prefix,r)}"`);}});}),e};function ee(e,t="",r){return r==="v3"?e.split(" ").map(s=>{let[i,n,o]=Ft(s);return i?o?`${i}:${t}${n}/${o}`:`${i}:${t}${n}`:o?`${t}${n}/${o}`:`${t}${n}`}).join(" "):e.split(" ").map(s=>s.indexOf(`${t}:`)===0?s:`${t}:${s.trim()}`).join(" ")}var Ei=new Project({compilerOptions:{}});async function Ii(e){let t=await promises.mkdtemp(b__default.join(tmpdir(),"uidesu-"));return b__default.join(t,e)}async function jr(e,t=[ot,lt,st,ct,nt]){let r=await Ii(e.filename),s=Ei.createSourceFile(r,e.raw,{scriptKind:ScriptKind.TSX});for(let i of t)await i({sourceFile:s,...e});return e.transformJsx?await kr({sourceFile:s,...e}):s.getText()}var Or=async({sourceFile:e})=>(e.getFunctions().forEach(t=>{t.getName()==="middleware"&&t.rename("proxy");}),e.getVariableDeclarations().forEach(t=>{t.getName()==="middleware"&&t.rename("proxy");}),e.getExportDeclarations().forEach(t=>{t.getNamedExports().forEach(s=>{s.getName()==="middleware"&&s.setName("proxy"),s.getAliasNode()?.getText()==="middleware"&&s.setAlias("proxy");});}),e);async function Ar(e,t,r){if(!e?.length)return {filesCreated:[],filesUpdated:[],filesSkipped:[]};r={overwrite:false,force:false,silent:false,isRemote:false,isWorkspace:false,...r};let s=R("Updating files.",{silent:r.silent})?.start(),[i,n]=await Promise.all([N(t.resolvedPaths.cwd),t.tailwind.baseColor?ft(t.tailwind.baseColor):Promise.resolve(void 0)]),o=[],a=[],l=[],c=[],f=null;for(let w=0;w<e.length;w++){let S=e[w];if(!S.content)continue;let h=Dt(S,t,{isSrcDir:i?.isSrcDir,framework:i?.framework.name,commonRoot:Lt(e.map(C=>C.path),S.path),path:r.path,fileIndex:w});if(!h)continue;let x=basename(S.path),E=b__default.dirname(h);if(t.tsx||(h=h.replace(/\.tsx?$/,C=>C===".tsx"?".jsx":".js")),ae(h)&&!existsSync(h)){let C=et(E);C&&(h=C);}let j=existsSync(h);if(j&&statSync(h).isDirectory())throw new Error(`Cannot write to ${h}: path exists and is a directory. Please provide a file path instead.`);let I=ae(h)?S.content:await jr({filename:S.path,raw:S.content,config:t,baseColor:n,transformJsx:!t.tsx,isRemote:r.isRemote},[ot,lt,st,ct,nt,...Nr(h,i,t)?[Or]:[]]);if(j&&!ae(h)){let C=await promises.readFile(h,"utf-8");if(Cr(C,I,{ignoreImports:r.isWorkspace})){l.push(b__default.relative(t.resolvedPaths.cwd,h));continue}}if(j&&!r.overwrite&&!ae(h)){s.stop(),r.rootSpinner&&r.rootSpinner.stop();let{overwrite:C}=await Bt({type:"confirm",name:"overwrite",message:`The file ${u.info(x)} already exists. Would you like to overwrite?`,initial:false});if(!C){l.push(b__default.relative(t.resolvedPaths.cwd,h)),r.rootSpinner&&r.rootSpinner.start();continue}s?.start(),r.rootSpinner&&r.rootSpinner.start();}if(Nr(h,i,t)&&(h=h.replace(/middleware\.(ts|js)$/,"proxy.$1")),existsSync(E)||await promises.mkdir(E,{recursive:true}),ae(h)&&j){let C=await promises.readFile(h,"utf-8"),q=rt(C,I);if(c=tt(C,I),f=b__default.relative(t.resolvedPaths.cwd,h),!c.length){l.push(b__default.relative(t.resolvedPaths.cwd,h));continue}await promises.writeFile(h,q,"utf-8"),a.push(b__default.relative(t.resolvedPaths.cwd,h));continue}await promises.writeFile(h,I,"utf-8"),j?a.push(b__default.relative(t.resolvedPaths.cwd,h)):(o.push(b__default.relative(t.resolvedPaths.cwd,h)),ae(h)&&(c=Object.keys(he(I)),f=b__default.relative(t.resolvedPaths.cwd,h)));}let p=[...o,...a,...l],d=await Di(p,t);if(a.push(...d),a=a.filter(w=>!o.includes(w)),!(o.length||a.length)&&!l.length&&s?.info("No files updated."),o=Array.from(new Set(o)),a=Array.from(new Set(a)),l=Array.from(new Set(l)),o.length){if(s?.succeed(`Created ${o.length} ${o.length===1?"file":"files"}:`),!r.silent)for(let w of o)m.log(`  - ${w}`);}else s?.stop();if(a.length&&(R(`Updated ${a.length} ${a.length===1?"file":"files"}:`,{silent:r.silent})?.info(),!r.silent))for(let w of a)m.log(`  - ${w}`);if(l.length&&(R(`Skipped ${l.length} ${a.length===1?"file":"files"}: (files might be identical, use --overwrite to overwrite)`,{silent:r.silent})?.info(),!r.silent))for(let w of l)m.log(`  - ${w}`);if(c.length&&f&&(R(`Added the following variables to ${u.info(f)}:`)?.info(),!r.silent))for(let w of c)m.log(`  ${u.success("+")} ${w}`);return r.silent||m.break(),{filesCreated:o,filesUpdated:a,filesSkipped:l}}function Dt(e,t,r){if(r.path){let n=b__default.isAbsolute(r.path)?r.path:b__default.join(t.resolvedPaths.cwd,r.path);if(/\.[^/\\]+$/.test(n)){if(r.fileIndex===0)return n}else {let a=b__default.basename(e.path);return b__default.join(n,a)}}if(e.target){if(e.target.startsWith("~/"))return b__default.join(t.resolvedPaths.cwd,e.target.replace("~/",""));let n=e.target;return e.type==="registry:page"&&(n=Fi(n,r.framework),!n)?"":r.isSrcDir?b__default.join(t.resolvedPaths.cwd,"src",n.replace("src/","")):b__default.join(t.resolvedPaths.cwd,n.replace("src/",""))}let s=$i(e,t),i=Ai(e.path,s);return b__default.join(s,i)}function $i(e,t){return e.type==="registry:ui"?t.resolvedPaths.ui:e.type==="registry:lib"?t.resolvedPaths.lib:e.type==="registry:block"||e.type==="registry:component"?t.resolvedPaths.components:e.type==="registry:hook"?t.resolvedPaths.hooks:t.resolvedPaths.components}function Lt(e,t){let r=e.map(o=>o.replace(/^\//,"")),s=t.replace(/^\//,""),i=s.split("/").slice(0,-1).join("/");if(!i)return "";let n=i.split("/");for(let o=n.length;o>0;o--){let a=n.slice(0,o).join("/");if(r.some(c=>c!==s&&c.startsWith(a+"/")))return "/"+a}return "/"+i}function Ai(e,t){let r=e.replace(/^\/|\/$/g,""),s=t.replace(/^\/|\/$/g,""),i=r.split("/"),n=s.split("/"),o=n[n.length-1],a=i.findIndex(l=>l===o);return a===-1?i[i.length-1]:i.slice(a+1).join("/")}function Fi(e,t){if(!t)return "";if(t==="next-app")return e;if(t==="next-pages"){let r=e.replace(/^app\//,"pages/");return r=r.replace(/\/page(\.[jt]sx?)$/,"$1"),r}return ""}async function Di(e,t){let r=new Project({compilerOptions:{}}),s=await N(t.resolvedPaths.cwd),i=loadConfig(t.resolvedPaths.cwd),n=[];if(!s||i.resultType==="failed")return [];for(let o of e){let a=b__default.resolve(t.resolvedPaths.cwd,o);if(!existsSync(a))continue;let l=await promises.readFile(a,"utf-8"),c=await promises.mkdtemp(b__default.join(tmpdir(),"shadcn-")),f=r.createSourceFile(b__default.join(c,basename(a)),l,{scriptKind:ScriptKind.TSX});if(![".tsx",".ts",".jsx",".js"].includes(f.getExtension()))continue;let p=f.getImportDeclarations();for(let d of p){let g=d.getModuleSpecifierValue();if(s?.aliasPrefix&&!g.startsWith(`${s.aliasPrefix}/`))continue;let w=await z(g,i);if(!w)continue;let S=Li(w,e,t);if(!S)continue;let h=Vi(S,t,s);!h||h===g||(d.setModuleSpecifier(h),await promises.writeFile(a,f.getFullText(),"utf-8"),n.push(o));}}return n}function Li(e,t,r,s=[".tsx",".ts",".js",".jsx",".css"]){let i=b__default.normalize(r.resolvedPaths.cwd),n=t.map(h=>h.split(b__default.sep).join(b__default.posix.sep)),o=new Set(n),a=b__default.extname(e),l=a!=="",c=l?e.slice(0,-a.length):e,p=b__default.relative(i,c).split(b__default.sep).join(b__default.posix.sep),d=l?[a]:s,g=new Set;for(let h of d){let x=c+h,E=b__default.posix.normalize(b__default.relative(i,x));(o.has(E)||existsSync(x))&&g.add(E);let j=b__default.join(c,`index${h}`),I=b__default.posix.normalize(b__default.relative(i,j));(o.has(I)||existsSync(j))&&g.add(I);}let w=b__default.basename(c);for(let h of n)d.some(x=>h.endsWith(`/${w}${x}`))&&g.add(h);return g.size===0?null:Array.from(g).sort((h,x)=>{let E=b__default.posix.extname(h),j=b__default.posix.extname(x),I=d.indexOf(E)-d.indexOf(j);if(I!==0)return I;let C=p&&h.startsWith(p)?-1:1,q=p&&x.startsWith(p)?-1:1;return C-q})[0]}function Vi(e,t,r){let s=b__default.normalize(b__default.join(t.resolvedPaths.cwd,e)),i=Object.entries(t.resolvedPaths).filter(([,w])=>w&&s.startsWith(b__default.normalize(w+b__default.sep))).sort((w,S)=>S[1].length-w[1].length);if(i.length===0)return null;let[n,o]=i[0],a=b__default.relative(o,s);a=a.split(b__default.sep).join("/");let l=b__default.posix.extname(a),f=[".ts",".tsx",".js",".jsx"].includes(l)?"":l,p=a.slice(0,a.length-l.length);p.endsWith("/index")&&(p=p.slice(0,-6));let d=n==="cwd"?r.aliasPrefix:t.aliases[n];if(!d)return null;let g=p===""?"":`/${p}`;return g=g.replace("/src",""),`${d}${g}${f}`}function Nr(e,t,r){let s=e===b__default.join(r.resolvedPaths.cwd,"middleware.ts")||e===b__default.join(r.resolvedPaths.cwd,"middleware.js"),i=t?.framework.name==="next-app"||t?.framework.name==="next-pages";if(!s||!i||!t?.frameworkVersion)return  false;let n=parseInt(t.frameworkVersion.split(".")[0]);return !isNaN(n)&&n>=16}function B(e){try{return new URL(e),!0}catch{return  false}}function mt(e){return e.endsWith(".json")&&!B(e)}function Dr(e){return !e||e.type!=="registry:item"&&e.type!=="registry:file"?false:(e.files??[]).every(r=>!!r.target&&(r.type==="registry:file"||r.type==="registry:item"))}async function Lr(e,t){if(!_i(t))return Ct.array(b$1).parse(e.flat().filter(Boolean));let r=await N(t.resolvedPaths.cwd),s=new Map,i=Ct.array(b$1).parse(e.flat().filter(Boolean));return i.forEach(n=>{let o=Dt(n,t,{isSrcDir:r?.isSrcDir,framework:r?.framework.name,commonRoot:Lt(i.map(a=>a.path),n.path)});o&&s.set(o,n);}),Array.from(s.values())}function _i(e){return !!(e?.resolvedPaths?.cwd&&(e?.resolvedPaths?.ui||e?.resolvedPaths?.lib||e?.resolvedPaths?.components||e?.resolvedPaths?.hooks))}function Wi(e){return e.style?e.style==="aodesu"&&e.tailwind?.config===""?Ke:e.style:Ke}function H(e){let t=Be({style:Ke,registries:O});return e?q.parse(xe(t,{...e,style:Wi(e),registries:{...O,...e.registries}})):t}var pt={headers:{}};function dt(e){pt.headers={...pt.headers,...e};}function Vr(e){return pt.headers[e]||{}}function le(){pt.headers={};}function Ui(e){let t=new Set;return typeof e=="string"?Ne(e).forEach(r=>t.add(r)):(Ne(e.url).forEach(r=>t.add(r)),e.params&&Object.values(e.params).forEach(r=>{Ne(r).forEach(s=>t.add(s));}),e.headers&&Object.values(e.headers).forEach(r=>{Ne(r).forEach(s=>t.add(s));})),Array.from(t)}function _r(e,t){let s=Ui(t).filter(i=>!process.env[i]);if(s.length>0)throw new Qe(e,s)}var zr="{name}",ut="{style}",Wr=/\${(\w+)}/g,Ur="?",Ki="&";function we(e,t){let{registry:r,item:s}=M(e);if(!r)return null;let n=(t?.registries||{})[r];if(!n)throw new J(r);return _r(r,n),{url:Mi(s,n,t),headers:Bi(n)}}function Mi(e,t,r){if(typeof t=="string"){let i=t.replace(zr,e);return r?.style&&i.includes(ut)&&(i=i.replace(ut,r.style)),Oe(i)}let s=t.url.replace(zr,e);return r?.style&&s.includes(ut)&&(s=s.replace(ut,r.style)),s=Oe(s),t.params?Gi(s,t.params):s}function Bi(e){if(typeof e=="string"||!e.headers)return {};let t={};for(let[r,s]of Object.entries(e.headers)){let i=Oe(s);Ji(s,i)&&(t[r]=i);}return t}function Gi(e,t){let r=new URLSearchParams;for(let[n,o]of Object.entries(t)){let a=Oe(o);a&&r.append(n,a);}let s=r.toString();if(!s)return e;let i=e.includes(Ur)?Ki:Ur;return `${e}${i}${s}`}function Ji(e,t){let r=t.trim();if(!r)return  false;if(e.includes("${")&&e.match(Wr)){let i=e.replace(Wr,"").trim();return r!==i}return  true}function gt(e){if(B(e)){let t=new URL(e);return t.pathname.match(/\/chat\/b\//)&&!t.pathname.endsWith("/json")&&(t.pathname=`${t.pathname}/json`),t.toString()}return `${ke}/${e}`}var Qi=process.env.https_proxy?new HttpsProxyAgent(process.env.https_proxy):void 0,Vt=new Map;async function F(e,t={}){t={useCache:true,...t};try{return await Promise.all(e.map(async s=>{let i=gt(s);if(t.useCache&&Vt.has(i))return Vt.get(i);let n=(async()=>{let o=Vr(i),a=await qi(i,{agent:Qi,headers:{...o}});if(!a.ok){let l;if(a.headers.get("content-type")?.includes("application/json")){let c=await a.json(),f=z$1.object({detail:z$1.string().optional(),title:z$1.string().optional(),message:z$1.string().optional(),error:z$1.string().optional()}).safeParse(c);f.success&&(l=f.data.detail||f.data.message,f.data.error&&(l=`[${f.data.error}] ${l}`));}throw a.status===401?new Ye(i,l):a.status===404?new Te(i,l):a.status===403?new qe(i,l):new Ze(i,a.status,l)}return a.json()})();return t.useCache&&Vt.set(i,n),n}))}catch(r){throw r}}async function Mr(e){try{let t=e;e.startsWith("~/")&&(t=b__default.join(homedir(),e.slice(2)));let r=b__default.resolve(t),s=await promises.readFile(r,"utf8"),i=JSON.parse(s);try{return g.parse(i)}catch(n){throw new U(e,n)}}catch(t){throw t instanceof Error&&(t.message.includes("ENOENT")||t.message.includes("no such file"))?new je(e,t):t instanceof U?t:new je(e,t)}}function Ae(e,t){let r={},s=[...e];if(!t?.registries)return dt({}),s;for(let i=0;i<s.length;i++){let n=we(s[i],t);n&&(s[i]=n.url,Object.keys(n.headers).length>0&&(r[n.url]=n.headers));}return dt(r),s}async function Y(e,t,r={}){return await Promise.all(e.map(async i=>{if(mt(i))return Mr(i);if(B(i)){let[a]=await F([i],r);try{return g.parse(a)}catch(l){throw new U(i,l)}}if(i.startsWith("@")&&t?.registries){let a=Ae([i],t),[l]=await F(a,r);try{return g.parse(l)}catch(c){throw new U(i,c)}}let n=`styles/${t?.style??"aodesu"}/${i}.json`,[o]=await F([n],r);try{return g.parse(o)}catch(a){throw new U(i,a)}}))}g.extend({_source:Ct.string().optional()});async function _t(e,t,r={}){r={useCache:true,...r};let s=[],i=[],n=[],o=Array.from(new Set(e)),a=await Y(o,t,r),l=new Map;for(let x=0;x<a.length;x++)a[x]&&l.set(o[x],a[x]);for(let[x,E]of Array.from(l.entries())){let j={...E,_source:x};if(s.push(j),E.registryDependencies){let I=E.registryDependencies;if(t?.registries)I=Ae(E.registryDependencies,t);else {let de=E.registryDependencies.filter(Ce=>Ce.startsWith("@"));if(de.length>0){let{registry:Ce}=M(de[0]);throw new J(Ce)}}let{items:C,registryNames:q}=await Fe(I,t,r,new Set(o));i.push(...C),n.push(...q);}}if(s.push(...i),n.length>0){let x=Array.from(new Set(n)),E=x.filter(I=>!I.startsWith("@")),j=x.filter(I=>I.startsWith("@"));if(j.length>0){let I=await Y(j,t,r);for(let C=0;C<I.length;C++){let de={...I[C],_source:j[C]};s.push(de);}}if(E.length>0){let I=await ht();if(!I&&s.length===0)return null;if(I){E.includes("index")&&E.unshift("index");let C=[];for(let bs of E){let Rs=await en(bs,t,r);C.push(...Rs);}let q=Array.from(new Set(C)),de=await F(q,r),Ce=Ct.array(g).parse(de);s.push(...Ce);}}}if(!s.length)return null;if((o.includes("index")||n.includes("index"))&&t.tailwind.baseColor){let x=await tn(t.tailwind.baseColor,t);x&&s.unshift(x);}let c=new Map;s.forEach(x=>{let E=x._source||x.name;c.set(x,E);}),s=sn(s,c),s.sort((x,E)=>x.type==="registry:theme"&&E.type!=="registry:theme"?-1:x.type!=="registry:theme"&&E.type==="registry:theme"?1:0);let f={};s.forEach(x=>{f=xe(f,x.tailwind??{});});let p={};s.forEach(x=>{p=xe(p,x.cssVars??{});});let d={};s.forEach(x=>{d=xe(d,x.css??{});});let g$1="";s.forEach(x=>{x.docs&&(g$1+=`${x.docs}
`);});let w={};s.forEach(x=>{w=xe(w,x.envVars??{});});let S=await Lr(s.map(x=>x.files??[]),t),h=m$1.parse({dependencies:xe.all(s.map(x=>x.dependencies??[])),devDependencies:xe.all(s.map(x=>x.devDependencies??[])),files:S,tailwind:f,cssVars:p,css:d,docs:g$1});return Object.keys(w).length>0&&(h.envVars=w),h}async function Fe(e,t,r={},s=new Set){let i=[],n=[];for(let o of e)if(!s.has(o)){if(s.add(o),B(o)||mt(o)){let[a]=await Y([o],t,r);if(a&&(i.push(a),a.registryDependencies)){let l=t?.registries?Ae(a.registryDependencies,t):a.registryDependencies,c=await Fe(l,t,r,s);i.push(...c.items),n.push(...c.registryNames);}}else if(o.startsWith("@")&&t?.registries){let{registry:a}=M(o);if(a&&!(a in t.registries))throw new J(a);let[l]=await Y([o],t,r);if(l&&(i.push(l),l.registryDependencies)){let c=t?.registries?Ae(l.registryDependencies,t):l.registryDependencies,f=await Fe(c,t,r,s);i.push(...f.items),n.push(...f.registryNames);}}else if(n.push(o),t)try{let[a]=await Y([o],t,r);if(a&&a.registryDependencies){let l=t?.registries?Ae(a.registryDependencies,t):a.registryDependencies,c=await Fe(l,t,r,s);i.push(...c.items),n.push(...c.registryNames);}}catch{}}return {items:i,registryNames:n}}async function en(e,t,r={}){if(B(e))return [e];let{registryNames:s}=await Fe([e],t,r,new Set),i=t.resolvedPaths?.cwd?await yr(t.resolvedPaths.cwd,t.style):t.style,n=s.map(o=>gt(B(o)?o:`styles/${i}/${o}.json`));return Array.from(new Set(n))}async function tn(e,t){let[r,s]=await Promise.all([ft(e),X(t)]);if(!r)return null;let i={name:e,type:"registry:theme",tailwind:{config:{theme:{extend:{borderRadius:{lg:"var(--radius)",md:"calc(var(--radius) - 2px)",sm:"calc(var(--radius) - 4px)"},colors:{}}}}},cssVars:{theme:{},light:{radius:"0.5rem"},dark:{}}};return t.tailwind.cssVariables&&(i.tailwind.config.theme.extend.colors={...i.tailwind.config.theme.extend.colors,...lr(r.cssVars.dark??{})},i.cssVars={theme:{...r.cssVars.theme,...i.cssVars.theme},light:{...r.cssVars.light,...i.cssVars.light},dark:{...r.cssVars.dark,...i.cssVars.dark}},s==="v4"&&r.cssVarsV4&&(i.cssVars={theme:{...r.cssVarsV4.theme,...i.cssVars.theme},light:{radius:"0.625rem",...r.cssVarsV4.light},dark:{...r.cssVarsV4.dark}})),i}function re(e,t){let r=t||e.name,s=createHash("sha256").update(r).digest("hex").substring(0,8);return `${e.name}::${s}`}function rn(e){if(B(e)){let s=new URL(e).pathname,i=s.match(/\/([^/]+)\.json$/),n=i?i[1]:b__default.basename(s,".json");return {name:n,hash:re({name:n},e)}}if(mt(e)){let r=e.match(/\/([^/]+)\.json$/),s=r?r[1]:b__default.basename(e,".json");return {name:s,hash:re({name:s},e)}}let{item:t}=M(e);return {name:t,hash:re({name:t},e)}}function sn(e,t){let r=new Map,s=new Map,i=new Map,n=new Map;e.forEach(c=>{let f=t.get(c)||c.name,p=re(c,f);r.set(p,c),s.set(p,c),i.set(p,0),n.set(p,[]);});let o=new Map;e.forEach(c=>{let f=t.get(c)||c.name,p=re(c,f);o.has(c.name)||o.set(c.name,[]),o.get(c.name).push(p),f!==c.name&&(o.has(f)||o.set(f,[]),o.get(f).push(p));}),e.forEach(c=>{let f=t.get(c)||c.name,p=re(c,f);c.registryDependencies&&c.registryDependencies.forEach(d=>{let g,w=o.get(d)||[];if(w.length===1)g=w[0];else if(w.length>1)g=w[0];else {let{name:S}=rn(d),h=o.get(S)||[];h.length>0&&(g=h[0]);}g&&r.has(g)&&(n.get(g).push(p),i.set(p,i.get(p)+1));});});let a=[],l=[];for(i.forEach((c,f)=>{c===0&&a.push(f);});a.length>0;){let c=a.shift(),f=r.get(c);l.push(f),n.get(c).forEach(p=>{let d=i.get(p)-1;i.set(p,d),d===0&&a.push(p);});}if(l.length!==e.length){console.warn("Circular dependency detected in registry items");let c=new Set(l.map(f=>{let p=t.get(f)||f.name;return re(f,p)}));e.forEach(f=>{let p=t.get(f)||f.name,d=re(f,p);c.has(d)||l.push(f);});}return l}async function se(e,t){let{config:r,useCache:s}=t||{};return le(),Y(e,H(r),{useCache:s})}async function ht(){try{let[e]=await F(["index.json"]);return i.parse(e)}catch(e){m.error(`
`),T(e);}}async function zt(){try{let[e]=await F(["styles/index.json"]);return j.parse(e)}catch(e){return m.error(`
`),T(e),[]}}async function Pr(){try{let[e]=await F(["icons/index.json"]);return k.parse(e)}catch(e){return T(e),{}}}async function Wt(){return mr}async function ft(e){try{let[t]=await F([`colors/${e}.json`]);return l.parse(t)}catch(t){T(t);}}async function Jr(e){e={useCache:true,...e};let t=`${ke}/registries.json`,[r]=await F([t],{useCache:e.useCache});try{return u$1.parse(r)}catch(s){throw s instanceof Ct.ZodError?new Xe(s):s}}function Hr(e,t){if(e.includes("\0"))return  false;let r;try{r=e;let d="";for(;r!==d&&r.includes("%");)d=r,r=decodeURIComponent(r);}catch{return  false}let s=b__default.normalize(r.replace(/\\/g,"/")),i=b__default.normalize(t),n=d=>d.replace(/\[\.\.\..*?\]/g,"").includes("..");if(n(s)||n(r)||n(e))return  false;let o=d=>d.replace(/\[\.\.\..*?\]/g,""),a=o(e),l=o(r);if([/\.\.[\/\\]/,/[\/\\]\.\./,/\.\./,/\.\.%/,/\x00/,/[\x01-\x1f]/].some(d=>d.test(a)||d.test(l))||(e.includes("~")||r.includes("~"))&&(e.includes("../")||r.includes("../")))return  false;if(/^[a-zA-Z]:[\/\\]/.test(r))return process.platform==="win32"?r.toLowerCase().startsWith(t.toLowerCase()):false;if(b__default.isAbsolute(s))return s.startsWith(i+b__default.sep);let p=b__default.resolve(i,s);return p.startsWith(i+b__default.sep)||p===i}async function qr(e,t,r){if(!t.resolvedPaths.tailwindCss||!e||Object.keys(e).length===0)return;r={silent:false,...r};let s=t.resolvedPaths.tailwindCss,i=b__default.relative(t.resolvedPaths.cwd,s),n=R(`Updating ${u.info(i)}`,{silent:r.silent}).start(),o=await promises.readFile(s,"utf8"),a=await an(o,e);await promises.writeFile(s,a,"utf8"),n.succeed();}async function an(e,t){let r=[ln(t)],s=await v(r).process(e,{from:void 0}),i=s.css,n=s.root;if(n.nodes&&n.nodes.length>0){let o=n.nodes[n.nodes.length-1];o.type==="atrule"&&!o.nodes&&!i.trimEnd().endsWith(";")&&(i=i.trimEnd()+";");}return i=i.replace(/\/\* ---break--- \*\//g,""),i=i.replace(/(\n\s*\n)+/g,`

`),i=i.trimEnd(),i}function ln(e){return {postcssPlugin:"update-css",Once(t){for(let[r,s]of Object.entries(e))if(r.startsWith("@")){let i=r.match(/@([a-zA-Z-]+)\s*(.*)/);if(!i)continue;let[,n,o]=i;if(n==="import"){if(!t.nodes?.find(l=>l.type==="atrule"&&l.name==="import"&&l.params===o)){let l=v.atRule({name:"import",params:o,raws:{semicolon:true}}),c=t.nodes?.filter(f=>f.type==="atrule"&&f.name==="import");if(c&&c.length>0){let f=c[c.length-1];l.raws.before=`
`,t.insertAfter(f,l);}else !t.nodes||t.nodes.length,l.raws.before="",t.prepend(l);}}else if(n==="plugin"){let a=o;o&&!o.startsWith('"')&&!o.startsWith("'")&&(a=`"${o}"`);let l=f=>f.startsWith('"')&&f.endsWith('"')||f.startsWith("'")&&f.endsWith("'")?f.slice(1,-1):f;if(!t.nodes?.find(f=>f.type!=="atrule"||f.name!=="plugin"?false:l(f.params)===l(o))){let f=v.atRule({name:"plugin",params:a,raws:{semicolon:true,before:`
`}}),p=t.nodes?.filter(g=>g.type==="atrule"&&g.name==="import"),d=t.nodes?.filter(g=>g.type==="atrule"&&g.name==="plugin");if(d&&d.length>0){let g=d[d.length-1];t.insertAfter(g,f);}else if(p&&p.length>0){let g=p[p.length-1];t.insertAfter(g,f),t.insertBefore(f,v.comment({text:"---break---"})),t.insertAfter(f,v.comment({text:"---break---"}));}else t.prepend(f),t.insertBefore(f,v.comment({text:"---break---"})),t.insertAfter(f,v.comment({text:"---break---"}));}}else if(typeof s=="object"&&Object.keys(s).length===0){if(!t.nodes?.find(l=>l.type==="atrule"&&l.name===n&&l.params===o)){let l=v.atRule({name:n,params:o,raws:{semicolon:true}});t.append(l),t.insertBefore(l,v.comment({text:"---break---"}));}}else if(n==="keyframes"){let a=t.nodes?.find(c=>c.type==="atrule"&&c.name==="theme"&&c.params==="inline");a||(a=v.atRule({name:"theme",params:"inline",raws:{semicolon:true,between:" ",before:`
`}}),t.append(a),t.insertBefore(a,v.comment({text:"---break---"})));let l=v.atRule({name:"keyframes",params:o,raws:{semicolon:true,between:" ",before:`
  `}});if(a.append(l),typeof s=="object")for(let[c,f]of Object.entries(s))ce(l,c,f);}else if(n==="utility"){let a=t.nodes?.find(l=>l.type==="atrule"&&l.name===n&&l.params===o);if(a){if(typeof s=="object")for(let[l,c]of Object.entries(s))if(typeof c=="string"){let f=a.nodes?.find(d=>d.type==="decl"&&d.prop===l),p=v.decl({prop:l,value:c,raws:{semicolon:true,before:`
    `}});f?f.replaceWith(p):a.append(p);}else typeof c=="object"&&ce(a,l,c);}else {let l=v.atRule({name:n,params:o,raws:{semicolon:true,between:" ",before:`
`}});if(t.append(l),t.insertBefore(l,v.comment({text:"---break---"})),typeof s=="object")for(let[c,f]of Object.entries(s))if(typeof f=="string"){let p=v.decl({prop:c,value:f,raws:{semicolon:true,before:`
    `}});l.append(p);}else typeof f=="object"&&ce(l,c,f);}}else n==="property"?ce(t,r,s):Zr(t,n,o,s);}else ce(t,r,s);}}}function Zr(e,t,r,s){let i=e.nodes?.find(n=>n.type==="atrule"&&n.name===t&&n.params===r);if(i||(i=v.atRule({name:t,params:r,raws:{semicolon:true,between:" ",before:`
`}}),e.append(i),e.insertBefore(i,v.comment({text:"---break---"}))),typeof s=="object")for(let[n,o]of Object.entries(s))if(n.startsWith("@")){let a=n.match(/@([a-zA-Z-]+)\s*(.*)/);if(a){let[,l,c]=a;Zr(i,l,c,o);}}else ce(i,n,o);else if(typeof s=="string")try{let o=v.parse(`.temp{${s}}`).first;if(o&&o.nodes){let a=v.rule({selector:"temp",raws:{semicolon:!0,between:" ",before:`
  `}});o.nodes.forEach(l=>{if(l.type==="decl"){let c=l.clone();c.raws.before=`
    `,a.append(c);}}),a.nodes?.length&&i.append(a);}}catch(n){throw console.error("Error parsing at-rule content:",s,n),n}}function ce(e,t,r){let s=e.nodes?.find(i=>i.type==="rule"&&i.selector===t);if(s||(s=v.rule({selector:t,raws:{semicolon:true,between:" ",before:`
  `}}),e.append(s)),typeof r=="object"){for(let[i,n]of Object.entries(r))if(i.startsWith("@")&&typeof n=="object"&&n!==null&&Object.keys(n).length===0){let o=i.match(/@([a-zA-Z-]+)\s*(.*)/);if(o){let[,a,l]=o,c=v.atRule({name:a,params:l,raws:{semicolon:true,before:`
    `}});s.append(c);}}else if(typeof n=="string"){let o=v.decl({prop:i,value:n,raws:{semicolon:true,before:`
    `}}),a=s.nodes?.find(l=>l.type==="decl"&&l.prop===i);a?a.replaceWith(o):s.append(o);}else if(typeof n=="object"){let o=i.startsWith("&")?t.replace(/^([^:]+)/,`$1${i.substring(1)}`):i;ce(e,o,n);}}else if(typeof r=="string")try{let n=v.parse(`.temp{${r}}`).first;n&&n.nodes&&n.nodes.forEach(o=>{if(o.type==="decl"){let a=o.clone();a.raws.before=`
    `,s?.append(a);}});}catch(i){throw console.error("Error parsing rule content:",t,r,i),i}}async function ts(e,t,r){if(!t.resolvedPaths.tailwindCss||!Object.keys(e??{}).length)return;r={cleanupDefaultNextStyles:false,silent:false,tailwindVersion:"v3",overwriteCssVars:false,initIndex:true,...r};let s=t.resolvedPaths.tailwindCss,i=b__default.relative(t.resolvedPaths.cwd,s),n=R(`Updating CSS variables in ${u.info(i)}`,{silent:r.silent}).start(),o=await promises.readFile(s,"utf8"),a=await mn(o,e??{},t,{cleanupDefaultNextStyles:r.cleanupDefaultNextStyles,tailwindVersion:r.tailwindVersion,tailwindConfig:r.tailwindConfig,overwriteCssVars:r.overwriteCssVars,initIndex:r.initIndex});await promises.writeFile(s,a,"utf8"),n.succeed();}async function mn(e,t,r,s={cleanupDefaultNextStyles:false,tailwindVersion:"v3",tailwindConfig:void 0,overwriteCssVars:false,initIndex:true}){s={cleanupDefaultNextStyles:false,tailwindVersion:"v3",tailwindConfig:void 0,overwriteCssVars:false,initIndex:true,...s};let i=[dn(t)];if(s.cleanupDefaultNextStyles&&i.push(es()),s.tailwindVersion==="v4"){if(i=[],r.resolvedPaths?.cwd){let a=Q(r.resolvedPaths.cwd);!a?.dependencies?.["tailwindcss-animate"]&&!a?.devDependencies?.["tailwindcss-animate"]&&s.initIndex&&i.push(wn({params:"tw-animate-css"}));}i.push(yn({params:"dark (&:is(.dark *))"})),s.cleanupDefaultNextStyles&&i.push(es()),i.push(gn(t,{overwriteCssVars:s.overwriteCssVars})),i.push(hn(t)),s.tailwindConfig&&(i.push(xn(s.tailwindConfig)),i.push(Rn(s.tailwindConfig)),i.push(bn(s.tailwindConfig)));}r.tailwind.cssVariables&&s.initIndex&&i.push(pn({tailwindVersion:s.tailwindVersion}));let o=(await v(i).process(e,{from:void 0})).css;return o=o.replace(/\/\* ---break--- \*\//g,""),s.tailwindVersion==="v4"&&(o=o.replace(/(\n\s*\n)+/g,`

`)),o}function pn({tailwindVersion:e}){return {postcssPlugin:"update-base-layer",Once(t){let r=[{selector:"*",apply:e==="v4"?"border-border outline-ring/50":"border-border"},{selector:"body",apply:"bg-background text-foreground"}],s=t.nodes.find(i=>i.type==="atrule"&&i.name==="layer"&&i.params==="base"&&r.every(({selector:n,apply:o})=>i.nodes?.some(a=>a.type==="rule"&&a.selector===n&&a.nodes.some(l=>l.type==="atrule"&&l.name==="apply"&&l.params===o))));s||(s=v.atRule({name:"layer",params:"base",raws:{semicolon:true,between:" ",before:`
`}}),t.append(s),t.insertBefore(s,v.comment({text:"---break---"}))),r.forEach(({selector:i,apply:n})=>{s?.nodes?.find(a=>a.type==="rule"&&a.selector===i)||s?.append(v.rule({selector:i,nodes:[v.atRule({name:"apply",params:n,raws:{semicolon:true,before:`
    `}})],raws:{semicolon:true,between:" ",before:`
  `}}));});}}}function dn(e){return {postcssPlugin:"update-css-vars",Once(t){let r=t.nodes.find(s=>s.type==="atrule"&&s.name==="layer"&&s.params==="base");r instanceof fn||(r=v.atRule({name:"layer",params:"base",nodes:[],raws:{semicolon:true,before:`
`,between:" "}}),t.append(r),t.insertBefore(r,v.comment({text:"---break---"}))),r!==void 0&&Object.entries(e).forEach(([s,i])=>{let n=s==="light"?":root":`.${s}`;un(r,n,i);});}}}function Xr(e){let t=e.nodes.find(r=>r.type==="rule"&&r.selector===":root");if(t){let r=["--background","--foreground"];t.nodes.filter(s=>s.type==="decl"&&r.includes(s.prop)).forEach(s=>s.remove()),t.nodes.length===0&&t.remove();}}function es(){return {postcssPlugin:"cleanup-default-next-styles",Once(e){let t=e.nodes.find(s=>s.type==="rule"&&s.selector==="body");t&&(t.nodes.find(s=>s.type==="decl"&&s.prop==="color"&&["rgb(var(--foreground-rgb))","var(--foreground)"].includes(s.value))?.remove(),t.nodes.find(s=>s.type==="decl"&&s.prop==="background"&&(s.value.startsWith("linear-gradient")||s.value==="var(--background)"))?.remove(),t.nodes.find(s=>s.type==="decl"&&s.prop==="font-family"&&s.value==="Arial, Helvetica, sans-serif")?.remove(),t.nodes.length===0&&t.remove()),Xr(e);let r=e.nodes.find(s=>s.type==="atrule"&&s.params==="(prefers-color-scheme: dark)");r&&(Xr(r),r.nodes.length===0&&r.remove());}}}function un(e,t,r){let s=e.nodes?.find(i=>i.type==="rule"&&i.selector===t);s||Object.keys(r).length>0&&(s=v.rule({selector:t,raws:{between:" ",before:`
  `}}),e.append(s)),Object.entries(r).forEach(([i,n])=>{let o=`--${i.replace(/^--/,"")}`,a=v.decl({prop:o,value:n,raws:{semicolon:true}}),l=s?.nodes.find(c=>c.type==="decl"&&c.prop===o);l?l.replaceWith(a):s?.append(a);});}function gn(e,t){return {postcssPlugin:"update-css-vars-v4",Once(r){Object.entries(e).forEach(([s,i])=>{let n=s==="light"?":root":`.${s}`;if(s==="theme"){n="@theme";let a=yt(r);Object.entries(i).forEach(([l,c])=>{let f=`--${l.replace(/^--/,"")}`,p=v.decl({prop:f,value:c,raws:{semicolon:true}}),d=a?.nodes?.find(g=>g.type==="decl"&&g.prop===f);t.overwriteCssVars?d?d.replaceWith(p):a?.append(p):d||a?.append(p);});return}let o=r.nodes?.find(a=>a.type==="rule"&&a.selector===n);!o&&Object.keys(i).length>0&&(o=v.rule({selector:n,nodes:[],raws:{semicolon:true,between:" ",before:`
`}}),r.append(o),r.insertBefore(o,v.comment({text:"---break---"}))),Object.entries(i).forEach(([a,l])=>{let c=`--${a.replace(/^--/,"")}`;c==="--sidebar-background"&&(c="--sidebar"),rs(l)&&(l=`hsl(${l})`);let f=v.decl({prop:c,value:l,raws:{semicolon:true}}),p=o?.nodes.find(d=>d.type==="decl"&&d.prop===c);t.overwriteCssVars?p?p.replaceWith(f):o?.append(f):p||o?.append(f);});});}}}function hn(e){return {postcssPlugin:"update-theme",Once(t){let r=Array.from(new Set(Object.keys(e).flatMap(n=>Object.keys(e[n]||{}))));if(!r.length)return;let s=yt(t),i=s.nodes?.filter(n=>n.type==="decl"&&n.prop.startsWith("--"));for(let n of r){let o=Object.values(e).find(p=>p[n])?.[n];if(!o)continue;if(n==="radius"){let p={sm:"calc(var(--radius) - 4px)",md:"calc(var(--radius) - 2px)",lg:"var(--radius)",xl:"calc(var(--radius) + 4px)"};for(let[d,g]of Object.entries(p)){let w=v.decl({prop:`--radius-${d}`,value:g,raws:{semicolon:true}});s?.nodes?.find(S=>S.type==="decl"&&S.prop===w.prop)||s?.append(w);}continue}let a=rs(o)||Sn(o)?`--color-${n.replace(/^--/,"")}`:`--${n.replace(/^--/,"")}`;a==="--color-sidebar-background"&&(a="--color-sidebar");let l=`var(--${n})`;a==="--color-sidebar"&&(l="var(--sidebar)");let c=v.decl({prop:a,value:l,raws:{semicolon:true}});s?.nodes?.find(p=>p.type==="decl"&&p.prop===c.prop)||(i?.length?s?.insertAfter(i[i.length-1],c):s?.append(c));}}}}function yt(e){let t=e.nodes.find(r=>r.type==="atrule"&&r.name==="theme"&&r.params==="inline");return t||(t=v.atRule({name:"theme",params:"inline",nodes:[],raws:{semicolon:true,between:" ",before:`
`}}),e.append(t),e.insertBefore(t,v.comment({text:"---break---"}))),t}function yn({params:e}){return {postcssPlugin:"add-custom-variant",Once(t){if(!t.nodes.find(s=>s.type==="atrule"&&s.name==="custom-variant")){let s=t.nodes.filter(n=>n.type==="atrule"&&n.name==="import"),i=v.atRule({name:"custom-variant",params:e,raws:{semicolon:true,before:`
`}});if(s.length>0){let n=s[s.length-1];t.insertAfter(n,i);}else t.insertAfter(t.nodes[0],i);t.insertBefore(i,v.comment({text:"---break---"}));}}}}function wn({params:e}){return {postcssPlugin:"add-custom-import",Once(t){let r=t.nodes.filter(n=>n.type==="atrule"&&n.name==="import"),s=t.nodes.find(n=>n.type==="atrule"&&n.name==="custom-variant");if(!r.some(n=>n.params.replace(/["']/g,"")===e)){let n=v.atRule({name:"import",params:`"${e}"`,raws:{semicolon:true,before:`
`}});if(r.length>0){let o=r[r.length-1];t.insertAfter(o,n);}else s?(t.insertBefore(s,n),t.insertBefore(s,v.comment({text:"---break---"}))):(t.prepend(n),t.insertAfter(n,v.comment({text:"---break---"})));}}}}function xn(e){return {postcssPlugin:"update-tailwind-config",Once(t){if(!e?.plugins)return;let s=vn(t)==="single"?"'":'"',i=t.nodes.filter(o=>o.type==="atrule"&&o.name==="plugin"),n=i[i.length-1]||t.nodes[0];for(let o of e.plugins){let a=o.replace(/^require\(["']|["']\)$/g,"");if(i.some(c=>c.params.replace(/["']/g,"")===a))continue;let l=v.atRule({name:"plugin",params:`${s}${a}${s}`,raws:{semicolon:true,before:`
`}});t.insertAfter(n,l),t.insertBefore(l,v.comment({text:"---break---"}));}}}}function bn(e){return {postcssPlugin:"update-tailwind-config-keyframes",Once(t){if(!e?.theme?.extend?.keyframes)return;let r=yt(t),s=r.nodes?.filter(n=>n.type==="atrule"&&n.name==="keyframes"),i=z$1.record(z$1.string(),z$1.record(z$1.string(),z$1.string()));for(let[n,o]of Object.entries(e.theme.extend.keyframes)){if(typeof n!="string")continue;let a=i.safeParse(o);if(!a.success||s?.find(c=>c.type==="atrule"&&c.name==="keyframes"&&c.params===n))continue;let l=v.atRule({name:"keyframes",params:n,nodes:[],raws:{semicolon:true,between:" ",before:`
  `}});for(let[c,f]of Object.entries(a.data)){let p=v.rule({selector:c,nodes:Object.entries(f).map(([d,g])=>v.decl({prop:d,value:g,raws:{semicolon:true,before:`
      `,between:": "}})),raws:{semicolon:true,between:" ",before:`
    `}});l.append(p);}r.append(l),r.insertBefore(l,v.comment({text:"---break---"}));}}}}function Rn(e){return {postcssPlugin:"update-tailwind-config-animation",Once(t){if(!e?.theme?.extend?.animation)return;let r=yt(t),s=r.nodes?.filter(n=>n.type==="decl"&&n.prop.startsWith("--animate-")),i=z$1.record(z$1.string(),z$1.string()).safeParse(e.theme.extend.animation);if(i.success)for(let[n,o]of Object.entries(i.data)){let a=`--animate-${n}`;if(s?.find(c=>c.prop===a))continue;let l=v.decl({prop:a,value:o,raws:{semicolon:true,between:": ",before:`
  `}});r.append(l);}}}}function vn(e){return e.nodes[0].toString().includes("'")?"single":"double"}function rs(e){if(e.startsWith("hsl")||e.startsWith("rgb")||e.startsWith("#")||e.startsWith("oklch"))return  false;let t=e.split(" ");return t.length===3&&t.slice(1,3).every(r=>r.includes("%"))}function Sn(e){return e.startsWith("hsl")||e.startsWith("rgb")||e.startsWith("#")||e.startsWith("oklch")||e.startsWith("var(--color-")}async function wt(e,{withFallback:t}={withFallback:false}){let r=await detect({programmatic:true,cwd:e});if(r==="yarn@berry")return "yarn";if(r==="pnpm@6")return "pnpm";if(r==="bun")return "bun";if(r==="deno")return "deno";if(!t)return r??"npm";let s=process.env.npm_config_user_agent||"";return s.startsWith("yarn")?"yarn":s.startsWith("pnpm")?"pnpm":s.startsWith("bun")?"bun":"npm"}async function ss(e,t,r,s){if(e=Array.from(new Set(e)),t=Array.from(new Set(t)),!e?.length&&!t?.length)return;s={silent:false,...s};let i=R("Installing dependencies.",{silent:s.silent})?.start(),n=await Pn(r),o="";if(In(r)&&n==="npm")if(s.silent)o="force";else {i.stopAndPersist(),m.warn(`
It looks like you are using React 19. 
Some packages may fail to install due to peer dependency issues in npm (see https://ui.aodesu.com/react-19).
`);let a=await Bt([{type:"select",name:"flag",message:"How would you like to proceed?",choices:[{title:"Use --force",value:"force"},{title:"Use --legacy-peer-deps",value:"legacy-peer-deps"}]}]);a&&(o=a.flag);}i?.start(),await kn(n,e,t,r.resolvedPaths.cwd,o),i?.succeed();}function In(e){let t=Q(e.resolvedPaths.cwd,false);if(!t?.dependencies?.react)return  false;let r=/^(?:\^|~)?19(?:\.\d+)*(?:-.*)?$/.test(t.dependencies.react),s=t.dependencies["react-day-picker"]?.startsWith("8");return r&&s}async function Pn(e){return Q(e.resolvedPaths.cwd,false)?.dependencies?.expo?"expo":wt(e.resolvedPaths.cwd)}async function kn(e,t,r,s,i){if(e==="npm")return Tn(t,r,s,i);if(e==="deno")return jn(t,r,s);if(e==="expo")return On(t,r,s);t?.length&&await execa(e,["add",...t],{cwd:s}),r?.length&&await execa(e,["add","-D",...r],{cwd:s});}async function Tn(e,t,r,s){e.length&&await execa("npm",["install",...s?[`--${s}`]:[],...e],{cwd:r}),t.length&&await execa("npm",["install",...s?[`--${s}`]:[],"-D",...t],{cwd:r});}async function jn(e,t,r){e?.length&&await execa("deno",["add",...e.map(s=>`npm:${s}`)],{cwd:r}),t?.length&&await execa("deno",["add","-D",...t.map(s=>`npm:${s}`)],{cwd:r});}async function On(e,t,r){e.length&&await execa("npx",["expo","install",...e],{cwd:r}),t.length&&await execa("npx",["expo","install","-- -D",...t],{cwd:r});}async function is(e,t,r){if(!e||Object.keys(e).length===0)return {envVarsAdded:[],envFileUpdated:null,envFileCreated:null};r={silent:false,...r};let s=R("Adding environment variables.",{silent:r.silent})?.start(),i=t.resolvedPaths.cwd,n=b__default.join(i,".env.local"),o=et(i);o&&(n=o);let a=existsSync(n),l=b__default.basename(n),c=Object.entries(e).map(([g,w])=>`${g}=${w}`).join(`
`),f=[],p=null,d=null;if(a){let g=await promises.readFile(n,"utf-8"),w=rt(g,c);if(f=tt(g,c),f.length>0){if(await promises.writeFile(n,w,"utf-8"),p=b__default.relative(i,n),s?.succeed(`Added the following variables to ${u.info(l)}:`),!r.silent)for(let S of f)m.log(`  ${u.success("+")} ${S}`);}else s?.stop();}else if(await promises.writeFile(n,c+`
`,"utf-8"),d=b__default.relative(i,n),f=Object.keys(e),s?.succeed(`Added the following variables to ${u.info(l)}:`),!r.silent)for(let g of f)m.log(`  ${u.success("+")} ${g}`);return !r.silent&&f.length>0&&m.break(),{envVarsAdded:f,envFileUpdated:p,envFileCreated:d}}async function De(e,t,r){r={overwrite:false,silent:false,isNewProject:false,baseStyle:true,...r};let s=await hr(t);return s&&s.ui&&s.ui.resolvedPaths.cwd!==t.resolvedPaths.cwd?await Fn(e,t,s,{...r,isRemote:e?.length===1&&!!e[0].match(/\/chat\/b\//)}):await An(e,t,r)}async function An(e,t,r){if(!r.baseStyle&&!e.length)return;let s=R("Checking registry.",{silent:r.silent})?.start(),i=await _t(e,H(t));if(!i)return s?.fail(),T(new Error("Failed to fetch components from registry."));try{Ln(i.files??[],t.resolvedPaths.cwd);}catch(a){return s?.fail(),T(a)}s?.succeed();let n=await X(t);await ir(i.tailwind?.config,t,{silent:r.silent,tailwindVersion:n});let o=await Dn(e,t);await ts(i.cssVars,t,{cleanupDefaultNextStyles:r.isNewProject,silent:r.silent,tailwindVersion:n,tailwindConfig:i.tailwind?.config,overwriteCssVars:o,initIndex:r.baseStyle}),await qr(i.css,t,{silent:r.silent}),await is(i.envVars,t,{silent:r.silent}),await ss(i.dependencies,i.devDependencies,t,{silent:r.silent}),await Ar(i.files,t,{overwrite:r.overwrite,silent:r.silent,path:r.path}),i.docs&&m.info(i.docs);}async function Fn(e,t,r,s){if(!s.baseStyle&&!e.length)return;let i=R("Checking registry.",{silent:s.silent})?.start();if(!await _t(e,H(t)))return i?.fail(),T(new Error("Failed to fetch components from registry."))}async function Dn(e,t){let r=await se(e,{config:t});return Ct.array(g).parse(r).some(i=>i.type==="registry:theme"||i.type==="registry:style")}function Ln(e,t){for(let r of e)if(r?.target&&!Hr(r.target,t))throw new Error(`We found an unsafe file path "${r.target} in the registry item. Installation aborted.`)}var zn="https://codeload.github.com/aodesu-ui/ui/tar.gz/main",fe={next:"next","next-16":"next-16","next-monorepo":"next-monorepo",vite:"vite"};async function bt(e){e={srcDir:false,...e};let t=e.template&&fe[e.template]?e.template:"next",r=t===fe.next?"my-app":"my-monorepo",s="15",i=e.components?.length===1&&!!e.components[0].match(/\/chat\/b\//);if(e.components&&i)try{let[a]=await F(e.components),{meta:l}=Ct.object({meta:Ct.object({nextVersion:Ct.string()})}).parse(a);s=l.nextVersion,t=fe.next;}catch(a){m.break(),T(a);}if(!e.force){let{type:a,name:l}=await Bt([{type:e.template||i?null:"select",name:"type",message:`The path ${u.info(e.cwd)} does not contain a package.json file.
  Would you like to start a new project?`,choices:[{title:"Vite",value:"vite"},{title:"Next.js 15",value:"next"},{title:"Next.js 16",value:"next-16"},{title:"Next.js (Monorepo)",value:"next-monorepo"}],initial:0},{type:"text",name:"name",message:"What is your project named?",initial:r,format:c=>c.trim(),validate:c=>c.length>128?"Name should be less than 128 characters.":true}]);t=a??t,r=l,a==="next-16"&&(s="latest");}let n=await wt(e.cwd,{withFallback:true}),o=`${e.cwd}/${r}`;try{await G.access(e.cwd,G.constants.W_OK);}catch{m.break(),m.error(`The path ${u.info(e.cwd)} is not writable.`),m.error(`It is likely you do not have write permissions for this folder or the path ${u.info(e.cwd)} does not exist.`),m.break(),process.exit(1);}return G.existsSync(b__default.resolve(e.cwd,r,"package.json"))&&(m.break(),m.error(`A project with the name ${u.info(r)} already exists.`),m.error("Please choose a different name and try again."),m.break(),process.exit(1)),t===fe.vite&&await Wn(o,{packageManager:n}),(t===fe.next||t===fe["next-16"])&&await Un(o,{version:s,cwd:e.cwd,packageManager:n,srcDir:!!e.srcDir}),t===fe["next-monorepo"]&&await Kn(o,{packageManager:n}),{projectPath:o,projectName:r,template:t}}async function Wn(e,t){let r=R("Creating a new Vite project. This may take a few minutes.").start();try{let s=["create","vite@latest",b__default.basename(e),"--template","react-ts","--yes"];await execa(t.packageManager,s,{cwd:b__default.dirname(e)});let i=R(`Installing dependencies with ${t.packageManager}.`).start();await execa(t.packageManager,["install"],{cwd:e}),i?.succeed(`Installed dependencies with ${t.packageManager}.`);try{await execa("git",["init"],{cwd:e}),await execa("git",["add","-A"],{cwd:e}),await execa("git",["commit","-m","Initial commit from aodesu-ui"],{cwd:e});}catch{m.warn("Git initialization skipped (git not available)");}r?.succeed("Creating a new Vite project.");}catch(s){r?.fail("Something went worng creating a new Vite project."),T(s);}}async function Un(e,t){let r=R(`Creating a new Next.js ${t.version.startsWith("latest")?"16":"15"} project. This may take a few minutes.`).start(),s=["--tailwind","--eslint","--typescript","--app",t.srcDir?"--src-dir":"--no-src-dir","--no-import-alias",`--use-${t.packageManager}`];(t.version.startsWith("15")||t.version.startsWith("latest")||t.version.startsWith("canary"))&&s.push("--turbopack"),(t.version.startsWith("latest")||t.version.startsWith("canary"))&&s.push("--no-react-compiler");try{await execa("npx",[`create-next-app@${t.version}`,e,"--silent",...s],{cwd:t.cwd});}catch{m.break(),m.error("Something went wrong creating a new Next.js project. Please try again."),process.exit(1);}r?.succeed(`Creating a new Next.js ${t.version.startsWith("latest")?"16":"15"} project.`);}async function Kn(e,t){let r=R("Creating a new Next.js monorepo. This may take a few minutes.").start();try{let s=b__default.join(Vn.tmpdir(),`aodesu-template-${Date.now()}`);await G.ensureDir(s);let i=await fetch(zn);if(!i.ok)throw new Error(`Failed to download template: ${i.statusText}`);let n=b__default.resolve(s,"template.tar.gz");await G.writeFile(n,Buffer.from(await i.arrayBuffer())),await execa("tar",["-xzf",n,"-C",s,"--strip-components=2","ui-main/templates/monorepo-next"]);let o=b__default.resolve(s,"monorepo-next");await G.move(o,e),await G.remove(s),await execa(t.packageManager,["install"],{cwd:e});let a=b__default.join(e,"package.json");if(G.existsSync(a)){let c=await G.readFile(a,"utf8"),f=JSON.parse(c);f.name=e.split("/").pop(),await G.writeFile(a,JSON.stringify(f,null,2));}let l=process.cwd();await execa("git",["--version"],{cwd:e}),await execa("git",["init"],{cwd:e}),await execa("git",["add","-A"],{cwd:e}),await execa("git",["commit","-m","Initial commit"],{cwd:e}),r?.succeed("Creating a new Next.js monorepo.");}catch(s){r?.fail("Something went wrong creating a new Next.js monorepo."),T(s);}}async function Rt(e=process.cwd()){try{let{config:t}=await import('@dotenvx/dotenvx'),r=[".env.local",".env.development.local",".env.development",".env"];for(let s of r){let i=join(e,s);existsSync(i)&&t({path:i,overload:!1,quiet:!0});}}catch(t){m.warn("Failed to load env files:",t);}}var Le=".bak";function ns(e){if(!G.existsSync(e))return null;let t=`${e}${Le}`;try{return G.renameSync(e,t),t}catch(r){return console.error(`Failed to create backup of ${e}: ${r}`),null}}function os(e){let t=`${e}${Le}`;if(!G.existsSync(t))return  false;try{return G.renameSync(t,e),!0}catch(r){return console.error(`Warning: Could not restore backup file ${t}: ${r}`),false}}function Mt(e){let t=`${e}${Le}`;if(!G.existsSync(t))return  false;try{return G.unlinkSync(t),!0}catch{return  false}}async function as(e,t){let r=new Set,s=new Set,i=[...e];for(;i.length>0;){let n=i.shift();if(s.has(n))continue;s.add(n);let{registry:o}=M(n);o&&!O[o]&&r.add(o);try{let[a]=await Y([n],t,{useCache:!0});if(a?.registryDependencies)for(let l of a.registryDependencies){let{registry:c}=M(l);c&&!O[c]&&r.add(c),s.has(l)||i.push(l);}}catch(a){if(a instanceof J){let{registry:l}=M(n);l&&!O[l]&&r.add(l);continue}continue}}return Array.from(r)}async function ve(e,t,r={}){r={silent:false,writeFile:true,...r};let i=(await as(e,t)).filter(c=>!t.registries?.[c]&&!Object.keys(O).includes(c));if(i.length===0)return {config:t,newRegistries:[]};let n=await Jr({useCache:process.env.NODE_ENV!=="development"});if(!n)return {config:t,newRegistries:[]};let o={};for(let c of i)n[c]&&(o[c]=n[c]);if(Object.keys(o).length===0)return {config:t,newRegistries:[]};let a=Object.fromEntries(Object.entries(t.registries||{}).filter(([c])=>!Object.keys(O).includes(c))),l={...t,registries:{...a,...o}};if(r.writeFile){let{resolvedPaths:c,...f}=l,p$1=R("Updating components.json.",{silent:r.silent}).start(),d=p.parse(f);await G.writeFile(b__default.resolve(t.resolvedPaths.cwd,"components.json"),JSON.stringify(d,null,2)+`
`,"utf-8"),p$1.succeed();}return {config:l,newRegistries:Object.keys(o)}}process.on("exit",e=>{let t=b__default.resolve(process.cwd(),"components.json");return e===0?Mt(t):os(t)});var Zn=z$1.object({cwd:z$1.string(),components:z$1.array(z$1.string()).optional(),yes:z$1.boolean(),defaults:z$1.boolean(),force:z$1.boolean(),silent:z$1.boolean(),isNewProject:z$1.boolean(),srcDir:z$1.boolean().optional(),cssVariables:z$1.boolean(),template:z$1.string().optional().refine(e=>e?"TEMPLATES":true,{message:"Invalid template. Please use 'next', 'next-16' or 'next-monorepo'."}),baseColor:z$1.string().optional(),baseStyle:z$1.boolean()}),ls=new Command().name("init").description("initialize your project and install dependencies").argument("[components...]","names, url or local path to component").option("-t, --template <template>","the template to use. (next, next-16, next-monorepo)").option("-b, --base-color <base-color>","The base color to use. (neutral)",void 0).option("-y, --yes","Skip de confirmation prompt",true).option("-d, --defaults","Use default configuration.",false).option("-f, --force","Force overwrite of existing configuration",false).option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).option("-s, --silent","Mute output",false).option("--src-dir","Use the src directory when creating a new project.",false).option("--no-src-dir","Do not use the src directory when creating a new project.").option("--css-variables","Use css variables for theming.",true).option("--no-base-style","Do not install the base aodesu style.").action(async(e,t)=>{try{t.defaults&&(t.template=t.template||"next",t.baseColor=t.baseColor||"neutral");let r=Zn.parse({cwd:b__default.resolve(t.cwd),isNewProject:!1,components:e,...t});if(await Rt(r.cwd),e.length>0){let s=H({}),i=b__default.resolve(r.cwd,"components.json");if(G.existsSync(i)){let a=await G.readJson(i),l=p.partial().parse(a);s=H(l),ns(i);}let{config:n}=await ve(e,s,{silent:!0});s=n,we(e[0],s);let[o]=await se([e[0]],{config:s});o?.type=="registry:style"&&(r.baseColor="neutral",r.baseStyle=o.extends==="none"?!1:r.baseStyle);}r.baseStyle||(r.baseColor="neutral"),await St(r),m.log(`${u.success("Success!")} Project initialization completed. 
You may now add components.`),Mt(b__default.resolve(r.cwd,"components.json")),m.break();}catch(r){m.break(),T(r);}finally{le();}});async function St(e){let t,r;if(e.skipPreflight)t=await N(e.cwd);else {let d=await vr(e);if(d.errors["1"]){let{projectPath:g,template:w}=await bt(e);g||process.exit(1),e.cwd=g,e.isNewProject=true,r=w;}t=d.projectInfo;}if(r==="next-monorepo")return e.cwd=b__default.resolve(e.cwd,"apps/web"),await V(e.cwd);let s=await xr(e.cwd,t),i=s?await Xn(s,e):await Qn(await V(e.cwd));if(!e.yes){let{proceed:d}=await Bt({type:"confirm",name:"proceed",message:`Write configuration to ${u.info("components.json")}. Proceed?`,initial:true});d||process.exit(0);}let n=[...e.baseStyle?["index"]:[],...e.components??[]],o=await ue(e.cwd,i),{config:a}=await ve(n,o,{silent:true});a.registries&&(i.registries=a.registries);let l=R("Writing components.json.").start(),c=b__default.resolve(e.cwd,"components.json"),f=`${c}${Le}`;if(!e.force&&G.existsSync(f)){let d=await G.readJson(f),{registries:g,...w}=xe(d,i);i={...w,registries:g};}i.registries=Object.fromEntries(Object.entries(i.registries||{}).filter(([d])=>!Object.keys(O).includes(d))),await promises.writeFile(c,`${JSON.stringify(i,null,2)}
`,"utf8"),l.succeed();let p=await ue(e.cwd,i);return await De(n,p,{overwrite:true,silent:e.silent,baseStyle:e.baseStyle,isNewProject:e.isNewProject||t?.framework.name==="next-app"}),e.isNewProject&&e.srcDir&&await fr(["./src/**/*.{js,ts,jsx,tsx,mdx}"],p,{silent:e.silent}),p}async function Qn(e=null){let[t,r]=await Promise.all([zt(),Wt()]);m.info("");let s=await Bt([{type:"toggle",name:"typescript",message:`Would you like to use ${u.info("TypeScript")} (recommended)?`,initial:e?.tsx??true,active:"yes",inactive:"no"},{type:"select",name:"style",message:`Which ${u.info("style")} would you like to use?`,choices:t.map(i=>({title:i.label,value:i.name}))},{type:"select",name:"tailwindBaseColor",message:`Which color would you like to use as the ${u.info("base color")}?`,choices:r.map(i=>({title:i.label,value:i.name}))},{type:"text",name:"tailwindCss",message:`Where is your ${u.info("global CSS")} file?`,initial:e?.tailwind.css??ur},{type:"toggle",name:"tailwindCssVariables",message:`Would you like to use ${u.info("CSS variables")} for theming?`,initial:e?.tailwind.cssVariables??true,active:"yes",inactive:"no"},{type:"text",name:"tailwindPrefix",message:`Are you using a custom ${u.info("tailwind prefix eg. tw-")}? (Leave blank if not)`,initial:""},{type:"text",name:"tailwindConfig",message:`Where is your ${u.info("tailwind.config.js")} located?`,initial:e?.tailwind.config??gr},{type:"text",name:"components",message:`Configure the import alias for ${u.info("components")}:`,initial:e?.aliases.components??pr},{type:"text",name:"utils",message:`Configure the import alias for ${u.info("utils")}:`,initial:e?.aliases.utils??dr},{type:"toggle",name:"rsc",message:`Are you using ${u.info("React Server Components")}?`,initial:e?.rsc??true,active:"yes",inactive:"no"}]);return p.parse({$schema:"https://ui.aodesu.com/schema.json",style:s.style,tailwind:{config:s.tailwindConfig,css:s.tailwindCss,baseColor:s.tailwindBaseColor,cssVariables:s.tailwindCssVariables,prefix:s.tailwindPrefix},rsc:s.rsc,tsx:s.typescript,aliases:{utils:s.utils,components:s.components,lib:s.components.replace(/\/components$/,"lib"),hooks:s.components.replace(/\/components$/,"hooks")}})}async function Xn(e,t){let r=e.style,s=t.baseColor,i=e.tailwind.cssVariables;if(!t.defaults){let[n,o,a]=await Promise.all([zt(),Wt(),X(e)]),l=await Bt([{type:a==="v4"?null:"select",name:"style",message:`Which ${u.info("style")} would you like to use?`,choices:n.map(c=>({title:c.name==="aodesu"?"aodesu (Recommended)":c.label,value:c.name})),initial:0},{type:t.baseColor?null:"select",name:"tailwindBaseColor",message:`Which color would you like to use as the ${u.info("base color")}?`,choices:o.map(c=>({title:c.label,value:c.name}))}]);r=l.style??"aodesu",s=l.tailwindBaseColor??s,i=t.cssVariables;}return p.parse({$schema:e?.$schema,style:r,tailwind:{...e?.tailwind,baseColor:s,cssVariables:i},rsc:e?.rsc,tsx:e?.tsx,iconLibrary:e?.iconLibrary,aliases:e?.aliases})}async function fs(e){let t={};if(!G.existsSync(e.cwd)||!G.existsSync(b__default.resolve(e.cwd,"package.json")))return t["1"]=true,{errors:t,config:null};if(!G.existsSync(b__default.resolve(e.cwd,"components.json")))return t["3"]=true,{errors:t,config:null};try{let r=await V(e.cwd);return {errors:t,config:r}}catch{m.break(),m.error(`An invalid ${u.info("components.json")} file was found at ${u.info(e.cwd)}.
Before you can add components, you must create a valid ${u.info("components.json")} file by running the ${u.info("init")} command.`),m.error(`Learn more at ${u.info("https://ui.shadcn.com/docs/components-json")}.`),m.break(),process.exit(1);}}async function ps(e,t){let r=b__default.join(t.resolvedPaths.cwd,"app/page.tsx");if(!(await pe__default.stat(r)).isFile())return;let[s]=await se([e],{config:t});if(!s?.meta?.importSpecifier||!s?.meta?.moduleSpecifier)return;let i=`import { ${s?.meta?.importSpecifier} } from "${s.meta.moduleSpecifier}"

export default function Page() {
  return <${s?.meta?.importSpecifier} />
}`;await pe__default.writeFile(r,i,"utf8");}var ro=z$1.object({components:z$1.array(z$1.string()).optional(),yes:z$1.boolean(),overwrite:z$1.boolean(),cwd:z$1.string(),all:z$1.boolean(),path:z$1.string().optional(),silent:z$1.boolean(),srcDir:z$1.boolean().optional(),cssVariables:z$1.boolean()}),us=new Command().name("add").description("add a component to your project.").argument("[components...]","names, url or local path to component.").option("-y, --yes","skip confirmation prompt.",false).option("-o, --overwrite","overwrite existing files.",false).option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).option("-a, --all","add all available components",false).option("-p, --path <path>","the path to add the component to.").option("-s, --silent","mute output.",false).option("--src-dir","use the src directory when creating a new project.",false).option("--no-src-dir","do not use the src directory when creating a new project.").option("--css-variables","use css variables for theming.",true).option("--no-css-variables","do not use css variables for theming.").action(async(e,t)=>{try{let r=ro.parse({components:e,cwd:b__default.resolve(t.cwd),...t});await Rt(r.cwd);let s=await V(r.cwd);s||(s=Be({style:"aodesu",resolvedPaths:{cwd:r.cwd}}));let i=!1;if(e.length>0){let{config:p,newRegistries:d}=await ve(e,s,{silent:r.silent,writeFile:!1});s=p,i=d.length>0;}if(e.length>0){let[p]=await se([e[0]],{config:s}),d=p?.type;if(Dr(p)){await De(e,s,r);return}if(!r.yes&&(d==="registry:style"||d==="registry:theme")){m.break();let{confirm:g}=await Bt({type:"confirm",name:"confirm",message:u.warn(`You are about to install a new ${d.replace("registry:","")}. 
Existing CSS variables and components will be overwritten. Continue?`)});g||(m.break(),m.log("Installation cancelled."),m.break(),process.exit(1));}}if(r.components?.length||(r.components=await so(r)),(await N(r.cwd))?.tailwindVersion==="v4"){let p=Me.filter(d=>r.components?.includes(d.name));p?.length&&(m.break(),p.forEach(d=>{m.warn(u.warn(d.message));}),m.break(),process.exit(1));}let{errors:o,config:a}=await fs(r),l=!1;if(o["3"]){let{proceed:p}=await Bt({type:"confirm",name:"proceed",message:`You need to create a ${u.info("components.json")} file to add components. Proceed?`,initial:!0});p||(m.break(),process.exit(1)),a=await St({cwd:r.cwd,yes:!0,force:!0,defaults:!1,skipPreflight:!1,silent:r.silent||!i,isNewProject:!1,srcDir:r.srcDir,cssVariables:r.cssVariables,baseStyle:!0,components:r.components}),l=!0;}let c=!1;if(o["1"]){let{projectPath:p,template:d}=await bt({cwd:r.cwd,force:r.overwrite,srcDir:r.srcDir,components:r.components});p||(m.break(),process.exit(1)),r.cwd=p,d==="next-monorepo"?(r.cwd=b__default.resolve(r.cwd,"apps/web"),a=await V(r.cwd)):(a=await St({cwd:r.cwd,yes:!0,force:!0,defaults:!1,skipPreflight:!0,silent:!i&&r.silent,isNewProject:!0,srcDir:r.srcDir,cssVariables:r.cssVariables,baseStyle:!0,components:r.components}),l=!0,c=r.components?.length===1&&!!r.components[0].match(/\/chat\/b\//));}if(!a)throw new Error(`Failed to read config at ${u.info(r.cwd)}.`);let{config:f}=await ve(r.components,a,{silent:r.silent||i});a=f,l||await De(r.components,a,r),c&&await ps(r.components[0],a);}catch(r){m.break(),T(r);}finally{le();}});async function so(e){let t=await ht();if(!t)return m.break(),T(new Error("Failed to fetch registry index.")),[];if(e.all)return t.map(i=>i.name).filter(i=>!Me.some(n=>n.name===i));if(e.components?.length)return e.components;let{components:r}=await Bt({type:"multiselect",name:"components",message:"Which components do you want to add?",hint:"Space to select. A toggle all. Enter to submit.",instructions:false,choices:t.filter(i=>i.type==="registry:ui"&&!Me.some(n=>n.name===i.name)).map(i=>({title:i.name,value:i.name,selected:e.all?true:e.components?.includes(i.name)}))});r?.length||(m.warn("No components selected. Exiting."),m.info(""),process.exit(1));let s=z$1.array(z$1.string()).safeParse(r);return s.success?s.data:(m.error(""),T(new Error("Invalid components selected.")),[])}async function ws(e){let t={},r={cwd:e.cwd,registryFile:b__default.resolve(e.cwd,e.registryFile),outputDir:b__default.resolve(e.cwd,e.outputDir)};return G.existsSync(r.registryFile)||(t["13"]=true),await G.mkdir(r.outputDir,{recursive:true}),Object.keys(t).length>0&&(t["13"]&&(m.break(),m.error(`The path ${u.info(r.registryFile)} does not exist.`)),m.break(),process.exit(1)),{errors:t,resolvePaths:r}}var no=Ct.object({cwd:Ct.string(),registryFile:Ct.string(),outputDir:Ct.string()}),xs=new Command().name("build").description("build components for a aodesu registry").argument("[registry]","path to registry.json file","./registry.json").option("-o, --output <path>","destination directory for json files","./public/r").option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).action(async(e,t)=>{try{let r=no.parse({cwd:b.resolve(t.cwd),registryFile:e,outputDir:t.output}),{resolvePaths:s}=await ws(r),i=await pe.readFile(s.registryFile,"utf-8"),n=h.safeParse(JSON.parse(i));n.success||(m.error(`Invalid registry file found at ${u.info(s.registryFile)}.`),process.exit(1));let o=R("Building registry...");for(let a of n.data.items){o.start(`Building ${a.name}...`),a.$schema="https://ui.aodesu.com/schema/registry-item.json";for(let c of a.files??[])c.content=await pe.readFile(b.resolve(s.cwd,c.path),"utf-8");let l=g.safeParse(a);if(!l.success){m.error(`Invalid registry item found for ${u.info(a.name)}.`);continue}m.info(`Registry item found for ${a.name}`),await pe.writeFile(b.resolve(s.outputDir,`${l.data.name}.json`),JSON.stringify(l.data,null,2));}await pe.copyFile(s.registryFile,b.resolve(s.outputDir,"registry.json")),o.succeed("Building registry.");}catch(r){m.break(),T(r);}});process.on("SIGNINT",()=>process.exit(0));process.on("SIGTERM",()=>process.exit(0));async function ao(){let e=new Command().name("uidesu").description("add items from registry to your project").version(rr.version,"-v, --version","display the version number");e.addCommand(ls).addCommand(us).addCommand(xs),e.parse();}ao();//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map