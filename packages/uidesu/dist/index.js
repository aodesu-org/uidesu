#!/usr/bin/env node
import {p,q as q$1,u as u$1,g as g$1}from'./chunk-2IEF2V43.js';import {Command}from'commander';import x from'fs-extra';import k,{join}from'path';import u,{z}from'zod';import {cosmiconfig}from'cosmiconfig';import {loadConfig,createMatchPath}from'tsconfig-paths';import {green,cyan,yellow,red}from'kleur/colors';import J from'fast-glob';import pt from'ora';import ht from'deepmerge';import {existsSync,promises}from'fs';import {HttpsProxyAgent}from'https-proxy-agent';import Ct from'node-fetch';import jt,{homedir}from'os';import {detect}from'@antfu/ni';import {execa}from'execa';import Ft from'prompts';var de={version:"1.0.0"};var A={"next-app":{name:"next-app",label:"Next.js",links:{installation:"https://ui.aodesu.com/docs/installation/next",tailwind:"https://tailwindcss.com/docs/guides/nextjs"}},"next-pages":{name:"next-pages",label:"Next.js",links:{installation:"https://ui.aodesu.com/docs/installation/next",tailwind:"https://tailwindcss.com/docs/guides/nextjs"}},vite:{name:"vite",label:"vite",links:{installation:"https://ui.aodesu.com/docs/installation/vite",tailwind:"https://tailwindcss.com/docs/guides/vite"}},manual:{name:"manual",label:"Manual",links:{installation:"https://ui.aodesu.com/docs/installation/manual",tailwind:"https://tailwindcss.com/docs/installation"}}};var L=process.env.REGISTRY_URL??"https://ui.aodesu.com/r",B="aodesu",g={"@uidesu":`${L}/styles/{style}/{name}.json`};var f={error:red,warn:yellow,info:cyan,success:green};async function E(e,t){return createMatchPath(t.absoluteBaseUrl,t.paths)(e,void 0,()=>true,[".ts",".tsx",".jsx",".js",".css"])}var tt=cosmiconfig("components",{searchPlaces:["components.json"]});async function ye(e){let t=await nt(e);return t?(t.iconLibrary||(t.iconLibrary=t.style==="aodesu"?"radix":"lucide"),await rt(e,t)):null}async function rt(e,t){t.registries={...g,...t.registries||{}};let r=await loadConfig(e);if(r.resultType==="failed")throw new Error(`Failed to load ${t.tsx?"tsconfig":"jsconfig"}.json ${r.message??""}`.trim());return q$1.parse({...t,resolvedPaths:{cwd:e,tailwindConfig:t.tailwind.config?k.resolve(e,t.tailwind.config):"",tailwindCss:k.resolve(e,t.tailwind.css),utils:await E(t.aliases.utils,r),components:await E(t.aliases.components,r),ui:t.aliases.ui?await E(t.aliases.ui,r):k.resolve(await E(t.aliases.components,r)??e,"ui"),lib:t.aliases.lib?await E(t.aliases.lib,r):k.resolve(await E(t.aliases.utils,r)??e,".."),hooks:t.aliases.hooks?await E(t.aliases.hooks,r):k.resolve(await E(t.aliases.components,r)??e,"..","hooks")}})}async function nt(e){try{let t=await tt.search(e);if(!t)return null;let r=p.parse(t.config);if(r.registries){for(let n of Object.keys(r.registries))if(n in g)throw new Error(`"${n}" is a built-in registry and cannot be overriden.`)}return r}catch(t){let r=`${e}/components.json`;throw t instanceof Error&&t.message.includes("reserved registry")?t:new Error(`Invalid configuration found in ${f.info(r)}`)}}function we(e){let t={resolvedPaths:{cwd:process.cwd(),tailwindConfig:"",tailwindCss:"",utils:"",components:"",ui:"",lib:"",hooks:""},style:"",tailwind:{config:"",css:"",baseColor:"",cssVariables:false},rsc:false,tsx:true,aliases:{components:"",utils:""},registries:{...g}};return e?{...t,...e,resolvedPaths:{...t.resolvedPaths,...e.resolvedPaths||{}},tailwind:{...t.tailwind,...e.tailwind||{}},aliases:{...t.aliases,...e.aliases||{}},registries:{...t.registries,...e.registries||{}}}:t}function se(e="",t=true){let r=k.join(e,"package.json");return x.readJSONSync(r,{throws:t})}var Y=["**/node_modules/**",".next","public","dist","build"];z.object({compilerOptions:z.object({paths:z.record(z.string().or(z.array(z.string())))})});async function Re(e){let[t,r,n,o,s,c,a,l]=await Promise.all([J.glob("**/{vite,app}.config.*|gatsby-config.*|composer.json|react-router.config.*",{cwd:e,deep:3,ignore:Y}),x.pathExists(k.resolve(e,"src")),mt(e),lt(e),ct(e),xe(e),ft(e),se(e,false)]),m=await x.pathExists(k.resolve(e,`${r?"src/":""}app`)),p={framework:A.manual,isSrcDir:r,isRSC:false,isTsx:n,tailwindConfigFile:o,tailwindCssFile:s,tailwindVersion:c,frameworkVersion:null,aliasPrefix:a};return t.find($=>$.startsWith("next.config."))?.length?(p.framework=m?A["next-app"]:A["next-pages"],p.isRSC=m,p.frameworkVersion=await at(p.framework,l),p):(t.find($=>$.startsWith("vite.config."))?.length&&(p.framework=A.vite),p)}async function at(e,t){if(!t||!["next-app","next-pages"].includes(e.name))return null;let r=t.dependencies?.next||t.devDependencies?.next;if(!r)return null;let n=r.match(/^[\^~]?(\d+\.\d+\.\d+)/);if(n)return n[1];let o=r.match(/(\d+\.\d+\.\d+)/);return o?o[1]:r}async function xe(e){let[t,r]=await Promise.all([se(e,false),ye(e)]);return r?.tailwind?.config===""?"v4":!t?.dependencies?.tailwindcss&&!t?.devDependencies?.tailwindcss?null:/^(?:\^|~)?3(?:\.\d+)*(?:-.*)?$/.test(t?.dependencies?.tailwindcss||t?.devDependencies?.tailwindcss||"")?"v3":"v4"}async function ct(e){let[t,r]=await Promise.all([J.glob(["**/*.css","**/*.scss"],{cwd:e,deep:5,ignore:Y}),xe(e)]);if(!t.length)return null;for(let n of t){let o=await x.readFile(k.resolve(e,n),"utf8");if(o.includes('@import "tailwindcss"')||o.includes("@import 'tailwindcss'")||o.includes("@tailwind base"))return n}return null}async function lt(e){let t=await J.glob("tailwind.config.*",{cwd:e,deep:3,ignore:Y});return t.length?t[0]:null}async function ft(e){let t=await loadConfig(e);if(t?.resultType==="failed"||!Object.entries(t?.paths).length)return null;for(let[r,n]of Object.entries(t.paths))if(n.includes("./*")||n.includes("./src/*")||n.includes("./app/*")||n.includes("./resources/js/*"))return r.replace(/\/\*$/,"")??null;return Object.keys(t?.paths)?.[0].replace(/\/\*$/,"")??null}async function mt(e){return (await J.glob("tsconfig.*",{cwd:e,deep:1,ignore:Y})).length>0}var i={error(...e){console.log(f.error(e.join(" ")));},warn(...e){console.log(f.warn(e.join(" ")));},info(...e){console.log(f.info(e.join(" ")));},success(...e){console.log(f.success(e.join(" ")));},log(...e){console.log(e.join(" "));},break(){console.log("");}};function h(e,t){return pt({text:e,isSilent:t?.silent})}async function be(e){let t={};if(!x.existsSync(e.cwd)||!x.existsSync(k.resolve(e.cwd,"package.json")))return t["1"]=true,{errors:t,projectInfo:null};let r=h("Preflight checks.",{silent:e.silent}).start();x.existsSync(k.resolve(e.cwd,"components.json"))&&!e.force&&(r?.fail(),i.break(),i.error(`A ${f.info("components.json")} file already exist at ${f.info(e.cwd)}. 
To start over, remove the ${f.info("components.json")} file and run ${f.info("init")} again.`),i.break(),process.exit(1)),r?.succeed();let n=h("Verifying framework.",{silent:e.silent}).start(),o=await Re(e.cwd);(!o||o?.framework.name==="manual")&&(t["7"]=true,n?.fail(),i.break(),o?.framework.links.installation&&i.error(`We could not detect a supported framework at ${f.info(e.cwd)}.
Visit ${f.info(o?.framework.links.installation)} to manually configure your project. 
Once configured, you can use the cli to add components.`),i.break(),process.exit(1)),n?.succeed(`Verifying framework. Found ${f.info(o.framework.label)}.`);let s="Validating Tailwind CSS.";o.tailwindVersion==="v4"&&(s=`Validating Tailwind CSS config. Found ${f.info("v4")}.`);let c=h(s,{silent:e.silent}).start();o.tailwindVersion==="v3"&&(!o?.tailwindConfigFile||!o?.tailwindCssFile)?(t["5"]=true,c?.fail()):o.tailwindVersion==="v4"&&!o?.tailwindCssFile?(t["5"]=true,c?.fail()):o.tailwindVersion?c?.succeed():(t["5"]=true,c?.fail());let a=h("Validating import alias.",{silent:e.silent}).start();return o?.aliasPrefix?a?.succeed():(t["6"]=true,a?.fail()),Object.keys(t).length>0&&(t["5"]&&(i.break(),i.error(`No Tailwind CSS configuration found at ${f.info(e.cwd)}.`),i.error("It is likely you do not have Tailwind CSS installed or have an invalid configuration."),i.error("Install Tailwind CSS then try again."),o?.framework.links.tailwind&&i.error(`Visit ${f.info(o?.framework.links.tailwind)} to get started.`)),t["6"]&&(i.break(),i.error("No import alias found in your tsconfig.json file."),o?.framework.links.installation&&i.error(`Visit ${f.info(o?.framework.links.installation)} to learn how to set an import alias.`)),i.break(),process.exit(1)),{errors:t,projectInfo:o}}var R={NOT_FOUND:"NOT_FOUND",UNAUTHORIZED:"UNAUTHORIZED",FORBIDDEN:"FORBIDDEN",FETCH_ERROR:"FETCH_ERROR",NOT_CONFIGURED:"NOT_CONFIGURED",MISSING_ENV_VARS:"MISSING_ENV_VARS",LOCAL_FILE_ERROR:"LOCAL_FILE_ERROR",PARSE_ERROR:"PARSE_ERROR",UNKNOWN_ERROR:"UNKNOWN_ERROR"},d=class extends Error{code;statusCode;context;suggestion;timestamp;cause;constructor(t,r={}){super(t),this.name="RegistryError",this.code=r.code||R.UNKNOWN_ERROR,this.statusCode=r.statusCode,this.cause=r.cause,this.context=r.context,this.suggestion=r.suggestion,this.timestamp=new Date,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor);}toJSON(){return {name:this.name,message:this.message,code:this.code,statusCode:this.statusCode,context:this.context,suggestion:this.suggestion,timestamp:this.timestamp,stack:this.stack}}},U=class extends d{constructor(r,n){let o=`The item at ${r} was not found. It may not exist at the registry.`;super(o,{code:R.NOT_FOUND,statusCode:404,cause:n,context:{url:r},suggestion:"Check if the item name is correct and the registry URL is accessible."});this.url=r;this.name="RegistryNotFoundError";}},Z=class extends d{constructor(r,n){let o=`You are not authorized to access the item at ${r}. If this is a remote registry, you may need to authenticate.`;super(o,{code:R.UNAUTHORIZED,statusCode:401,cause:n,context:{url:r},suggestion:"Check your authentication credentials and environment variables."});this.url=r;this.name="RegistryUnauthorizedError";}},q=class extends d{constructor(r,n){let o=`You are not authorized to access the item at ${r}. If this is a remote registry, you may need to authenticate.`;super(o,{code:R.FORBIDDEN,statusCode:403,cause:n,context:{url:r},suggestion:"Check your authentication credentials and environment variables."});this.url=r;this.name="RegistryForbiddenError";}},Q=class extends d{constructor(r,n,o,s){let c=n?`Failed to fetch from registry (${n}): ${r}`:`Failed to fetch from registry: ${r}`,a=typeof s=="string"&&s?`${c} - ${s}`:c,l="Check your network connection and try again.";n===404?l="The requested resource was not found. Check the URL or item name.":n===500?l="The registry server encountered an error. Try again later.":n&&n>=400&&n<500&&(l="There was a client error. Check your request parameters.");super(a,{code:R.FETCH_ERROR,statusCode:n,cause:s,context:{url:r,responseBody:o},suggestion:l});this.url=r;this.responseBody=o;this.name="RegistryFetchError";}},N=class extends d{constructor(r){let n=r?`Unknown registry "${r}". Make sure it is defined in components.json as follows:
{
  "registries": {
    "${r}": "[URL_TO_REGISTRY]"
  }
}`:'Unknown registry. Make sure it is defined in components.json under "registries".';super(n,{code:R.NOT_CONFIGURED,context:{registryName:r},suggestion:"Add the registry configuration to your components.json file. Consult the registry documentation for the correct format."});this.registryName=r;this.name="RegistryNotConfiguredError";}},M=class extends d{constructor(r,n){super(`Failed to read local registry file: ${r}`,{code:R.LOCAL_FILE_ERROR,cause:n,context:{filePath:r},suggestion:"Check if the file exists and you have read permissions."});this.filePath=r;this.name="RegistryLocalFileError";}},w=class extends d{constructor(r,n){let o=`Failed to parse registry item: ${r}`;n instanceof z.ZodError&&(o=`Failed to parse registry item: ${r}
${n.errors.map(s=>`  - ${s.path.join(".")}: ${s.message}`).join(`
`)}`);super(o,{code:R.PARSE_ERROR,cause:n,context:{item:r},suggestion:"The registry item may be corrupted or have an invalid format. Please make sure it returns a valid JSON object. See https://ui.shadcn.com/schema/registry-item.json."});this.item=r;this.parseError=n,this.name="RegistryParseError";}parseError},X=class extends d{constructor(r,n){let o=`Registry "${r}" requires the following environment variables:

`+n.map(s=>`  \u2022 ${s}`).join(`
`);super(o,{code:R.MISSING_ENV_VARS,context:{registryName:r,missingVars:n},suggestion:"Set the required environment variables to your .env or .env.local file."});this.registryName=r;this.missingVars=n;this.name="RegistryMissingEnvironmentVariablesError";}};var ee=class extends d{parseError;constructor(t){let r="Failed to parse registries index";if(t instanceof z.ZodError){let n=t.errors.filter(o=>o.path.length>0).map(o=>`"${o.path[0]}"`).filter((o,s,c)=>c.indexOf(o)===s);n.length>0?r=`Failed to parse registries index. Invalid registry namespace(s): ${n.join(", ")}
${t.errors.map(o=>`  - ${o.path.join(".")}: ${o.message}`).join(`
`)}`:r=`Failed to parse registries index:
${t.errors.map(o=>`  - ${o.path.join(".")}: ${o.message}`).join(`
`)}`;}super(r,{code:R.PARSE_ERROR,cause:t,context:{parseError:t},suggestion:"The registries index may be corrupted or have invalid registry namespace format. Registry names must start with @ (e.g., @shadcn, @example)."}),this.parseError=t,this.name="RegistriesIndexParseError";}};function b(e){if(i.break(),i.error("Something went wrong. Please check the error below for more details."),i.error("If the problem persist, please open an issue on GitHub."),i.error(""),typeof e=="string"&&(i.error(e),i.break(),process.exit(1)),e instanceof d&&(e.message&&(i.error(e.cause?"Error":"Message:"),i.error(e.message)),e.cause&&(i.error(`
Message:`),i.error(e.cause)),e.suggestion&&(i.error(`
Suggestion:`),i.error(e.suggestion)),i.break(),process.exit(1)),e instanceof u.ZodError){i.error("Validation failed:");for(let[t,r]of Object.entries(e.flatten().fieldErrors))i.error(`- ${f.info(t)}: ${r}`);i.break(),process.exit(1);}e instanceof Error&&(i.error(e.message),i.break(),process.exit(1)),i.break(),process.exit(1);}function V(e){return e.replace(/\${(\w+)}/g,(t,r)=>process.env[r]||"")}function G(e){let t=[],r=/\${(\w+)}/g,n;for(;(n=r.exec(e))!==null;)t.push(n[1]);return t}var dt=/^(@[a-zA-Z0-9](?:[a-zA-Z0-9-_]*[a-zA-Z0-9])?)\/(.+)$/;function T(e){if(!e.startsWith("@"))return {registry:null,item:e};let t=e.match(dt);return t?{registry:t[1],item:t[2]}:{registry:null,item:e}}function _(e){try{return new URL(e),!0}catch{return  false}}function ke(e){return e.endsWith(".json")&&!_(e)}function yt(e){return e.style?e.style==="aodesu"&&e.tailwind?.config===""?B:e.style:B}function j(e){let t=we({style:B,registries:g});return e?q$1.parse(ht(t,{...e,style:yt(e),registries:{...g,...e.registries}})):t}var te={headers:{}};function re(e){te.headers={...te.headers,...e};}function Ce(e){return te.headers[e]||{}}function W(){te.headers={};}function wt(e){let t=new Set;return typeof e=="string"?G(e).forEach(r=>t.add(r)):(G(e.url).forEach(r=>t.add(r)),e.params&&Object.values(e.params).forEach(r=>{G(r).forEach(n=>t.add(n));}),e.headers&&Object.values(e.headers).forEach(r=>{G(r).forEach(n=>t.add(n));})),Array.from(t)}function ve(e,t){let n=wt(t).filter(o=>!process.env[o]);if(n.length>0)throw new X(e,n)}var Oe="{name}",ne="{style}",Ne=/\${(\w+)}/g,Te="?",Rt="&";function F(e,t){let{registry:r,item:n}=T(e);if(!r)return null;let s=(t?.registries||{})[r];if(!s)throw new N(r);return ve(r,s),{url:xt(n,s,t),headers:Et(s)}}function xt(e,t,r){if(typeof t=="string"){let o=t.replace(Oe,e);return r?.style&&o.includes(ne)&&(o=o.replace(ne,r.style)),V(o)}let n=t.url.replace(Oe,e);return r?.style&&n.includes(ne)&&(n=n.replace(ne,r.style)),n=V(n),t.params?It(n,t.params):n}function Et(e){if(typeof e=="string"||!e.headers)return {};let t={};for(let[r,n]of Object.entries(e.headers)){let o=V(n);bt(n,o)&&(t[r]=o);}return t}function It(e,t){let r=new URLSearchParams;for(let[s,c]of Object.entries(t)){let a=V(c);a&&r.append(s,a);}let n=r.toString();if(!n)return e;let o=e.includes(Te)?Rt:Te;return `${e}${o}${n}`}function bt(e,t){let r=t.trim();if(!r)return  false;if(e.includes("${")&&e.match(Ne)){let o=e.replace(Ne,"").trim();return r!==o}return  true}function _e(e){if(_(e)){let t=new URL(e);return t.pathname.match(/\/chat\/b\//)&&!t.pathname.endsWith("/json")&&(t.pathname=`${t.pathname}/json`),t.toString()}return `${L}/${e}`}var Ot=process.env.https_proxy?new HttpsProxyAgent(process.env.https_proxy):void 0,fe=new Map;async function I(e,t={}){t={useCache:true,...t};try{return await Promise.all(e.map(async n=>{let o=_e(n);if(t.useCache&&fe.has(o))return fe.get(o);let s=(async()=>{let c=Ce(o),a=await Ct(o,{agent:Ot,headers:{...c}});if(!a.ok){let l;if(a.headers.get("content-type")?.includes("application/json")){let m=await a.json(),p=z.object({detail:z.string().optional(),title:z.string().optional(),message:z.string().optional(),error:z.string().optional()}).safeParse(m);p.success&&(l=p.data.detail||p.data.message,p.data.error&&(l=`[${p.data.error}] ${l}`));}throw a.status===401?new Z(o,l):a.status===404?new U(o,l):a.status===403?new q(o,l):new Q(o,a.status,l)}return a.json()})();return t.useCache&&fe.set(o,s),s}))}catch(r){throw r}}async function Fe(e){try{let t=e;e.startsWith("~/")&&(t=k.join(homedir(),e.slice(2)));let r=k.resolve(t),n=await promises.readFile(r,"utf8"),o=JSON.parse(n);try{return g$1.parse(o)}catch(s){throw new w(e,s)}}catch(t){throw t instanceof Error&&(t.message.includes("ENOENT")||t.message.includes("no such file"))?new M(e,t):t instanceof w?t:new M(e,t)}}function Nt(e,t){let r={},n=[...e];if(!t?.registries)return re({}),n;for(let o=0;o<n.length;o++){let s=F(n[o],t);s&&(n[o]=s.url,Object.keys(s.headers).length>0&&(r[s.url]=s.headers));}return re(r),n}async function oe(e,t,r={}){return await Promise.all(e.map(async o=>{if(ke(o))return Fe(o);if(_(o)){let[a]=await I([o],r);try{return g$1.parse(a)}catch(l){throw new w(o,l)}}if(o.startsWith("@")&&t?.registries){let a=Nt([o],t),[l]=await I(a,r);try{return g$1.parse(l)}catch(m){throw new w(o,m)}}let s=`styles/${t?.style??"aodesu"}/${o}.json`,[c]=await I([s],r);console.log("TEST - LLEGO AKI");try{return g$1.parse(c)}catch(a){throw new w(o,a)}}))}async function Pe(e,t){let{config:r,useCache:n}=t||{};return W(),oe(e,j(r),{useCache:n})}async function $e(e){e={useCache:true,...e};let t=`${L}/registries.json`,[r]=await I([t],{useCache:e.useCache});try{return u$1.parse(r)}catch(n){throw n instanceof u.ZodError?new ee(n):n}}async function Ae(e,{withFallback:t}={withFallback:false}){let r=await detect({programmatic:true,cwd:e});if(r==="yarn@berry")return "yarn";if(r==="pnpm@6")return "pnpm";if(r==="bun")return "bun";if(r==="deno")return "deno";if(!t)return r??"npm";let n=process.env.npm_config_user_agent||"";return n.startsWith("yarn")?"yarn":n.startsWith("pnpm")?"pnpm":n.startsWith("bun")?"bun":"npm"}var Pt="https://codeload.github.com/shadcn-ui/ui/tar.gz/main",S={next:"next","next-16":"next-16","next-monorepo":"next-monorepo",vite:"vite"};async function Le(e){e={srcDir:false,...e};let t=e.template&&S[e.template]?e.template:"next",r=t===S.next?"my-app":"my-monorepo",n="15",o=e.components?.length===1&&!!e.components[0].match(/\/chat\/b\//);if(e.components&&o)try{let[a]=await I(e.components),{meta:l}=u.object({meta:u.object({nextVersion:u.string()})}).parse(a);n=l.nextVersion,t=S.next;}catch(a){i.break(),b(a);}if(!e.force){let{type:a,name:l}=await Ft([{type:e.template||o?null:"select",name:"type",message:`The path ${f.info(e.cwd)} does not contain a package.json file.
  Would you like to start a new project?`,choices:[{title:"Vite",value:"vite"},{title:"Next.js 15",value:"next"},{title:"Next.js 16",value:"next-16"},{title:"Next.js (Monorepo)",value:"next-monorepo"}],initial:0},{type:"text",name:"name",message:"What is your project named?",initial:r,format:m=>m.trim(),validate:m=>m.length>128?"Name should be less than 128 characters.":true}]);t=a??t,r=l,a==="next-16"&&(n="latest");}let s=await Ae(e.cwd,{withFallback:true}),c=`${e.cwd}/${r}`;try{await x.access(e.cwd,x.constants.W_OK);}catch{i.break(),i.error(`The path ${f.info(e.cwd)} is not writable.`),i.error(`It is likely you do not have write permissions for this folder or the path ${f.info(e.cwd)} does not exist.`),i.break(),process.exit(1);}return x.existsSync(k.resolve(e.cwd,r,"package.json"))&&(i.break(),i.error(`A project with the name ${f.info(r)} already exists.`),i.error("Please choose a different name and try again."),i.break(),process.exit(1)),t===S.vite&&await $t(c,{packageManager:s}),(t===S.next||t===S["next-16"])&&await At(c,{version:n,cwd:e.cwd,packageManager:s,srcDir:!!e.srcDir}),t===S["next-monorepo"]&&await Lt(c,{packageManager:s}),{projectPath:c,projectName:r,template:t}}async function $t(e,t){let r=h("Creating a new Vite project. This may take a few minutes.").start();try{let n=["create","vite@latest",k.basename(e),"--template","react-ts","--yes"];await execa(t.packageManager,n,{cwd:k.dirname(e)});let o=h(`Installing dependencies with ${t.packageManager}.`).start();await execa(t.packageManager,["install"],{cwd:e}),o?.succeed(`Installed dependencies with ${t.packageManager}.`);try{await execa("git",["init"],{cwd:e}),await execa("git",["add","-A"],{cwd:e}),await execa("git",["commit","-m","Initial commit from shadcn-ui"],{cwd:e});}catch{i.warn("Git initialization skipped (git not available)");}r?.succeed("Creating a new Vite project.");}catch(n){r?.fail("Something went worng creating a new Vite project."),b(n);}}async function At(e,t){let r=h(`Creating a new Next.js ${t.version.startsWith("latest")?"16":"15"} project. This may take a few minutes.`).start(),n=["--tailwind","--eslint","--typescript","--app",t.srcDir?"--src-dir":"--no-src-dir","--no-import-alias",`--use-${t.packageManager}`];(t.version.startsWith("15")||t.version.startsWith("latest")||t.version.startsWith("canary"))&&n.push("--turbopack"),(t.version.startsWith("latest")||t.version.startsWith("canary"))&&n.push("--no-react-compiler");try{await execa("npx",[`create-next-app@${t.version}`,e,"--silent",...n],{cwd:t.cwd});}catch{i.break(),i.error("Something went wrong creating a new Next.js project. Please try again."),process.exit(1);}r?.succeed(`Creating a new Next.js ${t.version.startsWith("latest")?"16":"15"} project.`);}async function Lt(e,t){let r=h("Creating a new Next.js monorepo. This may take a few minutes.").start();try{let n=k.join(jt.tmpdir(),`shadcn-template-${Date.now()}`);await x.ensureDir(n);let o=await fetch(Pt);if(!o.ok)throw new Error(`Failed to download template: ${o.statusText}`);let s=k.resolve(n,"template.tar.gz");await x.writeFile(s,Buffer.from(await o.arrayBuffer())),await execa("tar",["-xzf",s,"-C",n,"--strip-components=2","ui-main/templates/monorepo-next"]);let c=k.resolve(n,"monorepo-next");await x.move(c,e),await x.remove(n),await execa(t.packageManager,["install"],{cwd:e});let a=k.join(e,"package.json");if(x.existsSync(a)){let m=await x.readFile(a,"utf8"),p=JSON.parse(m);p.name=e.split("/").pop(),await x.writeFile(a,JSON.stringify(p,null,2));}let l=process.cwd();await execa("git",["--version"],{cwd:e}),await execa("git",["init"],{cwd:e}),await execa("git",["add","-A"],{cwd:e}),await execa("git",["commit","-m","Initial commit"],{cwd:e}),r?.succeed("Creating a new Next.js monorepo.");}catch(n){r?.fail("Something went wrong creating a new Next.js monorepo."),b(n);}}async function De(e=process.cwd()){try{let{config:t}=await import('@dotenvx/dotenvx'),r=[".env.local",".env.development.local",".env.development",".env"];for(let n of r){let o=join(e,n);existsSync(o)&&t({path:o,overload:!1,quiet:!0});}}catch(t){i.warn("Failed to load env files:",t);}}var pe=".bak";function Ue(e){if(!x.existsSync(e))return null;let t=`${e}${pe}`;try{return x.renameSync(e,t),t}catch(r){return console.error(`Failed to create backup of ${e}: ${r}`),null}}function Me(e){let t=`${e}${pe}`;if(!x.existsSync(t))return  false;try{return x.renameSync(t,e),!0}catch(r){return console.error(`Warning: Could not restore backup file ${t}: ${r}`),false}}function Ve(e){let t=`${e}${pe}`;if(!x.existsSync(t))return  false;try{return x.unlinkSync(t),!0}catch{return  false}}async function Ge(e,t){let r=new Set,n=new Set,o=[...e];for(;o.length>0;){let s=o.shift();if(n.has(s))continue;n.add(s);let{registry:c}=T(s);c&&!g[c]&&r.add(c);try{let[a]=await oe([s],t,{useCache:!0});if(a?.registryDependencies)for(let l of a.registryDependencies){let{registry:m}=T(l);m&&!g[m]&&r.add(m),n.has(l)||o.push(l);}}catch(a){if(a instanceof N){let{registry:l}=T(s);l&&!g[l]&&r.add(l);continue}continue}}return Array.from(r)}async function We(e,t,r={}){r={silent:false,writeFile:true,...r};let o=(await Ge(e,t)).filter(m=>!t.registries?.[m]&&!Object.keys(g).includes(m));if(o.length===0)return {config:t,newRegistries:[]};let s=await $e({useCache:process.env.NODE_ENV!=="development"});if(!s)return {config:t,newRegistries:[]};let c={};for(let m of o)s[m]&&(c[m]=s[m]);if(Object.keys(c).length===0)return {config:t,newRegistries:[]};let a=Object.fromEntries(Object.entries(t.registries||{}).filter(([m])=>!Object.keys(g).includes(m))),l={...t,registries:{...a,...c}};if(r.writeFile){let{resolvedPaths:m,...p$1}=l,$=h("Updating components.json.",{silent:r.silent}).start(),Be=p.parse(p$1);await x.writeFile(k.resolve(t.resolvedPaths.cwd,"components.json"),JSON.stringify(Be,null,2)+`
`,"utf-8"),$.succeed();}return {config:l,newRegistries:Object.keys(c)}}process.on("exit",e=>{let t=k.resolve(process.cwd(),"components.json");return e===0?Ve(t):Me(t)});var Wt=u.object({cwd:u.string(),components:u.array(u.string()).optional(),yes:u.boolean(),defaults:u.boolean(),force:u.boolean(),silent:u.boolean(),isNewProject:u.boolean(),srcDir:u.boolean().optional(),cssVariables:u.boolean(),template:u.string().optional().refine(e=>e?"TEMPLATES":true,{message:"Invalid template. Please use 'next', 'next-16' or 'next-monorepo'."}),baseColor:u.string().optional(),baseStyle:u.boolean()}),He=new Command().name("init").description("initialize your project and install dependencies").argument("[components...]","names, url or local path to component").option("-t, --template <template>","the template to use. (next, next-16, next-monorepo)").option("-b, --base-color <base-color>","The base color to use. (neutral)",void 0).option("-y, --yes","Skip de confirmation prompt",true).option("-d, --defaults","Use default configuration.",false).option("-f, --force","Force overwrite of existing configuration",false).option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).option("-s, --silent","Mute output",false).option("--src-dir","Use the src directory when creating a new project.",false).option("--no-src-dir","Do not use the src directory when creating a new project.").option("--css-variables","Use css variables for theming.",true).option("--no-base-style","Do not install the base aodesu style.").action(async(e,t)=>{try{t.defaults&&(t.template=t.template||"next",t.baseColor=t.baseColor||"neutral");let r=Wt.parse({cwd:k.resolve(t.cwd),isNewProject:!1,components:e,...t});if(await De(r.cwd),e.length>0){let n=j({}),o=k.resolve(r.cwd,"components.json");if(x.existsSync(o)){let a=await x.readJson(o),l=p.partial().parse(a);n=j(l),Ue(o);}let{config:s}=await We(e,n,{silent:!0});n=s,F(e[0],n);let[c]=await Pe([e[0]],{config:n});console.log("TEST - LLEGO AKI"),c?.type=="registry:style"&&(r.baseColor="neutral",r.baseStyle=c.extends==="none"?!1:r.baseStyle);}r.baseStyle||(r.baseColor="neutral"),await zt(r),i.log(`${f.success("Success!")} Project initialization completed. 
You may now add components.`);}catch(r){i.break(),b(r);}finally{W();}});async function zt(e){if(!e.skipPreflight&&(await be(e)).errors["1"]){let{projectPath:o,template:s}=await Le(e);o||process.exit(1);}}process.on("SIGNINT",()=>process.exit(0));process.on("SIGTERM",()=>process.exit(0));async function Bt(){let e=new Command().name("uidesu").description("add items from registry to your project").version(de.version,"-v, --version","display the version number");e.addCommand(He),e.parse();}Bt();//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map