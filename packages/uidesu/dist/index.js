#!/usr/bin/env node
import {p as p$1,q as q$1,u as u$1,g as g$1}from'./chunk-2IEF2V43.js';import {c,d,a}from'./chunk-3PNIJ46X.js';import'./chunk-I75INDCH.js';import {Command}from'commander';import q from'fs-extra';import Ae,{join}from'path';import b,{z as z$1}from'zod';import {green,cyan,yellow,red}from'kleur/colors';import jr from'deepmerge';import {existsSync,promises}from'fs';import {HttpsProxyAgent}from'https-proxy-agent';import be from'http';import ot from'https';import K from'zlib';import A,{pipeline,PassThrough}from'stream';import {Buffer as Buffer$1}from'buffer';import {promisify,deprecate,types}from'util';import {format}from'url';import {isIP}from'net';import {homedir}from'os';import mt from'ora';var De={version:"1.0.0"};var P={NOT_FOUND:"NOT_FOUND",UNAUTHORIZED:"UNAUTHORIZED",FORBIDDEN:"FORBIDDEN",FETCH_ERROR:"FETCH_ERROR",NOT_CONFIGURED:"NOT_CONFIGURED",MISSING_ENV_VARS:"MISSING_ENV_VARS",LOCAL_FILE_ERROR:"LOCAL_FILE_ERROR",PARSE_ERROR:"PARSE_ERROR",UNKNOWN_ERROR:"UNKNOWN_ERROR"},w=class extends Error{code;statusCode;context;suggestion;timestamp;cause;constructor(r,t={}){super(r),this.name="RegistryError",this.code=t.code||P.UNKNOWN_ERROR,this.statusCode=t.statusCode,this.cause=t.cause,this.context=t.context,this.suggestion=t.suggestion,this.timestamp=new Date,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor);}toJSON(){return {name:this.name,message:this.message,code:this.code,statusCode:this.statusCode,context:this.context,suggestion:this.suggestion,timestamp:this.timestamp,stack:this.stack}}},X=class extends w{constructor(t,n){let o=`The item at ${t} was not found. It may not exist at the registry.`;super(o,{code:P.NOT_FOUND,statusCode:404,cause:n,context:{url:t},suggestion:"Check if the item name is correct and the registry URL is accessible."});this.url=t;this.name="RegistryNotFoundError";}},ce=class extends w{constructor(t,n){let o=`You are not authorized to access the item at ${t}. If this is a remote registry, you may need to authenticate.`;super(o,{code:P.UNAUTHORIZED,statusCode:401,cause:n,context:{url:t},suggestion:"Check your authentication credentials and environment variables."});this.url=t;this.name="RegistryUnauthorizedError";}},le=class extends w{constructor(t,n){let o=`You are not authorized to access the item at ${t}. If this is a remote registry, you may need to authenticate.`;super(o,{code:P.FORBIDDEN,statusCode:403,cause:n,context:{url:t},suggestion:"Check your authentication credentials and environment variables."});this.url=t;this.name="RegistryForbiddenError";}},fe=class extends w{constructor(t,n,o,s){let i=n?`Failed to fetch from registry (${n}): ${t}`:`Failed to fetch from registry: ${t}`,a=typeof s=="string"&&s?`${i} - ${s}`:i,l="Check your network connection and try again.";n===404?l="The requested resource was not found. Check the URL or item name.":n===500?l="The registry server encountered an error. Try again later.":n&&n>=400&&n<500&&(l="There was a client error. Check your request parameters.");super(a,{code:P.FETCH_ERROR,statusCode:n,cause:s,context:{url:t,responseBody:o},suggestion:l});this.url=t;this.responseBody=o;this.name="RegistryFetchError";}},H=class extends w{constructor(t){let n=t?`Unknown registry "${t}". Make sure it is defined in components.json as follows:
{
  "registries": {
    "${t}": "[URL_TO_REGISTRY]"
  }
}`:'Unknown registry. Make sure it is defined in components.json under "registries".';super(n,{code:P.NOT_CONFIGURED,context:{registryName:t},suggestion:"Add the registry configuration to your components.json file. Consult the registry documentation for the correct format."});this.registryName=t;this.name="RegistryNotConfiguredError";}},ee=class extends w{constructor(t,n){super(`Failed to read local registry file: ${t}`,{code:P.LOCAL_FILE_ERROR,cause:n,context:{filePath:t},suggestion:"Check if the file exists and you have read permissions."});this.filePath=t;this.name="RegistryLocalFileError";}},I=class extends w{constructor(t,n){let o=`Failed to parse registry item: ${t}`;n instanceof z$1.ZodError&&(o=`Failed to parse registry item: ${t}
${n.errors.map(s=>`  - ${s.path.join(".")}: ${s.message}`).join(`
`)}`);super(o,{code:P.PARSE_ERROR,cause:n,context:{item:t},suggestion:"The registry item may be corrupted or have an invalid format. Please make sure it returns a valid JSON object. See https://ui.shadcn.com/schema/registry-item.json."});this.item=t;this.parseError=n,this.name="RegistryParseError";}parseError},ue=class extends w{constructor(t,n){let o=`Registry "${t}" requires the following environment variables:

`+n.map(s=>`  \u2022 ${s}`).join(`
`);super(o,{code:P.MISSING_ENV_VARS,context:{registryName:t,missingVars:n},suggestion:"Set the required environment variables to your .env or .env.local file."});this.registryName=t;this.missingVars=n;this.name="RegistryMissingEnvironmentVariablesError";}};var de=class extends w{parseError;constructor(r){let t="Failed to parse registries index";if(r instanceof z$1.ZodError){let n=r.errors.filter(o=>o.path.length>0).map(o=>`"${o.path[0]}"`).filter((o,s,i)=>i.indexOf(o)===s);n.length>0?t=`Failed to parse registries index. Invalid registry namespace(s): ${n.join(", ")}
${r.errors.map(o=>`  - ${o.path.join(".")}: ${o.message}`).join(`
`)}`:t=`Failed to parse registries index:
${r.errors.map(o=>`  - ${o.path.join(".")}: ${o.message}`).join(`
`)}`;}super(t,{code:P.PARSE_ERROR,cause:r,context:{parseError:r},suggestion:"The registries index may be corrupted or have invalid registry namespace format. Registry names must start with @ (e.g., @shadcn, @example)."}),this.parseError=r,this.name="RegistriesIndexParseError";}};var $={error:red,warn:yellow,info:cyan,success:green};var u={error(...e){console.log($.error(e.join(" ")));},warn(...e){console.log($.warn(e.join(" ")));},info(...e){console.log($.info(e.join(" ")));},success(...e){console.log($.success(e.join(" ")));},log(...e){console.log(e.join(" "));},break(){console.log("");}};function Ie(e){if(u.break(),u.error("Something went wrong. Please check the error below for more details."),u.error("If the problem persist, please open an issue on GitHub."),u.error(""),typeof e=="string"&&(u.error(e),u.break(),process.exit(1)),e instanceof w&&(e.message&&(u.error(e.cause?"Error":"Message:"),u.error(e.message)),e.cause&&(u.error(`
Message:`),u.error(e.cause)),e.suggestion&&(u.error(`
Suggestion:`),u.error(e.suggestion)),u.break(),process.exit(1)),e instanceof b.ZodError){u.error("Validation failed:");for(let[r,t]of Object.entries(e.flatten().fieldErrors))u.error(`- ${$.info(r)}: ${t}`);u.break(),process.exit(1);}e instanceof Error&&(u.error(e.message),u.break(),process.exit(1)),u.break(),process.exit(1);}var re=process.env.REGISTRY_URL??"https://ui.aodesu.com/r",pe="aodesu",E={"@uidesu":`${re}/styles/{style}/{name}.json`};function te(e){return e.replace(/\${(\w+)}/g,(r,t)=>process.env[t]||"")}function oe(e){let r=[],t=/\${(\w+)}/g,n;for(;(n=t.exec(e))!==null;)r.push(n[1]);return r}var _r=/^(@[a-zA-Z0-9](?:[a-zA-Z0-9-_]*[a-zA-Z0-9])?)\/(.+)$/;function z(e){if(!e.startsWith("@"))return {registry:null,item:e};let r=e.match(_r);return r?{registry:r[1],item:r[2]}:{registry:null,item:e}}function V(e){try{return new URL(e),!0}catch{return  false}}function ze(e){return e.endsWith(".json")&&!V(e)}function Ve(e){let r={resolvedPaths:{cwd:process.cwd(),tailwindConfig:"",tailwindCss:"",utils:"",components:"",ui:"",lib:"",hooks:""},style:"",tailwind:{config:"",css:"",baseColor:"",cssVariables:false},rsc:false,tsx:true,aliases:{components:"",utils:""},registries:{...E}};return e?{...r,...e,resolvedPaths:{...r.resolvedPaths,...e.resolvedPaths||{}},tailwind:{...r.tailwind,...e.tailwind||{}},aliases:{...r.aliases,...e.aliases||{}},registries:{...r.registries,...e.registries||{}}}:r}function Br(e){return e.style?e.style==="aodesu"&&e.tailwind?.config===""?pe:e.style:pe}function W(e){let r=Ve({style:pe,registries:E});return e?q$1.parse(jr(r,{...e,style:Br(e),registries:{...E,...e.registries}})):r}var me={headers:{}};function he(e){me.headers={...me.headers,...e};}function We(e){return me.headers[e]||{}}function Pe(){me.headers={};}function Dr(e){let r=new Set;return typeof e=="string"?oe(e).forEach(t=>r.add(t)):(oe(e.url).forEach(t=>r.add(t)),e.params&&Object.values(e.params).forEach(t=>{oe(t).forEach(n=>r.add(n));}),e.headers&&Object.values(e.headers).forEach(t=>{oe(t).forEach(n=>r.add(n));})),Array.from(r)}function Me(e,r){let n=Dr(r).filter(o=>!process.env[o]);if(n.length>0)throw new ue(e,n)}var Ge="{name}",ge="{style}",Ye=/\${(\w+)}/g,Ke="?",Hr="&";function M(e,r){let{registry:t,item:n}=z(e);if(!t)return null;let s=(r?.registries||{})[t];if(!s)throw new H(t);return Me(t,s),{url:zr(n,s,r),headers:Vr(s)}}function zr(e,r,t){if(typeof r=="string"){let o=r.replace(Ge,e);return t?.style&&o.includes(ge)&&(o=o.replace(ge,t.style)),te(o)}let n=r.url.replace(Ge,e);return t?.style&&n.includes(ge)&&(n=n.replace(ge,t.style)),n=te(n),r.params?Wr(n,r.params):n}function Vr(e){if(typeof e=="string"||!e.headers)return {};let r={};for(let[t,n]of Object.entries(e.headers)){let o=te(n);Mr(n,o)&&(r[t]=o);}return r}function Wr(e,r){let t=new URLSearchParams;for(let[s,i]of Object.entries(r)){let a=te(i);a&&t.append(s,a);}let n=t.toString();if(!n)return e;let o=e.includes(Ke)?Hr:Ke;return `${e}${o}${n}`}function Mr(e,r){let t=r.trim();if(!t)return  false;if(e.includes("${")&&e.match(Ye)){let o=e.replace(Ye,"").trim();return t!==o}return  true}function Ze(e){if(V(e)){let r=new URL(e);return r.pathname.match(/\/chat\/b\//)&&!r.pathname.endsWith("/json")&&(r.pathname=`${r.pathname}/json`),r.toString()}return `${re}/${e}`}function Gr(e){if(!/^data:/i.test(e))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');e=e.replace(/\r?\n/g,"");let r=e.indexOf(",");if(r===-1||r<=4)throw new TypeError("malformed data: URI");let t=e.substring(5,r).split(";"),n="",o=false,s=t[0]||"text/plain",i=s;for(let d=1;d<t.length;d++)t[d]==="base64"?o=true:t[d]&&(i+=`;${t[d]}`,t[d].indexOf("charset=")===0&&(n=t[d].substring(8)));!t[0]&&!n.length&&(i+=";charset=US-ASCII",n="US-ASCII");let a=o?"base64":"ascii",l=unescape(e.substring(r+1)),c=Buffer.from(l,a);return c.type=s,c.typeFull=i,c.charset=n,c}var Je=Gr;var U=class extends Error{constructor(r,t){super(r),Error.captureStackTrace(this,this.constructor),this.type=t;}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var g=class extends U{constructor(r,t,n){super(r,t),n&&(this.code=this.errno=n.code,this.erroredSysCall=n.syscall);}};var ye=Symbol.toStringTag,ke=e=>typeof e=="object"&&typeof e.append=="function"&&typeof e.delete=="function"&&typeof e.get=="function"&&typeof e.getAll=="function"&&typeof e.has=="function"&&typeof e.set=="function"&&typeof e.sort=="function"&&e[ye]==="URLSearchParams",ne=e=>e&&typeof e=="object"&&typeof e.arrayBuffer=="function"&&typeof e.type=="string"&&typeof e.stream=="function"&&typeof e.constructor=="function"&&/^(Blob|File)$/.test(e[ye]),qe=e=>typeof e=="object"&&(e[ye]==="AbortSignal"||e[ye]==="EventTarget"),Qe=(e,r)=>{let t=new URL(r).hostname,n=new URL(e).hostname;return t===n||t.endsWith(`.${n}`)},Xe=(e,r)=>{let t=new URL(r).protocol,n=new URL(e).protocol;return t===n};var Kr=promisify(A.pipeline),y=Symbol("Body internals"),k=class{constructor(r,{size:t=0}={}){let n=null;r===null?r=null:ke(r)?r=Buffer$1.from(r.toString()):ne(r)||Buffer$1.isBuffer(r)||(types.isAnyArrayBuffer(r)?r=Buffer$1.from(r):ArrayBuffer.isView(r)?r=Buffer$1.from(r.buffer,r.byteOffset,r.byteLength):r instanceof A||(r instanceof c?(r=d(r),n=r.type.split("=")[1]):r=Buffer$1.from(String(r))));let o=r;Buffer$1.isBuffer(r)?o=A.Readable.from(r):ne(r)&&(o=A.Readable.from(r.stream())),this[y]={body:r,stream:o,boundary:n,disturbed:false,error:null},this.size=t,r instanceof A&&r.on("error",s=>{let i=s instanceof U?s:new g(`Invalid response body while trying to fetch ${this.url}: ${s.message}`,"system",s);this[y].error=i;});}get body(){return this[y].stream}get bodyUsed(){return this[y].disturbed}async arrayBuffer(){let{buffer:r,byteOffset:t,byteLength:n}=await Le(this);return r.slice(t,t+n)}async formData(){let r=this.headers.get("content-type");if(r.startsWith("application/x-www-form-urlencoded")){let n=new c,o=new URLSearchParams(await this.text());for(let[s,i]of o)n.append(s,i);return n}let{toFormData:t}=await import('./multipart-parser-QRVESOG6.js');return t(this.body,r)}async blob(){let r=this.headers&&this.headers.get("content-type")||this[y].body&&this[y].body.type||"",t=await this.arrayBuffer();return new a([t],{type:r})}async json(){let r=await this.text();return JSON.parse(r)}async text(){let r=await Le(this);return new TextDecoder().decode(r)}buffer(){return Le(this)}};k.prototype.buffer=deprecate(k.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer");Object.defineProperties(k.prototype,{body:{enumerable:true},bodyUsed:{enumerable:true},arrayBuffer:{enumerable:true},blob:{enumerable:true},json:{enumerable:true},text:{enumerable:true},data:{get:deprecate(()=>{},"data doesn't exist, use json(), text(), arrayBuffer(), or body instead","https://github.com/node-fetch/node-fetch/issues/1000 (response)")}});async function Le(e){if(e[y].disturbed)throw new TypeError(`body used already for: ${e.url}`);if(e[y].disturbed=true,e[y].error)throw e[y].error;let{body:r}=e;if(r===null)return Buffer$1.alloc(0);if(!(r instanceof A))return Buffer$1.alloc(0);let t=[],n=0;try{for await(let o of r){if(e.size>0&&n+o.length>e.size){let s=new g(`content size at ${e.url} over limit: ${e.size}`,"max-size");throw r.destroy(s),s}n+=o.length,t.push(o);}}catch(o){throw o instanceof U?o:new g(`Invalid response body while trying to fetch ${e.url}: ${o.message}`,"system",o)}if(r.readableEnded===true||r._readableState.ended===true)try{return t.every(o=>typeof o=="string")?Buffer$1.from(t.join("")):Buffer$1.concat(t,n)}catch(o){throw new g(`Could not create Buffer from response body for ${e.url}: ${o.message}`,"system",o)}else throw new g(`Premature close of server response while trying to fetch ${e.url}`)}var G=(e,r)=>{let t,n,{body:o}=e[y];if(e.bodyUsed)throw new Error("cannot clone body after it is used");return o instanceof A&&typeof o.getBoundary!="function"&&(t=new PassThrough({highWaterMark:r}),n=new PassThrough({highWaterMark:r}),o.pipe(t),o.pipe(n),e[y].stream=t,o=n),o},Zr=deprecate(e=>e.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),we=(e,r)=>e===null?null:typeof e=="string"?"text/plain;charset=UTF-8":ke(e)?"application/x-www-form-urlencoded;charset=UTF-8":ne(e)?e.type||null:Buffer$1.isBuffer(e)||types.isAnyArrayBuffer(e)||ArrayBuffer.isView(e)?null:e instanceof c?`multipart/form-data; boundary=${r[y].boundary}`:e&&typeof e.getBoundary=="function"?`multipart/form-data;boundary=${Zr(e)}`:e instanceof A?null:"text/plain;charset=UTF-8",tr=e=>{let{body:r}=e[y];return r===null?0:ne(r)?r.size:Buffer$1.isBuffer(r)?r.length:r&&typeof r.getLengthSync=="function"&&r.hasKnownLength&&r.hasKnownLength()?r.getLengthSync():null},or=async(e,{body:r})=>{r===null?e.end():await Kr(r,e);};var Re=typeof be.validateHeaderName=="function"?be.validateHeaderName:e=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(e)){let r=new TypeError(`Header name must be a valid HTTP token [${e}]`);throw Object.defineProperty(r,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),r}},Fe=typeof be.validateHeaderValue=="function"?be.validateHeaderValue:(e,r)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(r)){let t=new TypeError(`Invalid character in header content ["${e}"]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_CHAR"}),t}},R=class e extends URLSearchParams{constructor(r){let t=[];if(r instanceof e){let n=r.raw();for(let[o,s]of Object.entries(n))t.push(...s.map(i=>[o,i]));}else if(r!=null)if(typeof r=="object"&&!types.isBoxedPrimitive(r)){let n=r[Symbol.iterator];if(n==null)t.push(...Object.entries(r));else {if(typeof n!="function")throw new TypeError("Header pairs must be iterable");t=[...r].map(o=>{if(typeof o!="object"||types.isBoxedPrimitive(o))throw new TypeError("Each header pair must be an iterable object");return [...o]}).map(o=>{if(o.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return [...o]});}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");return t=t.length>0?t.map(([n,o])=>(Re(n),Fe(n,String(o)),[String(n).toLowerCase(),String(o)])):void 0,super(t),new Proxy(this,{get(n,o,s){switch(o){case "append":case "set":return (i,a)=>(Re(i),Fe(i,String(a)),URLSearchParams.prototype[o].call(n,String(i).toLowerCase(),String(a)));case "delete":case "has":case "getAll":return i=>(Re(i),URLSearchParams.prototype[o].call(n,String(i).toLowerCase()));case "keys":return ()=>(n.sort(),new Set(URLSearchParams.prototype.keys.call(n)).keys());default:return Reflect.get(n,o,s)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(r){let t=this.getAll(r);if(t.length===0)return null;let n=t.join(", ");return /^content-encoding$/i.test(r)&&(n=n.toLowerCase()),n}forEach(r,t=void 0){for(let n of this.keys())Reflect.apply(r,t,[this.get(n),n,this]);}*values(){for(let r of this.keys())yield this.get(r);}*entries(){for(let r of this.keys())yield [r,this.get(r)];}[Symbol.iterator](){return this.entries()}raw(){return [...this.keys()].reduce((r,t)=>(r[t]=this.getAll(t),r),{})}[Symbol.for("nodejs.util.inspect.custom")](){return [...this.keys()].reduce((r,t)=>{let n=this.getAll(t);return t==="host"?r[t]=n[0]:r[t]=n.length>1?n:n[0],r},{})}};Object.defineProperties(R.prototype,["get","entries","forEach","values"].reduce((e,r)=>(e[r]={enumerable:true},e),{}));function sr(e=[]){return new R(e.reduce((r,t,n,o)=>(n%2===0&&r.push(o.slice(n,n+2)),r),[]).filter(([r,t])=>{try{return Re(r),Fe(r,String(t)),!0}catch{return  false}}))}var Jr=new Set([301,302,303,307,308]),xe=e=>Jr.has(e);var T=Symbol("Response internals"),C=class e extends k{constructor(r=null,t={}){super(r,t);let n=t.status!=null?t.status:200,o=new R(t.headers);if(r!==null&&!o.has("Content-Type")){let s=we(r,this);s&&o.append("Content-Type",s);}this[T]={type:"default",url:t.url,status:n,statusText:t.statusText||"",headers:o,counter:t.counter,highWaterMark:t.highWaterMark};}get type(){return this[T].type}get url(){return this[T].url||""}get status(){return this[T].status}get ok(){return this[T].status>=200&&this[T].status<300}get redirected(){return this[T].counter>0}get statusText(){return this[T].statusText}get headers(){return this[T].headers}get highWaterMark(){return this[T].highWaterMark}clone(){return new e(G(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(r,t=302){if(!xe(t))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new e(null,{headers:{location:new URL(r).toString()},status:t})}static error(){let r=new e(null,{status:0,statusText:""});return r[T].type="error",r}static json(r=void 0,t={}){let n=JSON.stringify(r);if(n===void 0)throw new TypeError("data is not JSON serializable");let o=new R(t&&t.headers);return o.has("content-type")||o.set("content-type","application/json"),new e(n,{...t,headers:o})}get[Symbol.toStringTag](){return "Response"}};Object.defineProperties(C.prototype,{type:{enumerable:true},url:{enumerable:true},status:{enumerable:true},ok:{enumerable:true},redirected:{enumerable:true},statusText:{enumerable:true},headers:{enumerable:true},clone:{enumerable:true}});var ir=e=>{if(e.search)return e.search;let r=e.href.length-1,t=e.hash||(e.href[r]==="#"?"#":"");return e.href[r-t.length]==="?"?"?":""};function ar(e,r=false){return e==null||(e=new URL(e),/^(about|blob|data):$/.test(e.protocol))?"no-referrer":(e.username="",e.password="",e.hash="",r&&(e.pathname="",e.search=""),e)}var cr=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]),lr="strict-origin-when-cross-origin";function fr(e){if(!cr.has(e))throw new TypeError(`Invalid referrerPolicy: ${e}`);return e}function Qr(e){if(/^(http|ws)s:$/.test(e.protocol))return  true;let r=e.host.replace(/(^\[)|(]$)/g,""),t=isIP(r);return t===4&&/^127\./.test(r)||t===6&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(r)?true:e.host==="localhost"||e.host.endsWith(".localhost")?false:e.protocol==="file:"}function Y(e){return /^about:(blank|srcdoc)$/.test(e)||e.protocol==="data:"||/^(blob|filesystem):$/.test(e.protocol)?true:Qr(e)}function ur(e,{referrerURLCallback:r,referrerOriginCallback:t}={}){if(e.referrer==="no-referrer"||e.referrerPolicy==="")return null;let n=e.referrerPolicy;if(e.referrer==="about:client")return "no-referrer";let o=e.referrer,s=ar(o),i=ar(o,true);s.toString().length>4096&&(s=i),r&&(s=r(s)),t&&(i=t(i));let a=new URL(e.url);switch(n){case "no-referrer":return "no-referrer";case "origin":return i;case "unsafe-url":return s;case "strict-origin":return Y(s)&&!Y(a)?"no-referrer":i.toString();case "strict-origin-when-cross-origin":return s.origin===a.origin?s:Y(s)&&!Y(a)?"no-referrer":i;case "same-origin":return s.origin===a.origin?s:"no-referrer";case "origin-when-cross-origin":return s.origin===a.origin?s:i;case "no-referrer-when-downgrade":return Y(s)&&!Y(a)?"no-referrer":s;default:throw new TypeError(`Invalid referrerPolicy: ${n}`)}}function dr(e){let r=(e.get("referrer-policy")||"").split(/[,\s]+/),t="";for(let n of r)n&&cr.has(n)&&(t=n);return t}var p=Symbol("Request internals"),se=e=>typeof e=="object"&&typeof e[p]=="object",rt=deprecate(()=>{},".data is not a valid RequestInit property, use .body instead","https://github.com/node-fetch/node-fetch/issues/1000 (request)"),_=class e extends k{constructor(r,t={}){let n;if(se(r)?n=new URL(r.url):(n=new URL(r),r={}),n.username!==""||n.password!=="")throw new TypeError(`${n} is an url with embedded credentials.`);let o=t.method||r.method||"GET";if(/^(delete|get|head|options|post|put)$/i.test(o)&&(o=o.toUpperCase()),!se(t)&&"data"in t&&rt(),(t.body!=null||se(r)&&r.body!==null)&&(o==="GET"||o==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let s=t.body?t.body:se(r)&&r.body!==null?G(r):null;super(s,{size:t.size||r.size||0});let i=new R(t.headers||r.headers||{});if(s!==null&&!i.has("Content-Type")){let c=we(s,this);c&&i.set("Content-Type",c);}let a=se(r)?r.signal:null;if("signal"in t&&(a=t.signal),a!=null&&!qe(a))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let l=t.referrer==null?r.referrer:t.referrer;if(l==="")l="no-referrer";else if(l){let c=new URL(l);l=/^about:(\/\/)?client$/.test(c)?"client":c;}else l=void 0;this[p]={method:o,redirect:t.redirect||r.redirect||"follow",headers:i,parsedURL:n,signal:a,referrer:l},this.follow=t.follow===void 0?r.follow===void 0?20:r.follow:t.follow,this.compress=t.compress===void 0?r.compress===void 0?true:r.compress:t.compress,this.counter=t.counter||r.counter||0,this.agent=t.agent||r.agent,this.highWaterMark=t.highWaterMark||r.highWaterMark||16384,this.insecureHTTPParser=t.insecureHTTPParser||r.insecureHTTPParser||false,this.referrerPolicy=t.referrerPolicy||r.referrerPolicy||"";}get method(){return this[p].method}get url(){return format(this[p].parsedURL)}get headers(){return this[p].headers}get redirect(){return this[p].redirect}get signal(){return this[p].signal}get referrer(){if(this[p].referrer==="no-referrer")return "";if(this[p].referrer==="client")return "about:client";if(this[p].referrer)return this[p].referrer.toString()}get referrerPolicy(){return this[p].referrerPolicy}set referrerPolicy(r){this[p].referrerPolicy=fr(r);}clone(){return new e(this)}get[Symbol.toStringTag](){return "Request"}};Object.defineProperties(_.prototype,{method:{enumerable:true},url:{enumerable:true},headers:{enumerable:true},redirect:{enumerable:true},clone:{enumerable:true},signal:{enumerable:true},referrer:{enumerable:true},referrerPolicy:{enumerable:true}});var pr=e=>{let{parsedURL:r}=e[p],t=new R(e[p].headers);t.has("Accept")||t.set("Accept","*/*");let n=null;if(e.body===null&&/^(post|put)$/i.test(e.method)&&(n="0"),e.body!==null){let a=tr(e);typeof a=="number"&&!Number.isNaN(a)&&(n=String(a));}n&&t.set("Content-Length",n),e.referrerPolicy===""&&(e.referrerPolicy=lr),e.referrer&&e.referrer!=="no-referrer"?e[p].referrer=ur(e):e[p].referrer="no-referrer",e[p].referrer instanceof URL&&t.set("Referer",e.referrer),t.has("User-Agent")||t.set("User-Agent","node-fetch"),e.compress&&!t.has("Accept-Encoding")&&t.set("Accept-Encoding","gzip, deflate, br");let{agent:o}=e;typeof o=="function"&&(o=o(r));let s=ir(r),i={path:r.pathname+s,method:e.method,headers:t[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:e.insecureHTTPParser,agent:o};return {parsedURL:r,options:i}};var Ee=class extends U{constructor(r,t="aborted"){super(r,t);}};var nt=new Set(["data:","http:","https:"]);async function Ce(e,r){return new Promise((t,n)=>{let o=new _(e,r),{parsedURL:s,options:i}=pr(o);if(!nt.has(s.protocol))throw new TypeError(`node-fetch cannot load ${e}. URL scheme "${s.protocol.replace(/:$/,"")}" is not supported.`);if(s.protocol==="data:"){let f=Je(o.url),O=new C(f,{headers:{"Content-Type":f.typeFull}});t(O);return}let a=(s.protocol==="https:"?ot:be).request,{signal:l}=o,c=null,d=()=>{let f=new Ee("The operation was aborted.");n(f),o.body&&o.body instanceof A.Readable&&o.body.destroy(f),!(!c||!c.body)&&c.body.emit("error",f);};if(l&&l.aborted){d();return}let j=()=>{d(),N();},L=a(s.toString(),i);l&&l.addEventListener("abort",j);let N=()=>{L.abort(),l&&l.removeEventListener("abort",j);};L.on("error",f=>{n(new g(`request to ${o.url} failed, reason: ${f.message}`,"system",f)),N();}),st(L,f=>{c&&c.body&&c.body.destroy(f);}),process.version<"v14"&&L.on("socket",f=>{let O;f.prependListener("end",()=>{O=f._eventsCount;}),f.prependListener("close",m=>{if(c&&O<f._eventsCount&&!m){let F=new Error("Premature close");F.code="ERR_STREAM_PREMATURE_CLOSE",c.body.emit("error",F);}});}),L.on("response",f=>{L.setTimeout(0);let O=sr(f.rawHeaders);if(xe(f.statusCode)){let h=O.get("Location"),v=null;try{v=h===null?null:new URL(h,o.url);}catch{if(o.redirect!=="manual"){n(new g(`uri requested responds with an invalid redirect URL: ${h}`,"invalid-redirect")),N();return}}switch(o.redirect){case "error":n(new g(`uri requested responds with a redirect, redirect mode is set to error: ${o.url}`,"no-redirect")),N();return;case "manual":break;case "follow":{if(v===null)break;if(o.counter>=o.follow){n(new g(`maximum redirect reached at: ${o.url}`,"max-redirect")),N();return}let x={headers:new R(o.headers),follow:o.follow,counter:o.counter+1,agent:o.agent,compress:o.compress,method:o.method,body:G(o),signal:o.signal,size:o.size,referrer:o.referrer,referrerPolicy:o.referrerPolicy};if(!Qe(o.url,v)||!Xe(o.url,v))for(let Lr of ["authorization","www-authenticate","cookie","cookie2"])x.headers.delete(Lr);if(f.statusCode!==303&&o.body&&r.body instanceof A.Readable){n(new g("Cannot follow redirect with body being a readable stream","unsupported-redirect")),N();return}(f.statusCode===303||(f.statusCode===301||f.statusCode===302)&&o.method==="POST")&&(x.method="GET",x.body=void 0,x.headers.delete("content-length"));let Ne=dr(O);Ne&&(x.referrerPolicy=Ne),t(Ce(new _(v,x))),N();return}default:return n(new TypeError(`Redirect option '${o.redirect}' is not a valid value of RequestRedirect`))}}l&&f.once("end",()=>{l.removeEventListener("abort",j);});let m=pipeline(f,new PassThrough,h=>{h&&n(h);});process.version<"v12.10"&&f.on("aborted",j);let F={url:o.url,status:f.statusCode,statusText:f.statusMessage,headers:O,size:o.size,counter:o.counter,highWaterMark:o.highWaterMark},B=O.get("Content-Encoding");if(!o.compress||o.method==="HEAD"||B===null||f.statusCode===204||f.statusCode===304){c=new C(m,F),t(c);return}let kr={flush:K.Z_SYNC_FLUSH,finishFlush:K.Z_SYNC_FLUSH};if(B==="gzip"||B==="x-gzip"){m=pipeline(m,K.createGunzip(kr),h=>{h&&n(h);}),c=new C(m,F),t(c);return}if(B==="deflate"||B==="x-deflate"){let h=pipeline(f,new PassThrough,v=>{v&&n(v);});h.once("data",v=>{(v[0]&15)===8?m=pipeline(m,K.createInflate(),x=>{x&&n(x);}):m=pipeline(m,K.createInflateRaw(),x=>{x&&n(x);}),c=new C(m,F),t(c);}),h.once("end",()=>{c||(c=new C(m,F),t(c));});return}if(B==="br"){m=pipeline(m,K.createBrotliDecompress(),h=>{h&&n(h);}),c=new C(m,F),t(c);return}c=new C(m,F),t(c);}),or(L,o).catch(n);})}function st(e,r){let t=Buffer$1.from(`0\r
\r
`),n=false,o=false,s;e.on("response",i=>{let{headers:a}=i;n=a["transfer-encoding"]==="chunked"&&!a["content-length"];}),e.on("socket",i=>{let a=()=>{if(n&&!o){let c=new Error("Premature close");c.code="ERR_STREAM_PREMATURE_CLOSE",r(c);}},l=c=>{o=Buffer$1.compare(c.slice(-5),t)===0,!o&&s&&(o=Buffer$1.compare(s.slice(-3),t.slice(0,3))===0&&Buffer$1.compare(c.slice(-2),t.slice(3))===0),s=c;};i.prependListener("close",a),i.on("data",l),e.on("close",()=>{i.removeListener("close",a),i.removeListener("data",l);});});}var lt=process.env.https_proxy?new HttpsProxyAgent(process.env.https_proxy):void 0,$e=new Map;async function J(e,r={}){r={useCache:true,...r};try{return await Promise.all(e.map(async n=>{let o=Ze(n);if(r.useCache&&$e.has(o))return $e.get(o);let s=(async()=>{let i=We(o),a=await Ce(o,{agent:lt,headers:{...i}});if(!a.ok){let l;if(a.headers.get("content-type")?.includes("application/json")){let c=await a.json(),d=z$1.object({detail:z$1.string().optional(),title:z$1.string().optional(),message:z$1.string().optional(),error:z$1.string().optional()}).safeParse(c);d.success&&(l=d.data.detail||d.data.message,d.data.error&&(l=`[${d.data.error}] ${l}`));}throw a.status===401?new ce(o,l):a.status===404?new X(o,l):a.status===403?new le(o,l):new fe(o,a.status,l)}return a.json()})();return r.useCache&&$e.set(o,s),s}))}catch(t){throw t}}async function yr(e){try{let r=e;e.startsWith("~/")&&(r=Ae.join(homedir(),e.slice(2)));let t=Ae.resolve(r),n=await promises.readFile(t,"utf8"),o=JSON.parse(n);try{return g$1.parse(o)}catch(s){throw new I(e,s)}}catch(r){throw r instanceof Error&&(r.message.includes("ENOENT")||r.message.includes("no such file"))?new ee(e,r):r instanceof I?r:new ee(e,r)}}function ft(e,r){let t={},n=[...e];if(!r?.registries)return he({}),n;for(let o=0;o<n.length;o++){let s=M(n[o],r);s&&(n[o]=s.url,Object.keys(s.headers).length>0&&(t[s.url]=s.headers));}return he(t),n}async function Te(e,r,t={}){return await Promise.all(e.map(async o=>{if(ze(o))return yr(o);if(V(o)){let[a]=await J([o],t);try{return g$1.parse(a)}catch(l){throw new I(o,l)}}if(o.startsWith("@")&&r?.registries){let a=ft([o],r),[l]=await J(a,t);try{return g$1.parse(l)}catch(c){throw new I(o,c)}}let s=`styles/${r?.style??"aodesu"}/${o}.json`,[i]=await J([s],t);console.log("TEST - LLEGO AKI");try{return g$1.parse(i)}catch(a){throw new I(o,a)}}))}async function wr(e,r){let{config:t,useCache:n}=r||{};return Pe(),Te(e,W(t),{useCache:n})}async function Rr(e){e={useCache:true,...e};let r=`${re}/registries.json`,[t]=await J([r],{useCache:e.useCache});try{return u$1.parse(t)}catch(n){throw n instanceof b.ZodError?new de(n):n}}async function br(e=process.cwd()){try{let{config:r}=await import('@dotenvx/dotenvx'),t=[".env.local",".env.development.local",".env.development",".env"];for(let n of t){let o=join(e,n);existsSync(o)&&r({path:o,overload:!1,quiet:!0});}}catch(r){u.warn("Failed to load env files:",r);}}var Ue=".bak";function xr(e){if(!q.existsSync(e))return null;let r=`${e}${Ue}`;try{return q.renameSync(e,r),r}catch(t){return console.error(`Failed to create backup of ${e}: ${t}`),null}}function Er(e){let r=`${e}${Ue}`;if(!q.existsSync(r))return  false;try{return q.renameSync(r,e),!0}catch(t){return console.error(`Warning: Could not restore backup file ${r}: ${t}`),false}}function Sr(e){let r=`${e}${Ue}`;if(!q.existsSync(r))return  false;try{return q.unlinkSync(r),!0}catch{return  false}}async function Cr(e,r){let t=new Set,n=new Set,o=[...e];for(;o.length>0;){let s=o.shift();if(n.has(s))continue;n.add(s);let{registry:i}=z(s);i&&!E[i]&&t.add(i);try{let[a]=await Te([s],r,{useCache:!0});if(a?.registryDependencies)for(let l of a.registryDependencies){let{registry:c}=z(l);c&&!E[c]&&t.add(c),n.has(l)||o.push(l);}}catch(a){if(a instanceof H){let{registry:l}=z(s);l&&!E[l]&&t.add(l);continue}continue}}return Array.from(t)}function Tr(e,r){return mt({text:e,isSilent:r?.silent})}async function vr(e,r,t={}){t={silent:false,writeFile:true,...t};let o=(await Cr(e,r)).filter(c=>!r.registries?.[c]&&!Object.keys(E).includes(c));if(o.length===0)return {config:r,newRegistries:[]};let s=await Rr({useCache:process.env.NODE_ENV!=="development"});if(!s)return {config:r,newRegistries:[]};let i={};for(let c of o)s[c]&&(i[c]=s[c]);if(Object.keys(i).length===0)return {config:r,newRegistries:[]};let a=Object.fromEntries(Object.entries(r.registries||{}).filter(([c])=>!Object.keys(E).includes(c))),l={...r,registries:{...a,...i}};if(t.writeFile){let{resolvedPaths:c,...d}=l,j=Tr("Updating components.json.",{silent:t.silent}).start(),L=p$1.parse(d);await q.writeFile(Ae.resolve(r.resolvedPaths.cwd,"components.json"),JSON.stringify(L,null,2)+`
`,"utf-8"),j.succeed();}return {config:l,newRegistries:Object.keys(i)}}process.on("exit",e=>{let r=Ae.resolve(process.cwd(),"components.json");return e===0?Sr(r):Er(r)});var wt=b.object({cwd:b.string(),components:b.array(b.string()).optional(),yes:b.boolean(),defaults:b.boolean(),force:b.boolean(),silent:b.boolean(),isNewProject:b.boolean(),srcDir:b.boolean().optional(),cssVariables:b.boolean(),baseColor:b.string().optional(),baseStyle:b.boolean()}),Pr=new Command().name("init").description("initialize your project and install dependencies").argument("[components...]","names, url or local path to component").option("-b, --base-color <base-color>","The base color to use. (neutral)",void 0).option("-y, --yes","Skip de confirmation prompt",true).option("-d, --defaults","Use default configuration.",false).option("-f, --force","Force overwrite of existing configuration",false).option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).option("-s, --silent","Mute output",false).option("--src-dir","Use the src directory when creating a new project.",false).option("--no-src-dir","Do not use the src directory when creating a new project.").option("--css-variables","Use css variables for theming.",true).option("--no-base-style","Do not install the base aodesu style.").action(async(e,r)=>{try{r.defaults&&(r.template=r.template||"next",r.baseColor=r.baseColor||"neutral");let t=wt.parse({cwd:Ae.resolve(r.cwd),isNewProject:!1,components:e,...r});if(await br(t.cwd),e.length>0){let n=W({}),o=Ae.resolve(t.cwd,"components.json");if(q.existsSync(o)){let a=await q.readJson(o),l=p$1.partial().parse(a);n=W(l),xr(o);}let{config:s}=await vr(e,n,{silent:!0});n=s,M(e[0],n);let[i]=await wr([e[0]],{config:n});console.log("TEST - LLEGO AKI"),i?.type=="registry:style"&&(t.baseColor="neutral",t.baseStyle=i.extends==="none"?!1:t.baseStyle);}t.baseStyle||(t.baseColor="neutral"),await Rt(t),u.log(`${$.success("Success!")} Project initialization completed. 
You may now add components.`);}catch(t){u.break(),Ie(t);}finally{}});async function Rt(e){e.skipPreflight||console.log("SKIP PREFLIGHT");}process.on("SIGNINT",()=>process.exit(0));process.on("SIGTERM",()=>process.exit(0));async function xt(){let e=new Command().name("uidesu").description("add items from registry to your project").version(De.version,"-v, --version","display the version number");e.addCommand(Pr),e.parse();}xt();//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map