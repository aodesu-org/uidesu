{"version":3,"sources":["../package.json","../src/registry/errors.ts","../src/utils/highlighter.ts","../src/utils/logger.ts","../src/utils/handle-error.ts","../src/registry/constants.ts","../src/registry/env.ts","../src/registry/parser.ts","../src/registry/utils.ts","../src/utils/get-config.ts","../src/registry/config.ts","../src/registry/context.ts","../src/registry/validator.ts","../src/registry/builder.ts","../../../node_modules/.pnpm/data-uri-to-buffer@4.0.1/node_modules/data-uri-to-buffer/src/index.ts","../../../node_modules/.pnpm/node-fetch@3.3.2/node_modules/node-fetch/src/errors/base.js","../../../node_modules/.pnpm/node-fetch@3.3.2/node_modules/node-fetch/src/errors/fetch-error.js","../../../node_modules/.pnpm/node-fetch@3.3.2/node_modules/node-fetch/src/utils/is.js","../../../node_modules/.pnpm/node-fetch@3.3.2/node_modules/node-fetch/src/body.js","../../../node_modules/.pnpm/node-fetch@3.3.2/node_modules/node-fetch/src/headers.js","../../../node_modules/.pnpm/node-fetch@3.3.2/node_modules/node-fetch/src/utils/is-redirect.js","../../../node_modules/.pnpm/node-fetch@3.3.2/node_modules/node-fetch/src/response.js","../../../node_modules/.pnpm/node-fetch@3.3.2/node_modules/node-fetch/src/utils/get-search.js","../../../node_modules/.pnpm/node-fetch@3.3.2/node_modules/node-fetch/src/utils/referrer.js","../../../node_modules/.pnpm/node-fetch@3.3.2/node_modules/node-fetch/src/request.js","../../../node_modules/.pnpm/node-fetch@3.3.2/node_modules/node-fetch/src/errors/abort-error.js","../../../node_modules/.pnpm/node-fetch@3.3.2/node_modules/node-fetch/src/index.js","../src/registry/fetcher.ts","../src/registry/resolver.ts","../src/registry/api.ts","../src/utils/env-loader.ts","../src/utils/file-helper.ts","../src/registry/namespaces.ts","../src/utils/spinner.ts","../src/utils/registries.ts","../src/commands/init.ts","../src/index.ts"],"names":["package_default","RegistryErrorCode","RegistryError","message","options","RegistryNotFoundError","url","cause","RegistryUnauthorizedError","RegistryForbiddenError","RegistryFetchError","statusCode","responseBody","baseMessage","suggestion","RegistryNotConfiguredError","registryName","RegistryLocalFileError","filePath","RegistryParseError","item","parseError","z","e","RegistryMissingEnvironmentVariablesError","missingVars","v","RegistriesIndexParseError","invalidNamespaces","i","arr","highlighter","red","yellow","cyan","green","logger","args","handleError","error","key","value","REGISTRY_URL","FALLBACK_STYLE","BUILTIN_REGISTRIES","expandEnvVars","_match","extractEnvVars","vars","regex","match","REGISTRY_PATTERN","parseRegistryAndItemFromString","name","isUrl","path","isLocalFile","createConfig","partial","defaultConfig","resolveStyleFromConfig","config","configWithDefaults","baseConfig","configSchema","deepmerge","context","setRegistryHeaders","headers","getRegistryHeadersFromContext","clearRegistryContext","extractEnvVarsFromRegistryConfig","validateRegistryConfig","missing","NAME_PLACEHOLDER","STYLE_PLACEHOLDER","ENV_VAR_PATTER","QUERY_PARAM_SEPARATOR","QUERY_PARAM_DELIMITER","buildUrlAndHeadersForRegistryItem","registry","registryConfig","buildUrlFromRegistryConfig","buildHeadersFromRegistryConfig","baseUrl","appendQueryParams","expandedValue","shouldIncludeHeader","params","urlParams","queryString","separator","originalValue","trimmedExpanded","templateWithoutVars","resolveRegistryUrl","pathOrUrl","dataUriToBuffer","uri","firstComma","meta","charset","base64","type","typeFull","encoding","data","buffer","dist_default","FetchBaseError","FetchError","systemError","NAME","isURLSearchParameters","object","isBlob","isAbortSignal","isDomainOrSubdomain","destination","original","orig","dest","isSameProtocol","pipeline","promisify","Stream","INTERNALS","Body","body","size","boundary","Buffer","types","FormData","formDataToBlob","stream","error_","byteOffset","byteLength","consumeBody","ct","formData","parameters","toFormData","buf","fetch_blob_default","text","deprecate","accum","accumBytes","chunk","c","clone","instance","highWaterMark","p1","p2","PassThrough","getNonSpecFormDataBoundary","extractContentType","request","getTotalBytes","writeToStream","validateHeaderName","http","validateHeaderValue","Headers","_Headers","init","result","raw","values","method","pair","target","p","receiver","callback","thisArg","property","fromRawHeaders","index","array","redirectStatus","isRedirect","code","Response","_Response","status","contentType","response","getSearch","parsedURL","lastOffset","hash","stripURLForUseAsAReferrer","originOnly","ReferrerPolicy","DEFAULT_REFERRER_POLICY","validateReferrerPolicy","referrerPolicy","isOriginPotentiallyTrustworthy","hostIp","hostIPVersion","isIP","isUrlPotentiallyTrustworthy","determineRequestsReferrer","referrerURLCallback","referrerOriginCallback","policy","referrerSource","referrerURL","referrerOrigin","currentURL","parseReferrerPolicyFromHeader","policyTokens","token","isRequest","doBadDataWarn","Request","_Request","input","inputBody","signal","referrer","parsedReferrer","formatUrl","getNodeRequestOptions","contentLengthValue","totalBytes","agent","search","AbortError","supportedSchemas","fetch","options_","resolve","reject","send","https","abort","abortAndFinalize","finalize","request_","fixResponseChunkedTransferBadEnding","s","endedWithEventsCount","hadError","response_","location","locationURL","requestOptions","responseReferrerPolicy","pump","responseOptions","codings","zlibOptions","zlib","errorCallback","LAST_CHUNK","isChunkedTransfer","properLastChunkReceived","previousChunk","socket","onSocketClose","onData","HttpsProxyAgent","registryCache","fetchRegistry","paths","fetchPromise","messageFromServer","json","parsed","fetchRegistryLocal","expandedPath","homedir","resolvedPath","content","fs","registryItemSchema","resolveRegistryItemsFromRegistries","items","registryHeaders","resolvedItems","resolved","fetchRegistryItems","getRegistryItems","useCache","getRegistriesIndex","registriesIndexSchema","loadEnvFiles","cwd","envFiles","envFile","envPath","join","existsSync","FILE_BACKUP_SUFFIX","createFileBackup","fsExtra","backupPath","restoreFileBackup","deleteFileBackup","resolveRegistryNamespaces","components","discoveredNamespaces","visitedItems","itemsToProcess","currentItem","dep","depRegistry","spinner","ora","ensureRegistriesInConfig","missingRegistries","registryIndex","foundRegistries","existingRegistries","newConfigWithRegistries","resolvedPaths","configWithoutResolvedPaths","configSpinner","updatedConfig","rawConfigSchema","initOptionsSchema","Command","opts","shadowConfig","componentsJsonPath","existingConfig","runInit","main","program"],"mappings":"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","file":"index.js","sourcesContent":["{\r\n  \"name\": \"uidesu\",\r\n  \"version\": \"1.0.0\",\r\n  \"description\": \"Add components to your apps.\",\r\n  \"publishConfig\": {\r\n    \"access\": \"public\"\r\n  },\r\n  \"license\": \"MIT\",\r\n  \"author\": {\r\n    \"name\": \"sergiocortes-dll\",\r\n    \"url\": \"https://twitter.com/sergiocortes-dll\"\r\n  },\r\n  \"repository\": {\r\n    \"type\": \"git\",\r\n    \"url\": \"https://github.com/aodesu/ui-cli.git\",\r\n    \"directory\": \"packages/shadcn\"\r\n  },\r\n  \"files\": [\r\n    \"dist\"\r\n  ],\r\n  \"keywords\": [\r\n    \"components\",\r\n    \"ui\",\r\n    \"tailwind\",\r\n    \"radix-ui\",\r\n    \"uidesu\"\r\n  ],\r\n  \"type\": \"module\",\r\n  \"exports\": {\r\n    \".\": {\r\n      \"types\": \"./dist/index.d.ts\",\r\n      \"default\": \"./dist/index.js\"\r\n    }\r\n  },\r\n  \"bin\": \"./dist/index.js\",\r\n  \"scripts\": {\r\n    \"dev\": \"tsup --watch\",\r\n    \"start:dev\": \"cross-env REGISTRY_URL=https://localhost:4000/r node dist/index.js\"\r\n  },\r\n  \"dependencies\": {\r\n    \"@dotenvx/dotenvx\": \"^1.48.4\",\r\n    \"commander\": \"^14.0.0\",\r\n    \"deepmerge\": \"^4.3.1\",\r\n    \"fs-extra\": \"^11.3.1\",\r\n    \"https-proxy-agent\": \"^7.0.6\",\r\n    \"kleur\": \"^4.1.5\",\r\n    \"node-fetch\": \"^3.3.2\",\r\n    \"ora\": \"^8.2.0\",\r\n    \"zod\": \"^3.24.1\",\r\n    \"zod-to-json-schema\": \"3.24.6\"\r\n  },\r\n  \"devDependencies\": {\r\n    \"@types/babel__core\": \"^7.20.5\",\r\n    \"@types/fs-extra\": \"^11.0.4\",\r\n    \"@types/prompts\": \"^2.4.9\",\r\n    \"@types/stringify-object\": \"^4.0.5\",\r\n    \"rimraf\": \"^6.0.1\",\r\n    \"tsup\": \"^8.5.0\",\r\n    \"type-fest\": \"^4.41.0\",\r\n    \"typescript\": \"^5.9.2\"\r\n  }\r\n}\r\n","import { z } from \"zod\"\r\n\r\n// Error codes for programmatic error handling\r\nexport const RegistryErrorCode = {\r\n  // Network errors\r\n  NETWORK_ERROR: \"NETWORK_ERROR\",\r\n  NOT_FOUND: \"NOT_FOUND\",\r\n  UNAUTHORIZED: \"UNAUTHORIZED\",\r\n  FORBIDDEN: \"FORBIDDEN\",\r\n  FETCH_ERROR: \"FETCH_ERROR\",\r\n\r\n  // Configuration errors\r\n  NOT_CONFIGURED: \"NOT_CONFIGURED\",\r\n  INVALID_CONFIG: \"INVALID_CONFIG\",\r\n  MISSING_ENV_VARS: \"MISSING_ENV_VARS\",\r\n\r\n  // File system errors\r\n  LOCAL_FILE_ERROR: \"LOCAL_FILE_ERROR\",\r\n\r\n  // Parsing errors\r\n  PARSE_ERROR: \"PARSE_ERROR\",\r\n  VALIDATION_ERROR: \"VALIDATION_ERROR\",\r\n\r\n  // Generic errors\r\n  UNKNOWN_ERROR: \"UNKNOWN_ERROR\",\r\n} as const\r\n\r\nexport type RegistryErrorCode =\r\n  (typeof RegistryErrorCode)[keyof typeof RegistryErrorCode]\r\n\r\nexport class RegistryError extends Error {\r\n  public readonly code: RegistryErrorCode\r\n  public readonly statusCode?: number\r\n  public readonly context?: Record<string, unknown>\r\n  public readonly suggestion?: string\r\n  public readonly timestamp: Date\r\n  public readonly cause?: unknown\r\n\r\n  constructor(\r\n    message: string,\r\n    options: {\r\n      code?: RegistryErrorCode\r\n      statusCode?: number\r\n      cause?: unknown\r\n      context?: Record<string, unknown>\r\n      suggestion?: string\r\n    } = {}\r\n  ) {\r\n    super(message)\r\n    this.name = \"RegistryError\"\r\n    this.code = options.code || RegistryErrorCode.UNKNOWN_ERROR\r\n    this.statusCode = options.statusCode\r\n    this.cause = options.cause\r\n    this.context = options.context\r\n    this.suggestion = options.suggestion\r\n    this.timestamp = new Date()\r\n\r\n    if (Error.captureStackTrace) {\r\n      Error.captureStackTrace(this, this.constructor)\r\n    }\r\n  }\r\n\r\n  toJSON() {\r\n    return {\r\n      name: this.name,\r\n      message: this.message,\r\n      code: this.code,\r\n      statusCode: this.statusCode,\r\n      context: this.context,\r\n      suggestion: this.suggestion,\r\n      timestamp: this.timestamp,\r\n      stack: this.stack,\r\n    }\r\n  }\r\n}\r\n\r\nexport class RegistryNotFoundError extends RegistryError {\r\n  constructor(public readonly url: string, cause?: unknown) {\r\n    const message = `The item at ${url} was not found. It may not exist at the registry.`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.NOT_FOUND,\r\n      statusCode: 404,\r\n      cause,\r\n      context: { url },\r\n      suggestion:\r\n        \"Check if the item name is correct and the registry URL is accessible.\",\r\n    })\r\n    this.name = \"RegistryNotFoundError\"\r\n  }\r\n}\r\n\r\nexport class RegistryUnauthorizedError extends RegistryError {\r\n  constructor(public readonly url: string, cause?: unknown) {\r\n    const message = `You are not authorized to access the item at ${url}. If this is a remote registry, you may need to authenticate.`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.UNAUTHORIZED,\r\n      statusCode: 401,\r\n      cause,\r\n      context: { url },\r\n      suggestion:\r\n        \"Check your authentication credentials and environment variables.\",\r\n    })\r\n    this.name = \"RegistryUnauthorizedError\"\r\n  }\r\n}\r\n\r\nexport class RegistryForbiddenError extends RegistryError {\r\n  constructor(public readonly url: string, cause?: unknown) {\r\n    const message = `You are not authorized to access the item at ${url}. If this is a remote registry, you may need to authenticate.`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.FORBIDDEN,\r\n      statusCode: 403,\r\n      cause,\r\n      context: { url },\r\n      suggestion:\r\n        \"Check your authentication credentials and environment variables.\",\r\n    })\r\n    this.name = \"RegistryForbiddenError\"\r\n  }\r\n}\r\n\r\nexport class RegistryFetchError extends RegistryError {\r\n  constructor(\r\n    public readonly url: string,\r\n    statusCode?: number,\r\n    public readonly responseBody?: string,\r\n    cause?: unknown\r\n  ) {\r\n    // Use the error detail from the server if available\r\n    const baseMessage = statusCode\r\n      ? `Failed to fetch from registry (${statusCode}): ${url}`\r\n      : `Failed to fetch from registry: ${url}`\r\n\r\n    const message =\r\n      typeof cause === \"string\" && cause\r\n        ? `${baseMessage} - ${cause}`\r\n        : baseMessage\r\n\r\n    let suggestion = \"Check your network connection and try again.\"\r\n    if (statusCode === 404) {\r\n      suggestion =\r\n        \"The requested resource was not found. Check the URL or item name.\"\r\n    } else if (statusCode === 500) {\r\n      suggestion = \"The registry server encountered an error. Try again later.\"\r\n    } else if (statusCode && statusCode >= 400 && statusCode < 500) {\r\n      suggestion = \"There was a client error. Check your request parameters.\"\r\n    }\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.FETCH_ERROR,\r\n      statusCode,\r\n      cause,\r\n      context: { url, responseBody },\r\n      suggestion,\r\n    })\r\n    this.name = \"RegistryFetchError\"\r\n  }\r\n}\r\n\r\nexport class RegistryNotConfiguredError extends RegistryError {\r\n  constructor(public readonly registryName: string | null) {\r\n    const message = registryName\r\n      ? `Unknown registry \"${registryName}\". Make sure it is defined in components.json as follows:\r\n{\r\n  \"registries\": {\r\n    \"${registryName}\": \"[URL_TO_REGISTRY]\"\r\n  }\r\n}`\r\n      : `Unknown registry. Make sure it is defined in components.json under \"registries\".`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.NOT_CONFIGURED,\r\n      context: { registryName },\r\n      suggestion:\r\n        \"Add the registry configuration to your components.json file. Consult the registry documentation for the correct format.\",\r\n    })\r\n    this.name = \"RegistryNotConfiguredError\"\r\n  }\r\n}\r\n\r\nexport class RegistryLocalFileError extends RegistryError {\r\n  constructor(public readonly filePath: string, cause?: unknown) {\r\n    super(`Failed to read local registry file: ${filePath}`, {\r\n      code: RegistryErrorCode.LOCAL_FILE_ERROR,\r\n      cause,\r\n      context: { filePath },\r\n      suggestion: \"Check if the file exists and you have read permissions.\",\r\n    })\r\n    this.name = \"RegistryLocalFileError\"\r\n  }\r\n}\r\n\r\nexport class RegistryParseError extends RegistryError {\r\n  public readonly parseError: unknown\r\n\r\n  constructor(public readonly item: string, parseError: unknown) {\r\n    let message = `Failed to parse registry item: ${item}`\r\n\r\n    if (parseError instanceof z.ZodError) {\r\n      message = `Failed to parse registry item: ${item}\\n${parseError.errors\r\n        .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\r\n        .join(\"\\n\")}`\r\n    }\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.PARSE_ERROR,\r\n      cause: parseError,\r\n      context: { item },\r\n      suggestion:\r\n        \"The registry item may be corrupted or have an invalid format. Please make sure it returns a valid JSON object. See https://ui.shadcn.com/schema/registry-item.json.\",\r\n    })\r\n\r\n    this.parseError = parseError\r\n    this.name = \"RegistryParseError\"\r\n  }\r\n}\r\n\r\nexport class RegistryMissingEnvironmentVariablesError extends RegistryError {\r\n  constructor(\r\n    public readonly registryName: string,\r\n    public readonly missingVars: string[]\r\n  ) {\r\n    const message =\r\n      `Registry \"${registryName}\" requires the following environment variables:\\n\\n` +\r\n      missingVars.map((v) => `   ${v}`).join(\"\\n\")\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.MISSING_ENV_VARS,\r\n      context: { registryName, missingVars },\r\n      suggestion:\r\n        \"Set the required environment variables to your .env or .env.local file.\",\r\n    })\r\n    this.name = \"RegistryMissingEnvironmentVariablesError\"\r\n  }\r\n}\r\n\r\nexport class RegistryInvalidNamespaceError extends RegistryError {\r\n  constructor(public readonly name: string) {\r\n    const message = `Invalid registry namespace: \"${name}\". Registry names must start with @ (e.g., @shadcn, @v0).`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.VALIDATION_ERROR,\r\n      context: { name },\r\n      suggestion:\r\n        \"Use a valid registry name starting with @ or provide a direct URL to the registry.\",\r\n    })\r\n    this.name = \"RegistryInvalidNamespaceError\"\r\n  }\r\n}\r\n\r\nexport class ConfigMissingError extends RegistryError {\r\n  constructor(public readonly cwd: string) {\r\n    const message = `No components.json found in ${cwd} or parent directories.`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.NOT_CONFIGURED,\r\n      context: { cwd },\r\n      suggestion:\r\n        \"Run 'npx shadcn@latest init' to create a components.json file, or check that you're in the correct directory.\",\r\n    })\r\n    this.name = \"ConfigMissingError\"\r\n  }\r\n}\r\n\r\nexport class ConfigParseError extends RegistryError {\r\n  constructor(public readonly cwd: string, parseError: unknown) {\r\n    let message = `Invalid components.json configuration in ${cwd}.`\r\n\r\n    if (parseError instanceof z.ZodError) {\r\n      message = `Invalid components.json configuration in ${cwd}:\\n${parseError.errors\r\n        .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\r\n        .join(\"\\n\")}`\r\n    }\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.INVALID_CONFIG,\r\n      cause: parseError,\r\n      context: { cwd },\r\n      suggestion:\r\n        \"Check your components.json file for syntax errors or invalid configuration. Run 'npx shadcn@latest init' to regenerate a valid configuration.\",\r\n    })\r\n    this.name = \"ConfigParseError\"\r\n  }\r\n}\r\n\r\nexport class RegistriesIndexParseError extends RegistryError {\r\n  public readonly parseError: unknown\r\n\r\n  constructor(parseError: unknown) {\r\n    let message = \"Failed to parse registries index\"\r\n\r\n    if (parseError instanceof z.ZodError) {\r\n      const invalidNamespaces = parseError.errors\r\n        .filter((e) => e.path.length > 0)\r\n        .map((e) => `\"${e.path[0]}\"`)\r\n        .filter((v, i, arr) => arr.indexOf(v) === i) // remove duplicates\r\n\r\n      if (invalidNamespaces.length > 0) {\r\n        message = `Failed to parse registries index. Invalid registry namespace(s): ${invalidNamespaces.join(\r\n          \", \"\r\n        )}\\n${parseError.errors\r\n          .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\r\n          .join(\"\\n\")}`\r\n      } else {\r\n        message = `Failed to parse registries index:\\n${parseError.errors\r\n          .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\r\n          .join(\"\\n\")}`\r\n      }\r\n    }\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.PARSE_ERROR,\r\n      cause: parseError,\r\n      context: { parseError },\r\n      suggestion:\r\n        \"The registries index may be corrupted or have invalid registry namespace format. Registry names must start with @ (e.g., @shadcn, @example).\",\r\n    })\r\n\r\n    this.parseError = parseError\r\n    this.name = \"RegistriesIndexParseError\"\r\n  }\r\n}\r\n","import { cyan, green, red, yellow } from \"kleur/colors\";\r\n\r\nexport const highlighter = {\r\n  error: red,\r\n  warn: yellow,\r\n  info: cyan,\r\n  success: green,\r\n};\r\n","import { highlighter } from \"./highlighter\";\r\n\r\nexport const logger = {\r\n  error(...args: unknown[]) {\r\n    console.log(highlighter.error(args.join(\" \")))\r\n  },\r\n  warn(...args: unknown[]) {\r\n    console.log(highlighter.warn(args.join(\" \")))\r\n  },\r\n  info(...args: unknown[]) {\r\n    console.log(highlighter.info(args.join(\" \")))\r\n  },\r\n  success(...args: unknown[]) {\r\n    console.log(highlighter.success(args.join(\" \")))\r\n  },\r\n  log(...args: unknown[]) {\r\n    console.log(args.join(\" \"))\r\n  },\r\n  break() {\r\n    console.log(\"\")\r\n  },\r\n};\r\n","import z from \"zod\";\r\nimport { RegistryError } from \"../registry/errors\";\r\nimport { highlighter } from \"./highlighter\";\r\nimport { logger } from \"./logger\";\r\n\r\nexport function handleError(error: unknown) {\r\n  logger.break();\r\n  logger.error(\"Something went wrong. Please check the error below for more details.\");\r\n  logger.error(\"If the problem persist, please open an issue on GitHub.\");\r\n  logger.error(\"\");\r\n\r\n  if (typeof error === \"string\") {\r\n    logger.error(error);\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  if (error instanceof RegistryError) {\r\n    if (error.message) {\r\n      logger.error(error.cause ? \"Error\" : \"Message:\");\r\n      logger.error(error.message);\r\n    }\r\n\r\n    if (error.cause) {\r\n      logger.error(\"\\nMessage:\");\r\n      logger.error(error.cause);\r\n    }\r\n\r\n    if (error.suggestion) {\r\n      logger.error(\"\\nSuggestion:\");\r\n      logger.error(error.suggestion);\r\n    }\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  if (error instanceof z.ZodError) {\r\n    logger.error(\"Validation failed:\");\r\n    for (const [key, value] of Object.entries(error.flatten().fieldErrors)) {\r\n      logger.error(`- ${highlighter.info(key)}: ${value}`);\r\n    }\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  if (error instanceof Error) {\r\n    logger.error(error.message);\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  logger.break();\r\n  process.exit(1);\r\n}\r\n","import z from \"zod\";\r\nimport { registryConfigSchema } from \"./schema\";\r\n\r\nexport const REGISTRY_URL =\r\n  process.env.REGISTRY_URL ?? \"https://ui.aodesu.com/r\";\r\n\r\nexport const FALLBACK_STYLE = \"aodesu\";\r\n\r\nexport const BUILTIN_REGISTRIES: z.infer<typeof registryConfigSchema> = {\r\n  \"@uidesu\": `${REGISTRY_URL}/styles/{style}/{name}.json`,\r\n}\r\n","export function expandEnvVars(value: string) {\r\n  return value.replace(/\\${(\\w+)}/g, (_match, key) => process.env[key] || \"\")\r\n}\r\n\r\nexport function extractEnvVars(value: string) {\r\n  const vars: string[] = []\r\n  const regex = /\\${(\\w+)}/g\r\n  let match: RegExpExecArray | null\r\n\r\n  while ((match = regex.exec(value)) !== null) {\r\n    vars.push(match[1])\r\n  }\r\n\r\n  return vars\r\n}\r\n","// Valid registry name pattern: @namespace where namespace is alphanumeric with hyphens/underscores\r\nconst REGISTRY_PATTERN = /^(@[a-zA-Z0-9](?:[a-zA-Z0-9-_]*[a-zA-Z0-9])?)\\/(.+)$/\r\n\r\nexport function parseRegistryAndItemFromString(name: string) {\r\n  if (!name.startsWith(\"@\")) {\r\n    return {\r\n      registry: null,\r\n      item: name,\r\n    }\r\n  }\r\n\r\n  const match = name.match(REGISTRY_PATTERN)\r\n  if (match) {\r\n    return {\r\n      registry: match[1],\r\n      item: match[2],\r\n    }\r\n  }\r\n\r\n  return {\r\n    registry: null,\r\n    item: name,\r\n  }\r\n}\r\n","export function isUrl(path: string) {\r\n  try {\r\n    new URL(path);\r\n    return true;\r\n  } catch (error) {\r\n    return false;\r\n  }\r\n}\r\n\r\nexport function isLocalFile(path: string) {\r\n  return path.endsWith(\".json\") && !isUrl(path);\r\n}\r\n","import z from \"zod\";\r\nimport { BUILTIN_REGISTRIES } from \"../registry/constants\";\r\nimport { configSchema } from \"../schema\";\r\n\r\nexport type Config = z.infer<typeof configSchema>\r\n\r\ntype DeepPartial<T> = {\r\n  [P in keyof T]?: T[P] extends object ? DeepPartial<T[P]> : T[P]\r\n}\r\n\r\nexport function createConfig(partial?: DeepPartial<Config>): Config {\r\n  const defaultConfig: Config = {\r\n    resolvedPaths: {\r\n      cwd: process.cwd(),\r\n      tailwindConfig: \"\",\r\n      tailwindCss: \"\",\r\n      utils: \"\",\r\n      components: \"\",\r\n      ui: \"\",\r\n      lib: \"\",\r\n      hooks: \"\",\r\n    },\r\n    style: \"\",\r\n    tailwind: {\r\n      config: \"\",\r\n      css: \"\",\r\n      baseColor: \"\",\r\n      cssVariables: false,\r\n    },\r\n    rsc: false,\r\n    tsx: true,\r\n    aliases: {\r\n      components: \"\",\r\n      utils: \"\",\r\n    },\r\n    registries: {\r\n      ...BUILTIN_REGISTRIES,\r\n    },\r\n  }\r\n\r\n  // Deep merge the partial config with defaults\r\n  if (partial) {\r\n    return {\r\n      ...defaultConfig,\r\n      ...partial,\r\n      resolvedPaths: {\r\n        ...defaultConfig.resolvedPaths,\r\n        ...(partial.resolvedPaths|| {}),\r\n      },\r\n      tailwind: {\r\n        ...defaultConfig.tailwind,\r\n        ...(partial.tailwind || {}),\r\n      },\r\n      aliases: {\r\n        ...defaultConfig.aliases,\r\n        ...(partial.aliases || {}),\r\n      },\r\n      registries: {\r\n        ...defaultConfig.registries,\r\n        ...(partial.registries || {}),\r\n      },\r\n    }\r\n  }\r\n\r\n  return defaultConfig;\r\n}\r\n","import deepmerge from \"deepmerge\";\r\nimport { Config, createConfig } from \"../utils/get-config\";\r\nimport { BUILTIN_REGISTRIES, FALLBACK_STYLE } from \"./constants\";\r\nimport { configSchema } from \"./schema\";\r\n\r\nfunction resolveStyleFromConfig(config: Partial<Config> | Config) {\r\n  if (!config.style) {\r\n    return FALLBACK_STYLE;\r\n  }\r\n\r\n  // Check if we should use aodesu for tailwind\r\n  // We assume that if tailwind.config is empty, we're using tailwind v4.\r\n  if (config.style === \"aodesu\" && config.tailwind?.config === \"\") {\r\n    return FALLBACK_STYLE;\r\n  }\r\n\r\n  return config.style;\r\n}\r\n\r\nexport function configWithDefaults(config?: Partial<Config> | Config) {\r\n  const baseConfig = createConfig({\r\n    style: FALLBACK_STYLE,\r\n    registries: BUILTIN_REGISTRIES,\r\n  });\r\n\r\n  if (!config) {\r\n    return baseConfig;\r\n  }\r\n\r\n  return configSchema.parse(\r\n    deepmerge(baseConfig, {\r\n      ...config,\r\n      style: resolveStyleFromConfig(config),\r\n      registries: { ...BUILTIN_REGISTRIES, ...config.registries },\r\n    })\r\n  )\r\n};\r\n","interface RegistryContext {\r\n  headers: Record<string, Record<string, string>>\r\n}\r\n\r\nlet context: RegistryContext = {\r\n  headers: {},\r\n}\r\n\r\nexport function setRegistryHeaders(\r\n  headers: Record<string, Record<string, string>>\r\n) {\r\n  // Merge new headers with existing ones to preserve headers for nested dependencies\r\n  context.headers = { ...context.headers, ...headers };\r\n}\r\n\r\nexport function getRegistryHeadersFromContext(\r\n  url: string\r\n): Record<string, string> {\r\n  return context.headers[url] || {}\r\n};\r\n\r\nexport function clearRegistryContext() {\r\n  context.headers = {};\r\n}\r\n","import z from \"zod\";\r\nimport { Config } from \"../utils/get-config\";\r\nimport { buildUrlAndHeadersForRegistryItem } from \"./builder\";\r\nimport { configWithDefaults } from \"./config\";\r\nimport { clearRegistryContext } from \"./context\";\r\nimport { extractEnvVars } from \"./env\";\r\nimport { RegistryMissingEnvironmentVariablesError } from \"./errors\";\r\nimport { registryConfigItemSchema } from \"./schema\";\r\n\r\nexport function extractEnvVarsFromRegistryConfig(\r\n  config: z.infer<typeof registryConfigItemSchema>\r\n): string[] {\r\n  const vars = new Set<string>();\r\n\r\n  if (typeof config === \"string\") {\r\n    extractEnvVars(config).forEach((v) => vars.add(v));\r\n  } else {\r\n    extractEnvVars(config.url).forEach((v) => vars.add(v));\r\n\r\n    if (config.params) {\r\n      Object.values(config.params).forEach((value) => {\r\n        extractEnvVars(value).forEach((v) => vars.add(v));\r\n      })\r\n    }\r\n\r\n    if (config.headers) {\r\n      Object.values(config.headers).forEach((value) => {\r\n        extractEnvVars(value).forEach((v) => vars.add(v));\r\n      })\r\n    }\r\n  }\r\n\r\n  return Array.from(vars);\r\n}\r\n\r\nexport function validateRegistryConfig(\r\n  registryName: string,\r\n  config: z.infer<typeof registryConfigItemSchema>\r\n): void {\r\n  const requiredVars = extractEnvVarsFromRegistryConfig(config);\r\n  const missing = requiredVars.filter((v) => !process.env[v]);\r\n\r\n  if (missing.length > 0) {\r\n    throw new RegistryMissingEnvironmentVariablesError(registryName, missing);\r\n  }\r\n}\r\n\r\nexport function validateRegistryConfigForItems(\r\n  items: string[],\r\n  config?: Config\r\n): void {\r\n  for (const item of items) {\r\n    buildUrlAndHeadersForRegistryItem(item, configWithDefaults(config));\r\n  }\r\n\r\n  // Clear registry context after validation.\r\n  clearRegistryContext();\r\n}\r\n","import z from \"zod\";\r\nimport { Config } from \"../utils/get-config\";\r\nimport { REGISTRY_URL } from \"./constants\";\r\nimport { expandEnvVars } from \"./env\";\r\nimport { RegistryNotConfiguredError } from \"./errors\";\r\nimport { parseRegistryAndItemFromString } from \"./parser\";\r\nimport { registryConfigItemSchema } from \"./schema\";\r\nimport { isUrl } from \"./utils\";\r\nimport { validateRegistryConfig } from \"./validator\";\r\n\r\nconst NAME_PLACEHOLDER = \"{name}\";\r\nconst STYLE_PLACEHOLDER = \"{style}\";\r\nconst ENV_VAR_PATTER = /\\${(\\w+)}/g\r\nconst QUERY_PARAM_SEPARATOR = \"?\";\r\nconst QUERY_PARAM_DELIMITER = \"&\";\r\n\r\nexport function buildUrlAndHeadersForRegistryItem(\r\n  name: string,\r\n  config?: Config\r\n) {\r\n  const { registry, item } = parseRegistryAndItemFromString(name);\r\n\r\n  if (!registry) {\r\n    return null;\r\n  }\r\n\r\n  const registries = config?.registries || {};\r\n  const registryConfig = registries[registry];\r\n  if (!registryConfig) {\r\n    throw new RegistryNotConfiguredError(registry);\r\n  }\r\n\r\n  validateRegistryConfig(registry, registryConfig);\r\n\r\n  return {\r\n    url: buildUrlFromRegistryConfig(item, registryConfig, config),\r\n    headers: buildHeadersFromRegistryConfig(registryConfig),\r\n  }\r\n}\r\n\r\nexport function buildUrlFromRegistryConfig(\r\n  item: string,\r\n  registryConfig: z.infer<typeof registryConfigItemSchema>,\r\n  config?: Config\r\n) {\r\n  if (typeof registryConfig === \"string\") {\r\n    let url = registryConfig.replace(NAME_PLACEHOLDER, item);\r\n    if (config?.style && url.includes(STYLE_PLACEHOLDER)) {\r\n      url = url.replace(STYLE_PLACEHOLDER, config.style);\r\n    }\r\n    return expandEnvVars(url);\r\n  }\r\n\r\n  let baseUrl = registryConfig.url.replace(NAME_PLACEHOLDER, item);\r\n  if (config?.style && baseUrl.includes(STYLE_PLACEHOLDER)) {\r\n    baseUrl = baseUrl.replace(STYLE_PLACEHOLDER, config.style);\r\n  }\r\n  baseUrl = expandEnvVars(baseUrl);\r\n\r\n  if (!registryConfig.params) {\r\n    return baseUrl;\r\n  }\r\n\r\n  return appendQueryParams(baseUrl, registryConfig.params);\r\n}\r\n\r\nexport function buildHeadersFromRegistryConfig(\r\n  config: z.infer<typeof registryConfigItemSchema>\r\n) {\r\n  if (typeof config === \"string\" || !config.headers) {\r\n    return {}\r\n  }\r\n\r\n  const headers: Record<string, string> = {};\r\n\r\n  for (const [key, value] of Object.entries(config.headers)) {\r\n    const expandedValue = expandEnvVars(value);\r\n\r\n    if (shouldIncludeHeader(value, expandedValue)) {\r\n      headers[key] = expandedValue;\r\n    }\r\n  }\r\n\r\n  return headers;\r\n}\r\n\r\nfunction appendQueryParams(baseUrl: string, params: Record<string, string>) {\r\n  const urlParams = new URLSearchParams();\r\n\r\n  for (const [key, value] of Object.entries(params)) {\r\n    const expandedValue = expandEnvVars(value);\r\n    if (expandedValue) {\r\n      urlParams.append(key, expandedValue);\r\n    }\r\n  }\r\n\r\n  const queryString = urlParams.toString();\r\n  if (!queryString) {\r\n    return baseUrl;\r\n  }\r\n\r\n  const separator = baseUrl.includes(QUERY_PARAM_SEPARATOR)\r\n    ? QUERY_PARAM_DELIMITER\r\n    : QUERY_PARAM_SEPARATOR;\r\n\r\n  return `${baseUrl}${separator}${queryString}`;\r\n}\r\n\r\nfunction shouldIncludeHeader(originalValue: string, expandedValue: string) {\r\n  const trimmedExpanded = expandedValue.trim();\r\n\r\n  if (!trimmedExpanded) {\r\n    return false;\r\n  }\r\n\r\n  // If the original value contains valid en vars, only include if expansion changed the value.\r\n  if (originalValue.includes(\"${\")) {\r\n    // Check if there are actual en vars in the string\r\n    const envVars = originalValue.match(ENV_VAR_PATTER);\r\n    if (envVars) {\r\n      const templateWithoutVars = originalValue\r\n        .replace(ENV_VAR_PATTER, \"\")\r\n        .trim();\r\n\r\n      return trimmedExpanded !== templateWithoutVars;\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nexport function resolveRegistryUrl(pathOrUrl: string) {\r\n  if (isUrl(pathOrUrl)) {\r\n    // If the url contains /chat/b, we assume it's the v0 registry.\r\n    // We need to add the /json suffix if it's missing.\r\n    const url = new URL(pathOrUrl);\r\n    if (url.pathname.match(/\\/chat\\/b\\//) && !url.pathname.endsWith(\"/json\")) {\r\n      url.pathname = `${url.pathname}/json`\r\n    }\r\n\r\n    return url.toString();\r\n  }\r\n\r\n  return `${REGISTRY_URL}/${pathOrUrl}`;\r\n}\r\n","export interface MimeBuffer extends Buffer {\n\ttype: string;\n\ttypeFull: string;\n\tcharset: string;\n}\n\n/**\n * Returns a `Buffer` instance from the given data URI `uri`.\n *\n * @param {String} uri Data URI to turn into a Buffer instance\n * @returns {Buffer} Buffer instance from Data URI\n * @api public\n */\nexport function dataUriToBuffer(uri: string): MimeBuffer {\n\tif (!/^data:/i.test(uri)) {\n\t\tthrow new TypeError(\n\t\t\t'`uri` does not appear to be a Data URI (must begin with \"data:\")'\n\t\t);\n\t}\n\n\t// strip newlines\n\turi = uri.replace(/\\r?\\n/g, '');\n\n\t// split the URI up into the \"metadata\" and the \"data\" portions\n\tconst firstComma = uri.indexOf(',');\n\tif (firstComma === -1 || firstComma <= 4) {\n\t\tthrow new TypeError('malformed data: URI');\n\t}\n\n\t// remove the \"data:\" scheme and parse the metadata\n\tconst meta = uri.substring(5, firstComma).split(';');\n\n\tlet charset = '';\n\tlet base64 = false;\n\tconst type = meta[0] || 'text/plain';\n\tlet typeFull = type;\n\tfor (let i = 1; i < meta.length; i++) {\n\t\tif (meta[i] === 'base64') {\n\t\t\tbase64 = true;\n\t\t} else if(meta[i]) {\n\t\t\ttypeFull += `;${  meta[i]}`;\n\t\t\tif (meta[i].indexOf('charset=') === 0) {\n\t\t\t\tcharset = meta[i].substring(8);\n\t\t\t}\n\t\t}\n\t}\n\t// defaults to US-ASCII only if type is not provided\n\tif (!meta[0] && !charset.length) {\n\t\ttypeFull += ';charset=US-ASCII';\n\t\tcharset = 'US-ASCII';\n\t}\n\n\t// get the encoded data portion and decode URI-encoded chars\n\tconst encoding = base64 ? 'base64' : 'ascii';\n\tconst data = unescape(uri.substring(firstComma + 1));\n\tconst buffer = Buffer.from(data, encoding) as MimeBuffer;\n\n\t// set `.type` and `.typeFull` properties to MIME type\n\tbuffer.type = type;\n\tbuffer.typeFull = typeFull;\n\n\t// set the `.charset` property\n\tbuffer.charset = charset;\n\n\treturn buffer;\n}\n\nexport default dataUriToBuffer;\n","export class FetchBaseError extends Error {\n\tconstructor(message, type) {\n\t\tsuper(message);\n\t\t// Hide custom error implementation details from end-users\n\t\tError.captureStackTrace(this, this.constructor);\n\n\t\tthis.type = type;\n\t}\n\n\tget name() {\n\t\treturn this.constructor.name;\n\t}\n\n\tget [Symbol.toStringTag]() {\n\t\treturn this.constructor.name;\n\t}\n}\n","\nimport {FetchBaseError} from './base.js';\n\n/**\n * @typedef {{ address?: string, code: string, dest?: string, errno: number, info?: object, message: string, path?: string, port?: number, syscall: string}} SystemError\n*/\n\n/**\n * FetchError interface for operational errors\n */\nexport class FetchError extends FetchBaseError {\n\t/**\n\t * @param  {string} message -      Error message for human\n\t * @param  {string} [type] -        Error type for machine\n\t * @param  {SystemError} [systemError] - For Node.js system error\n\t */\n\tconstructor(message, type, systemError) {\n\t\tsuper(message, type);\n\t\t// When err.type is `system`, err.erroredSysCall contains system error and err.code contains system error code\n\t\tif (systemError) {\n\t\t\t// eslint-disable-next-line no-multi-assign\n\t\t\tthis.code = this.errno = systemError.code;\n\t\t\tthis.erroredSysCall = systemError.syscall;\n\t\t}\n\t}\n}\n","/**\n * Is.js\n *\n * Object type checks.\n */\n\nconst NAME = Symbol.toStringTag;\n\n/**\n * Check if `obj` is a URLSearchParams object\n * ref: https://github.com/node-fetch/node-fetch/issues/296#issuecomment-307598143\n * @param {*} object - Object to check for\n * @return {boolean}\n */\nexport const isURLSearchParameters = object => {\n\treturn (\n\t\ttypeof object === 'object' &&\n\t\ttypeof object.append === 'function' &&\n\t\ttypeof object.delete === 'function' &&\n\t\ttypeof object.get === 'function' &&\n\t\ttypeof object.getAll === 'function' &&\n\t\ttypeof object.has === 'function' &&\n\t\ttypeof object.set === 'function' &&\n\t\ttypeof object.sort === 'function' &&\n\t\tobject[NAME] === 'URLSearchParams'\n\t);\n};\n\n/**\n * Check if `object` is a W3C `Blob` object (which `File` inherits from)\n * @param {*} object - Object to check for\n * @return {boolean}\n */\nexport const isBlob = object => {\n\treturn (\n\t\tobject &&\n\t\ttypeof object === 'object' &&\n\t\ttypeof object.arrayBuffer === 'function' &&\n\t\ttypeof object.type === 'string' &&\n\t\ttypeof object.stream === 'function' &&\n\t\ttypeof object.constructor === 'function' &&\n\t\t/^(Blob|File)$/.test(object[NAME])\n\t);\n};\n\n/**\n * Check if `obj` is an instance of AbortSignal.\n * @param {*} object - Object to check for\n * @return {boolean}\n */\nexport const isAbortSignal = object => {\n\treturn (\n\t\ttypeof object === 'object' && (\n\t\t\tobject[NAME] === 'AbortSignal' ||\n\t\t\tobject[NAME] === 'EventTarget'\n\t\t)\n\t);\n};\n\n/**\n * isDomainOrSubdomain reports whether sub is a subdomain (or exact match) of\n * the parent domain.\n *\n * Both domains must already be in canonical form.\n * @param {string|URL} original\n * @param {string|URL} destination\n */\nexport const isDomainOrSubdomain = (destination, original) => {\n\tconst orig = new URL(original).hostname;\n\tconst dest = new URL(destination).hostname;\n\n\treturn orig === dest || orig.endsWith(`.${dest}`);\n};\n\n/**\n * isSameProtocol reports whether the two provided URLs use the same protocol.\n *\n * Both domains must already be in canonical form.\n * @param {string|URL} original\n * @param {string|URL} destination\n */\nexport const isSameProtocol = (destination, original) => {\n\tconst orig = new URL(original).protocol;\n\tconst dest = new URL(destination).protocol;\n\n\treturn orig === dest;\n};\n","\n/**\n * Body.js\n *\n * Body interface provides common methods for Request and Response\n */\n\nimport Stream, {PassThrough} from 'node:stream';\nimport {types, deprecate, promisify} from 'node:util';\nimport {Buffer} from 'node:buffer';\n\nimport Blob from 'fetch-blob';\nimport {FormData, formDataToBlob} from 'formdata-polyfill/esm.min.js';\n\nimport {FetchError} from './errors/fetch-error.js';\nimport {FetchBaseError} from './errors/base.js';\nimport {isBlob, isURLSearchParameters} from './utils/is.js';\n\nconst pipeline = promisify(Stream.pipeline);\nconst INTERNALS = Symbol('Body internals');\n\n/**\n * Body mixin\n *\n * Ref: https://fetch.spec.whatwg.org/#body\n *\n * @param   Stream  body  Readable stream\n * @param   Object  opts  Response options\n * @return  Void\n */\nexport default class Body {\n\tconstructor(body, {\n\t\tsize = 0\n\t} = {}) {\n\t\tlet boundary = null;\n\n\t\tif (body === null) {\n\t\t\t// Body is undefined or null\n\t\t\tbody = null;\n\t\t} else if (isURLSearchParameters(body)) {\n\t\t\t// Body is a URLSearchParams\n\t\t\tbody = Buffer.from(body.toString());\n\t\t} else if (isBlob(body)) {\n\t\t\t// Body is blob\n\t\t} else if (Buffer.isBuffer(body)) {\n\t\t\t// Body is Buffer\n\t\t} else if (types.isAnyArrayBuffer(body)) {\n\t\t\t// Body is ArrayBuffer\n\t\t\tbody = Buffer.from(body);\n\t\t} else if (ArrayBuffer.isView(body)) {\n\t\t\t// Body is ArrayBufferView\n\t\t\tbody = Buffer.from(body.buffer, body.byteOffset, body.byteLength);\n\t\t} else if (body instanceof Stream) {\n\t\t\t// Body is stream\n\t\t} else if (body instanceof FormData) {\n\t\t\t// Body is FormData\n\t\t\tbody = formDataToBlob(body);\n\t\t\tboundary = body.type.split('=')[1];\n\t\t} else {\n\t\t\t// None of the above\n\t\t\t// coerce to string then buffer\n\t\t\tbody = Buffer.from(String(body));\n\t\t}\n\n\t\tlet stream = body;\n\n\t\tif (Buffer.isBuffer(body)) {\n\t\t\tstream = Stream.Readable.from(body);\n\t\t} else if (isBlob(body)) {\n\t\t\tstream = Stream.Readable.from(body.stream());\n\t\t}\n\n\t\tthis[INTERNALS] = {\n\t\t\tbody,\n\t\t\tstream,\n\t\t\tboundary,\n\t\t\tdisturbed: false,\n\t\t\terror: null\n\t\t};\n\t\tthis.size = size;\n\n\t\tif (body instanceof Stream) {\n\t\t\tbody.on('error', error_ => {\n\t\t\t\tconst error = error_ instanceof FetchBaseError ?\n\t\t\t\t\terror_ :\n\t\t\t\t\tnew FetchError(`Invalid response body while trying to fetch ${this.url}: ${error_.message}`, 'system', error_);\n\t\t\t\tthis[INTERNALS].error = error;\n\t\t\t});\n\t\t}\n\t}\n\n\tget body() {\n\t\treturn this[INTERNALS].stream;\n\t}\n\n\tget bodyUsed() {\n\t\treturn this[INTERNALS].disturbed;\n\t}\n\n\t/**\n\t * Decode response as ArrayBuffer\n\t *\n\t * @return  Promise\n\t */\n\tasync arrayBuffer() {\n\t\tconst {buffer, byteOffset, byteLength} = await consumeBody(this);\n\t\treturn buffer.slice(byteOffset, byteOffset + byteLength);\n\t}\n\n\tasync formData() {\n\t\tconst ct = this.headers.get('content-type');\n\n\t\tif (ct.startsWith('application/x-www-form-urlencoded')) {\n\t\t\tconst formData = new FormData();\n\t\t\tconst parameters = new URLSearchParams(await this.text());\n\n\t\t\tfor (const [name, value] of parameters) {\n\t\t\t\tformData.append(name, value);\n\t\t\t}\n\n\t\t\treturn formData;\n\t\t}\n\n\t\tconst {toFormData} = await import('./utils/multipart-parser.js');\n\t\treturn toFormData(this.body, ct);\n\t}\n\n\t/**\n\t * Return raw response as Blob\n\t *\n\t * @return Promise\n\t */\n\tasync blob() {\n\t\tconst ct = (this.headers && this.headers.get('content-type')) || (this[INTERNALS].body && this[INTERNALS].body.type) || '';\n\t\tconst buf = await this.arrayBuffer();\n\n\t\treturn new Blob([buf], {\n\t\t\ttype: ct\n\t\t});\n\t}\n\n\t/**\n\t * Decode response as json\n\t *\n\t * @return  Promise\n\t */\n\tasync json() {\n\t\tconst text = await this.text();\n\t\treturn JSON.parse(text);\n\t}\n\n\t/**\n\t * Decode response as text\n\t *\n\t * @return  Promise\n\t */\n\tasync text() {\n\t\tconst buffer = await consumeBody(this);\n\t\treturn new TextDecoder().decode(buffer);\n\t}\n\n\t/**\n\t * Decode response as buffer (non-spec api)\n\t *\n\t * @return  Promise\n\t */\n\tbuffer() {\n\t\treturn consumeBody(this);\n\t}\n}\n\nBody.prototype.buffer = deprecate(Body.prototype.buffer, 'Please use \\'response.arrayBuffer()\\' instead of \\'response.buffer()\\'', 'node-fetch#buffer');\n\n// In browsers, all properties are enumerable.\nObject.defineProperties(Body.prototype, {\n\tbody: {enumerable: true},\n\tbodyUsed: {enumerable: true},\n\tarrayBuffer: {enumerable: true},\n\tblob: {enumerable: true},\n\tjson: {enumerable: true},\n\ttext: {enumerable: true},\n\tdata: {get: deprecate(() => {},\n\t\t'data doesn\\'t exist, use json(), text(), arrayBuffer(), or body instead',\n\t\t'https://github.com/node-fetch/node-fetch/issues/1000 (response)')}\n});\n\n/**\n * Consume and convert an entire Body to a Buffer.\n *\n * Ref: https://fetch.spec.whatwg.org/#concept-body-consume-body\n *\n * @return Promise\n */\nasync function consumeBody(data) {\n\tif (data[INTERNALS].disturbed) {\n\t\tthrow new TypeError(`body used already for: ${data.url}`);\n\t}\n\n\tdata[INTERNALS].disturbed = true;\n\n\tif (data[INTERNALS].error) {\n\t\tthrow data[INTERNALS].error;\n\t}\n\n\tconst {body} = data;\n\n\t// Body is null\n\tif (body === null) {\n\t\treturn Buffer.alloc(0);\n\t}\n\n\t/* c8 ignore next 3 */\n\tif (!(body instanceof Stream)) {\n\t\treturn Buffer.alloc(0);\n\t}\n\n\t// Body is stream\n\t// get ready to actually consume the body\n\tconst accum = [];\n\tlet accumBytes = 0;\n\n\ttry {\n\t\tfor await (const chunk of body) {\n\t\t\tif (data.size > 0 && accumBytes + chunk.length > data.size) {\n\t\t\t\tconst error = new FetchError(`content size at ${data.url} over limit: ${data.size}`, 'max-size');\n\t\t\t\tbody.destroy(error);\n\t\t\t\tthrow error;\n\t\t\t}\n\n\t\t\taccumBytes += chunk.length;\n\t\t\taccum.push(chunk);\n\t\t}\n\t} catch (error) {\n\t\tconst error_ = error instanceof FetchBaseError ? error : new FetchError(`Invalid response body while trying to fetch ${data.url}: ${error.message}`, 'system', error);\n\t\tthrow error_;\n\t}\n\n\tif (body.readableEnded === true || body._readableState.ended === true) {\n\t\ttry {\n\t\t\tif (accum.every(c => typeof c === 'string')) {\n\t\t\t\treturn Buffer.from(accum.join(''));\n\t\t\t}\n\n\t\t\treturn Buffer.concat(accum, accumBytes);\n\t\t} catch (error) {\n\t\t\tthrow new FetchError(`Could not create Buffer from response body for ${data.url}: ${error.message}`, 'system', error);\n\t\t}\n\t} else {\n\t\tthrow new FetchError(`Premature close of server response while trying to fetch ${data.url}`);\n\t}\n}\n\n/**\n * Clone body given Res/Req instance\n *\n * @param   Mixed   instance       Response or Request instance\n * @param   String  highWaterMark  highWaterMark for both PassThrough body streams\n * @return  Mixed\n */\nexport const clone = (instance, highWaterMark) => {\n\tlet p1;\n\tlet p2;\n\tlet {body} = instance[INTERNALS];\n\n\t// Don't allow cloning a used body\n\tif (instance.bodyUsed) {\n\t\tthrow new Error('cannot clone body after it is used');\n\t}\n\n\t// Check that body is a stream and not form-data object\n\t// note: we can't clone the form-data object without having it as a dependency\n\tif ((body instanceof Stream) && (typeof body.getBoundary !== 'function')) {\n\t\t// Tee instance body\n\t\tp1 = new PassThrough({highWaterMark});\n\t\tp2 = new PassThrough({highWaterMark});\n\t\tbody.pipe(p1);\n\t\tbody.pipe(p2);\n\t\t// Set instance body to teed body and return the other teed body\n\t\tinstance[INTERNALS].stream = p1;\n\t\tbody = p2;\n\t}\n\n\treturn body;\n};\n\nconst getNonSpecFormDataBoundary = deprecate(\n\tbody => body.getBoundary(),\n\t'form-data doesn\\'t follow the spec and requires special treatment. Use alternative package',\n\t'https://github.com/node-fetch/node-fetch/issues/1167'\n);\n\n/**\n * Performs the operation \"extract a `Content-Type` value from |object|\" as\n * specified in the specification:\n * https://fetch.spec.whatwg.org/#concept-bodyinit-extract\n *\n * This function assumes that instance.body is present.\n *\n * @param {any} body Any options.body input\n * @returns {string | null}\n */\nexport const extractContentType = (body, request) => {\n\t// Body is null or undefined\n\tif (body === null) {\n\t\treturn null;\n\t}\n\n\t// Body is string\n\tif (typeof body === 'string') {\n\t\treturn 'text/plain;charset=UTF-8';\n\t}\n\n\t// Body is a URLSearchParams\n\tif (isURLSearchParameters(body)) {\n\t\treturn 'application/x-www-form-urlencoded;charset=UTF-8';\n\t}\n\n\t// Body is blob\n\tif (isBlob(body)) {\n\t\treturn body.type || null;\n\t}\n\n\t// Body is a Buffer (Buffer, ArrayBuffer or ArrayBufferView)\n\tif (Buffer.isBuffer(body) || types.isAnyArrayBuffer(body) || ArrayBuffer.isView(body)) {\n\t\treturn null;\n\t}\n\n\tif (body instanceof FormData) {\n\t\treturn `multipart/form-data; boundary=${request[INTERNALS].boundary}`;\n\t}\n\n\t// Detect form data input from form-data module\n\tif (body && typeof body.getBoundary === 'function') {\n\t\treturn `multipart/form-data;boundary=${getNonSpecFormDataBoundary(body)}`;\n\t}\n\n\t// Body is stream - can't really do much about this\n\tif (body instanceof Stream) {\n\t\treturn null;\n\t}\n\n\t// Body constructor defaults other things to string\n\treturn 'text/plain;charset=UTF-8';\n};\n\n/**\n * The Fetch Standard treats this as if \"total bytes\" is a property on the body.\n * For us, we have to explicitly get it with a function.\n *\n * ref: https://fetch.spec.whatwg.org/#concept-body-total-bytes\n *\n * @param {any} obj.body Body object from the Body instance.\n * @returns {number | null}\n */\nexport const getTotalBytes = request => {\n\tconst {body} = request[INTERNALS];\n\n\t// Body is null or undefined\n\tif (body === null) {\n\t\treturn 0;\n\t}\n\n\t// Body is Blob\n\tif (isBlob(body)) {\n\t\treturn body.size;\n\t}\n\n\t// Body is Buffer\n\tif (Buffer.isBuffer(body)) {\n\t\treturn body.length;\n\t}\n\n\t// Detect form data input from form-data module\n\tif (body && typeof body.getLengthSync === 'function') {\n\t\treturn body.hasKnownLength && body.hasKnownLength() ? body.getLengthSync() : null;\n\t}\n\n\t// Body is stream\n\treturn null;\n};\n\n/**\n * Write a Body to a Node.js WritableStream (e.g. http.Request) object.\n *\n * @param {Stream.Writable} dest The stream to write to.\n * @param obj.body Body object from the Body instance.\n * @returns {Promise<void>}\n */\nexport const writeToStream = async (dest, {body}) => {\n\tif (body === null) {\n\t\t// Body is null\n\t\tdest.end();\n\t} else {\n\t\t// Body is stream\n\t\tawait pipeline(body, dest);\n\t}\n};\n","/**\n * Headers.js\n *\n * Headers class offers convenient helpers\n */\n\nimport {types} from 'node:util';\nimport http from 'node:http';\n\n/* c8 ignore next 9 */\nconst validateHeaderName = typeof http.validateHeaderName === 'function' ?\n\thttp.validateHeaderName :\n\tname => {\n\t\tif (!/^[\\^`\\-\\w!#$%&'*+.|~]+$/.test(name)) {\n\t\t\tconst error = new TypeError(`Header name must be a valid HTTP token [${name}]`);\n\t\t\tObject.defineProperty(error, 'code', {value: 'ERR_INVALID_HTTP_TOKEN'});\n\t\t\tthrow error;\n\t\t}\n\t};\n\n/* c8 ignore next 9 */\nconst validateHeaderValue = typeof http.validateHeaderValue === 'function' ?\n\thttp.validateHeaderValue :\n\t(name, value) => {\n\t\tif (/[^\\t\\u0020-\\u007E\\u0080-\\u00FF]/.test(value)) {\n\t\t\tconst error = new TypeError(`Invalid character in header content [\"${name}\"]`);\n\t\t\tObject.defineProperty(error, 'code', {value: 'ERR_INVALID_CHAR'});\n\t\t\tthrow error;\n\t\t}\n\t};\n\n/**\n * @typedef {Headers | Record<string, string> | Iterable<readonly [string, string]> | Iterable<Iterable<string>>} HeadersInit\n */\n\n/**\n * This Fetch API interface allows you to perform various actions on HTTP request and response headers.\n * These actions include retrieving, setting, adding to, and removing.\n * A Headers object has an associated header list, which is initially empty and consists of zero or more name and value pairs.\n * You can add to this using methods like append() (see Examples.)\n * In all methods of this interface, header names are matched by case-insensitive byte sequence.\n *\n */\nexport default class Headers extends URLSearchParams {\n\t/**\n\t * Headers class\n\t *\n\t * @constructor\n\t * @param {HeadersInit} [init] - Response headers\n\t */\n\tconstructor(init) {\n\t\t// Validate and normalize init object in [name, value(s)][]\n\t\t/** @type {string[][]} */\n\t\tlet result = [];\n\t\tif (init instanceof Headers) {\n\t\t\tconst raw = init.raw();\n\t\t\tfor (const [name, values] of Object.entries(raw)) {\n\t\t\t\tresult.push(...values.map(value => [name, value]));\n\t\t\t}\n\t\t} else if (init == null) { // eslint-disable-line no-eq-null, eqeqeq\n\t\t\t// No op\n\t\t} else if (typeof init === 'object' && !types.isBoxedPrimitive(init)) {\n\t\t\tconst method = init[Symbol.iterator];\n\t\t\t// eslint-disable-next-line no-eq-null, eqeqeq\n\t\t\tif (method == null) {\n\t\t\t\t// Record<ByteString, ByteString>\n\t\t\t\tresult.push(...Object.entries(init));\n\t\t\t} else {\n\t\t\t\tif (typeof method !== 'function') {\n\t\t\t\t\tthrow new TypeError('Header pairs must be iterable');\n\t\t\t\t}\n\n\t\t\t\t// Sequence<sequence<ByteString>>\n\t\t\t\t// Note: per spec we have to first exhaust the lists then process them\n\t\t\t\tresult = [...init]\n\t\t\t\t\t.map(pair => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\ttypeof pair !== 'object' || types.isBoxedPrimitive(pair)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tthrow new TypeError('Each header pair must be an iterable object');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn [...pair];\n\t\t\t\t\t}).map(pair => {\n\t\t\t\t\t\tif (pair.length !== 2) {\n\t\t\t\t\t\t\tthrow new TypeError('Each header pair must be a name/value tuple');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn [...pair];\n\t\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tthrow new TypeError('Failed to construct \\'Headers\\': The provided value is not of type \\'(sequence<sequence<ByteString>> or record<ByteString, ByteString>)');\n\t\t}\n\n\t\t// Validate and lowercase\n\t\tresult =\n\t\t\tresult.length > 0 ?\n\t\t\t\tresult.map(([name, value]) => {\n\t\t\t\t\tvalidateHeaderName(name);\n\t\t\t\t\tvalidateHeaderValue(name, String(value));\n\t\t\t\t\treturn [String(name).toLowerCase(), String(value)];\n\t\t\t\t}) :\n\t\t\t\tundefined;\n\n\t\tsuper(result);\n\n\t\t// Returning a Proxy that will lowercase key names, validate parameters and sort keys\n\t\t// eslint-disable-next-line no-constructor-return\n\t\treturn new Proxy(this, {\n\t\t\tget(target, p, receiver) {\n\t\t\t\tswitch (p) {\n\t\t\t\t\tcase 'append':\n\t\t\t\t\tcase 'set':\n\t\t\t\t\t\treturn (name, value) => {\n\t\t\t\t\t\t\tvalidateHeaderName(name);\n\t\t\t\t\t\t\tvalidateHeaderValue(name, String(value));\n\t\t\t\t\t\t\treturn URLSearchParams.prototype[p].call(\n\t\t\t\t\t\t\t\ttarget,\n\t\t\t\t\t\t\t\tString(name).toLowerCase(),\n\t\t\t\t\t\t\t\tString(value)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t};\n\n\t\t\t\t\tcase 'delete':\n\t\t\t\t\tcase 'has':\n\t\t\t\t\tcase 'getAll':\n\t\t\t\t\t\treturn name => {\n\t\t\t\t\t\t\tvalidateHeaderName(name);\n\t\t\t\t\t\t\treturn URLSearchParams.prototype[p].call(\n\t\t\t\t\t\t\t\ttarget,\n\t\t\t\t\t\t\t\tString(name).toLowerCase()\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t};\n\n\t\t\t\t\tcase 'keys':\n\t\t\t\t\t\treturn () => {\n\t\t\t\t\t\t\ttarget.sort();\n\t\t\t\t\t\t\treturn new Set(URLSearchParams.prototype.keys.call(target)).keys();\n\t\t\t\t\t\t};\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn Reflect.get(target, p, receiver);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t/* c8 ignore next */\n\t}\n\n\tget [Symbol.toStringTag]() {\n\t\treturn this.constructor.name;\n\t}\n\n\ttoString() {\n\t\treturn Object.prototype.toString.call(this);\n\t}\n\n\tget(name) {\n\t\tconst values = this.getAll(name);\n\t\tif (values.length === 0) {\n\t\t\treturn null;\n\t\t}\n\n\t\tlet value = values.join(', ');\n\t\tif (/^content-encoding$/i.test(name)) {\n\t\t\tvalue = value.toLowerCase();\n\t\t}\n\n\t\treturn value;\n\t}\n\n\tforEach(callback, thisArg = undefined) {\n\t\tfor (const name of this.keys()) {\n\t\t\tReflect.apply(callback, thisArg, [this.get(name), name, this]);\n\t\t}\n\t}\n\n\t* values() {\n\t\tfor (const name of this.keys()) {\n\t\t\tyield this.get(name);\n\t\t}\n\t}\n\n\t/**\n\t * @type {() => IterableIterator<[string, string]>}\n\t */\n\t* entries() {\n\t\tfor (const name of this.keys()) {\n\t\t\tyield [name, this.get(name)];\n\t\t}\n\t}\n\n\t[Symbol.iterator]() {\n\t\treturn this.entries();\n\t}\n\n\t/**\n\t * Node-fetch non-spec method\n\t * returning all headers and their values as array\n\t * @returns {Record<string, string[]>}\n\t */\n\traw() {\n\t\treturn [...this.keys()].reduce((result, key) => {\n\t\t\tresult[key] = this.getAll(key);\n\t\t\treturn result;\n\t\t}, {});\n\t}\n\n\t/**\n\t * For better console.log(headers) and also to convert Headers into Node.js Request compatible format\n\t */\n\t[Symbol.for('nodejs.util.inspect.custom')]() {\n\t\treturn [...this.keys()].reduce((result, key) => {\n\t\t\tconst values = this.getAll(key);\n\t\t\t// Http.request() only supports string as Host header.\n\t\t\t// This hack makes specifying custom Host header possible.\n\t\t\tif (key === 'host') {\n\t\t\t\tresult[key] = values[0];\n\t\t\t} else {\n\t\t\t\tresult[key] = values.length > 1 ? values : values[0];\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}, {});\n\t}\n}\n\n/**\n * Re-shaping object for Web IDL tests\n * Only need to do it for overridden methods\n */\nObject.defineProperties(\n\tHeaders.prototype,\n\t['get', 'entries', 'forEach', 'values'].reduce((result, property) => {\n\t\tresult[property] = {enumerable: true};\n\t\treturn result;\n\t}, {})\n);\n\n/**\n * Create a Headers object from an http.IncomingMessage.rawHeaders, ignoring those that do\n * not conform to HTTP grammar productions.\n * @param {import('http').IncomingMessage['rawHeaders']} headers\n */\nexport function fromRawHeaders(headers = []) {\n\treturn new Headers(\n\t\theaders\n\t\t\t// Split into pairs\n\t\t\t.reduce((result, value, index, array) => {\n\t\t\t\tif (index % 2 === 0) {\n\t\t\t\t\tresult.push(array.slice(index, index + 2));\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t}, [])\n\t\t\t.filter(([name, value]) => {\n\t\t\t\ttry {\n\t\t\t\t\tvalidateHeaderName(name);\n\t\t\t\t\tvalidateHeaderValue(name, String(value));\n\t\t\t\t\treturn true;\n\t\t\t\t} catch {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t})\n\n\t);\n}\n","const redirectStatus = new Set([301, 302, 303, 307, 308]);\n\n/**\n * Redirect code matching\n *\n * @param {number} code - Status code\n * @return {boolean}\n */\nexport const isRedirect = code => {\n\treturn redirectStatus.has(code);\n};\n","/**\n * Response.js\n *\n * Response class provides content decoding\n */\n\nimport Headers from './headers.js';\nimport Body, {clone, extractContentType} from './body.js';\nimport {isRedirect} from './utils/is-redirect.js';\n\nconst INTERNALS = Symbol('Response internals');\n\n/**\n * Response class\n *\n * Ref: https://fetch.spec.whatwg.org/#response-class\n *\n * @param   Stream  body  Readable stream\n * @param   Object  opts  Response options\n * @return  Void\n */\nexport default class Response extends Body {\n\tconstructor(body = null, options = {}) {\n\t\tsuper(body, options);\n\n\t\t// eslint-disable-next-line no-eq-null, eqeqeq, no-negated-condition\n\t\tconst status = options.status != null ? options.status : 200;\n\n\t\tconst headers = new Headers(options.headers);\n\n\t\tif (body !== null && !headers.has('Content-Type')) {\n\t\t\tconst contentType = extractContentType(body, this);\n\t\t\tif (contentType) {\n\t\t\t\theaders.append('Content-Type', contentType);\n\t\t\t}\n\t\t}\n\n\t\tthis[INTERNALS] = {\n\t\t\ttype: 'default',\n\t\t\turl: options.url,\n\t\t\tstatus,\n\t\t\tstatusText: options.statusText || '',\n\t\t\theaders,\n\t\t\tcounter: options.counter,\n\t\t\thighWaterMark: options.highWaterMark\n\t\t};\n\t}\n\n\tget type() {\n\t\treturn this[INTERNALS].type;\n\t}\n\n\tget url() {\n\t\treturn this[INTERNALS].url || '';\n\t}\n\n\tget status() {\n\t\treturn this[INTERNALS].status;\n\t}\n\n\t/**\n\t * Convenience property representing if the request ended normally\n\t */\n\tget ok() {\n\t\treturn this[INTERNALS].status >= 200 && this[INTERNALS].status < 300;\n\t}\n\n\tget redirected() {\n\t\treturn this[INTERNALS].counter > 0;\n\t}\n\n\tget statusText() {\n\t\treturn this[INTERNALS].statusText;\n\t}\n\n\tget headers() {\n\t\treturn this[INTERNALS].headers;\n\t}\n\n\tget highWaterMark() {\n\t\treturn this[INTERNALS].highWaterMark;\n\t}\n\n\t/**\n\t * Clone this response\n\t *\n\t * @return  Response\n\t */\n\tclone() {\n\t\treturn new Response(clone(this, this.highWaterMark), {\n\t\t\ttype: this.type,\n\t\t\turl: this.url,\n\t\t\tstatus: this.status,\n\t\t\tstatusText: this.statusText,\n\t\t\theaders: this.headers,\n\t\t\tok: this.ok,\n\t\t\tredirected: this.redirected,\n\t\t\tsize: this.size,\n\t\t\thighWaterMark: this.highWaterMark\n\t\t});\n\t}\n\n\t/**\n\t * @param {string} url    The URL that the new response is to originate from.\n\t * @param {number} status An optional status code for the response (e.g., 302.)\n\t * @returns {Response}    A Response object.\n\t */\n\tstatic redirect(url, status = 302) {\n\t\tif (!isRedirect(status)) {\n\t\t\tthrow new RangeError('Failed to execute \"redirect\" on \"response\": Invalid status code');\n\t\t}\n\n\t\treturn new Response(null, {\n\t\t\theaders: {\n\t\t\t\tlocation: new URL(url).toString()\n\t\t\t},\n\t\t\tstatus\n\t\t});\n\t}\n\n\tstatic error() {\n\t\tconst response = new Response(null, {status: 0, statusText: ''});\n\t\tresponse[INTERNALS].type = 'error';\n\t\treturn response;\n\t}\n\n\tstatic json(data = undefined, init = {}) {\n\t\tconst body = JSON.stringify(data);\n\n\t\tif (body === undefined) {\n\t\t\tthrow new TypeError('data is not JSON serializable');\n\t\t}\n\n\t\tconst headers = new Headers(init && init.headers);\n\n\t\tif (!headers.has('content-type')) {\n\t\t\theaders.set('content-type', 'application/json');\n\t\t}\n\n\t\treturn new Response(body, {\n\t\t\t...init,\n\t\t\theaders\n\t\t});\n\t}\n\n\tget [Symbol.toStringTag]() {\n\t\treturn 'Response';\n\t}\n}\n\nObject.defineProperties(Response.prototype, {\n\ttype: {enumerable: true},\n\turl: {enumerable: true},\n\tstatus: {enumerable: true},\n\tok: {enumerable: true},\n\tredirected: {enumerable: true},\n\tstatusText: {enumerable: true},\n\theaders: {enumerable: true},\n\tclone: {enumerable: true}\n});\n","export const getSearch = parsedURL => {\n\tif (parsedURL.search) {\n\t\treturn parsedURL.search;\n\t}\n\n\tconst lastOffset = parsedURL.href.length - 1;\n\tconst hash = parsedURL.hash || (parsedURL.href[lastOffset] === '#' ? '#' : '');\n\treturn parsedURL.href[lastOffset - hash.length] === '?' ? '?' : '';\n};\n","import {isIP} from 'node:net';\n\n/**\n * @external URL\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/URL|URL}\n */\n\n/**\n * @module utils/referrer\n * @private\n */\n\n/**\n * @see {@link https://w3c.github.io/webappsec-referrer-policy/#strip-url|Referrer Policy 8.4. Strip url for use as a referrer}\n * @param {string} URL\n * @param {boolean} [originOnly=false]\n */\nexport function stripURLForUseAsAReferrer(url, originOnly = false) {\n\t// 1. If url is null, return no referrer.\n\tif (url == null) { // eslint-disable-line no-eq-null, eqeqeq\n\t\treturn 'no-referrer';\n\t}\n\n\turl = new URL(url);\n\n\t// 2. If url's scheme is a local scheme, then return no referrer.\n\tif (/^(about|blob|data):$/.test(url.protocol)) {\n\t\treturn 'no-referrer';\n\t}\n\n\t// 3. Set url's username to the empty string.\n\turl.username = '';\n\n\t// 4. Set url's password to null.\n\t// Note: `null` appears to be a mistake as this actually results in the password being `\"null\"`.\n\turl.password = '';\n\n\t// 5. Set url's fragment to null.\n\t// Note: `null` appears to be a mistake as this actually results in the fragment being `\"#null\"`.\n\turl.hash = '';\n\n\t// 6. If the origin-only flag is true, then:\n\tif (originOnly) {\n\t\t// 6.1. Set url's path to null.\n\t\t// Note: `null` appears to be a mistake as this actually results in the path being `\"/null\"`.\n\t\turl.pathname = '';\n\n\t\t// 6.2. Set url's query to null.\n\t\t// Note: `null` appears to be a mistake as this actually results in the query being `\"?null\"`.\n\t\turl.search = '';\n\t}\n\n\t// 7. Return url.\n\treturn url;\n}\n\n/**\n * @see {@link https://w3c.github.io/webappsec-referrer-policy/#enumdef-referrerpolicy|enum ReferrerPolicy}\n */\nexport const ReferrerPolicy = new Set([\n\t'',\n\t'no-referrer',\n\t'no-referrer-when-downgrade',\n\t'same-origin',\n\t'origin',\n\t'strict-origin',\n\t'origin-when-cross-origin',\n\t'strict-origin-when-cross-origin',\n\t'unsafe-url'\n]);\n\n/**\n * @see {@link https://w3c.github.io/webappsec-referrer-policy/#default-referrer-policy|default referrer policy}\n */\nexport const DEFAULT_REFERRER_POLICY = 'strict-origin-when-cross-origin';\n\n/**\n * @see {@link https://w3c.github.io/webappsec-referrer-policy/#referrer-policies|Referrer Policy 3. Referrer Policies}\n * @param {string} referrerPolicy\n * @returns {string} referrerPolicy\n */\nexport function validateReferrerPolicy(referrerPolicy) {\n\tif (!ReferrerPolicy.has(referrerPolicy)) {\n\t\tthrow new TypeError(`Invalid referrerPolicy: ${referrerPolicy}`);\n\t}\n\n\treturn referrerPolicy;\n}\n\n/**\n * @see {@link https://w3c.github.io/webappsec-secure-contexts/#is-origin-trustworthy|Referrer Policy 3.2. Is origin potentially trustworthy?}\n * @param {external:URL} url\n * @returns `true`: \"Potentially Trustworthy\", `false`: \"Not Trustworthy\"\n */\nexport function isOriginPotentiallyTrustworthy(url) {\n\t// 1. If origin is an opaque origin, return \"Not Trustworthy\".\n\t// Not applicable\n\n\t// 2. Assert: origin is a tuple origin.\n\t// Not for implementations\n\n\t// 3. If origin's scheme is either \"https\" or \"wss\", return \"Potentially Trustworthy\".\n\tif (/^(http|ws)s:$/.test(url.protocol)) {\n\t\treturn true;\n\t}\n\n\t// 4. If origin's host component matches one of the CIDR notations 127.0.0.0/8 or ::1/128 [RFC4632], return \"Potentially Trustworthy\".\n\tconst hostIp = url.host.replace(/(^\\[)|(]$)/g, '');\n\tconst hostIPVersion = isIP(hostIp);\n\n\tif (hostIPVersion === 4 && /^127\\./.test(hostIp)) {\n\t\treturn true;\n\t}\n\n\tif (hostIPVersion === 6 && /^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(hostIp)) {\n\t\treturn true;\n\t}\n\n\t// 5. If origin's host component is \"localhost\" or falls within \".localhost\", and the user agent conforms to the name resolution rules in [let-localhost-be-localhost], return \"Potentially Trustworthy\".\n\t// We are returning FALSE here because we cannot ensure conformance to\n\t// let-localhost-be-loalhost (https://tools.ietf.org/html/draft-west-let-localhost-be-localhost)\n\tif (url.host === 'localhost' || url.host.endsWith('.localhost')) {\n\t\treturn false;\n\t}\n\n\t// 6. If origin's scheme component is file, return \"Potentially Trustworthy\".\n\tif (url.protocol === 'file:') {\n\t\treturn true;\n\t}\n\n\t// 7. If origin's scheme component is one which the user agent considers to be authenticated, return \"Potentially Trustworthy\".\n\t// Not supported\n\n\t// 8. If origin has been configured as a trustworthy origin, return \"Potentially Trustworthy\".\n\t// Not supported\n\n\t// 9. Return \"Not Trustworthy\".\n\treturn false;\n}\n\n/**\n * @see {@link https://w3c.github.io/webappsec-secure-contexts/#is-url-trustworthy|Referrer Policy 3.3. Is url potentially trustworthy?}\n * @param {external:URL} url\n * @returns `true`: \"Potentially Trustworthy\", `false`: \"Not Trustworthy\"\n */\nexport function isUrlPotentiallyTrustworthy(url) {\n\t// 1. If url is \"about:blank\" or \"about:srcdoc\", return \"Potentially Trustworthy\".\n\tif (/^about:(blank|srcdoc)$/.test(url)) {\n\t\treturn true;\n\t}\n\n\t// 2. If url's scheme is \"data\", return \"Potentially Trustworthy\".\n\tif (url.protocol === 'data:') {\n\t\treturn true;\n\t}\n\n\t// Note: The origin of blob: and filesystem: URLs is the origin of the context in which they were\n\t// created. Therefore, blobs created in a trustworthy origin will themselves be potentially\n\t// trustworthy.\n\tif (/^(blob|filesystem):$/.test(url.protocol)) {\n\t\treturn true;\n\t}\n\n\t// 3. Return the result of executing 3.2 Is origin potentially trustworthy? on url's origin.\n\treturn isOriginPotentiallyTrustworthy(url);\n}\n\n/**\n * Modifies the referrerURL to enforce any extra security policy considerations.\n * @see {@link https://w3c.github.io/webappsec-referrer-policy/#determine-requests-referrer|Referrer Policy 8.3. Determine request's Referrer}, step 7\n * @callback module:utils/referrer~referrerURLCallback\n * @param {external:URL} referrerURL\n * @returns {external:URL} modified referrerURL\n */\n\n/**\n * Modifies the referrerOrigin to enforce any extra security policy considerations.\n * @see {@link https://w3c.github.io/webappsec-referrer-policy/#determine-requests-referrer|Referrer Policy 8.3. Determine request's Referrer}, step 7\n * @callback module:utils/referrer~referrerOriginCallback\n * @param {external:URL} referrerOrigin\n * @returns {external:URL} modified referrerOrigin\n */\n\n/**\n * @see {@link https://w3c.github.io/webappsec-referrer-policy/#determine-requests-referrer|Referrer Policy 8.3. Determine request's Referrer}\n * @param {Request} request\n * @param {object} o\n * @param {module:utils/referrer~referrerURLCallback} o.referrerURLCallback\n * @param {module:utils/referrer~referrerOriginCallback} o.referrerOriginCallback\n * @returns {external:URL} Request's referrer\n */\nexport function determineRequestsReferrer(request, {referrerURLCallback, referrerOriginCallback} = {}) {\n\t// There are 2 notes in the specification about invalid pre-conditions.  We return null, here, for\n\t// these cases:\n\t// > Note: If request's referrer is \"no-referrer\", Fetch will not call into this algorithm.\n\t// > Note: If request's referrer policy is the empty string, Fetch will not call into this\n\t// > algorithm.\n\tif (request.referrer === 'no-referrer' || request.referrerPolicy === '') {\n\t\treturn null;\n\t}\n\n\t// 1. Let policy be request's associated referrer policy.\n\tconst policy = request.referrerPolicy;\n\n\t// 2. Let environment be request's client.\n\t// not applicable to node.js\n\n\t// 3. Switch on request's referrer:\n\tif (request.referrer === 'about:client') {\n\t\treturn 'no-referrer';\n\t}\n\n\t// \"a URL\": Let referrerSource be request's referrer.\n\tconst referrerSource = request.referrer;\n\n\t// 4. Let request's referrerURL be the result of stripping referrerSource for use as a referrer.\n\tlet referrerURL = stripURLForUseAsAReferrer(referrerSource);\n\n\t// 5. Let referrerOrigin be the result of stripping referrerSource for use as a referrer, with the\n\t//    origin-only flag set to true.\n\tlet referrerOrigin = stripURLForUseAsAReferrer(referrerSource, true);\n\n\t// 6. If the result of serializing referrerURL is a string whose length is greater than 4096, set\n\t//    referrerURL to referrerOrigin.\n\tif (referrerURL.toString().length > 4096) {\n\t\treferrerURL = referrerOrigin;\n\t}\n\n\t// 7. The user agent MAY alter referrerURL or referrerOrigin at this point to enforce arbitrary\n\t//    policy considerations in the interests of minimizing data leakage. For example, the user\n\t//    agent could strip the URL down to an origin, modify its host, replace it with an empty\n\t//    string, etc.\n\tif (referrerURLCallback) {\n\t\treferrerURL = referrerURLCallback(referrerURL);\n\t}\n\n\tif (referrerOriginCallback) {\n\t\treferrerOrigin = referrerOriginCallback(referrerOrigin);\n\t}\n\n\t// 8.Execute the statements corresponding to the value of policy:\n\tconst currentURL = new URL(request.url);\n\n\tswitch (policy) {\n\t\tcase 'no-referrer':\n\t\t\treturn 'no-referrer';\n\n\t\tcase 'origin':\n\t\t\treturn referrerOrigin;\n\n\t\tcase 'unsafe-url':\n\t\t\treturn referrerURL;\n\n\t\tcase 'strict-origin':\n\t\t\t// 1. If referrerURL is a potentially trustworthy URL and request's current URL is not a\n\t\t\t//    potentially trustworthy URL, then return no referrer.\n\t\t\tif (isUrlPotentiallyTrustworthy(referrerURL) && !isUrlPotentiallyTrustworthy(currentURL)) {\n\t\t\t\treturn 'no-referrer';\n\t\t\t}\n\n\t\t\t// 2. Return referrerOrigin.\n\t\t\treturn referrerOrigin.toString();\n\n\t\tcase 'strict-origin-when-cross-origin':\n\t\t\t// 1. If the origin of referrerURL and the origin of request's current URL are the same, then\n\t\t\t//    return referrerURL.\n\t\t\tif (referrerURL.origin === currentURL.origin) {\n\t\t\t\treturn referrerURL;\n\t\t\t}\n\n\t\t\t// 2. If referrerURL is a potentially trustworthy URL and request's current URL is not a\n\t\t\t//    potentially trustworthy URL, then return no referrer.\n\t\t\tif (isUrlPotentiallyTrustworthy(referrerURL) && !isUrlPotentiallyTrustworthy(currentURL)) {\n\t\t\t\treturn 'no-referrer';\n\t\t\t}\n\n\t\t\t// 3. Return referrerOrigin.\n\t\t\treturn referrerOrigin;\n\n\t\tcase 'same-origin':\n\t\t\t// 1. If the origin of referrerURL and the origin of request's current URL are the same, then\n\t\t\t//    return referrerURL.\n\t\t\tif (referrerURL.origin === currentURL.origin) {\n\t\t\t\treturn referrerURL;\n\t\t\t}\n\n\t\t\t// 2. Return no referrer.\n\t\t\treturn 'no-referrer';\n\n\t\tcase 'origin-when-cross-origin':\n\t\t\t// 1. If the origin of referrerURL and the origin of request's current URL are the same, then\n\t\t\t//    return referrerURL.\n\t\t\tif (referrerURL.origin === currentURL.origin) {\n\t\t\t\treturn referrerURL;\n\t\t\t}\n\n\t\t\t// Return referrerOrigin.\n\t\t\treturn referrerOrigin;\n\n\t\tcase 'no-referrer-when-downgrade':\n\t\t\t// 1. If referrerURL is a potentially trustworthy URL and request's current URL is not a\n\t\t\t//    potentially trustworthy URL, then return no referrer.\n\t\t\tif (isUrlPotentiallyTrustworthy(referrerURL) && !isUrlPotentiallyTrustworthy(currentURL)) {\n\t\t\t\treturn 'no-referrer';\n\t\t\t}\n\n\t\t\t// 2. Return referrerURL.\n\t\t\treturn referrerURL;\n\n\t\tdefault:\n\t\t\tthrow new TypeError(`Invalid referrerPolicy: ${policy}`);\n\t}\n}\n\n/**\n * @see {@link https://w3c.github.io/webappsec-referrer-policy/#parse-referrer-policy-from-header|Referrer Policy 8.1. Parse a referrer policy from a Referrer-Policy header}\n * @param {Headers} headers Response headers\n * @returns {string} policy\n */\nexport function parseReferrerPolicyFromHeader(headers) {\n\t// 1. Let policy-tokens be the result of extracting header list values given `Referrer-Policy`\n\t//    and responses header list.\n\tconst policyTokens = (headers.get('referrer-policy') || '').split(/[,\\s]+/);\n\n\t// 2. Let policy be the empty string.\n\tlet policy = '';\n\n\t// 3. For each token in policy-tokens, if token is a referrer policy and token is not the empty\n\t//    string, then set policy to token.\n\t// Note: This algorithm loops over multiple policy values to allow deployment of new policy\n\t// values with fallbacks for older user agents, as described in  11.1 Unknown Policy Values.\n\tfor (const token of policyTokens) {\n\t\tif (token && ReferrerPolicy.has(token)) {\n\t\t\tpolicy = token;\n\t\t}\n\t}\n\n\t// 4. Return policy.\n\treturn policy;\n}\n","/**\n * Request.js\n *\n * Request class contains server only options\n *\n * All spec algorithm step numbers are based on https://fetch.spec.whatwg.org/commit-snapshots/ae716822cb3a61843226cd090eefc6589446c1d2/.\n */\n\nimport {format as formatUrl} from 'node:url';\nimport {deprecate} from 'node:util';\nimport Headers from './headers.js';\nimport Body, {clone, extractContentType, getTotalBytes} from './body.js';\nimport {isAbortSignal} from './utils/is.js';\nimport {getSearch} from './utils/get-search.js';\nimport {\n\tvalidateReferrerPolicy, determineRequestsReferrer, DEFAULT_REFERRER_POLICY\n} from './utils/referrer.js';\n\nconst INTERNALS = Symbol('Request internals');\n\n/**\n * Check if `obj` is an instance of Request.\n *\n * @param  {*} object\n * @return {boolean}\n */\nconst isRequest = object => {\n\treturn (\n\t\ttypeof object === 'object' &&\n\t\ttypeof object[INTERNALS] === 'object'\n\t);\n};\n\nconst doBadDataWarn = deprecate(() => {},\n\t'.data is not a valid RequestInit property, use .body instead',\n\t'https://github.com/node-fetch/node-fetch/issues/1000 (request)');\n\n/**\n * Request class\n *\n * Ref: https://fetch.spec.whatwg.org/#request-class\n *\n * @param   Mixed   input  Url or Request instance\n * @param   Object  init   Custom options\n * @return  Void\n */\nexport default class Request extends Body {\n\tconstructor(input, init = {}) {\n\t\tlet parsedURL;\n\n\t\t// Normalize input and force URL to be encoded as UTF-8 (https://github.com/node-fetch/node-fetch/issues/245)\n\t\tif (isRequest(input)) {\n\t\t\tparsedURL = new URL(input.url);\n\t\t} else {\n\t\t\tparsedURL = new URL(input);\n\t\t\tinput = {};\n\t\t}\n\n\t\tif (parsedURL.username !== '' || parsedURL.password !== '') {\n\t\t\tthrow new TypeError(`${parsedURL} is an url with embedded credentials.`);\n\t\t}\n\n\t\tlet method = init.method || input.method || 'GET';\n\t\tif (/^(delete|get|head|options|post|put)$/i.test(method)) {\n\t\t\tmethod = method.toUpperCase();\n\t\t}\n\n\t\tif (!isRequest(init) && 'data' in init) {\n\t\t\tdoBadDataWarn();\n\t\t}\n\n\t\t// eslint-disable-next-line no-eq-null, eqeqeq\n\t\tif ((init.body != null || (isRequest(input) && input.body !== null)) &&\n\t\t\t(method === 'GET' || method === 'HEAD')) {\n\t\t\tthrow new TypeError('Request with GET/HEAD method cannot have body');\n\t\t}\n\n\t\tconst inputBody = init.body ?\n\t\t\tinit.body :\n\t\t\t(isRequest(input) && input.body !== null ?\n\t\t\t\tclone(input) :\n\t\t\t\tnull);\n\n\t\tsuper(inputBody, {\n\t\t\tsize: init.size || input.size || 0\n\t\t});\n\n\t\tconst headers = new Headers(init.headers || input.headers || {});\n\n\t\tif (inputBody !== null && !headers.has('Content-Type')) {\n\t\t\tconst contentType = extractContentType(inputBody, this);\n\t\t\tif (contentType) {\n\t\t\t\theaders.set('Content-Type', contentType);\n\t\t\t}\n\t\t}\n\n\t\tlet signal = isRequest(input) ?\n\t\t\tinput.signal :\n\t\t\tnull;\n\t\tif ('signal' in init) {\n\t\t\tsignal = init.signal;\n\t\t}\n\n\t\t// eslint-disable-next-line no-eq-null, eqeqeq\n\t\tif (signal != null && !isAbortSignal(signal)) {\n\t\t\tthrow new TypeError('Expected signal to be an instanceof AbortSignal or EventTarget');\n\t\t}\n\n\t\t// 5.4, Request constructor steps, step 15.1\n\t\t// eslint-disable-next-line no-eq-null, eqeqeq\n\t\tlet referrer = init.referrer == null ? input.referrer : init.referrer;\n\t\tif (referrer === '') {\n\t\t\t// 5.4, Request constructor steps, step 15.2\n\t\t\treferrer = 'no-referrer';\n\t\t} else if (referrer) {\n\t\t\t// 5.4, Request constructor steps, step 15.3.1, 15.3.2\n\t\t\tconst parsedReferrer = new URL(referrer);\n\t\t\t// 5.4, Request constructor steps, step 15.3.3, 15.3.4\n\t\t\treferrer = /^about:(\\/\\/)?client$/.test(parsedReferrer) ? 'client' : parsedReferrer;\n\t\t} else {\n\t\t\treferrer = undefined;\n\t\t}\n\n\t\tthis[INTERNALS] = {\n\t\t\tmethod,\n\t\t\tredirect: init.redirect || input.redirect || 'follow',\n\t\t\theaders,\n\t\t\tparsedURL,\n\t\t\tsignal,\n\t\t\treferrer\n\t\t};\n\n\t\t// Node-fetch-only options\n\t\tthis.follow = init.follow === undefined ? (input.follow === undefined ? 20 : input.follow) : init.follow;\n\t\tthis.compress = init.compress === undefined ? (input.compress === undefined ? true : input.compress) : init.compress;\n\t\tthis.counter = init.counter || input.counter || 0;\n\t\tthis.agent = init.agent || input.agent;\n\t\tthis.highWaterMark = init.highWaterMark || input.highWaterMark || 16384;\n\t\tthis.insecureHTTPParser = init.insecureHTTPParser || input.insecureHTTPParser || false;\n\n\t\t// 5.4, Request constructor steps, step 16.\n\t\t// Default is empty string per https://fetch.spec.whatwg.org/#concept-request-referrer-policy\n\t\tthis.referrerPolicy = init.referrerPolicy || input.referrerPolicy || '';\n\t}\n\n\t/** @returns {string} */\n\tget method() {\n\t\treturn this[INTERNALS].method;\n\t}\n\n\t/** @returns {string} */\n\tget url() {\n\t\treturn formatUrl(this[INTERNALS].parsedURL);\n\t}\n\n\t/** @returns {Headers} */\n\tget headers() {\n\t\treturn this[INTERNALS].headers;\n\t}\n\n\tget redirect() {\n\t\treturn this[INTERNALS].redirect;\n\t}\n\n\t/** @returns {AbortSignal} */\n\tget signal() {\n\t\treturn this[INTERNALS].signal;\n\t}\n\n\t// https://fetch.spec.whatwg.org/#dom-request-referrer\n\tget referrer() {\n\t\tif (this[INTERNALS].referrer === 'no-referrer') {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (this[INTERNALS].referrer === 'client') {\n\t\t\treturn 'about:client';\n\t\t}\n\n\t\tif (this[INTERNALS].referrer) {\n\t\t\treturn this[INTERNALS].referrer.toString();\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tget referrerPolicy() {\n\t\treturn this[INTERNALS].referrerPolicy;\n\t}\n\n\tset referrerPolicy(referrerPolicy) {\n\t\tthis[INTERNALS].referrerPolicy = validateReferrerPolicy(referrerPolicy);\n\t}\n\n\t/**\n\t * Clone this request\n\t *\n\t * @return  Request\n\t */\n\tclone() {\n\t\treturn new Request(this);\n\t}\n\n\tget [Symbol.toStringTag]() {\n\t\treturn 'Request';\n\t}\n}\n\nObject.defineProperties(Request.prototype, {\n\tmethod: {enumerable: true},\n\turl: {enumerable: true},\n\theaders: {enumerable: true},\n\tredirect: {enumerable: true},\n\tclone: {enumerable: true},\n\tsignal: {enumerable: true},\n\treferrer: {enumerable: true},\n\treferrerPolicy: {enumerable: true}\n});\n\n/**\n * Convert a Request to Node.js http request options.\n *\n * @param {Request} request - A Request instance\n * @return The options object to be passed to http.request\n */\nexport const getNodeRequestOptions = request => {\n\tconst {parsedURL} = request[INTERNALS];\n\tconst headers = new Headers(request[INTERNALS].headers);\n\n\t// Fetch step 1.3\n\tif (!headers.has('Accept')) {\n\t\theaders.set('Accept', '*/*');\n\t}\n\n\t// HTTP-network-or-cache fetch steps 2.4-2.7\n\tlet contentLengthValue = null;\n\tif (request.body === null && /^(post|put)$/i.test(request.method)) {\n\t\tcontentLengthValue = '0';\n\t}\n\n\tif (request.body !== null) {\n\t\tconst totalBytes = getTotalBytes(request);\n\t\t// Set Content-Length if totalBytes is a number (that is not NaN)\n\t\tif (typeof totalBytes === 'number' && !Number.isNaN(totalBytes)) {\n\t\t\tcontentLengthValue = String(totalBytes);\n\t\t}\n\t}\n\n\tif (contentLengthValue) {\n\t\theaders.set('Content-Length', contentLengthValue);\n\t}\n\n\t// 4.1. Main fetch, step 2.6\n\t// > If request's referrer policy is the empty string, then set request's referrer policy to the\n\t// > default referrer policy.\n\tif (request.referrerPolicy === '') {\n\t\trequest.referrerPolicy = DEFAULT_REFERRER_POLICY;\n\t}\n\n\t// 4.1. Main fetch, step 2.7\n\t// > If request's referrer is not \"no-referrer\", set request's referrer to the result of invoking\n\t// > determine request's referrer.\n\tif (request.referrer && request.referrer !== 'no-referrer') {\n\t\trequest[INTERNALS].referrer = determineRequestsReferrer(request);\n\t} else {\n\t\trequest[INTERNALS].referrer = 'no-referrer';\n\t}\n\n\t// 4.5. HTTP-network-or-cache fetch, step 6.9\n\t// > If httpRequest's referrer is a URL, then append `Referer`/httpRequest's referrer, serialized\n\t// >  and isomorphic encoded, to httpRequest's header list.\n\tif (request[INTERNALS].referrer instanceof URL) {\n\t\theaders.set('Referer', request.referrer);\n\t}\n\n\t// HTTP-network-or-cache fetch step 2.11\n\tif (!headers.has('User-Agent')) {\n\t\theaders.set('User-Agent', 'node-fetch');\n\t}\n\n\t// HTTP-network-or-cache fetch step 2.15\n\tif (request.compress && !headers.has('Accept-Encoding')) {\n\t\theaders.set('Accept-Encoding', 'gzip, deflate, br');\n\t}\n\n\tlet {agent} = request;\n\tif (typeof agent === 'function') {\n\t\tagent = agent(parsedURL);\n\t}\n\n\t// HTTP-network fetch step 4.2\n\t// chunked encoding is handled by Node.js\n\n\tconst search = getSearch(parsedURL);\n\n\t// Pass the full URL directly to request(), but overwrite the following\n\t// options:\n\tconst options = {\n\t\t// Overwrite search to retain trailing ? (issue #776)\n\t\tpath: parsedURL.pathname + search,\n\t\t// The following options are not expressed in the URL\n\t\tmethod: request.method,\n\t\theaders: headers[Symbol.for('nodejs.util.inspect.custom')](),\n\t\tinsecureHTTPParser: request.insecureHTTPParser,\n\t\tagent\n\t};\n\n\treturn {\n\t\t/** @type {URL} */\n\t\tparsedURL,\n\t\toptions\n\t};\n};\n","import {FetchBaseError} from './base.js';\n\n/**\n * AbortError interface for cancelled requests\n */\nexport class AbortError extends FetchBaseError {\n\tconstructor(message, type = 'aborted') {\n\t\tsuper(message, type);\n\t}\n}\n","/**\n * Index.js\n *\n * a request API compatible with window.fetch\n *\n * All spec algorithm step numbers are based on https://fetch.spec.whatwg.org/commit-snapshots/ae716822cb3a61843226cd090eefc6589446c1d2/.\n */\n\nimport http from 'node:http';\nimport https from 'node:https';\nimport zlib from 'node:zlib';\nimport Stream, {PassThrough, pipeline as pump} from 'node:stream';\nimport {Buffer} from 'node:buffer';\n\nimport dataUriToBuffer from 'data-uri-to-buffer';\n\nimport {writeToStream, clone} from './body.js';\nimport Response from './response.js';\nimport Headers, {fromRawHeaders} from './headers.js';\nimport Request, {getNodeRequestOptions} from './request.js';\nimport {FetchError} from './errors/fetch-error.js';\nimport {AbortError} from './errors/abort-error.js';\nimport {isRedirect} from './utils/is-redirect.js';\nimport {FormData} from 'formdata-polyfill/esm.min.js';\nimport {isDomainOrSubdomain, isSameProtocol} from './utils/is.js';\nimport {parseReferrerPolicyFromHeader} from './utils/referrer.js';\nimport {\n\tBlob,\n\tFile,\n\tfileFromSync,\n\tfileFrom,\n\tblobFromSync,\n\tblobFrom\n} from 'fetch-blob/from.js';\n\nexport {FormData, Headers, Request, Response, FetchError, AbortError, isRedirect};\nexport {Blob, File, fileFromSync, fileFrom, blobFromSync, blobFrom};\n\nconst supportedSchemas = new Set(['data:', 'http:', 'https:']);\n\n/**\n * Fetch function\n *\n * @param   {string | URL | import('./request').default} url - Absolute url or Request instance\n * @param   {*} [options_] - Fetch options\n * @return  {Promise<import('./response').default>}\n */\nexport default async function fetch(url, options_) {\n\treturn new Promise((resolve, reject) => {\n\t\t// Build request object\n\t\tconst request = new Request(url, options_);\n\t\tconst {parsedURL, options} = getNodeRequestOptions(request);\n\t\tif (!supportedSchemas.has(parsedURL.protocol)) {\n\t\t\tthrow new TypeError(`node-fetch cannot load ${url}. URL scheme \"${parsedURL.protocol.replace(/:$/, '')}\" is not supported.`);\n\t\t}\n\n\t\tif (parsedURL.protocol === 'data:') {\n\t\t\tconst data = dataUriToBuffer(request.url);\n\t\t\tconst response = new Response(data, {headers: {'Content-Type': data.typeFull}});\n\t\t\tresolve(response);\n\t\t\treturn;\n\t\t}\n\n\t\t// Wrap http.request into fetch\n\t\tconst send = (parsedURL.protocol === 'https:' ? https : http).request;\n\t\tconst {signal} = request;\n\t\tlet response = null;\n\n\t\tconst abort = () => {\n\t\t\tconst error = new AbortError('The operation was aborted.');\n\t\t\treject(error);\n\t\t\tif (request.body && request.body instanceof Stream.Readable) {\n\t\t\t\trequest.body.destroy(error);\n\t\t\t}\n\n\t\t\tif (!response || !response.body) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tresponse.body.emit('error', error);\n\t\t};\n\n\t\tif (signal && signal.aborted) {\n\t\t\tabort();\n\t\t\treturn;\n\t\t}\n\n\t\tconst abortAndFinalize = () => {\n\t\t\tabort();\n\t\t\tfinalize();\n\t\t};\n\n\t\t// Send request\n\t\tconst request_ = send(parsedURL.toString(), options);\n\n\t\tif (signal) {\n\t\t\tsignal.addEventListener('abort', abortAndFinalize);\n\t\t}\n\n\t\tconst finalize = () => {\n\t\t\trequest_.abort();\n\t\t\tif (signal) {\n\t\t\t\tsignal.removeEventListener('abort', abortAndFinalize);\n\t\t\t}\n\t\t};\n\n\t\trequest_.on('error', error => {\n\t\t\treject(new FetchError(`request to ${request.url} failed, reason: ${error.message}`, 'system', error));\n\t\t\tfinalize();\n\t\t});\n\n\t\tfixResponseChunkedTransferBadEnding(request_, error => {\n\t\t\tif (response && response.body) {\n\t\t\t\tresponse.body.destroy(error);\n\t\t\t}\n\t\t});\n\n\t\t/* c8 ignore next 18 */\n\t\tif (process.version < 'v14') {\n\t\t\t// Before Node.js 14, pipeline() does not fully support async iterators and does not always\n\t\t\t// properly handle when the socket close/end events are out of order.\n\t\t\trequest_.on('socket', s => {\n\t\t\t\tlet endedWithEventsCount;\n\t\t\t\ts.prependListener('end', () => {\n\t\t\t\t\tendedWithEventsCount = s._eventsCount;\n\t\t\t\t});\n\t\t\t\ts.prependListener('close', hadError => {\n\t\t\t\t\t// if end happened before close but the socket didn't emit an error, do it now\n\t\t\t\t\tif (response && endedWithEventsCount < s._eventsCount && !hadError) {\n\t\t\t\t\t\tconst error = new Error('Premature close');\n\t\t\t\t\t\terror.code = 'ERR_STREAM_PREMATURE_CLOSE';\n\t\t\t\t\t\tresponse.body.emit('error', error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\trequest_.on('response', response_ => {\n\t\t\trequest_.setTimeout(0);\n\t\t\tconst headers = fromRawHeaders(response_.rawHeaders);\n\n\t\t\t// HTTP fetch step 5\n\t\t\tif (isRedirect(response_.statusCode)) {\n\t\t\t\t// HTTP fetch step 5.2\n\t\t\t\tconst location = headers.get('Location');\n\n\t\t\t\t// HTTP fetch step 5.3\n\t\t\t\tlet locationURL = null;\n\t\t\t\ttry {\n\t\t\t\t\tlocationURL = location === null ? null : new URL(location, request.url);\n\t\t\t\t} catch {\n\t\t\t\t\t// error here can only be invalid URL in Location: header\n\t\t\t\t\t// do not throw when options.redirect == manual\n\t\t\t\t\t// let the user extract the errorneous redirect URL\n\t\t\t\t\tif (request.redirect !== 'manual') {\n\t\t\t\t\t\treject(new FetchError(`uri requested responds with an invalid redirect URL: ${location}`, 'invalid-redirect'));\n\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// HTTP fetch step 5.5\n\t\t\t\tswitch (request.redirect) {\n\t\t\t\t\tcase 'error':\n\t\t\t\t\t\treject(new FetchError(`uri requested responds with a redirect, redirect mode is set to error: ${request.url}`, 'no-redirect'));\n\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\treturn;\n\t\t\t\t\tcase 'manual':\n\t\t\t\t\t\t// Nothing to do\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'follow': {\n\t\t\t\t\t\t// HTTP-redirect fetch step 2\n\t\t\t\t\t\tif (locationURL === null) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 5\n\t\t\t\t\t\tif (request.counter >= request.follow) {\n\t\t\t\t\t\t\treject(new FetchError(`maximum redirect reached at: ${request.url}`, 'max-redirect'));\n\t\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 6 (counter increment)\n\t\t\t\t\t\t// Create a new Request object.\n\t\t\t\t\t\tconst requestOptions = {\n\t\t\t\t\t\t\theaders: new Headers(request.headers),\n\t\t\t\t\t\t\tfollow: request.follow,\n\t\t\t\t\t\t\tcounter: request.counter + 1,\n\t\t\t\t\t\t\tagent: request.agent,\n\t\t\t\t\t\t\tcompress: request.compress,\n\t\t\t\t\t\t\tmethod: request.method,\n\t\t\t\t\t\t\tbody: clone(request),\n\t\t\t\t\t\t\tsignal: request.signal,\n\t\t\t\t\t\t\tsize: request.size,\n\t\t\t\t\t\t\treferrer: request.referrer,\n\t\t\t\t\t\t\treferrerPolicy: request.referrerPolicy\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// when forwarding sensitive headers like \"Authorization\",\n\t\t\t\t\t\t// \"WWW-Authenticate\", and \"Cookie\" to untrusted targets,\n\t\t\t\t\t\t// headers will be ignored when following a redirect to a domain\n\t\t\t\t\t\t// that is not a subdomain match or exact match of the initial domain.\n\t\t\t\t\t\t// For example, a redirect from \"foo.com\" to either \"foo.com\" or \"sub.foo.com\"\n\t\t\t\t\t\t// will forward the sensitive headers, but a redirect to \"bar.com\" will not.\n\t\t\t\t\t\t// headers will also be ignored when following a redirect to a domain using\n\t\t\t\t\t\t// a different protocol. For example, a redirect from \"https://foo.com\" to \"http://foo.com\"\n\t\t\t\t\t\t// will not forward the sensitive headers\n\t\t\t\t\t\tif (!isDomainOrSubdomain(request.url, locationURL) || !isSameProtocol(request.url, locationURL)) {\n\t\t\t\t\t\t\tfor (const name of ['authorization', 'www-authenticate', 'cookie', 'cookie2']) {\n\t\t\t\t\t\t\t\trequestOptions.headers.delete(name);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 9\n\t\t\t\t\t\tif (response_.statusCode !== 303 && request.body && options_.body instanceof Stream.Readable) {\n\t\t\t\t\t\t\treject(new FetchError('Cannot follow redirect with body being a readable stream', 'unsupported-redirect'));\n\t\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 11\n\t\t\t\t\t\tif (response_.statusCode === 303 || ((response_.statusCode === 301 || response_.statusCode === 302) && request.method === 'POST')) {\n\t\t\t\t\t\t\trequestOptions.method = 'GET';\n\t\t\t\t\t\t\trequestOptions.body = undefined;\n\t\t\t\t\t\t\trequestOptions.headers.delete('content-length');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 14\n\t\t\t\t\t\tconst responseReferrerPolicy = parseReferrerPolicyFromHeader(headers);\n\t\t\t\t\t\tif (responseReferrerPolicy) {\n\t\t\t\t\t\t\trequestOptions.referrerPolicy = responseReferrerPolicy;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 15\n\t\t\t\t\t\tresolve(fetch(new Request(locationURL, requestOptions)));\n\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn reject(new TypeError(`Redirect option '${request.redirect}' is not a valid value of RequestRedirect`));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Prepare response\n\t\t\tif (signal) {\n\t\t\t\tresponse_.once('end', () => {\n\t\t\t\t\tsignal.removeEventListener('abort', abortAndFinalize);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tlet body = pump(response_, new PassThrough(), error => {\n\t\t\t\tif (error) {\n\t\t\t\t\treject(error);\n\t\t\t\t}\n\t\t\t});\n\t\t\t// see https://github.com/nodejs/node/pull/29376\n\t\t\t/* c8 ignore next 3 */\n\t\t\tif (process.version < 'v12.10') {\n\t\t\t\tresponse_.on('aborted', abortAndFinalize);\n\t\t\t}\n\n\t\t\tconst responseOptions = {\n\t\t\t\turl: request.url,\n\t\t\t\tstatus: response_.statusCode,\n\t\t\t\tstatusText: response_.statusMessage,\n\t\t\t\theaders,\n\t\t\t\tsize: request.size,\n\t\t\t\tcounter: request.counter,\n\t\t\t\thighWaterMark: request.highWaterMark\n\t\t\t};\n\n\t\t\t// HTTP-network fetch step 12.1.1.3\n\t\t\tconst codings = headers.get('Content-Encoding');\n\n\t\t\t// HTTP-network fetch step 12.1.1.4: handle content codings\n\n\t\t\t// in following scenarios we ignore compression support\n\t\t\t// 1. compression support is disabled\n\t\t\t// 2. HEAD request\n\t\t\t// 3. no Content-Encoding header\n\t\t\t// 4. no content response (204)\n\t\t\t// 5. content not modified response (304)\n\t\t\tif (!request.compress || request.method === 'HEAD' || codings === null || response_.statusCode === 204 || response_.statusCode === 304) {\n\t\t\t\tresponse = new Response(body, responseOptions);\n\t\t\t\tresolve(response);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// For Node v6+\n\t\t\t// Be less strict when decoding compressed responses, since sometimes\n\t\t\t// servers send slightly invalid responses that are still accepted\n\t\t\t// by common browsers.\n\t\t\t// Always using Z_SYNC_FLUSH is what cURL does.\n\t\t\tconst zlibOptions = {\n\t\t\t\tflush: zlib.Z_SYNC_FLUSH,\n\t\t\t\tfinishFlush: zlib.Z_SYNC_FLUSH\n\t\t\t};\n\n\t\t\t// For gzip\n\t\t\tif (codings === 'gzip' || codings === 'x-gzip') {\n\t\t\t\tbody = pump(body, zlib.createGunzip(zlibOptions), error => {\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\treject(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tresponse = new Response(body, responseOptions);\n\t\t\t\tresolve(response);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// For deflate\n\t\t\tif (codings === 'deflate' || codings === 'x-deflate') {\n\t\t\t\t// Handle the infamous raw deflate response from old servers\n\t\t\t\t// a hack for old IIS and Apache servers\n\t\t\t\tconst raw = pump(response_, new PassThrough(), error => {\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\treject(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\traw.once('data', chunk => {\n\t\t\t\t\t// See http://stackoverflow.com/questions/37519828\n\t\t\t\t\tif ((chunk[0] & 0x0F) === 0x08) {\n\t\t\t\t\t\tbody = pump(body, zlib.createInflate(), error => {\n\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\treject(error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbody = pump(body, zlib.createInflateRaw(), error => {\n\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\treject(error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tresponse = new Response(body, responseOptions);\n\t\t\t\t\tresolve(response);\n\t\t\t\t});\n\t\t\t\traw.once('end', () => {\n\t\t\t\t\t// Some old IIS servers return zero-length OK deflate responses, so\n\t\t\t\t\t// 'data' is never emitted. See https://github.com/node-fetch/node-fetch/pull/903\n\t\t\t\t\tif (!response) {\n\t\t\t\t\t\tresponse = new Response(body, responseOptions);\n\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// For br\n\t\t\tif (codings === 'br') {\n\t\t\t\tbody = pump(body, zlib.createBrotliDecompress(), error => {\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\treject(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tresponse = new Response(body, responseOptions);\n\t\t\t\tresolve(response);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Otherwise, use response as-is\n\t\t\tresponse = new Response(body, responseOptions);\n\t\t\tresolve(response);\n\t\t});\n\n\t\t// eslint-disable-next-line promise/prefer-await-to-then\n\t\twriteToStream(request_, request).catch(reject);\n\t});\n}\n\nfunction fixResponseChunkedTransferBadEnding(request, errorCallback) {\n\tconst LAST_CHUNK = Buffer.from('0\\r\\n\\r\\n');\n\n\tlet isChunkedTransfer = false;\n\tlet properLastChunkReceived = false;\n\tlet previousChunk;\n\n\trequest.on('response', response => {\n\t\tconst {headers} = response;\n\t\tisChunkedTransfer = headers['transfer-encoding'] === 'chunked' && !headers['content-length'];\n\t});\n\n\trequest.on('socket', socket => {\n\t\tconst onSocketClose = () => {\n\t\t\tif (isChunkedTransfer && !properLastChunkReceived) {\n\t\t\t\tconst error = new Error('Premature close');\n\t\t\t\terror.code = 'ERR_STREAM_PREMATURE_CLOSE';\n\t\t\t\terrorCallback(error);\n\t\t\t}\n\t\t};\n\n\t\tconst onData = buf => {\n\t\t\tproperLastChunkReceived = Buffer.compare(buf.slice(-5), LAST_CHUNK) === 0;\n\n\t\t\t// Sometimes final 0-length chunk and end of message code are in separate packets\n\t\t\tif (!properLastChunkReceived && previousChunk) {\n\t\t\t\tproperLastChunkReceived = (\n\t\t\t\t\tBuffer.compare(previousChunk.slice(-3), LAST_CHUNK.slice(0, 3)) === 0 &&\n\t\t\t\t\tBuffer.compare(buf.slice(-2), LAST_CHUNK.slice(3)) === 0\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tpreviousChunk = buf;\n\t\t};\n\n\t\tsocket.prependListener('close', onSocketClose);\n\t\tsocket.on('data', onData);\n\n\t\trequest.on('close', () => {\n\t\t\tsocket.removeListener('close', onSocketClose);\n\t\t\tsocket.removeListener('data', onData);\n\t\t});\n\t});\n}\n","import { resolveRegistryUrl } from \"@/src/registry/builder\"\r\nimport { getRegistryHeadersFromContext } from \"@/src/registry/context\"\r\nimport {\r\n  RegistryFetchError,\r\n  RegistryForbiddenError,\r\n  RegistryLocalFileError,\r\n  RegistryNotFoundError,\r\n  RegistryParseError,\r\n  RegistryUnauthorizedError,\r\n} from \"@/src/registry/errors\"\r\nimport { registryItemSchema } from \"@/src/schema\"\r\nimport { promises as fs } from \"fs\"\r\nimport { HttpsProxyAgent } from \"https-proxy-agent\"\r\nimport fetch from \"node-fetch\"\r\nimport { homedir } from \"os\"\r\nimport path from \"path\"\r\nimport { z } from \"zod\"\r\n\r\nconst agent = process.env.https_proxy\r\n  ? new HttpsProxyAgent(process.env.https_proxy)\r\n  : undefined\r\n\r\nconst registryCache = new Map<string, Promise<any>>()\r\n\r\nexport function clearRegistryCache() {\r\n  registryCache.clear()\r\n}\r\n\r\nexport async function fetchRegistry(\r\n  paths: string[],\r\n  options: { useCache?: boolean } = {}\r\n) {\r\n  options = {\r\n    useCache: true,\r\n    ...options,\r\n  }\r\n\r\n  try {\r\n    const results = await Promise.all(\r\n      paths.map(async (path) => {\r\n        const url = resolveRegistryUrl(path)\r\n\r\n        // Check cache first if caching is enabled\r\n        if (options.useCache && registryCache.has(url)) {\r\n          return registryCache.get(url)\r\n        }\r\n\r\n        // Store the promise in the cache before awaiting if caching is enabled.\r\n        const fetchPromise = (async () => {\r\n          // Get headers from context for this URL.\r\n          const headers = getRegistryHeadersFromContext(url)\r\n\r\n          const response = await fetch(url, {\r\n            agent,\r\n            headers: {\r\n              ...headers,\r\n            },\r\n          })\r\n\r\n          if (!response.ok) {\r\n            let messageFromServer = undefined\r\n\r\n            if (\r\n              response.headers.get(\"content-type\")?.includes(\"application/json\")\r\n            ) {\r\n              const json = await response.json()\r\n              const parsed = z\r\n                .object({\r\n                  // RFC 7807.\r\n                  detail: z.string().optional(),\r\n                  title: z.string().optional(),\r\n                  // Standard error response.\r\n                  message: z.string().optional(),\r\n                  error: z.string().optional(),\r\n                })\r\n                .safeParse(json)\r\n\r\n              if (parsed.success) {\r\n                // Prefer RFC 7807 detail field, then message field.\r\n                messageFromServer = parsed.data.detail || parsed.data.message\r\n\r\n                if (parsed.data.error) {\r\n                  messageFromServer = `[${parsed.data.error}] ${messageFromServer}`\r\n                }\r\n              }\r\n            }\r\n\r\n            if (response.status === 401) {\r\n              throw new RegistryUnauthorizedError(url, messageFromServer)\r\n            }\r\n\r\n            if (response.status === 404) {\r\n              throw new RegistryNotFoundError(url, messageFromServer)\r\n            }\r\n\r\n            if (response.status === 403) {\r\n              throw new RegistryForbiddenError(url, messageFromServer)\r\n            }\r\n\r\n            throw new RegistryFetchError(\r\n              url,\r\n              response.status,\r\n              messageFromServer\r\n            )\r\n          }\r\n\r\n          return response.json()\r\n        })()\r\n\r\n        if (options.useCache) {\r\n          registryCache.set(url, fetchPromise)\r\n        }\r\n        return fetchPromise\r\n      })\r\n    )\r\n\r\n    return results\r\n  } catch (error) {\r\n    throw error\r\n  }\r\n}\r\n\r\nexport async function fetchRegistryLocal(filePath: string) {\r\n  try {\r\n    // Handle tilde expansion for home directory\r\n    let expandedPath = filePath\r\n    if (filePath.startsWith(\"~/\")) {\r\n      expandedPath = path.join(homedir(), filePath.slice(2))\r\n    }\r\n\r\n    const resolvedPath = path.resolve(expandedPath)\r\n    const content = await fs.readFile(resolvedPath, \"utf8\")\r\n    const parsed = JSON.parse(content)\r\n\r\n    try {\r\n      return registryItemSchema.parse(parsed)\r\n    } catch (error) {\r\n      throw new RegistryParseError(filePath, error)\r\n    }\r\n  } catch (error) {\r\n    // Check if this is a file not found error\r\n    if (\r\n      error instanceof Error &&\r\n      (error.message.includes(\"ENOENT\") ||\r\n        error.message.includes(\"no such file\"))\r\n    ) {\r\n      throw new RegistryLocalFileError(filePath, error)\r\n    }\r\n    // Re-throw parse errors as-is\r\n    if (error instanceof RegistryParseError) {\r\n      throw error\r\n    }\r\n    // For other errors (like JSON parse errors), throw as local file error\r\n    throw new RegistryLocalFileError(filePath, error)\r\n  }\r\n}\r\n","// Internal function that fetches registry items without clearing context.\r\n\r\nimport { Config } from \"../utils/get-config\";\r\nimport { buildUrlAndHeadersForRegistryItem } from \"./builder\";\r\nimport { setRegistryHeaders } from \"./context\";\r\nimport { RegistryParseError } from \"./errors\";\r\nimport { fetchRegistry, fetchRegistryLocal } from \"./fetcher\";\r\nimport { registryItemSchema } from \"./schema\";\r\nimport { isLocalFile, isUrl } from \"./utils\";\r\n\r\nexport function resolveRegistryItemsFromRegistries(\r\n  items: string[],\r\n  config: Config\r\n) {\r\n  const registryHeaders: Record<string, Record<string, string>> = {};\r\n  const resolvedItems = [...items];\r\n\r\n  if (!config?.registries) {\r\n    setRegistryHeaders({});\r\n    return resolvedItems;\r\n  }\r\n\r\n  for (let i = 0; i < resolvedItems.length; i++) {\r\n    const resolved = buildUrlAndHeadersForRegistryItem(resolvedItems[i], config);\r\n\r\n    if (resolved) {\r\n      resolvedItems[i] = resolved.url;\r\n\r\n      if (Object.keys(resolved.headers).length > 0) {\r\n        registryHeaders[resolved.url] = resolved.headers;\r\n      }\r\n    }\r\n  }\r\n\r\n  setRegistryHeaders(registryHeaders);\r\n\r\n  return resolvedItems;\r\n}\r\n\r\n// This is used for recursive dependecy resolution.\r\nexport async function fetchRegistryItems(\r\n  items: string[],\r\n  config: Config,\r\n  options: { useCache?: boolean } = {}\r\n) {\r\n  const results = await Promise.all(\r\n    items.map(async (item) => {\r\n      if (isLocalFile(item)) {\r\n        return fetchRegistryLocal(item);\r\n      }\r\n\r\n      if (isUrl(item)) {\r\n        const [result] = await fetchRegistry([item], options);\r\n        try {\r\n          return registryItemSchema.parse(result);\r\n        } catch (error) {\r\n          throw new RegistryParseError(item, error);\r\n        }\r\n      }\r\n\r\n      if (item.startsWith(\"@\") && config?.registries) {\r\n        const paths = resolveRegistryItemsFromRegistries([item], config);\r\n        const [result] = await fetchRegistry(paths, options);\r\n        try {\r\n          return registryItemSchema.parse(result);\r\n        } catch (error) {\r\n          throw new RegistryParseError(item, error);\r\n        }\r\n      }\r\n\r\n\r\n      const path = `styles/${config?.style ?? \"aodesu\"}/${item}.json`;\r\n      const [result] = await fetchRegistry([path], options);\r\n        console.log(\"TEST - LLEGO AKI\")\r\n      try {\r\n        return registryItemSchema.parse(result);\r\n      } catch (error) {\r\n        throw new RegistryParseError(item, error);\r\n      }\r\n    })\r\n  )\r\n\r\n  return results;\r\n}\r\n","import z from \"zod\";\r\nimport { Config } from \"../utils/get-config\";\r\nimport { handleError } from \"../utils/handle-error\";\r\nimport { logger } from \"../utils/logger\";\r\nimport { buildUrlAndHeadersForRegistryItem } from \"./builder\";\r\nimport { configWithDefaults } from \"./config\";\r\nimport { REGISTRY_URL } from \"./constants\";\r\nimport { clearRegistryContext, setRegistryHeaders } from \"./context\";\r\nimport { RegistriesIndexParseError, RegistryInvalidNamespaceError, RegistryNotFoundError, RegistryParseError } from \"./errors\";\r\nimport { fetchRegistry } from \"./fetcher\";\r\nimport { fetchRegistryItems } from \"./resolver\";\r\nimport { registriesIndexSchema, registryIndexSchema, registrySchema } from \"./schema\";\r\nimport { isUrl } from \"./utils\";\r\n\r\nexport async function getRegistry(\r\n  name: string,\r\n  options?: {\r\n    config?: Partial<Config>\r\n    useCache?: boolean\r\n  }\r\n) {\r\n  const { config, useCache } = options || {};\r\n\r\n  if (isUrl(name)) {\r\n    const [result] = await fetchRegistry([name], { useCache });\r\n    try {\r\n      return registrySchema.parse(result);\r\n    } catch (error) {\r\n      throw new RegistryParseError(name, error);\r\n    }\r\n  }\r\n\r\n  if (!name.startsWith(\"@\")) {\r\n    throw new RegistryInvalidNamespaceError(name);\r\n  }\r\n\r\n  let registryName = name;\r\n  if (!registryName.endsWith(\"/registry\")) {\r\n    registryName = `${registryName}/registry`\r\n  }\r\n\r\n  const urlAndHeaders = buildUrlAndHeadersForRegistryItem(\r\n    registryName as `@${string}`,\r\n    configWithDefaults(config)\r\n  );\r\n\r\n  if (!urlAndHeaders?.url) {\r\n    throw new RegistryNotFoundError(registryName);\r\n  }\r\n\r\n  if (urlAndHeaders.headers && Object.keys(urlAndHeaders.headers).length > 0) {\r\n    setRegistryHeaders({\r\n      [urlAndHeaders.url]: urlAndHeaders.headers,\r\n    })\r\n  }\r\n\r\n  const [result] = await fetchRegistry([urlAndHeaders.url], { useCache });\r\n\r\n  try {\r\n    return registrySchema.parse(result);\r\n  } catch (error) {\r\n    throw new RegistryParseError(registryName, error);\r\n  }\r\n}\r\n\r\nexport async function getRegistryItems(\r\n  items: string[],\r\n  options?: {\r\n    config?: Partial<Config>\r\n    useCache?: boolean\r\n  }\r\n) {\r\n  const { config, useCache } = options || {};\r\n\r\n  clearRegistryContext();\r\n\r\n  return fetchRegistryItems(items, configWithDefaults(config), { useCache })\r\n}\r\n\r\n\r\nexport async function getShadcnRegistryIndex() {\r\n  try {\r\n    const [result] = await fetchRegistry([\"index.json\"])\r\n\r\n    return registryIndexSchema.parse(result)\r\n  } catch (error) {\r\n    logger.error(\"\\n\")\r\n    handleError(error)\r\n  }\r\n}\r\n\r\n\r\nexport async function getRegistriesIndex(options?: { useCache?: boolean }) {\r\n  options = {\r\n    useCache: true,\r\n    ...options,\r\n  }\r\n\r\n  const url = `${REGISTRY_URL}/registries.json`\r\n  const [data] = await fetchRegistry([url], {\r\n    useCache: options.useCache,\r\n  })\r\n\r\n  try {\r\n    return registriesIndexSchema.parse(data)\r\n  } catch (error) {\r\n    if (error instanceof z.ZodError) {\r\n      throw new RegistriesIndexParseError(error)\r\n    }\r\n\r\n    throw error\r\n  }\r\n}\r\n","import { existsSync } from \"fs\";\r\nimport { join } from \"path\";\r\nimport { logger } from \"./logger\";\r\n\r\nexport async function loadEnvFiles(cwd: string = process.cwd()): Promise<void> {\r\n  try {\r\n    const { config } = await import(\"@dotenvx/dotenvx\");\r\n    const envFiles = [\r\n      \".env.local\",\r\n      \".env.development.local\",\r\n      \".env.development\",\r\n      \".env\"\r\n    ];\r\n\r\n    for (const envFile of envFiles) {\r\n      const envPath = join(cwd, envFile);\r\n      if (existsSync(envPath)) {\r\n        config({\r\n          path: envPath,\r\n          overload: false,\r\n          quiet: true\r\n        })\r\n      }\r\n    }\r\n  } catch (error) {\r\n    logger.warn(\"Failed to load env files:\", error);\r\n  }\r\n}\r\n","import fsExtra from \"fs-extra\"\r\n\r\nexport const FILE_BACKUP_SUFFIX = \".bak\"\r\n\r\nexport function createFileBackup(filePath: string): string | null {\r\n  if (!fsExtra.existsSync(filePath)) {\r\n    return null\r\n  }\r\n\r\n  const backupPath = `${filePath}${FILE_BACKUP_SUFFIX}`\r\n  try {\r\n    fsExtra.renameSync(filePath, backupPath)\r\n    return backupPath\r\n  } catch (error) {\r\n    console.error(`Failed to create backup of ${filePath}: ${error}`)\r\n    return null\r\n  }\r\n}\r\n\r\nexport function restoreFileBackup(filePath: string): boolean {\r\n  const backupPath = `${filePath}${FILE_BACKUP_SUFFIX}`\r\n\r\n  if (!fsExtra.existsSync(backupPath)) {\r\n    return false\r\n  }\r\n\r\n  try {\r\n    fsExtra.renameSync(backupPath, filePath)\r\n    return true\r\n  } catch (error) {\r\n    console.error(\r\n      `Warning: Could not restore backup file ${backupPath}: ${error}`\r\n    )\r\n    return false\r\n  }\r\n}\r\n\r\nexport function deleteFileBackup(filePath: string): boolean {\r\n  const backupPath = `${filePath}${FILE_BACKUP_SUFFIX}`\r\n\r\n  if (!fsExtra.existsSync(backupPath)) {\r\n    return false\r\n  }\r\n\r\n  try {\r\n    fsExtra.unlinkSync(backupPath)\r\n    return true\r\n  } catch (error) {\r\n    // Best effort - don't log as this is just cleanup\r\n    return false\r\n  }\r\n}\r\n","import { BUILTIN_REGISTRIES } from \"@/src/registry/constants\"\r\nimport { RegistryNotConfiguredError } from \"@/src/registry/errors\"\r\nimport { parseRegistryAndItemFromString } from \"@/src/registry/parser\"\r\nimport { fetchRegistryItems } from \"@/src/registry/resolver\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\n\r\n// Recursively discovers all registry namespaces including nested ones.\r\nexport async function resolveRegistryNamespaces(\r\n  components: string[],\r\n  config: Config\r\n) {\r\n  const discoveredNamespaces = new Set<string>()\r\n  const visitedItems = new Set<string>()\r\n  const itemsToProcess = [...components]\r\n\r\n  while (itemsToProcess.length > 0) {\r\n    const currentItem = itemsToProcess.shift()!\r\n\r\n    if (visitedItems.has(currentItem)) {\r\n      continue\r\n    }\r\n    visitedItems.add(currentItem)\r\n\r\n    const { registry } = parseRegistryAndItemFromString(currentItem)\r\n    if (registry && !BUILTIN_REGISTRIES[registry]) {\r\n      discoveredNamespaces.add(registry)\r\n    }\r\n\r\n    try {\r\n      const [item] = await fetchRegistryItems([currentItem], config, {\r\n        useCache: true,\r\n      })\r\n\r\n      if (item?.registryDependencies) {\r\n        for (const dep of item.registryDependencies) {\r\n          const { registry: depRegistry } = parseRegistryAndItemFromString(dep)\r\n          if (depRegistry && !BUILTIN_REGISTRIES[depRegistry]) {\r\n            discoveredNamespaces.add(depRegistry)\r\n          }\r\n\r\n          if (!visitedItems.has(dep)) {\r\n            itemsToProcess.push(dep)\r\n          }\r\n        }\r\n      }\r\n    } catch (error) {\r\n      // If a registry is not configured, we still track it.\r\n      if (error instanceof RegistryNotConfiguredError) {\r\n        const { registry } = parseRegistryAndItemFromString(currentItem)\r\n        if (registry && !BUILTIN_REGISTRIES[registry]) {\r\n          discoveredNamespaces.add(registry)\r\n        }\r\n        continue\r\n      }\r\n\r\n      // For other errors (network, parsing, etc.), we skip this item\r\n      // but continue processing others to discover as many namespaces as possible.\r\n      continue\r\n    }\r\n  }\r\n\r\n  return Array.from(discoveredNamespaces)\r\n}\r\n","import ora, { type Options } from \"ora\";\r\n\r\nexport function spinner(\r\n  text: Options[\"text\"],\r\n  options?: {\r\n    silent?: boolean\r\n  }\r\n) {\r\n  return ora({\r\n    text,\r\n    isSilent: options?.silent,\r\n  });\r\n}\r\n","import { getRegistriesIndex } from \"@/src/registry/api\"\r\nimport { BUILTIN_REGISTRIES } from \"@/src/registry/constants\"\r\nimport { resolveRegistryNamespaces } from \"@/src/registry/namespaces\"\r\nimport { rawConfigSchema } from \"@/src/registry/schema\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\nimport { spinner } from \"@/src/utils/spinner\"\r\nimport fs from \"fs-extra\"\r\nimport path from \"path\"\r\n\r\nexport async function ensureRegistriesInConfig(\r\n  components: string[],\r\n  config: Config,\r\n  options: {\r\n    silent?: boolean\r\n    writeFile?: boolean\r\n  } = {}\r\n) {\r\n  options = {\r\n    silent: false,\r\n    writeFile: true,\r\n    ...options,\r\n  }\r\n\r\n  // Use resolveRegistryNamespaces to discover all namespaces including dependencies.\r\n  const registryNames = await resolveRegistryNamespaces(components, config)\r\n\r\n  const missingRegistries = registryNames.filter(\r\n    (registry) =>\r\n      !config.registries?.[registry] &&\r\n      !Object.keys(BUILTIN_REGISTRIES).includes(registry)\r\n  )\r\n\r\n  if (missingRegistries.length === 0) {\r\n    return {\r\n      config,\r\n      newRegistries: [],\r\n    }\r\n  }\r\n\r\n  // We'll fail silently if we can't fetch the registry index.\r\n  // The error handling by caller will guide user to add the missing registries.\r\n  const registryIndex = await getRegistriesIndex({\r\n    useCache: process.env.NODE_ENV !== \"development\",\r\n  })\r\n\r\n  if (!registryIndex) {\r\n    return {\r\n      config,\r\n      newRegistries: [],\r\n    }\r\n  }\r\n\r\n  const foundRegistries: Record<string, string> = {}\r\n  for (const registry of missingRegistries) {\r\n    if (registryIndex[registry]) {\r\n      foundRegistries[registry] = registryIndex[registry]\r\n    }\r\n  }\r\n\r\n  if (Object.keys(foundRegistries).length === 0) {\r\n    return {\r\n      config,\r\n      newRegistries: [],\r\n    }\r\n  }\r\n\r\n  // Filter out built-in registries from existing config before merging\r\n  const existingRegistries = Object.fromEntries(\r\n    Object.entries(config.registries || {}).filter(\r\n      ([key]) => !Object.keys(BUILTIN_REGISTRIES).includes(key)\r\n    )\r\n  )\r\n\r\n  const newConfigWithRegistries = {\r\n    ...config,\r\n    registries: {\r\n      ...existingRegistries,\r\n      ...foundRegistries,\r\n    },\r\n  }\r\n\r\n  if (options.writeFile) {\r\n    const { resolvedPaths, ...configWithoutResolvedPaths } =\r\n      newConfigWithRegistries\r\n    const configSpinner = spinner(\"Updating components.json.\", {\r\n      silent: options.silent,\r\n    }).start()\r\n    const updatedConfig = rawConfigSchema.parse(configWithoutResolvedPaths)\r\n    await fs.writeFile(\r\n      path.resolve(config.resolvedPaths.cwd, \"components.json\"),\r\n      JSON.stringify(updatedConfig, null, 2) + \"\\n\",\r\n      \"utf-8\"\r\n    )\r\n    configSpinner.succeed()\r\n  }\r\n\r\n  return {\r\n    config: newConfigWithRegistries,\r\n    newRegistries: Object.keys(foundRegistries),\r\n  }\r\n}\r\n","import { Command } from 'commander';\r\nimport fsExtra from 'fs-extra';\r\nimport path from 'path';\r\nimport z from 'zod';\r\nimport { getRegistryItems } from '../registry/api';\r\nimport { buildUrlAndHeadersForRegistryItem } from '../registry/builder';\r\nimport { configWithDefaults } from '../registry/config';\r\nimport { rawConfigSchema } from \"../schema\";\r\nimport { loadEnvFiles } from '../utils/env-loader';\r\nimport { createFileBackup, deleteFileBackup, restoreFileBackup } from '../utils/file-helper';\r\nimport { handleError } from '../utils/handle-error';\r\nimport { highlighter } from '../utils/highlighter';\r\nimport { logger } from '../utils/logger';\r\nimport { ensureRegistriesInConfig } from '../utils/registries';\r\nprocess.on(\"exit\", (code) => {\r\n  const filePath = path.resolve(process.cwd(), \"components.json\")\r\n\r\n  if (code === 0) {\r\n    return deleteFileBackup(filePath);\r\n  }\r\n\r\n  return restoreFileBackup(filePath);\r\n});\r\n\r\nexport const initOptionsSchema = z.object({\r\n  cwd: z.string(),\r\n  components: z.array(z.string()).optional(),\r\n  yes: z.boolean(),\r\n  defaults: z.boolean(),\r\n  force: z.boolean(),\r\n  silent: z.boolean(),\r\n  isNewProject: z.boolean(),\r\n  srcDir: z.boolean().optional(),\r\n  cssVariables: z.boolean(),\r\n  /* template: z\r\n    .string()\r\n    .optional()\r\n    .refine(\r\n      (val) => {\r\n        if (val) {\r\n          return \"TEMPLATES\"\r\n        }\r\n        return true\r\n      },\r\n      {\r\n        message: \"Invalid template. Please use 'next', 'next-16' or 'next-monorepo'.\",\r\n      }\r\n    ), */\r\n  baseColor: z\r\n    .string()\r\n    .optional(),\r\n  baseStyle: z.boolean(),\r\n});\r\n\r\nexport const init = new Command()\r\n  .name(\"init\")\r\n  .description(\"initialize your project and install dependencies\")\r\n  .argument(\"[components...]\", \"names, url or local path to component\")\r\n  /* .option(\r\n    \"-t, --template <template>\",\r\n    \"the template to use. (next, next-16, next-monorepo\"\r\n  ) */\r\n  .option(\"-b, --base-color <base-color>\", \"The base color to use. (neutral)\", undefined)\r\n  .option(\"-y, --yes\", \"Skip de confirmation prompt\", true)\r\n  .option(\"-d, --defaults\", \"Use default configuration.\", false)\r\n  .option(\"-f, --force\", \"Force overwrite of existing configuration\", false)\r\n  .option(\r\n    \"-c, --cwd <cwd>\",\r\n    \"the working directory. defaults to the current directory.\",\r\n    process.cwd()\r\n  )\r\n  .option(\"-s, --silent\", \"Mute output\", false)\r\n  .option(\"--src-dir\", \"Use the src directory when creating a new project.\", false)\r\n  .option(\"--no-src-dir\", \"Do not use the src directory when creating a new project.\")\r\n  .option(\"--css-variables\", \"Use css variables for theming.\", true)\r\n  .option(\"--no-base-style\", \"Do not install the base aodesu style.\")\r\n  .action(async (components, opts) => {\r\n    try {\r\n      if (opts.defaults) {\r\n        opts.template = opts.template || \"next\"\r\n        opts.baseColor = opts.baseColor || \"neutral\"\r\n      }\r\n\r\n      const options = initOptionsSchema.parse({\r\n        cwd: path.resolve(opts.cwd),\r\n        isNewProject: false,\r\n        components,\r\n        ...opts\r\n      });\r\n\r\n      await loadEnvFiles(options.cwd);\r\n\r\n      // We need check if we're initializing with a new style\r\n      // This will allow us to determine if we need to install the base style.\r\n      // And if we should prompt the user for a base color.\r\n      if (components.length > 0) {\r\n        // We don't know the full config at this point.\r\n        // So we'll use a shadow config to fetch the first item,\r\n        let shadowConfig = configWithDefaults({});\r\n\r\n        // Check if there's a components.json file.\r\n        // If so, we'll merge with our shadow config.\r\n        const componentsJsonPath = path.resolve(options.cwd, \"components.json\");\r\n        if (fsExtra.existsSync(componentsJsonPath)) {\r\n          const existingConfig = await fsExtra.readJson(componentsJsonPath);\r\n          const config = rawConfigSchema.partial().parse(existingConfig);\r\n          shadowConfig = configWithDefaults(config);\r\n\r\n          // Since components.json might not be valid at this point.\r\n          // Temporaly rename components.json to allow preflight to run.\r\n          // We'll rename it back after preflight.\r\n          createFileBackup(componentsJsonPath);\r\n        }\r\n\r\n        // Ensure all registries used in componentes are configured.\r\n        const { config: updatedConfig } = await ensureRegistriesInConfig(\r\n          components,\r\n          shadowConfig,\r\n          {\r\n            silent: true,\r\n          }\r\n        )\r\n        shadowConfig = updatedConfig;\r\n\r\n\r\n        // This forces a shadowConfig validation early in the process.\r\n        buildUrlAndHeadersForRegistryItem(components[0], shadowConfig);\r\n\r\n\r\n        const [item] = await getRegistryItems([components[0]], {\r\n          config: shadowConfig\r\n        });\r\n\r\n        console.log(\"TEST - LLEGO AKI\")\r\n\r\n        if (item?.type == \"registry:style\") {\r\n          // Set a default base color so we're not prompted.\r\n          // The style will extend or override it.\r\n          options.baseColor = \"neutral\";\r\n\r\n          // If the style extends none, we don't want to install the base style.\r\n          options.baseStyle =\r\n            item.extends === \"none\" ? false : options.baseStyle;\r\n        }\r\n      }\r\n\r\n      // If --no-base-style, we don't want to prompt for a base color either\r\n      if (!options.baseStyle) {\r\n        options.baseColor = \"neutral\";\r\n      }\r\n\r\n      await runInit(options);\r\n\r\n      logger.log(\r\n        `${highlighter.success(\r\n          \"Success!\"\r\n        )} Project initialization completed. \\nYou may now add components.`\r\n      )\r\n\r\n    } catch (error) {\r\n      logger.break();\r\n      handleError(error);\r\n    } finally {\r\n\r\n    }\r\n  })\r\n\r\n\r\nexport async function runInit(\r\n  options: z.infer<typeof initOptionsSchema> & {\r\n    skipPreflight?: boolean\r\n  }\r\n) {\r\n  let projectInfo;\r\n  let newProjectTemplate;\r\n  if (!options.skipPreflight) {\r\n    console.log(\"SKIP PREFLIGHT\")\r\n  }\r\n}\r\n","#!/usr/bin/env node\r\nimport { Command } from \"commander\";\r\nimport packageJson from \"../package.json\";\r\nimport { init } from \"./commands/init\";\r\n\r\nprocess.on(\"SIGNINT\", () => process.exit(0));\r\nprocess.on(\"SIGTERM\", () => process.exit(0));\r\n\r\nasync function main() {\r\n  const program = new Command()\r\n    .name(\"uidesu\")\r\n    .description(\"add items from registry to your project\")\r\n    .version(\r\n      packageJson.version || \"1.0.0\",\r\n      \"-v, --version\",\r\n      \"display the version number\"\r\n    )\r\n\r\n  program\r\n    .addCommand(init)\r\n\r\n  program.parse()\r\n}\r\n\r\nmain()\r\n\r\n// export * from './registry/api';\r\n"]}