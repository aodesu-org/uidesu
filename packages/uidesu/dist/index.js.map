{"version":3,"sources":["../package.json","../src/utils/frameworks.ts","../src/registry/constants.ts","../src/utils/highlighter.ts","../src/utils/resolve-import.ts","../src/utils/get-config.ts","../src/utils/get-package-info.ts","../src/utils/get-project-info.ts","../src/utils/logger.ts","../src/utils/spinner.ts","../src/preflights/preflight-init.ts","../src/registry/errors.ts","../src/utils/handle-error.ts","../src/registry/env.ts","../src/registry/parser.ts","../src/registry/utils.ts","../src/registry/config.ts","../src/registry/context.ts","../src/registry/validator.ts","../src/registry/builder.ts","../src/registry/fetcher.ts","../src/registry/resolver.ts","../src/registry/api.ts","../src/utils/get-package-manager.ts","../src/utils/create-project.ts","../src/utils/env-loader.ts","../src/utils/file-helper.ts","../src/registry/namespaces.ts","../src/utils/registries.ts","../src/commands/init.ts","../src/index.ts"],"names":["package_default","FRAMEWORKS","REGISTRY_URL","FALLBACK_STYLE","BUILTIN_REGISTRIES","highlighter","red","yellow","cyan","green","resolveImport","importPath","config","createMatchPath","explorer","cosmiconfig","getConfig","cwd","getRawConfig","resolveConfigPaths","tsConfig","loadConfig","configSchema","path","configResult","rawConfigSchema","registryName","error","componentPath","createConfig","partial","defaultConfig","getPackageInfo","shouldThrow","packageJsonPath","fs","PROJECT_SHARED_IGNORE","z","getProjectInfo","configFiles","isSrcDir","isTsx","tailwindConfigFile","tailwindCssFile","tailwindVersion","aliasPrefix","packageJson","fg","isTypeScriptProject","getTailwindConfigFile","getTailwindCssFile","getTailwindVersion","getTsConfigAliasPrefix","isUsingAppDir","type","file","getFrameworkVersion","framework","version","versionMatch","rangeMatch","packageInfo","files","contents","alias","paths","logger","args","spinner","text","options","ora","preFlightInit","errors","projectSpinner","frameworkSpinner","projectInfo","tailwindSpinnerMessage","tailwindSpinner","tsConfigSpinner","RegistryErrorCode","RegistryError","message","RegistryNotFoundError","url","cause","RegistryUnauthorizedError","RegistryForbiddenError","RegistryFetchError","statusCode","responseBody","baseMessage","suggestion","RegistryNotConfiguredError","RegistryLocalFileError","filePath","RegistryParseError","item","parseError","e","RegistryMissingEnvironmentVariablesError","missingVars","v","RegistriesIndexParseError","invalidNamespaces","i","arr","handleError","key","value","expandEnvVars","_match","extractEnvVars","vars","regex","match","REGISTRY_PATTERN","parseRegistryAndItemFromString","name","isUrl","isLocalFile","resolveStyleFromConfig","configWithDefaults","baseConfig","deepmerge","context","setRegistryHeaders","headers","getRegistryHeadersFromContext","clearRegistryContext","extractEnvVarsFromRegistryConfig","validateRegistryConfig","missing","NAME_PLACEHOLDER","STYLE_PLACEHOLDER","ENV_VAR_PATTER","QUERY_PARAM_SEPARATOR","QUERY_PARAM_DELIMITER","buildUrlAndHeadersForRegistryItem","registry","registryConfig","buildUrlFromRegistryConfig","buildHeadersFromRegistryConfig","baseUrl","appendQueryParams","expandedValue","shouldIncludeHeader","params","urlParams","queryString","separator","originalValue","trimmedExpanded","templateWithoutVars","resolveRegistryUrl","pathOrUrl","agent","HttpsProxyAgent","registryCache","fetchRegistry","fetchPromise","response","fetch","messageFromServer","json","parsed","fetchRegistryLocal","expandedPath","homedir","resolvedPath","content","registryItemSchema","resolveRegistryItemsFromRegistries","items","registryHeaders","resolvedItems","resolved","fetchRegistryItems","result","getRegistryItems","useCache","getRegistriesIndex","data","registriesIndexSchema","getPackageManager","targetDir","withFallback","packageManager","detect","userAgent","MONOREPO_TEMPLATE_URL","TEMPLATES","createProject","template","projectName","nextVersion","isRemoteComponent","meta","prompts","projectPath","createViteProject","createNextProject","createMonorepoProject","createSpinner","execa","installSpinner","templatePath","os","tarPath","extractedPath","packageJsonContent","loadEnvFiles","envFiles","envFile","envPath","join","existsSync","FILE_BACKUP_SUFFIX","createFileBackup","fsExtra","backupPath","restoreFileBackup","deleteFileBackup","resolveRegistryNamespaces","components","discoveredNamespaces","visitedItems","itemsToProcess","currentItem","dep","depRegistry","ensureRegistriesInConfig","missingRegistries","registryIndex","foundRegistries","existingRegistries","newConfigWithRegistries","resolvedPaths","configWithoutResolvedPaths","configSpinner","updatedConfig","code","initOptionsSchema","val","init","Command","opts","shadowConfig","componentsJsonPath","existingConfig","runInit","main","program"],"mappings":"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","file":"index.js","sourcesContent":["{\r\n  \"name\": \"uidesu\",\r\n  \"version\": \"1.0.0\",\r\n  \"description\": \"Add components to your apps.\",\r\n  \"publishConfig\": {\r\n    \"access\": \"public\"\r\n  },\r\n  \"license\": \"MIT\",\r\n  \"author\": {\r\n    \"name\": \"sergiocortes-dll\",\r\n    \"url\": \"https://twitter.com/sergiocortes-dll\"\r\n  },\r\n  \"repository\": {\r\n    \"type\": \"git\",\r\n    \"url\": \"https://github.com/aodesu/ui-cli.git\",\r\n    \"directory\": \"packages/shadcn\"\r\n  },\r\n  \"files\": [\r\n    \"dist\"\r\n  ],\r\n  \"keywords\": [\r\n    \"components\",\r\n    \"ui\",\r\n    \"tailwind\",\r\n    \"radix-ui\",\r\n    \"uidesu\"\r\n  ],\r\n  \"type\": \"module\",\r\n  \"exports\": {\r\n    \".\": {\r\n      \"types\": \"./dist/index.d.ts\",\r\n      \"default\": \"./dist/index.js\"\r\n    }\r\n  },\r\n  \"bin\": \"./dist/index.js\",\r\n  \"scripts\": {\r\n    \"dev\": \"tsup --watch\",\r\n    \"start:dev\": \"cross-env REGISTRY_URL=https://localhost:4000/r node dist/index.js\"\r\n  },\r\n  \"dependencies\": {\r\n    \"@antfu/ni\": \"^25.0.0\",\r\n    \"@dotenvx/dotenvx\": \"^1.48.4\",\r\n    \"commander\": \"^14.0.0\",\r\n    \"cosmiconfig\": \"^9.0.0\",\r\n    \"deepmerge\": \"^4.3.1\",\r\n    \"execa\": \"^9.6.0\",\r\n    \"fast-glob\": \"^3.3.3\",\r\n    \"fs-extra\": \"^11.3.1\",\r\n    \"https-proxy-agent\": \"^7.0.6\",\r\n    \"kleur\": \"^4.1.5\",\r\n    \"node-fetch\": \"^3.3.2\",\r\n    \"ora\": \"^8.2.0\",\r\n    \"prompts\": \"^2.4.2\",\r\n    \"tsconfig-paths\": \"^4.2.0\",\r\n    \"zod\": \"^3.24.1\",\r\n    \"zod-to-json-schema\": \"3.24.6\"\r\n  },\r\n  \"devDependencies\": {\r\n    \"@types/babel__core\": \"^7.20.5\",\r\n    \"@types/fs-extra\": \"^11.0.4\",\r\n    \"@types/prompts\": \"^2.4.9\",\r\n    \"@types/stringify-object\": \"^4.0.5\",\r\n    \"rimraf\": \"^6.0.1\",\r\n    \"tsup\": \"^8.5.0\",\r\n    \"type-fest\": \"^4.41.0\",\r\n    \"typescript\": \"^5.9.2\"\r\n  }\r\n}\r\n","export const FRAMEWORKS = {\r\n  \"next-app\": {\r\n    name: \"next-app\",\r\n    label: \"Next.js\",\r\n    links: {\r\n      installation: \"https://ui.aodesu.com/docs/installation/next\",\r\n      tailwind: \"https://tailwindcss.com/docs/guides/nextjs\",\r\n    },\r\n  },\r\n  \"next-pages\": {\r\n    name: \"next-pages\",\r\n    label: \"Next.js\",\r\n    links: {\r\n      installation: \"https://ui.aodesu.com/docs/installation/next\",\r\n      tailwind: \"https://tailwindcss.com/docs/guides/nextjs\",\r\n    },\r\n  },\r\n  vite: {\r\n    name: \"vite\",\r\n    label: \"vite\",\r\n    links: {\r\n      installation: \"https://ui.aodesu.com/docs/installation/vite\",\r\n      tailwind: \"https://tailwindcss.com/docs/guides/vite\",\r\n    },\r\n  },\r\n  manual: {\r\n    name: \"manual\",\r\n    label: \"Manual\",\r\n    links: {\r\n      installation: \"https://ui.aodesu.com/docs/installation/manual\",\r\n      tailwind: \"https://tailwindcss.com/docs/installation\",\r\n    },\r\n  },\r\n} as const;\r\n\r\nexport type Framework = (typeof FRAMEWORKS)[keyof typeof FRAMEWORKS];\r\n","import z from \"zod\";\r\nimport { registryConfigSchema } from \"./schema\";\r\n\r\nexport const REGISTRY_URL =\r\n  process.env.REGISTRY_URL ?? \"https://ui.aodesu.com/r\";\r\n\r\nexport const FALLBACK_STYLE = \"aodesu\";\r\n\r\nexport const BUILTIN_REGISTRIES: z.infer<typeof registryConfigSchema> = {\r\n  \"@uidesu\": `${REGISTRY_URL}/styles/{style}/{name}.json`,\r\n}\r\n","import { cyan, green, red, yellow } from \"kleur/colors\";\r\n\r\nexport const highlighter = {\r\n  error: red,\r\n  warn: yellow,\r\n  info: cyan,\r\n  success: green,\r\n};\r\n","import { createMatchPath, type ConfigLoaderSuccessResult } from \"tsconfig-paths\";\r\n\r\nexport async function resolveImport(\r\n  importPath: string,\r\n  config: Pick<ConfigLoaderSuccessResult, \"absoluteBaseUrl\" | \"paths\">\r\n) {\r\n  return createMatchPath(config.absoluteBaseUrl, config.paths)(\r\n    importPath,\r\n    undefined,\r\n    () => true,\r\n    [\".ts\", \".tsx\", \".jsx\", \".js\", \".css\"]\r\n  )\r\n}\r\n","import { cosmiconfig } from \"cosmiconfig\";\r\nimport path from \"path\";\r\nimport { loadConfig } from \"tsconfig-paths\";\r\nimport z from \"zod\";\r\nimport { BUILTIN_REGISTRIES } from \"../registry/constants\";\r\nimport { configSchema, rawConfigSchema } from \"../schema\";\r\nimport { highlighter } from \"./highlighter\";\r\nimport { resolveImport } from \"./resolve-import\";\r\n\r\n// TODO: Figure out if we want to support all cosmiconfig formats.\r\n// A simple components.json file would be nice.\r\nexport const explorer = cosmiconfig(\"components\", {\r\n  searchPlaces: [\"components.json\"]\r\n});\r\n\r\nexport type Config = z.infer<typeof configSchema>\r\n\r\nexport async function getConfig(cwd: string) {\r\n  const config = await getRawConfig(cwd);\r\n\r\n  if (!config) {\r\n    return null;\r\n  }\r\n\r\n  // Set default icon library if not provided.\r\n  if (!config.iconLibrary) {\r\n    config.iconLibrary = config.style === \"aodesu\" ? \"radix\" : \"lucide\";\r\n  }\r\n\r\n  return await resolveConfigPaths(cwd, config);\r\n}\r\n\r\nexport async function resolveConfigPaths(\r\n  cwd: string,\r\n  config: z.infer<typeof rawConfigSchema>\r\n) {\r\n  // Merge built-in registries with user registries\r\n  config.registries = {\r\n    ...BUILTIN_REGISTRIES,\r\n    ...(config.registries || {}),\r\n  };\r\n\r\n  // Read tsconfig.json\r\n  const tsConfig = await loadConfig(cwd);\r\n\r\n  if (tsConfig.resultType === \"failed\") {\r\n    throw new Error(\r\n      `Failed to load ${config.tsx ? \"tsconfig\" : \"jsconfig\"}.json ${\r\n        tsConfig.message ?? \"\"\r\n      }`.trim()\r\n    );\r\n  }\r\n\r\n  return configSchema.parse({\r\n    ...config,\r\n    resolvedPaths: {\r\n      cwd,\r\n      tailwindConfig: config.tailwind.config\r\n        ? path.resolve(cwd, config.tailwind.config)\r\n        : \"\",\r\n      tailwindCss: path.resolve(cwd, config.tailwind.css),\r\n      utils: await resolveImport(config.aliases[\"utils\"], tsConfig),\r\n      components: await resolveImport(config.aliases[\"components\"], tsConfig),\r\n      ui: config.aliases[\"ui\"]\r\n        ? await resolveImport(config.aliases[\"ui\"], tsConfig)\r\n        : path.resolve(\r\n          (await resolveImport(config.aliases[\"components\"], tsConfig)) ??\r\n          cwd,\r\n          \"ui\"\r\n        ),\r\n      // TODO: Make this configurable\r\n      // For now, we assume the lib and hooks directories are one level up from the components directory.\r\n      lib: config.aliases[\"lib\"]\r\n        ? await resolveImport(config.aliases[\"lib\"], tsConfig)\r\n        : path.resolve(\r\n          (await resolveImport(config.aliases[\"utils\"], tsConfig)) ?? cwd,\r\n          \"..\"\r\n        ),\r\n      hooks: config.aliases[\"hooks\"]\r\n        ? await resolveImport(config.aliases[\"hooks\"], tsConfig)\r\n        : path.resolve(\r\n          (await resolveImport(config.aliases[\"components\"], tsConfig)) ??\r\n            cwd,\r\n          \"..\",\r\n          \"hooks\"\r\n        ),\r\n    },\r\n  })\r\n};\r\n\r\nexport async function getRawConfig(\r\n  cwd: string\r\n): Promise<z.infer<typeof rawConfigSchema> | null> {\r\n  try {\r\n    const configResult = await explorer.search(cwd);\r\n\r\n    if (!configResult) {\r\n      return null;\r\n    }\r\n\r\n    const config = rawConfigSchema.parse(configResult.config);\r\n\r\n    // Check if user is trying to override built-in registries\r\n    if (config.registries) {\r\n      for (const registryName of Object.keys(config.registries)) {\r\n        if (registryName in BUILTIN_REGISTRIES) {\r\n          throw new Error(\r\n            `\"${registryName}\" is a built-in registry and cannot be overriden.`\r\n          )\r\n        }\r\n      }\r\n    }\r\n\r\n    return config;\r\n  } catch (error) {\r\n    const componentPath = `${cwd}/components.json`;\r\n    if (error instanceof Error && error.message.includes(\"reserved registry\")) {\r\n      throw error;\r\n    }\r\n    throw new Error(\r\n      `Invalid configuration found in ${highlighter.info(componentPath)}`\r\n    );\r\n  }\r\n}\r\n\r\ntype DeepPartial<T> = {\r\n  [P in keyof T]?: T[P] extends object ? DeepPartial<T[P]> : T[P]\r\n}\r\n\r\nexport function createConfig(partial?: DeepPartial<Config>): Config {\r\n  const defaultConfig: Config = {\r\n    resolvedPaths: {\r\n      cwd: process.cwd(),\r\n      tailwindConfig: \"\",\r\n      tailwindCss: \"\",\r\n      utils: \"\",\r\n      components: \"\",\r\n      ui: \"\",\r\n      lib: \"\",\r\n      hooks: \"\",\r\n    },\r\n    style: \"\",\r\n    tailwind: {\r\n      config: \"\",\r\n      css: \"\",\r\n      baseColor: \"\",\r\n      cssVariables: false,\r\n    },\r\n    rsc: false,\r\n    tsx: true,\r\n    aliases: {\r\n      components: \"\",\r\n      utils: \"\",\r\n    },\r\n    registries: {\r\n      ...BUILTIN_REGISTRIES,\r\n    },\r\n  }\r\n\r\n  // Deep merge the partial config with defaults\r\n  if (partial) {\r\n    return {\r\n      ...defaultConfig,\r\n      ...partial,\r\n      resolvedPaths: {\r\n        ...defaultConfig.resolvedPaths,\r\n        ...(partial.resolvedPaths|| {}),\r\n      },\r\n      tailwind: {\r\n        ...defaultConfig.tailwind,\r\n        ...(partial.tailwind || {}),\r\n      },\r\n      aliases: {\r\n        ...defaultConfig.aliases,\r\n        ...(partial.aliases || {}),\r\n      },\r\n      registries: {\r\n        ...defaultConfig.registries,\r\n        ...(partial.registries || {}),\r\n      },\r\n    }\r\n  }\r\n\r\n  return defaultConfig;\r\n}\r\n","import fs from \"fs-extra\";\r\nimport path from \"path\";\r\nimport { type PackageJson } from \"type-fest\";\r\n\r\nexport function getPackageInfo(\r\n  cwd: string = \"\",\r\n  shouldThrow: boolean = true\r\n): PackageJson | null {\r\n  const packageJsonPath = path.join(cwd, \"package.json\");\r\n\r\n  return fs.readJSONSync(packageJsonPath, {\r\n    throws: shouldThrow,\r\n  }) as PackageJson;\r\n}\r\n","import { Framework, FRAMEWORKS } from \"@/src/utils/frameworks\";\r\nimport { getConfig } from \"@/src/utils/get-config\";\r\nimport { getPackageInfo } from \"@/src/utils/get-package-info\";\r\nimport fg from \"fast-glob\";\r\nimport fs from \"fs-extra\";\r\nimport path from \"path\";\r\nimport { loadConfig } from \"tsconfig-paths\";\r\nimport { z } from \"zod\";\r\n\r\nexport type TailwindVersion = \"v3\" | \"v4\" | null;\r\n\r\nexport type ProjectInfo = {\r\n  framework: Framework;\r\n  isSrcDir: boolean;\r\n  isRSC: boolean;\r\n  isTsx: boolean;\r\n  tailwindConfigFile: string | null;\r\n  tailwindCssFile: string | null;\r\n  tailwindVersion: TailwindVersion;\r\n  frameworkVersion: string | null;\r\n  aliasPrefix: string | null;\r\n}\r\n\r\nconst PROJECT_SHARED_IGNORE = [\r\n  \"**/node_modules/**\",\r\n  \".next\",\r\n  \"public\",\r\n  \"dist\",\r\n  \"build\",\r\n];\r\n\r\nconst TS_CONFIG_SCHEMA = z.object({\r\n  compilerOptions: z.object({\r\n    paths: z.record(z.string().or(z.array(z.string()))),\r\n  }),\r\n});\r\n\r\nexport async function getProjectInfo(cwd: string): Promise<ProjectInfo | null> {\r\n  const [\r\n    configFiles,\r\n    isSrcDir,\r\n    isTsx,\r\n    tailwindConfigFile,\r\n    tailwindCssFile,\r\n    tailwindVersion,\r\n    aliasPrefix,\r\n    packageJson,\r\n  ] = await Promise.all([\r\n    fg.glob(\r\n      \"**/{vite,app}.config.*|gatsby-config.*|composer.json|react-router.config.*\",\r\n      {\r\n        cwd,\r\n        deep: 3,\r\n        ignore: PROJECT_SHARED_IGNORE,\r\n      }\r\n    ),\r\n    fs.pathExists(path.resolve(cwd, \"src\")),\r\n    isTypeScriptProject(cwd),\r\n    getTailwindConfigFile(cwd),\r\n    getTailwindCssFile(cwd),\r\n    getTailwindVersion(cwd),\r\n    getTsConfigAliasPrefix(cwd),\r\n    getPackageInfo(cwd, false),\r\n  ]);\r\n\r\n  const isUsingAppDir = await fs.pathExists(\r\n    path.resolve(cwd, `${isSrcDir ? \"src/\" : \"\"}app`)\r\n  );\r\n\r\n  const type: ProjectInfo = {\r\n    framework: FRAMEWORKS[\"manual\"],\r\n    isSrcDir,\r\n    isRSC: false,\r\n    isTsx,\r\n    tailwindConfigFile,\r\n    tailwindCssFile,\r\n    tailwindVersion,\r\n    frameworkVersion: null,\r\n    aliasPrefix,\r\n  }\r\n\r\n  // Next.js.\r\n  if (configFiles.find((file) => file.startsWith(\"next.config.\"))?.length) {\r\n    type.framework = isUsingAppDir\r\n      ? FRAMEWORKS[\"next-app\"]\r\n      : FRAMEWORKS[\"next-pages\"];\r\n    type.isRSC = isUsingAppDir;\r\n    type.frameworkVersion = await getFrameworkVersion(\r\n      type.framework,\r\n      packageJson\r\n    );\r\n    return type;\r\n  }\r\n\r\n  // Vite.\r\n  if (configFiles.find((file) => file.startsWith(\"vite.config.\"))?.length) {\r\n    type.framework = FRAMEWORKS[\"vite\"];\r\n    return type;\r\n  }\r\n\r\n  return type;\r\n};\r\n\r\nexport async function getFrameworkVersion(\r\n  framework: Framework,\r\n  packageJson: ReturnType<typeof getPackageInfo>\r\n) {\r\n  if (!packageJson) {\r\n    return null;\r\n  }\r\n\r\n  // Only detect Next.js version for now.\r\n  if (![\"next-app\", \"next-pages\"].includes(framework.name)) {\r\n    return null;\r\n  }\r\n\r\n  const version =\r\n    packageJson.dependencies?.next || packageJson.devDependencies?.next;\r\n\r\n  if (!version) {\r\n    return null;\r\n  }\r\n\r\n  // Extract full semver (major.minor.patch), handling ^, ~, etc.\r\n  const versionMatch = version.match(/^[\\^~]?(\\d+\\.\\d+\\.\\d+)/)\r\n  if (versionMatch) {\r\n    return versionMatch[1] // e.g., \"16.0.0\"\r\n  }\r\n\r\n  // For ranges like \">=15.0.0 <16.0.0\", extract the first version.\r\n  const rangeMatch = version.match(/(\\d+\\.\\d+\\.\\d+)/)\r\n  if (rangeMatch) {\r\n    return rangeMatch[1]\r\n  }\r\n\r\n  // For \"latest\", \"canary\", \"rc\", etc., return the tag as-is.\r\n  return version\r\n}\r\n\r\nexport async function getTailwindVersion(\r\n  cwd: string\r\n): Promise<ProjectInfo[\"tailwindVersion\"]> {\r\n  const [packageInfo, config] = await Promise.all([\r\n    getPackageInfo(cwd, false),\r\n    getConfig(cwd),\r\n  ]);\r\n\r\n  // If the config file is empty, we can assume that it's a v4 project\r\n  if (config?.tailwind?.config === \"\") {\r\n    return \"v4\";\r\n  }\r\n\r\n  if (\r\n    !packageInfo?.dependencies?.tailwindcss &&\r\n    !packageInfo?.devDependencies?.tailwindcss\r\n  ) {\r\n    return null;\r\n  }\r\n\r\n  if (\r\n    /^(?:\\^|~)?3(?:\\.\\d+)*(?:-.*)?$/.test(\r\n      packageInfo?.dependencies?.tailwindcss ||\r\n        packageInfo?.devDependencies?.tailwindcss ||\r\n        \"\"\r\n    )\r\n  ) {\r\n    return \"v3\"\r\n  }\r\n\r\n  return \"v4\"\r\n}\r\n\r\nexport async function getTailwindCssFile(cwd: string) {\r\n  const [files, tailwindVersion] = await Promise.all([\r\n    fg.glob([\"**/*.css\", \"**/*.scss\"], {\r\n      cwd,\r\n      deep: 5,\r\n      ignore: PROJECT_SHARED_IGNORE,\r\n    }),\r\n    getTailwindVersion(cwd),\r\n  ]);\r\n\r\n  if (!files.length) {\r\n    return null;\r\n  }\r\n\r\n  for (const file of files) {\r\n    const contents = await fs.readFile(path.resolve(cwd, file), \"utf8\");\r\n    if (\r\n      contents.includes(`@import \"tailwindcss\"`) ||\r\n      contents.includes(`@import 'tailwindcss'`) ||\r\n      contents.includes(`@tailwind base`)\r\n    ) {\r\n      return file;\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nexport async function getTailwindConfigFile(cwd: string) {\r\n  const files = await fg.glob(\"tailwind.config.*\", {\r\n    cwd,\r\n    deep: 3,\r\n    ignore: PROJECT_SHARED_IGNORE,\r\n  });\r\n\r\n  if (!files.length) {\r\n    return null;\r\n  }\r\n\r\n  return files[0];\r\n}\r\n\r\nexport async function getTsConfigAliasPrefix(cwd: string) {\r\n  const tsConfig = await loadConfig(cwd);\r\n\r\n  if (\r\n    tsConfig?.resultType === \"failed\" ||\r\n    !Object.entries(tsConfig?.paths).length\r\n  ) {\r\n    return null;\r\n  }\r\n\r\n  // This assume that the first alias is the prefix.\r\n  for (const [alias, paths] of Object.entries(tsConfig.paths)) {\r\n    if (\r\n      paths.includes(\"./*\") ||\r\n      paths.includes(\"./src/*\") ||\r\n      paths.includes(\"./app/*\") ||\r\n      paths.includes(\"./resources/js/*\") // Laravel.\r\n    ) {\r\n      return alias.replace(/\\/\\*$/, \"\") ?? null\r\n    }\r\n  }\r\n\r\n  // Use the first alias as the prefix.\r\n  return Object.keys(tsConfig?.paths)?.[0].replace(/\\/\\*$/, \"\") ?? null;\r\n}\r\n\r\nexport async function isTypeScriptProject(cwd: string) {\r\n  const files = await fg.glob(\"tsconfig.*\", {\r\n    cwd,\r\n    deep: 1,\r\n    ignore: PROJECT_SHARED_IGNORE,\r\n  });\r\n\r\n  return files.length > 0;\r\n}\r\n\r\n","import { highlighter } from \"./highlighter\";\r\n\r\nexport const logger = {\r\n  error(...args: unknown[]) {\r\n    console.log(highlighter.error(args.join(\" \")))\r\n  },\r\n  warn(...args: unknown[]) {\r\n    console.log(highlighter.warn(args.join(\" \")))\r\n  },\r\n  info(...args: unknown[]) {\r\n    console.log(highlighter.info(args.join(\" \")))\r\n  },\r\n  success(...args: unknown[]) {\r\n    console.log(highlighter.success(args.join(\" \")))\r\n  },\r\n  log(...args: unknown[]) {\r\n    console.log(args.join(\" \"))\r\n  },\r\n  break() {\r\n    console.log(\"\")\r\n  },\r\n};\r\n","import ora, { type Options } from \"ora\";\r\n\r\nexport function spinner(\r\n  text: Options[\"text\"],\r\n  options?: {\r\n    silent?: boolean\r\n  }\r\n) {\r\n  return ora({\r\n    text,\r\n    isSilent: options?.silent,\r\n  });\r\n}\r\n","import { initOptionsSchema } from \"@/src/commands/init\";\r\nimport * as ERRORS from \"@/src/utils/errors\";\r\nimport { getProjectInfo } from \"@/src/utils/get-project-info\";\r\nimport { highlighter } from \"@/src/utils/highlighter\";\r\nimport { logger } from \"@/src/utils/logger\";\r\nimport { spinner } from \"@/src/utils/spinner\";\r\nimport fs from \"fs-extra\";\r\nimport path from \"path\";\r\nimport { z } from \"zod\";\r\n\r\nexport async function preFlightInit(\r\n  options: z.infer<typeof initOptionsSchema>\r\n) {\r\n  const errors: Record<string, boolean> = {};\r\n\r\n  // Ensure target directory exists.\r\n  // Check for empty project. We assume if no package.json exists, the project is empty.\r\n  if (\r\n    !fs.existsSync(options.cwd) ||\r\n    !fs.existsSync(path.resolve(options.cwd, \"package.json\"))\r\n  ) {\r\n    errors[ERRORS.MISSING_DIR_OR_EMPTY_PROJECT] = true;\r\n    return {\r\n      errors,\r\n      projectInfo: null,\r\n    }\r\n  }\r\n\r\n  const projectSpinner = spinner(\"Preflight checks.\", {\r\n    silent: options.silent,\r\n  }).start()\r\n\r\n  if (\r\n    fs.existsSync(path.resolve(options.cwd, \"components.json\")) &&\r\n    !options.force\r\n  ) {\r\n    projectSpinner?.fail();\r\n    logger.break();\r\n    logger.error(\r\n      `A ${highlighter.info(\r\n        \"components.json\"\r\n      )} file already exist at ${highlighter.info(\r\n        options.cwd\r\n      )}. \\nTo start over, remove the ${highlighter.info(\r\n        \"components.json\"\r\n      )} file and run ${highlighter.info(\"init\")} again.`\r\n    );\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  projectSpinner?.succeed();\r\n\r\n  const frameworkSpinner = spinner(\"Verifying framework.\", {\r\n    silent: options.silent,\r\n  }).start();\r\n  const projectInfo = await getProjectInfo(options.cwd);\r\n  if (!projectInfo || projectInfo?.framework.name === \"manual\") {\r\n    errors[ERRORS.UNSUPPORTED_FRAMEWORK] = true;\r\n    frameworkSpinner?.fail();\r\n    logger.break();\r\n    if (projectInfo?.framework.links.installation) {\r\n      logger.error(\r\n        `We could not detect a supported framework at ${highlighter.info(\r\n          options.cwd\r\n        )}.\\n` +\r\n          `Visit ${highlighter.info(\r\n            projectInfo?.framework.links.installation\r\n          )} to manually configure your project. \\nOnce configured, you can use the cli to add components.`\r\n      )\r\n    }\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n  frameworkSpinner?.succeed(\r\n    `Verifying framework. Found ${highlighter.info(\r\n      projectInfo.framework.label\r\n    )}.`\r\n  )\r\n\r\n  let tailwindSpinnerMessage = \"Validating Tailwind CSS.\";\r\n\r\n  if (projectInfo.tailwindVersion === \"v4\") {\r\n    tailwindSpinnerMessage = `Validating Tailwind CSS config. Found ${highlighter.info(\r\n      \"v4\"\r\n    )}.`\r\n  }\r\n\r\n  const tailwindSpinner = spinner(tailwindSpinnerMessage, {\r\n    silent: options.silent,\r\n  }).start();\r\n\r\n  if (\r\n    projectInfo.tailwindVersion === \"v3\" &&\r\n    (!projectInfo?.tailwindConfigFile || !projectInfo?.tailwindCssFile)\r\n  ) {\r\n    errors[ERRORS.TAILWIND_NOT_CONFIGURED] = true\r\n    tailwindSpinner?.fail()\r\n  } else if (\r\n    projectInfo.tailwindVersion === \"v4\" &&\r\n    !projectInfo?.tailwindCssFile\r\n  ) {\r\n    errors[ERRORS.TAILWIND_NOT_CONFIGURED] = true\r\n    tailwindSpinner?.fail()\r\n  } else if (!projectInfo.tailwindVersion) {\r\n    errors[ERRORS.TAILWIND_NOT_CONFIGURED] = true\r\n    tailwindSpinner?.fail()\r\n  } else {\r\n    tailwindSpinner?.succeed()\r\n  }\r\n\r\n  const tsConfigSpinner = spinner(`Validating import alias.`, {\r\n    silent: options.silent,\r\n  }).start();\r\n\r\n  if (!projectInfo?.aliasPrefix) {\r\n    errors[ERRORS.IMPORT_ALIAS_MISSING] = true\r\n    tsConfigSpinner?.fail()\r\n  } else {\r\n    tsConfigSpinner?.succeed()\r\n  }\r\n\r\n  if (Object.keys(errors).length > 0) {\r\n    if (errors[ERRORS.TAILWIND_NOT_CONFIGURED]) {\r\n      logger.break()\r\n      logger.error(\r\n        `No Tailwind CSS configuration found at ${highlighter.info(\r\n          options.cwd\r\n        )}.`\r\n      )\r\n      logger.error(\r\n        `It is likely you do not have Tailwind CSS installed or have an invalid configuration.`\r\n      )\r\n      logger.error(`Install Tailwind CSS then try again.`)\r\n      if (projectInfo?.framework.links.tailwind) {\r\n        logger.error(\r\n          `Visit ${highlighter.info(\r\n            projectInfo?.framework.links.tailwind\r\n          )} to get started.`\r\n        )\r\n      }\r\n    }\r\n\r\n    if (errors[ERRORS.IMPORT_ALIAS_MISSING]) {\r\n      logger.break()\r\n      logger.error(`No import alias found in your tsconfig.json file.`)\r\n      if (projectInfo?.framework.links.installation) {\r\n        logger.error(\r\n          `Visit ${highlighter.info(\r\n            projectInfo?.framework.links.installation\r\n          )} to learn how to set an import alias.`\r\n        )\r\n      }\r\n    }\r\n\r\n    logger.break()\r\n    process.exit(1)\r\n  }\r\n\r\n  return {\r\n    errors,\r\n    projectInfo\r\n  }\r\n}\r\n","import { z } from \"zod\"\r\n\r\n// Error codes for programmatic error handling\r\nexport const RegistryErrorCode = {\r\n  // Network errors\r\n  NETWORK_ERROR: \"NETWORK_ERROR\",\r\n  NOT_FOUND: \"NOT_FOUND\",\r\n  UNAUTHORIZED: \"UNAUTHORIZED\",\r\n  FORBIDDEN: \"FORBIDDEN\",\r\n  FETCH_ERROR: \"FETCH_ERROR\",\r\n\r\n  // Configuration errors\r\n  NOT_CONFIGURED: \"NOT_CONFIGURED\",\r\n  INVALID_CONFIG: \"INVALID_CONFIG\",\r\n  MISSING_ENV_VARS: \"MISSING_ENV_VARS\",\r\n\r\n  // File system errors\r\n  LOCAL_FILE_ERROR: \"LOCAL_FILE_ERROR\",\r\n\r\n  // Parsing errors\r\n  PARSE_ERROR: \"PARSE_ERROR\",\r\n  VALIDATION_ERROR: \"VALIDATION_ERROR\",\r\n\r\n  // Generic errors\r\n  UNKNOWN_ERROR: \"UNKNOWN_ERROR\",\r\n} as const\r\n\r\nexport type RegistryErrorCode =\r\n  (typeof RegistryErrorCode)[keyof typeof RegistryErrorCode]\r\n\r\nexport class RegistryError extends Error {\r\n  public readonly code: RegistryErrorCode\r\n  public readonly statusCode?: number\r\n  public readonly context?: Record<string, unknown>\r\n  public readonly suggestion?: string\r\n  public readonly timestamp: Date\r\n  public readonly cause?: unknown\r\n\r\n  constructor(\r\n    message: string,\r\n    options: {\r\n      code?: RegistryErrorCode\r\n      statusCode?: number\r\n      cause?: unknown\r\n      context?: Record<string, unknown>\r\n      suggestion?: string\r\n    } = {}\r\n  ) {\r\n    super(message)\r\n    this.name = \"RegistryError\"\r\n    this.code = options.code || RegistryErrorCode.UNKNOWN_ERROR\r\n    this.statusCode = options.statusCode\r\n    this.cause = options.cause\r\n    this.context = options.context\r\n    this.suggestion = options.suggestion\r\n    this.timestamp = new Date()\r\n\r\n    if (Error.captureStackTrace) {\r\n      Error.captureStackTrace(this, this.constructor)\r\n    }\r\n  }\r\n\r\n  toJSON() {\r\n    return {\r\n      name: this.name,\r\n      message: this.message,\r\n      code: this.code,\r\n      statusCode: this.statusCode,\r\n      context: this.context,\r\n      suggestion: this.suggestion,\r\n      timestamp: this.timestamp,\r\n      stack: this.stack,\r\n    }\r\n  }\r\n}\r\n\r\nexport class RegistryNotFoundError extends RegistryError {\r\n  constructor(public readonly url: string, cause?: unknown) {\r\n    const message = `The item at ${url} was not found. It may not exist at the registry.`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.NOT_FOUND,\r\n      statusCode: 404,\r\n      cause,\r\n      context: { url },\r\n      suggestion:\r\n        \"Check if the item name is correct and the registry URL is accessible.\",\r\n    })\r\n    this.name = \"RegistryNotFoundError\"\r\n  }\r\n}\r\n\r\nexport class RegistryUnauthorizedError extends RegistryError {\r\n  constructor(public readonly url: string, cause?: unknown) {\r\n    const message = `You are not authorized to access the item at ${url}. If this is a remote registry, you may need to authenticate.`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.UNAUTHORIZED,\r\n      statusCode: 401,\r\n      cause,\r\n      context: { url },\r\n      suggestion:\r\n        \"Check your authentication credentials and environment variables.\",\r\n    })\r\n    this.name = \"RegistryUnauthorizedError\"\r\n  }\r\n}\r\n\r\nexport class RegistryForbiddenError extends RegistryError {\r\n  constructor(public readonly url: string, cause?: unknown) {\r\n    const message = `You are not authorized to access the item at ${url}. If this is a remote registry, you may need to authenticate.`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.FORBIDDEN,\r\n      statusCode: 403,\r\n      cause,\r\n      context: { url },\r\n      suggestion:\r\n        \"Check your authentication credentials and environment variables.\",\r\n    })\r\n    this.name = \"RegistryForbiddenError\"\r\n  }\r\n}\r\n\r\nexport class RegistryFetchError extends RegistryError {\r\n  constructor(\r\n    public readonly url: string,\r\n    statusCode?: number,\r\n    public readonly responseBody?: string,\r\n    cause?: unknown\r\n  ) {\r\n    // Use the error detail from the server if available\r\n    const baseMessage = statusCode\r\n      ? `Failed to fetch from registry (${statusCode}): ${url}`\r\n      : `Failed to fetch from registry: ${url}`\r\n\r\n    const message =\r\n      typeof cause === \"string\" && cause\r\n        ? `${baseMessage} - ${cause}`\r\n        : baseMessage\r\n\r\n    let suggestion = \"Check your network connection and try again.\"\r\n    if (statusCode === 404) {\r\n      suggestion =\r\n        \"The requested resource was not found. Check the URL or item name.\"\r\n    } else if (statusCode === 500) {\r\n      suggestion = \"The registry server encountered an error. Try again later.\"\r\n    } else if (statusCode && statusCode >= 400 && statusCode < 500) {\r\n      suggestion = \"There was a client error. Check your request parameters.\"\r\n    }\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.FETCH_ERROR,\r\n      statusCode,\r\n      cause,\r\n      context: { url, responseBody },\r\n      suggestion,\r\n    })\r\n    this.name = \"RegistryFetchError\"\r\n  }\r\n}\r\n\r\nexport class RegistryNotConfiguredError extends RegistryError {\r\n  constructor(public readonly registryName: string | null) {\r\n    const message = registryName\r\n      ? `Unknown registry \"${registryName}\". Make sure it is defined in components.json as follows:\r\n{\r\n  \"registries\": {\r\n    \"${registryName}\": \"[URL_TO_REGISTRY]\"\r\n  }\r\n}`\r\n      : `Unknown registry. Make sure it is defined in components.json under \"registries\".`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.NOT_CONFIGURED,\r\n      context: { registryName },\r\n      suggestion:\r\n        \"Add the registry configuration to your components.json file. Consult the registry documentation for the correct format.\",\r\n    })\r\n    this.name = \"RegistryNotConfiguredError\"\r\n  }\r\n}\r\n\r\nexport class RegistryLocalFileError extends RegistryError {\r\n  constructor(public readonly filePath: string, cause?: unknown) {\r\n    super(`Failed to read local registry file: ${filePath}`, {\r\n      code: RegistryErrorCode.LOCAL_FILE_ERROR,\r\n      cause,\r\n      context: { filePath },\r\n      suggestion: \"Check if the file exists and you have read permissions.\",\r\n    })\r\n    this.name = \"RegistryLocalFileError\"\r\n  }\r\n}\r\n\r\nexport class RegistryParseError extends RegistryError {\r\n  public readonly parseError: unknown\r\n\r\n  constructor(public readonly item: string, parseError: unknown) {\r\n    let message = `Failed to parse registry item: ${item}`\r\n\r\n    if (parseError instanceof z.ZodError) {\r\n      message = `Failed to parse registry item: ${item}\\n${parseError.errors\r\n        .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\r\n        .join(\"\\n\")}`\r\n    }\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.PARSE_ERROR,\r\n      cause: parseError,\r\n      context: { item },\r\n      suggestion:\r\n        \"The registry item may be corrupted or have an invalid format. Please make sure it returns a valid JSON object. See https://ui.shadcn.com/schema/registry-item.json.\",\r\n    })\r\n\r\n    this.parseError = parseError\r\n    this.name = \"RegistryParseError\"\r\n  }\r\n}\r\n\r\nexport class RegistryMissingEnvironmentVariablesError extends RegistryError {\r\n  constructor(\r\n    public readonly registryName: string,\r\n    public readonly missingVars: string[]\r\n  ) {\r\n    const message =\r\n      `Registry \"${registryName}\" requires the following environment variables:\\n\\n` +\r\n      missingVars.map((v) => `   ${v}`).join(\"\\n\")\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.MISSING_ENV_VARS,\r\n      context: { registryName, missingVars },\r\n      suggestion:\r\n        \"Set the required environment variables to your .env or .env.local file.\",\r\n    })\r\n    this.name = \"RegistryMissingEnvironmentVariablesError\"\r\n  }\r\n}\r\n\r\nexport class RegistryInvalidNamespaceError extends RegistryError {\r\n  constructor(public readonly name: string) {\r\n    const message = `Invalid registry namespace: \"${name}\". Registry names must start with @ (e.g., @shadcn, @v0).`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.VALIDATION_ERROR,\r\n      context: { name },\r\n      suggestion:\r\n        \"Use a valid registry name starting with @ or provide a direct URL to the registry.\",\r\n    })\r\n    this.name = \"RegistryInvalidNamespaceError\"\r\n  }\r\n}\r\n\r\nexport class ConfigMissingError extends RegistryError {\r\n  constructor(public readonly cwd: string) {\r\n    const message = `No components.json found in ${cwd} or parent directories.`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.NOT_CONFIGURED,\r\n      context: { cwd },\r\n      suggestion:\r\n        \"Run 'npx shadcn@latest init' to create a components.json file, or check that you're in the correct directory.\",\r\n    })\r\n    this.name = \"ConfigMissingError\"\r\n  }\r\n}\r\n\r\nexport class ConfigParseError extends RegistryError {\r\n  constructor(public readonly cwd: string, parseError: unknown) {\r\n    let message = `Invalid components.json configuration in ${cwd}.`\r\n\r\n    if (parseError instanceof z.ZodError) {\r\n      message = `Invalid components.json configuration in ${cwd}:\\n${parseError.errors\r\n        .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\r\n        .join(\"\\n\")}`\r\n    }\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.INVALID_CONFIG,\r\n      cause: parseError,\r\n      context: { cwd },\r\n      suggestion:\r\n        \"Check your components.json file for syntax errors or invalid configuration. Run 'npx shadcn@latest init' to regenerate a valid configuration.\",\r\n    })\r\n    this.name = \"ConfigParseError\"\r\n  }\r\n}\r\n\r\nexport class RegistriesIndexParseError extends RegistryError {\r\n  public readonly parseError: unknown\r\n\r\n  constructor(parseError: unknown) {\r\n    let message = \"Failed to parse registries index\"\r\n\r\n    if (parseError instanceof z.ZodError) {\r\n      const invalidNamespaces = parseError.errors\r\n        .filter((e) => e.path.length > 0)\r\n        .map((e) => `\"${e.path[0]}\"`)\r\n        .filter((v, i, arr) => arr.indexOf(v) === i) // remove duplicates\r\n\r\n      if (invalidNamespaces.length > 0) {\r\n        message = `Failed to parse registries index. Invalid registry namespace(s): ${invalidNamespaces.join(\r\n          \", \"\r\n        )}\\n${parseError.errors\r\n          .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\r\n          .join(\"\\n\")}`\r\n      } else {\r\n        message = `Failed to parse registries index:\\n${parseError.errors\r\n          .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\r\n          .join(\"\\n\")}`\r\n      }\r\n    }\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.PARSE_ERROR,\r\n      cause: parseError,\r\n      context: { parseError },\r\n      suggestion:\r\n        \"The registries index may be corrupted or have invalid registry namespace format. Registry names must start with @ (e.g., @shadcn, @example).\",\r\n    })\r\n\r\n    this.parseError = parseError\r\n    this.name = \"RegistriesIndexParseError\"\r\n  }\r\n}\r\n","import z from \"zod\";\r\nimport { RegistryError } from \"../registry/errors\";\r\nimport { highlighter } from \"./highlighter\";\r\nimport { logger } from \"./logger\";\r\n\r\nexport function handleError(error: unknown) {\r\n  logger.break();\r\n  logger.error(\"Something went wrong. Please check the error below for more details.\");\r\n  logger.error(\"If the problem persist, please open an issue on GitHub.\");\r\n  logger.error(\"\");\r\n\r\n  if (typeof error === \"string\") {\r\n    logger.error(error);\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  if (error instanceof RegistryError) {\r\n    if (error.message) {\r\n      logger.error(error.cause ? \"Error\" : \"Message:\");\r\n      logger.error(error.message);\r\n    }\r\n\r\n    if (error.cause) {\r\n      logger.error(\"\\nMessage:\");\r\n      logger.error(error.cause);\r\n    }\r\n\r\n    if (error.suggestion) {\r\n      logger.error(\"\\nSuggestion:\");\r\n      logger.error(error.suggestion);\r\n    }\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  if (error instanceof z.ZodError) {\r\n    logger.error(\"Validation failed:\");\r\n    for (const [key, value] of Object.entries(error.flatten().fieldErrors)) {\r\n      logger.error(`- ${highlighter.info(key)}: ${value}`);\r\n    }\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  if (error instanceof Error) {\r\n    logger.error(error.message);\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  logger.break();\r\n  process.exit(1);\r\n}\r\n","export function expandEnvVars(value: string) {\r\n  return value.replace(/\\${(\\w+)}/g, (_match, key) => process.env[key] || \"\")\r\n}\r\n\r\nexport function extractEnvVars(value: string) {\r\n  const vars: string[] = []\r\n  const regex = /\\${(\\w+)}/g\r\n  let match: RegExpExecArray | null\r\n\r\n  while ((match = regex.exec(value)) !== null) {\r\n    vars.push(match[1])\r\n  }\r\n\r\n  return vars\r\n}\r\n","// Valid registry name pattern: @namespace where namespace is alphanumeric with hyphens/underscores\r\nconst REGISTRY_PATTERN = /^(@[a-zA-Z0-9](?:[a-zA-Z0-9-_]*[a-zA-Z0-9])?)\\/(.+)$/\r\n\r\nexport function parseRegistryAndItemFromString(name: string) {\r\n  if (!name.startsWith(\"@\")) {\r\n    return {\r\n      registry: null,\r\n      item: name,\r\n    }\r\n  }\r\n\r\n  const match = name.match(REGISTRY_PATTERN)\r\n  if (match) {\r\n    return {\r\n      registry: match[1],\r\n      item: match[2],\r\n    }\r\n  }\r\n\r\n  return {\r\n    registry: null,\r\n    item: name,\r\n  }\r\n}\r\n","export function isUrl(path: string) {\r\n  try {\r\n    new URL(path);\r\n    return true;\r\n  } catch (error) {\r\n    return false;\r\n  }\r\n}\r\n\r\nexport function isLocalFile(path: string) {\r\n  return path.endsWith(\".json\") && !isUrl(path);\r\n}\r\n","import deepmerge from \"deepmerge\";\r\nimport { Config, createConfig } from \"../utils/get-config\";\r\nimport { BUILTIN_REGISTRIES, FALLBACK_STYLE } from \"./constants\";\r\nimport { configSchema } from \"./schema\";\r\n\r\nfunction resolveStyleFromConfig(config: Partial<Config> | Config) {\r\n  if (!config.style) {\r\n    return FALLBACK_STYLE;\r\n  }\r\n\r\n  // Check if we should use aodesu for tailwind\r\n  // We assume that if tailwind.config is empty, we're using tailwind v4.\r\n  if (config.style === \"aodesu\" && config.tailwind?.config === \"\") {\r\n    return FALLBACK_STYLE;\r\n  }\r\n\r\n  return config.style;\r\n}\r\n\r\nexport function configWithDefaults(config?: Partial<Config> | Config) {\r\n  const baseConfig = createConfig({\r\n    style: FALLBACK_STYLE,\r\n    registries: BUILTIN_REGISTRIES,\r\n  });\r\n\r\n  if (!config) {\r\n    return baseConfig;\r\n  }\r\n\r\n  return configSchema.parse(\r\n    deepmerge(baseConfig, {\r\n      ...config,\r\n      style: resolveStyleFromConfig(config),\r\n      registries: { ...BUILTIN_REGISTRIES, ...config.registries },\r\n    })\r\n  )\r\n};\r\n","interface RegistryContext {\r\n  headers: Record<string, Record<string, string>>\r\n}\r\n\r\nlet context: RegistryContext = {\r\n  headers: {},\r\n}\r\n\r\nexport function setRegistryHeaders(\r\n  headers: Record<string, Record<string, string>>\r\n) {\r\n  // Merge new headers with existing ones to preserve headers for nested dependencies\r\n  context.headers = { ...context.headers, ...headers };\r\n}\r\n\r\nexport function getRegistryHeadersFromContext(\r\n  url: string\r\n): Record<string, string> {\r\n  return context.headers[url] || {}\r\n};\r\n\r\nexport function clearRegistryContext() {\r\n  context.headers = {};\r\n}\r\n","import z from \"zod\";\r\nimport { Config } from \"../utils/get-config\";\r\nimport { buildUrlAndHeadersForRegistryItem } from \"./builder\";\r\nimport { configWithDefaults } from \"./config\";\r\nimport { clearRegistryContext } from \"./context\";\r\nimport { extractEnvVars } from \"./env\";\r\nimport { RegistryMissingEnvironmentVariablesError } from \"./errors\";\r\nimport { registryConfigItemSchema } from \"./schema\";\r\n\r\nexport function extractEnvVarsFromRegistryConfig(\r\n  config: z.infer<typeof registryConfigItemSchema>\r\n): string[] {\r\n  const vars = new Set<string>();\r\n\r\n  if (typeof config === \"string\") {\r\n    extractEnvVars(config).forEach((v) => vars.add(v));\r\n  } else {\r\n    extractEnvVars(config.url).forEach((v) => vars.add(v));\r\n\r\n    if (config.params) {\r\n      Object.values(config.params).forEach((value) => {\r\n        extractEnvVars(value).forEach((v) => vars.add(v));\r\n      })\r\n    }\r\n\r\n    if (config.headers) {\r\n      Object.values(config.headers).forEach((value) => {\r\n        extractEnvVars(value).forEach((v) => vars.add(v));\r\n      })\r\n    }\r\n  }\r\n\r\n  return Array.from(vars);\r\n}\r\n\r\nexport function validateRegistryConfig(\r\n  registryName: string,\r\n  config: z.infer<typeof registryConfigItemSchema>\r\n): void {\r\n  const requiredVars = extractEnvVarsFromRegistryConfig(config);\r\n  const missing = requiredVars.filter((v) => !process.env[v]);\r\n\r\n  if (missing.length > 0) {\r\n    throw new RegistryMissingEnvironmentVariablesError(registryName, missing);\r\n  }\r\n}\r\n\r\nexport function validateRegistryConfigForItems(\r\n  items: string[],\r\n  config?: Config\r\n): void {\r\n  for (const item of items) {\r\n    buildUrlAndHeadersForRegistryItem(item, configWithDefaults(config));\r\n  }\r\n\r\n  // Clear registry context after validation.\r\n  clearRegistryContext();\r\n}\r\n","import z from \"zod\";\r\nimport { Config } from \"../utils/get-config\";\r\nimport { REGISTRY_URL } from \"./constants\";\r\nimport { expandEnvVars } from \"./env\";\r\nimport { RegistryNotConfiguredError } from \"./errors\";\r\nimport { parseRegistryAndItemFromString } from \"./parser\";\r\nimport { registryConfigItemSchema } from \"./schema\";\r\nimport { isUrl } from \"./utils\";\r\nimport { validateRegistryConfig } from \"./validator\";\r\n\r\nconst NAME_PLACEHOLDER = \"{name}\";\r\nconst STYLE_PLACEHOLDER = \"{style}\";\r\nconst ENV_VAR_PATTER = /\\${(\\w+)}/g\r\nconst QUERY_PARAM_SEPARATOR = \"?\";\r\nconst QUERY_PARAM_DELIMITER = \"&\";\r\n\r\nexport function buildUrlAndHeadersForRegistryItem(\r\n  name: string,\r\n  config?: Config\r\n) {\r\n  const { registry, item } = parseRegistryAndItemFromString(name);\r\n\r\n  if (!registry) {\r\n    return null;\r\n  }\r\n\r\n  const registries = config?.registries || {};\r\n  const registryConfig = registries[registry];\r\n  if (!registryConfig) {\r\n    throw new RegistryNotConfiguredError(registry);\r\n  }\r\n\r\n  validateRegistryConfig(registry, registryConfig);\r\n\r\n  return {\r\n    url: buildUrlFromRegistryConfig(item, registryConfig, config),\r\n    headers: buildHeadersFromRegistryConfig(registryConfig),\r\n  }\r\n}\r\n\r\nexport function buildUrlFromRegistryConfig(\r\n  item: string,\r\n  registryConfig: z.infer<typeof registryConfigItemSchema>,\r\n  config?: Config\r\n) {\r\n  if (typeof registryConfig === \"string\") {\r\n    let url = registryConfig.replace(NAME_PLACEHOLDER, item);\r\n    if (config?.style && url.includes(STYLE_PLACEHOLDER)) {\r\n      url = url.replace(STYLE_PLACEHOLDER, config.style);\r\n    }\r\n    return expandEnvVars(url);\r\n  }\r\n\r\n  let baseUrl = registryConfig.url.replace(NAME_PLACEHOLDER, item);\r\n  if (config?.style && baseUrl.includes(STYLE_PLACEHOLDER)) {\r\n    baseUrl = baseUrl.replace(STYLE_PLACEHOLDER, config.style);\r\n  }\r\n  baseUrl = expandEnvVars(baseUrl);\r\n\r\n  if (!registryConfig.params) {\r\n    return baseUrl;\r\n  }\r\n\r\n  return appendQueryParams(baseUrl, registryConfig.params);\r\n}\r\n\r\nexport function buildHeadersFromRegistryConfig(\r\n  config: z.infer<typeof registryConfigItemSchema>\r\n) {\r\n  if (typeof config === \"string\" || !config.headers) {\r\n    return {}\r\n  }\r\n\r\n  const headers: Record<string, string> = {};\r\n\r\n  for (const [key, value] of Object.entries(config.headers)) {\r\n    const expandedValue = expandEnvVars(value);\r\n\r\n    if (shouldIncludeHeader(value, expandedValue)) {\r\n      headers[key] = expandedValue;\r\n    }\r\n  }\r\n\r\n  return headers;\r\n}\r\n\r\nfunction appendQueryParams(baseUrl: string, params: Record<string, string>) {\r\n  const urlParams = new URLSearchParams();\r\n\r\n  for (const [key, value] of Object.entries(params)) {\r\n    const expandedValue = expandEnvVars(value);\r\n    if (expandedValue) {\r\n      urlParams.append(key, expandedValue);\r\n    }\r\n  }\r\n\r\n  const queryString = urlParams.toString();\r\n  if (!queryString) {\r\n    return baseUrl;\r\n  }\r\n\r\n  const separator = baseUrl.includes(QUERY_PARAM_SEPARATOR)\r\n    ? QUERY_PARAM_DELIMITER\r\n    : QUERY_PARAM_SEPARATOR;\r\n\r\n  return `${baseUrl}${separator}${queryString}`;\r\n}\r\n\r\nfunction shouldIncludeHeader(originalValue: string, expandedValue: string) {\r\n  const trimmedExpanded = expandedValue.trim();\r\n\r\n  if (!trimmedExpanded) {\r\n    return false;\r\n  }\r\n\r\n  // If the original value contains valid en vars, only include if expansion changed the value.\r\n  if (originalValue.includes(\"${\")) {\r\n    // Check if there are actual en vars in the string\r\n    const envVars = originalValue.match(ENV_VAR_PATTER);\r\n    if (envVars) {\r\n      const templateWithoutVars = originalValue\r\n        .replace(ENV_VAR_PATTER, \"\")\r\n        .trim();\r\n\r\n      return trimmedExpanded !== templateWithoutVars;\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nexport function resolveRegistryUrl(pathOrUrl: string) {\r\n  if (isUrl(pathOrUrl)) {\r\n    // If the url contains /chat/b, we assume it's the v0 registry.\r\n    // We need to add the /json suffix if it's missing.\r\n    const url = new URL(pathOrUrl);\r\n    if (url.pathname.match(/\\/chat\\/b\\//) && !url.pathname.endsWith(\"/json\")) {\r\n      url.pathname = `${url.pathname}/json`\r\n    }\r\n\r\n    return url.toString();\r\n  }\r\n\r\n  return `${REGISTRY_URL}/${pathOrUrl}`;\r\n}\r\n","import { resolveRegistryUrl } from \"@/src/registry/builder\"\r\nimport { getRegistryHeadersFromContext } from \"@/src/registry/context\"\r\nimport {\r\n  RegistryFetchError,\r\n  RegistryForbiddenError,\r\n  RegistryLocalFileError,\r\n  RegistryNotFoundError,\r\n  RegistryParseError,\r\n  RegistryUnauthorizedError,\r\n} from \"@/src/registry/errors\"\r\nimport { registryItemSchema } from \"@/src/schema\"\r\nimport { promises as fs } from \"fs\"\r\nimport { HttpsProxyAgent } from \"https-proxy-agent\"\r\nimport fetch from \"node-fetch\"\r\nimport { homedir } from \"os\"\r\nimport path from \"path\"\r\nimport { z } from \"zod\"\r\n\r\nconst agent = process.env.https_proxy\r\n  ? new HttpsProxyAgent(process.env.https_proxy)\r\n  : undefined\r\n\r\nconst registryCache = new Map<string, Promise<any>>()\r\n\r\nexport function clearRegistryCache() {\r\n  registryCache.clear()\r\n}\r\n\r\nexport async function fetchRegistry(\r\n  paths: string[],\r\n  options: { useCache?: boolean } = {}\r\n) {\r\n  options = {\r\n    useCache: true,\r\n    ...options,\r\n  }\r\n\r\n  try {\r\n    const results = await Promise.all(\r\n      paths.map(async (path) => {\r\n        const url = resolveRegistryUrl(path)\r\n\r\n        // Check cache first if caching is enabled\r\n        if (options.useCache && registryCache.has(url)) {\r\n          return registryCache.get(url)\r\n        }\r\n\r\n        // Store the promise in the cache before awaiting if caching is enabled.\r\n        const fetchPromise = (async () => {\r\n          // Get headers from context for this URL.\r\n          const headers = getRegistryHeadersFromContext(url)\r\n\r\n          const response = await fetch(url, {\r\n            agent,\r\n            headers: {\r\n              ...headers,\r\n            },\r\n          })\r\n\r\n          if (!response.ok) {\r\n            let messageFromServer = undefined\r\n\r\n            if (\r\n              response.headers.get(\"content-type\")?.includes(\"application/json\")\r\n            ) {\r\n              const json = await response.json()\r\n              const parsed = z\r\n                .object({\r\n                  // RFC 7807.\r\n                  detail: z.string().optional(),\r\n                  title: z.string().optional(),\r\n                  // Standard error response.\r\n                  message: z.string().optional(),\r\n                  error: z.string().optional(),\r\n                })\r\n                .safeParse(json)\r\n\r\n              if (parsed.success) {\r\n                // Prefer RFC 7807 detail field, then message field.\r\n                messageFromServer = parsed.data.detail || parsed.data.message\r\n\r\n                if (parsed.data.error) {\r\n                  messageFromServer = `[${parsed.data.error}] ${messageFromServer}`\r\n                }\r\n              }\r\n            }\r\n\r\n            if (response.status === 401) {\r\n              throw new RegistryUnauthorizedError(url, messageFromServer)\r\n            }\r\n\r\n            if (response.status === 404) {\r\n              throw new RegistryNotFoundError(url, messageFromServer)\r\n            }\r\n\r\n            if (response.status === 403) {\r\n              throw new RegistryForbiddenError(url, messageFromServer)\r\n            }\r\n\r\n            throw new RegistryFetchError(\r\n              url,\r\n              response.status,\r\n              messageFromServer\r\n            )\r\n          }\r\n\r\n          return response.json()\r\n        })()\r\n\r\n        if (options.useCache) {\r\n          registryCache.set(url, fetchPromise)\r\n        }\r\n        return fetchPromise\r\n      })\r\n    )\r\n\r\n    return results\r\n  } catch (error) {\r\n    throw error\r\n  }\r\n}\r\n\r\nexport async function fetchRegistryLocal(filePath: string) {\r\n  try {\r\n    // Handle tilde expansion for home directory\r\n    let expandedPath = filePath\r\n    if (filePath.startsWith(\"~/\")) {\r\n      expandedPath = path.join(homedir(), filePath.slice(2))\r\n    }\r\n\r\n    const resolvedPath = path.resolve(expandedPath)\r\n    const content = await fs.readFile(resolvedPath, \"utf8\")\r\n    const parsed = JSON.parse(content)\r\n\r\n    try {\r\n      return registryItemSchema.parse(parsed)\r\n    } catch (error) {\r\n      throw new RegistryParseError(filePath, error)\r\n    }\r\n  } catch (error) {\r\n    // Check if this is a file not found error\r\n    if (\r\n      error instanceof Error &&\r\n      (error.message.includes(\"ENOENT\") ||\r\n        error.message.includes(\"no such file\"))\r\n    ) {\r\n      throw new RegistryLocalFileError(filePath, error)\r\n    }\r\n    // Re-throw parse errors as-is\r\n    if (error instanceof RegistryParseError) {\r\n      throw error\r\n    }\r\n    // For other errors (like JSON parse errors), throw as local file error\r\n    throw new RegistryLocalFileError(filePath, error)\r\n  }\r\n}\r\n","// Internal function that fetches registry items without clearing context.\r\n\r\nimport { Config } from \"../utils/get-config\";\r\nimport { buildUrlAndHeadersForRegistryItem } from \"./builder\";\r\nimport { setRegistryHeaders } from \"./context\";\r\nimport { RegistryParseError } from \"./errors\";\r\nimport { fetchRegistry, fetchRegistryLocal } from \"./fetcher\";\r\nimport { registryItemSchema } from \"./schema\";\r\nimport { isLocalFile, isUrl } from \"./utils\";\r\n\r\nexport function resolveRegistryItemsFromRegistries(\r\n  items: string[],\r\n  config: Config\r\n) {\r\n  const registryHeaders: Record<string, Record<string, string>> = {};\r\n  const resolvedItems = [...items];\r\n\r\n  if (!config?.registries) {\r\n    setRegistryHeaders({});\r\n    return resolvedItems;\r\n  }\r\n\r\n  for (let i = 0; i < resolvedItems.length; i++) {\r\n    const resolved = buildUrlAndHeadersForRegistryItem(resolvedItems[i], config);\r\n\r\n    if (resolved) {\r\n      resolvedItems[i] = resolved.url;\r\n\r\n      if (Object.keys(resolved.headers).length > 0) {\r\n        registryHeaders[resolved.url] = resolved.headers;\r\n      }\r\n    }\r\n  }\r\n\r\n  setRegistryHeaders(registryHeaders);\r\n\r\n  return resolvedItems;\r\n}\r\n\r\n// This is used for recursive dependecy resolution.\r\nexport async function fetchRegistryItems(\r\n  items: string[],\r\n  config: Config,\r\n  options: { useCache?: boolean } = {}\r\n) {\r\n  const results = await Promise.all(\r\n    items.map(async (item) => {\r\n      if (isLocalFile(item)) {\r\n        return fetchRegistryLocal(item);\r\n      }\r\n\r\n      if (isUrl(item)) {\r\n        const [result] = await fetchRegistry([item], options);\r\n        try {\r\n          return registryItemSchema.parse(result);\r\n        } catch (error) {\r\n          throw new RegistryParseError(item, error);\r\n        }\r\n      }\r\n\r\n      if (item.startsWith(\"@\") && config?.registries) {\r\n        const paths = resolveRegistryItemsFromRegistries([item], config);\r\n        const [result] = await fetchRegistry(paths, options);\r\n        try {\r\n          return registryItemSchema.parse(result);\r\n        } catch (error) {\r\n          throw new RegistryParseError(item, error);\r\n        }\r\n      }\r\n\r\n\r\n      const path = `styles/${config?.style ?? \"aodesu\"}/${item}.json`;\r\n      const [result] = await fetchRegistry([path], options);\r\n        console.log(\"TEST - LLEGO AKI\")\r\n      try {\r\n        return registryItemSchema.parse(result);\r\n      } catch (error) {\r\n        throw new RegistryParseError(item, error);\r\n      }\r\n    })\r\n  )\r\n\r\n  return results;\r\n}\r\n","import z from \"zod\";\r\nimport { Config } from \"../utils/get-config\";\r\nimport { handleError } from \"../utils/handle-error\";\r\nimport { logger } from \"../utils/logger\";\r\nimport { buildUrlAndHeadersForRegistryItem } from \"./builder\";\r\nimport { configWithDefaults } from \"./config\";\r\nimport { REGISTRY_URL } from \"./constants\";\r\nimport { clearRegistryContext, setRegistryHeaders } from \"./context\";\r\nimport { RegistriesIndexParseError, RegistryInvalidNamespaceError, RegistryNotFoundError, RegistryParseError } from \"./errors\";\r\nimport { fetchRegistry } from \"./fetcher\";\r\nimport { fetchRegistryItems } from \"./resolver\";\r\nimport { registriesIndexSchema, registryIndexSchema, registrySchema } from \"./schema\";\r\nimport { isUrl } from \"./utils\";\r\n\r\nexport async function getRegistry(\r\n  name: string,\r\n  options?: {\r\n    config?: Partial<Config>\r\n    useCache?: boolean\r\n  }\r\n) {\r\n  const { config, useCache } = options || {};\r\n\r\n  if (isUrl(name)) {\r\n    const [result] = await fetchRegistry([name], { useCache });\r\n    try {\r\n      return registrySchema.parse(result);\r\n    } catch (error) {\r\n      throw new RegistryParseError(name, error);\r\n    }\r\n  }\r\n\r\n  if (!name.startsWith(\"@\")) {\r\n    throw new RegistryInvalidNamespaceError(name);\r\n  }\r\n\r\n  let registryName = name;\r\n  if (!registryName.endsWith(\"/registry\")) {\r\n    registryName = `${registryName}/registry`\r\n  }\r\n\r\n  const urlAndHeaders = buildUrlAndHeadersForRegistryItem(\r\n    registryName as `@${string}`,\r\n    configWithDefaults(config)\r\n  );\r\n\r\n  if (!urlAndHeaders?.url) {\r\n    throw new RegistryNotFoundError(registryName);\r\n  }\r\n\r\n  if (urlAndHeaders.headers && Object.keys(urlAndHeaders.headers).length > 0) {\r\n    setRegistryHeaders({\r\n      [urlAndHeaders.url]: urlAndHeaders.headers,\r\n    })\r\n  }\r\n\r\n  const [result] = await fetchRegistry([urlAndHeaders.url], { useCache });\r\n\r\n  try {\r\n    return registrySchema.parse(result);\r\n  } catch (error) {\r\n    throw new RegistryParseError(registryName, error);\r\n  }\r\n}\r\n\r\nexport async function getRegistryItems(\r\n  items: string[],\r\n  options?: {\r\n    config?: Partial<Config>\r\n    useCache?: boolean\r\n  }\r\n) {\r\n  const { config, useCache } = options || {};\r\n\r\n  clearRegistryContext();\r\n\r\n  return fetchRegistryItems(items, configWithDefaults(config), { useCache })\r\n}\r\n\r\n\r\nexport async function getShadcnRegistryIndex() {\r\n  try {\r\n    const [result] = await fetchRegistry([\"index.json\"])\r\n\r\n    return registryIndexSchema.parse(result)\r\n  } catch (error) {\r\n    logger.error(\"\\n\")\r\n    handleError(error)\r\n  }\r\n}\r\n\r\n\r\nexport async function getRegistriesIndex(options?: { useCache?: boolean }) {\r\n  options = {\r\n    useCache: true,\r\n    ...options,\r\n  }\r\n\r\n  const url = `${REGISTRY_URL}/registries.json`\r\n  const [data] = await fetchRegistry([url], {\r\n    useCache: options.useCache,\r\n  })\r\n\r\n  try {\r\n    return registriesIndexSchema.parse(data)\r\n  } catch (error) {\r\n    if (error instanceof z.ZodError) {\r\n      throw new RegistriesIndexParseError(error)\r\n    }\r\n\r\n    throw error\r\n  }\r\n}\r\n","import { detect } from \"@antfu/ni\"\r\n\r\nexport async function getPackageManager(\r\n  targetDir: string,\r\n  { withFallback }: { withFallback?: boolean } = {\r\n    withFallback: false,\r\n  }\r\n): Promise<\"yarn\" | \"pnpm\" | \"bun\" | \"npm\" | \"deno\"> {\r\n  const packageManager = await detect({ programmatic: true, cwd: targetDir })\r\n\r\n  if (packageManager === \"yarn@berry\") return \"yarn\"\r\n  if (packageManager === \"pnpm@6\") return \"pnpm\"\r\n  if (packageManager === \"bun\") return \"bun\"\r\n  if (packageManager === \"deno\") return \"deno\"\r\n  if (!withFallback) {\r\n    return packageManager ?? \"npm\"\r\n  }\r\n\r\n  // Fallback to user agent if not detected.\r\n  const userAgent = process.env.npm_config_user_agent || \"\"\r\n\r\n  if (userAgent.startsWith(\"yarn\")) {\r\n    return \"yarn\"\r\n  }\r\n\r\n  if (userAgent.startsWith(\"pnpm\")) {\r\n    return \"pnpm\"\r\n  }\r\n\r\n  if (userAgent.startsWith(\"bun\")) {\r\n    return \"bun\"\r\n  }\r\n\r\n  return \"npm\"\r\n}\r\n\r\nexport async function getPackageRunner(cwd: string) {\r\n  const packageManager = await getPackageManager(cwd)\r\n\r\n  if (packageManager === \"pnpm\") return \"pnpm dlx\"\r\n\r\n  if (packageManager === \"bun\") return \"bunx\"\r\n\r\n  return \"npx\"\r\n}\r\n","import { initOptionsSchema } from \"@/src/commands/init\";\r\nimport { fetchRegistry } from \"@/src/registry/fetcher\";\r\nimport { getPackageManager } from \"@/src/utils/get-package-manager\";\r\nimport { handleError } from \"@/src/utils/handle-error\";\r\nimport { highlighter } from \"@/src/utils/highlighter\";\r\nimport { logger } from \"@/src/utils/logger\";\r\nimport { spinner } from \"@/src/utils/spinner\";\r\nimport { execa } from \"execa\";\r\nimport fs from \"fs-extra\";\r\nimport os from \"os\";\r\nimport path from \"path\";\r\nimport prompts from \"prompts\";\r\nimport z from \"zod\";\r\n\r\nconst MONOREPO_TEMPLATE_URL = \"https://codeload.github.com/shadcn-ui/ui/tar.gz/main\";\r\n\r\nexport const TEMPLATES = {\r\n  next: \"next\",\r\n  \"next-16\": \"next-16\",\r\n  \"next-monorepo\": \"next-monorepo\",\r\n  vite: \"vite\"\r\n} as const;\r\n\r\nexport async function createProject(\r\n  options: Pick<\r\n    z.infer<typeof initOptionsSchema>,\r\n    \"cwd\" | \"force\" | \"srcDir\" | \"components\" | \"template\"\r\n  >\r\n) {\r\n  options = {\r\n    srcDir: false,\r\n    ...options,\r\n  };\r\n\r\n  let template: keyof typeof TEMPLATES =\r\n    options.template && TEMPLATES[options.template as keyof typeof TEMPLATES]\r\n    ? (options.template as keyof typeof TEMPLATES)\r\n    : \"next\";\r\n\r\n  let projectName: string =\r\n    template === TEMPLATES.next ? \"my-app\" : \"my-monorepo\";\r\n\r\n  let nextVersion = \"15\";\r\n\r\n  const isRemoteComponent =\r\n    options.components?.length === 1 &&\r\n    !!options.components[0].match(/\\/chat\\/b\\//);\r\n\r\n  if (options.components && isRemoteComponent) {\r\n    try {\r\n      const [result] = await fetchRegistry(options.components);\r\n      const { meta } = z\r\n        .object({\r\n          meta: z.object({\r\n            nextVersion: z.string(),\r\n          }),\r\n        })\r\n        .parse(result);\r\n      nextVersion = meta.nextVersion;\r\n\r\n      // Force template to next for remote components.\r\n      template = TEMPLATES.next;\r\n    } catch (error) {\r\n      logger.break();\r\n      handleError(error);\r\n    }\r\n  }\r\n\r\n  if (!options.force) {\r\n    const { type, name } = await prompts([\r\n      {\r\n        type: options.template || isRemoteComponent ? null : \"select\",\r\n        name: \"type\",\r\n        message: `The path ${highlighter.info(\r\n          options.cwd\r\n        )} does not contain a package.json file.\\n  Would you like to start a new project?`,\r\n        choices: [\r\n          { title: \"Vite\", value: \"vite\" },\r\n          { title: \"Next.js 15\", value: \"next\" },\r\n          { title: \"Next.js 16\", value: \"next-16\" },\r\n          { title: \"Next.js (Monorepo)\", value: \"next-monorepo\" },\r\n        ],\r\n        initial: 0,\r\n      },\r\n      {\r\n        type: \"text\",\r\n        name: \"name\",\r\n        message: \"What is your project named?\",\r\n        initial: projectName,\r\n        format: (value: string) => value.trim(),\r\n        validate: (value: string) =>\r\n          value.length > 128\r\n            ? `Name should be less than 128 characters.`\r\n            : true,\r\n      },\r\n    ])\r\n\r\n    template = type ?? template;\r\n    projectName = name;\r\n\r\n    if (type === \"next-16\") {\r\n      nextVersion = \"latest\"\r\n    }\r\n  }\r\n\r\n  const packageManager = await getPackageManager(options.cwd, {\r\n    withFallback: true,\r\n  });\r\n\r\n  const projectPath = `${options.cwd}/${projectName}`;\r\n\r\n  // Check if path is writable.\r\n  try {\r\n    await fs.access(options.cwd, fs.constants.W_OK);\r\n  } catch (error) {\r\n    logger.break()\r\n    logger.error(`The path ${highlighter.info(options.cwd)} is not writable.`)\r\n    logger.error(\r\n      `It is likely you do not have write permissions for this folder or the path ${highlighter.info(\r\n        options.cwd\r\n      )} does not exist.`\r\n    )\r\n    logger.break()\r\n    process.exit(1)\r\n  }\r\n\r\n  if (fs.existsSync(path.resolve(options.cwd, projectName, \"package.json\"))) {\r\n    logger.break()\r\n    logger.error(\r\n      `A project with the name ${highlighter.info(projectName)} already exists.`\r\n    )\r\n    logger.error(`Please choose a different name and try again.`)\r\n    logger.break()\r\n    process.exit(1)\r\n  }\r\n\r\n  if (template === TEMPLATES.vite) {\r\n    await createViteProject(projectPath, {\r\n      packageManager\r\n    })\r\n  }\r\n\r\n  if (template === TEMPLATES.next || template === TEMPLATES[\"next-16\"]) {\r\n    await createNextProject(projectPath, {\r\n      version: nextVersion,\r\n      cwd: options.cwd,\r\n      packageManager,\r\n      srcDir: !!options.srcDir,\r\n    })\r\n  }\r\n\r\n  if (template === TEMPLATES[\"next-monorepo\"]) {\r\n    await createMonorepoProject(projectPath, {\r\n      packageManager,\r\n    })\r\n  }\r\n\r\n  return {\r\n    projectPath,\r\n    projectName,\r\n    template,\r\n  }\r\n}\r\n\r\nasync function createViteProject(\r\n  projectPath: string,\r\n  options: {\r\n    packageManager: string\r\n  }\r\n) {\r\n  const createSpinner = spinner(\r\n    `Creating a new Vite project. This may take a few minutes.`\r\n  ).start();\r\n\r\n  try {\r\n    const args = [\r\n      \"create\",\r\n      \"vite@latest\",\r\n      path.basename(projectPath),\r\n      \"--template\",\r\n      \"react-ts\",\r\n      \"--yes\"\r\n    ]\r\n\r\n    await execa(options.packageManager, args, {\r\n      cwd: path.dirname(projectPath),\r\n    });\r\n\r\n    const installSpinner = spinner(`Installing dependencies with ${options.packageManager}.`).start();\r\n\r\n    await execa(options.packageManager, [\"install\"], {\r\n      cwd: projectPath,\r\n    });\r\n\r\n    installSpinner?.succeed(`Installed dependencies with ${options.packageManager}.`);\r\n\r\n    try {\r\n      await execa(\"git\", [\"init\"], { cwd: projectPath })\r\n      await execa(\"git\", [\"add\", \"-A\"], { cwd: projectPath })\r\n      await execa(\"git\", [\"commit\", \"-m\", \"Initial commit from shadcn-ui\"], {\r\n        cwd: projectPath,\r\n      })\r\n    } catch (gitError) {\r\n      logger.warn(\"Git initialization skipped (git not available)\")\r\n    }\r\n\r\n    createSpinner?.succeed(\"Creating a new Vite project.\");\r\n  } catch (error) {\r\n    createSpinner?.fail(\"Something went worng creating a new Vite project.\");\r\n    handleError(error);\r\n  }\r\n}\r\n\r\nasync function createNextProject(\r\n  projectPath: string,\r\n  options: {\r\n    version: string\r\n    cwd: string\r\n    packageManager: string\r\n    srcDir: boolean\r\n  }\r\n) {\r\n  const createSpinner = spinner(\r\n    `Creating a new Next.js ${\r\n      options.version.startsWith(\"latest\") ? \"16\" : \"15\"\r\n    } project. This may take a few minutes.`\r\n  ).start()\r\n\r\n  // Note: pnpm fails here. Fallback to npx with --use-PACKAGE-MANAGER.\r\n  const args = [\r\n    \"--tailwind\",\r\n    \"--eslint\",\r\n    \"--typescript\",\r\n    \"--app\",\r\n    options.srcDir ? \"--src-dir\" : \"--no-src-dir\",\r\n    \"--no-import-alias\",\r\n    `--use-${options.packageManager}`,\r\n  ]\r\n\r\n  if (\r\n    options.version.startsWith(\"15\") ||\r\n    options.version.startsWith(\"latest\") ||\r\n    options.version.startsWith(\"canary\")\r\n  ) {\r\n    args.push(\"--turbopack\")\r\n  }\r\n\r\n  if (\r\n    options.version.startsWith(\"latest\") ||\r\n    options.version.startsWith(\"canary\")\r\n  ) {\r\n    args.push(\"--no-react-compiler\")\r\n  }\r\n\r\n  try {\r\n    await execa(\r\n      \"npx\",\r\n      [`create-next-app@${options.version}`, projectPath, \"--silent\", ...args],\r\n      {\r\n        cwd: options.cwd,\r\n      }\r\n    )\r\n  } catch (error) {\r\n    logger.break()\r\n    logger.error(\r\n      `Something went wrong creating a new Next.js project. Please try again.`\r\n    )\r\n    process.exit(1)\r\n  }\r\n\r\n  createSpinner?.succeed(\r\n    `Creating a new Next.js ${\r\n      options.version.startsWith(\"latest\") ? \"16\" : \"15\"\r\n    } project.`\r\n  )\r\n}\r\n\r\nasync function createMonorepoProject(\r\n  projectPath: string,\r\n  options: {\r\n    packageManager: string\r\n  }\r\n) {\r\n  const createSpinner = spinner(\r\n    `Creating a new Next.js monorepo. This may take a few minutes.`\r\n  ).start()\r\n\r\n  try {\r\n    // Get the template.\r\n    const templatePath = path.join(os.tmpdir(), `shadcn-template-${Date.now()}`)\r\n    await fs.ensureDir(templatePath)\r\n    const response = await fetch(MONOREPO_TEMPLATE_URL)\r\n    if (!response.ok) {\r\n      throw new Error(`Failed to download template: ${response.statusText}`)\r\n    }\r\n\r\n    // Write the tar file\r\n    const tarPath = path.resolve(templatePath, \"template.tar.gz\")\r\n    await fs.writeFile(tarPath, Buffer.from(await response.arrayBuffer()))\r\n    await execa(\"tar\", [\r\n      \"-xzf\",\r\n      tarPath,\r\n      \"-C\",\r\n      templatePath,\r\n      \"--strip-components=2\",\r\n      \"ui-main/templates/monorepo-next\",\r\n    ])\r\n    const extractedPath = path.resolve(templatePath, \"monorepo-next\")\r\n    await fs.move(extractedPath, projectPath)\r\n    await fs.remove(templatePath)\r\n\r\n    // Run install.\r\n    await execa(options.packageManager, [\"install\"], {\r\n      cwd: projectPath,\r\n    })\r\n    // await execa(\"cd\", [cwd])\r\n\r\n    // Write project name to the package.json\r\n    const packageJsonPath = path.join(projectPath, \"package.json\")\r\n    if (fs.existsSync(packageJsonPath)) {\r\n      const packageJsonContent = await fs.readFile(packageJsonPath, \"utf8\")\r\n      const packageJson = JSON.parse(packageJsonContent)\r\n      packageJson.name = projectPath.split(\"/\").pop()\r\n      await fs.writeFile(packageJsonPath, JSON.stringify(packageJson, null, 2))\r\n    }\r\n\r\n    // Try git init.\r\n    const cwd = process.cwd()\r\n    await execa(\"git\", [\"--version\"], { cwd: projectPath })\r\n    await execa(\"git\", [\"init\"], { cwd: projectPath })\r\n    await execa(\"git\", [\"add\", \"-A\"], { cwd: projectPath })\r\n    await execa(\"git\", [\"commit\", \"-m\", \"Initial commit\"], {\r\n      cwd: projectPath,\r\n    })\r\n\r\n    createSpinner?.succeed(\"Creating a new Next.js monorepo.\")\r\n  } catch (error) {\r\n    createSpinner?.fail(\"Something went wrong creating a new Next.js monorepo.\")\r\n    handleError(error)\r\n  }\r\n}\r\n","import { existsSync } from \"fs\";\r\nimport { join } from \"path\";\r\nimport { logger } from \"./logger\";\r\n\r\nexport async function loadEnvFiles(cwd: string = process.cwd()): Promise<void> {\r\n  try {\r\n    const { config } = await import(\"@dotenvx/dotenvx\");\r\n    const envFiles = [\r\n      \".env.local\",\r\n      \".env.development.local\",\r\n      \".env.development\",\r\n      \".env\"\r\n    ];\r\n\r\n    for (const envFile of envFiles) {\r\n      const envPath = join(cwd, envFile);\r\n      if (existsSync(envPath)) {\r\n        config({\r\n          path: envPath,\r\n          overload: false,\r\n          quiet: true\r\n        })\r\n      }\r\n    }\r\n  } catch (error) {\r\n    logger.warn(\"Failed to load env files:\", error);\r\n  }\r\n}\r\n","import fsExtra from \"fs-extra\"\r\n\r\nexport const FILE_BACKUP_SUFFIX = \".bak\"\r\n\r\nexport function createFileBackup(filePath: string): string | null {\r\n  if (!fsExtra.existsSync(filePath)) {\r\n    return null\r\n  }\r\n\r\n  const backupPath = `${filePath}${FILE_BACKUP_SUFFIX}`\r\n  try {\r\n    fsExtra.renameSync(filePath, backupPath)\r\n    return backupPath\r\n  } catch (error) {\r\n    console.error(`Failed to create backup of ${filePath}: ${error}`)\r\n    return null\r\n  }\r\n}\r\n\r\nexport function restoreFileBackup(filePath: string): boolean {\r\n  const backupPath = `${filePath}${FILE_BACKUP_SUFFIX}`\r\n\r\n  if (!fsExtra.existsSync(backupPath)) {\r\n    return false\r\n  }\r\n\r\n  try {\r\n    fsExtra.renameSync(backupPath, filePath)\r\n    return true\r\n  } catch (error) {\r\n    console.error(\r\n      `Warning: Could not restore backup file ${backupPath}: ${error}`\r\n    )\r\n    return false\r\n  }\r\n}\r\n\r\nexport function deleteFileBackup(filePath: string): boolean {\r\n  const backupPath = `${filePath}${FILE_BACKUP_SUFFIX}`\r\n\r\n  if (!fsExtra.existsSync(backupPath)) {\r\n    return false\r\n  }\r\n\r\n  try {\r\n    fsExtra.unlinkSync(backupPath)\r\n    return true\r\n  } catch (error) {\r\n    // Best effort - don't log as this is just cleanup\r\n    return false\r\n  }\r\n}\r\n","import { BUILTIN_REGISTRIES } from \"@/src/registry/constants\"\r\nimport { RegistryNotConfiguredError } from \"@/src/registry/errors\"\r\nimport { parseRegistryAndItemFromString } from \"@/src/registry/parser\"\r\nimport { fetchRegistryItems } from \"@/src/registry/resolver\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\n\r\n// Recursively discovers all registry namespaces including nested ones.\r\nexport async function resolveRegistryNamespaces(\r\n  components: string[],\r\n  config: Config\r\n) {\r\n  const discoveredNamespaces = new Set<string>()\r\n  const visitedItems = new Set<string>()\r\n  const itemsToProcess = [...components]\r\n\r\n  while (itemsToProcess.length > 0) {\r\n    const currentItem = itemsToProcess.shift()!\r\n\r\n    if (visitedItems.has(currentItem)) {\r\n      continue\r\n    }\r\n    visitedItems.add(currentItem)\r\n\r\n    const { registry } = parseRegistryAndItemFromString(currentItem)\r\n    if (registry && !BUILTIN_REGISTRIES[registry]) {\r\n      discoveredNamespaces.add(registry)\r\n    }\r\n\r\n    try {\r\n      const [item] = await fetchRegistryItems([currentItem], config, {\r\n        useCache: true,\r\n      })\r\n\r\n      if (item?.registryDependencies) {\r\n        for (const dep of item.registryDependencies) {\r\n          const { registry: depRegistry } = parseRegistryAndItemFromString(dep)\r\n          if (depRegistry && !BUILTIN_REGISTRIES[depRegistry]) {\r\n            discoveredNamespaces.add(depRegistry)\r\n          }\r\n\r\n          if (!visitedItems.has(dep)) {\r\n            itemsToProcess.push(dep)\r\n          }\r\n        }\r\n      }\r\n    } catch (error) {\r\n      // If a registry is not configured, we still track it.\r\n      if (error instanceof RegistryNotConfiguredError) {\r\n        const { registry } = parseRegistryAndItemFromString(currentItem)\r\n        if (registry && !BUILTIN_REGISTRIES[registry]) {\r\n          discoveredNamespaces.add(registry)\r\n        }\r\n        continue\r\n      }\r\n\r\n      // For other errors (network, parsing, etc.), we skip this item\r\n      // but continue processing others to discover as many namespaces as possible.\r\n      continue\r\n    }\r\n  }\r\n\r\n  return Array.from(discoveredNamespaces)\r\n}\r\n","import { getRegistriesIndex } from \"@/src/registry/api\"\r\nimport { BUILTIN_REGISTRIES } from \"@/src/registry/constants\"\r\nimport { resolveRegistryNamespaces } from \"@/src/registry/namespaces\"\r\nimport { rawConfigSchema } from \"@/src/registry/schema\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\nimport { spinner } from \"@/src/utils/spinner\"\r\nimport fs from \"fs-extra\"\r\nimport path from \"path\"\r\n\r\nexport async function ensureRegistriesInConfig(\r\n  components: string[],\r\n  config: Config,\r\n  options: {\r\n    silent?: boolean\r\n    writeFile?: boolean\r\n  } = {}\r\n) {\r\n  options = {\r\n    silent: false,\r\n    writeFile: true,\r\n    ...options,\r\n  }\r\n\r\n  // Use resolveRegistryNamespaces to discover all namespaces including dependencies.\r\n  const registryNames = await resolveRegistryNamespaces(components, config)\r\n\r\n  const missingRegistries = registryNames.filter(\r\n    (registry) =>\r\n      !config.registries?.[registry] &&\r\n      !Object.keys(BUILTIN_REGISTRIES).includes(registry)\r\n  )\r\n\r\n  if (missingRegistries.length === 0) {\r\n    return {\r\n      config,\r\n      newRegistries: [],\r\n    }\r\n  }\r\n\r\n  // We'll fail silently if we can't fetch the registry index.\r\n  // The error handling by caller will guide user to add the missing registries.\r\n  const registryIndex = await getRegistriesIndex({\r\n    useCache: process.env.NODE_ENV !== \"development\",\r\n  })\r\n\r\n  if (!registryIndex) {\r\n    return {\r\n      config,\r\n      newRegistries: [],\r\n    }\r\n  }\r\n\r\n  const foundRegistries: Record<string, string> = {}\r\n  for (const registry of missingRegistries) {\r\n    if (registryIndex[registry]) {\r\n      foundRegistries[registry] = registryIndex[registry]\r\n    }\r\n  }\r\n\r\n  if (Object.keys(foundRegistries).length === 0) {\r\n    return {\r\n      config,\r\n      newRegistries: [],\r\n    }\r\n  }\r\n\r\n  // Filter out built-in registries from existing config before merging\r\n  const existingRegistries = Object.fromEntries(\r\n    Object.entries(config.registries || {}).filter(\r\n      ([key]) => !Object.keys(BUILTIN_REGISTRIES).includes(key)\r\n    )\r\n  )\r\n\r\n  const newConfigWithRegistries = {\r\n    ...config,\r\n    registries: {\r\n      ...existingRegistries,\r\n      ...foundRegistries,\r\n    },\r\n  }\r\n\r\n  if (options.writeFile) {\r\n    const { resolvedPaths, ...configWithoutResolvedPaths } =\r\n      newConfigWithRegistries\r\n    const configSpinner = spinner(\"Updating components.json.\", {\r\n      silent: options.silent,\r\n    }).start()\r\n    const updatedConfig = rawConfigSchema.parse(configWithoutResolvedPaths)\r\n    await fs.writeFile(\r\n      path.resolve(config.resolvedPaths.cwd, \"components.json\"),\r\n      JSON.stringify(updatedConfig, null, 2) + \"\\n\",\r\n      \"utf-8\"\r\n    )\r\n    configSpinner.succeed()\r\n  }\r\n\r\n  return {\r\n    config: newConfigWithRegistries,\r\n    newRegistries: Object.keys(foundRegistries),\r\n  }\r\n}\r\n","import * as ERRORS from \"@/src/utils/errors\";\r\nimport { Command } from 'commander';\r\nimport fsExtra from 'fs-extra';\r\nimport path from 'path';\r\nimport z from 'zod';\r\nimport { preFlightInit } from '../preflights/preflight-init';\r\nimport { getRegistryItems } from '../registry/api';\r\nimport { buildUrlAndHeadersForRegistryItem } from '../registry/builder';\r\nimport { configWithDefaults } from '../registry/config';\r\nimport { clearRegistryContext } from '../registry/context';\r\nimport { rawConfigSchema } from \"../schema\";\r\nimport { createProject } from \"../utils/create-project\";\r\nimport { loadEnvFiles } from '../utils/env-loader';\r\nimport { createFileBackup, deleteFileBackup, restoreFileBackup } from '../utils/file-helper';\r\nimport { handleError } from '../utils/handle-error';\r\nimport { highlighter } from '../utils/highlighter';\r\nimport { logger } from '../utils/logger';\r\nimport { ensureRegistriesInConfig } from '../utils/registries';\r\nprocess.on(\"exit\", (code) => {\r\n  const filePath = path.resolve(process.cwd(), \"components.json\")\r\n\r\n  if (code === 0) {\r\n    return deleteFileBackup(filePath);\r\n  }\r\n\r\n  return restoreFileBackup(filePath);\r\n});\r\n\r\nexport const initOptionsSchema = z.object({\r\n  cwd: z.string(),\r\n  components: z.array(z.string()).optional(),\r\n  yes: z.boolean(),\r\n  defaults: z.boolean(),\r\n  force: z.boolean(),\r\n  silent: z.boolean(),\r\n  isNewProject: z.boolean(),\r\n  srcDir: z.boolean().optional(),\r\n  cssVariables: z.boolean(),\r\n  template: z\r\n    .string()\r\n    .optional()\r\n    .refine(\r\n      (val) => {\r\n        if (val) {\r\n          return \"TEMPLATES\"\r\n        }\r\n        return true\r\n      },\r\n      {\r\n        message: \"Invalid template. Please use 'next', 'next-16' or 'next-monorepo'.\",\r\n      }\r\n    ),\r\n  baseColor: z\r\n    .string()\r\n    .optional(),\r\n  baseStyle: z.boolean(),\r\n});\r\n\r\nexport const init = new Command()\r\n  .name(\"init\")\r\n  .description(\"initialize your project and install dependencies\")\r\n  .argument(\"[components...]\", \"names, url or local path to component\")\r\n  .option(\r\n    \"-t, --template <template>\",\r\n    \"the template to use. (next, next-16, next-monorepo)\"\r\n  )\r\n  .option(\"-b, --base-color <base-color>\", \"The base color to use. (neutral)\", undefined)\r\n  .option(\"-y, --yes\", \"Skip de confirmation prompt\", true)\r\n  .option(\"-d, --defaults\", \"Use default configuration.\", false)\r\n  .option(\"-f, --force\", \"Force overwrite of existing configuration\", false)\r\n  .option(\r\n    \"-c, --cwd <cwd>\",\r\n    \"the working directory. defaults to the current directory.\",\r\n    process.cwd()\r\n  )\r\n  .option(\"-s, --silent\", \"Mute output\", false)\r\n  .option(\"--src-dir\", \"Use the src directory when creating a new project.\", false)\r\n  .option(\"--no-src-dir\", \"Do not use the src directory when creating a new project.\")\r\n  .option(\"--css-variables\", \"Use css variables for theming.\", true)\r\n  .option(\"--no-base-style\", \"Do not install the base aodesu style.\")\r\n  .action(async (components, opts) => {\r\n    try {\r\n      if (opts.defaults) {\r\n        opts.template = opts.template || \"next\"\r\n        opts.baseColor = opts.baseColor || \"neutral\"\r\n      }\r\n\r\n      const options = initOptionsSchema.parse({\r\n        cwd: path.resolve(opts.cwd),\r\n        isNewProject: false,\r\n        components,\r\n        ...opts\r\n      });\r\n\r\n      await loadEnvFiles(options.cwd);\r\n\r\n      // We need check if we're initializing with a new style\r\n      // This will allow us to determine if we need to install the base style.\r\n      // And if we should prompt the user for a base color.\r\n      if (components.length > 0) {\r\n        // We don't know the full config at this point.\r\n        // So we'll use a shadow config to fetch the first item,\r\n        let shadowConfig = configWithDefaults({});\r\n\r\n        // Check if there's a components.json file.\r\n        // If so, we'll merge with our shadow config.\r\n        const componentsJsonPath = path.resolve(options.cwd, \"components.json\");\r\n        if (fsExtra.existsSync(componentsJsonPath)) {\r\n          const existingConfig = await fsExtra.readJson(componentsJsonPath);\r\n          const config = rawConfigSchema.partial().parse(existingConfig);\r\n          shadowConfig = configWithDefaults(config);\r\n\r\n          // Since components.json might not be valid at this point.\r\n          // Temporaly rename components.json to allow preflight to run.\r\n          // We'll rename it back after preflight.\r\n          createFileBackup(componentsJsonPath);\r\n        }\r\n\r\n        // Ensure all registries used in componentes are configured.\r\n        const { config: updatedConfig } = await ensureRegistriesInConfig(\r\n          components,\r\n          shadowConfig,\r\n          {\r\n            silent: true,\r\n          }\r\n        )\r\n        shadowConfig = updatedConfig;\r\n\r\n\r\n        // This forces a shadowConfig validation early in the process.\r\n        buildUrlAndHeadersForRegistryItem(components[0], shadowConfig);\r\n\r\n\r\n        const [item] = await getRegistryItems([components[0]], {\r\n          config: shadowConfig\r\n        });\r\n\r\n        console.log(\"TEST - LLEGO AKI\")\r\n\r\n        if (item?.type == \"registry:style\") {\r\n          // Set a default base color so we're not prompted.\r\n          // The style will extend or override it.\r\n          options.baseColor = \"neutral\";\r\n\r\n          // If the style extends none, we don't want to install the base style.\r\n          options.baseStyle =\r\n            item.extends === \"none\" ? false : options.baseStyle;\r\n        }\r\n      }\r\n\r\n      // If --no-base-style, we don't want to prompt for a base color either\r\n      if (!options.baseStyle) {\r\n        options.baseColor = \"neutral\";\r\n      }\r\n\r\n      await runInit(options);\r\n\r\n      logger.log(\r\n        `${highlighter.success(\r\n          \"Success!\"\r\n        )} Project initialization completed. \\nYou may now add components.`\r\n      )\r\n\r\n    } catch (error) {\r\n      logger.break();\r\n      handleError(error);\r\n    } finally {\r\n      clearRegistryContext();\r\n    }\r\n  })\r\n\r\n\r\nexport async function runInit(\r\n  options: z.infer<typeof initOptionsSchema> & {\r\n    skipPreflight?: boolean\r\n  }\r\n) {\r\n  let projectInfo;\r\n  let newProjectTemplate;\r\n  if (!options.skipPreflight) {\r\n    const preflight = await preFlightInit(options);\r\n    if (preflight.errors[ERRORS.MISSING_DIR_OR_EMPTY_PROJECT]) {\r\n      const { projectPath, template } = await createProject(options);\r\n      if (!projectPath) {\r\n        process.exit(1);\r\n      }\r\n    }\r\n  }\r\n}\r\n","#!/usr/bin/env node\r\nimport { Command } from \"commander\";\r\nimport packageJson from \"../package.json\";\r\nimport { init } from \"./commands/init\";\r\n\r\nprocess.on(\"SIGNINT\", () => process.exit(0));\r\nprocess.on(\"SIGTERM\", () => process.exit(0));\r\n\r\nasync function main() {\r\n  const program = new Command()\r\n    .name(\"uidesu\")\r\n    .description(\"add items from registry to your project\")\r\n    .version(\r\n      packageJson.version || \"1.0.0\",\r\n      \"-v, --version\",\r\n      \"display the version number\"\r\n    )\r\n\r\n  program\r\n    .addCommand(init)\r\n\r\n  program.parse()\r\n}\r\n\r\nmain()\r\n\r\n// export * from './registry/api';\r\n"]}