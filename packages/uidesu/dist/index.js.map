{"version":3,"sources":["../package.json","../src/utils/highlighter.ts","../src/utils/spinner.ts","../src/utils/updaters/update-tailwind-config.ts","../src/utils/updaters/update-tailwind-content.ts","../src/utils/frameworks.ts","../src/registry/constants.ts","../src/utils/resolve-import.ts","../src/utils/get-config.ts","../src/utils/get-package-info.ts","../src/utils/get-project-info.ts","../src/utils/logger.ts","../src/preflights/preflight-init.ts","../src/registry/errors.ts","../src/utils/handle-error.ts","../src/registry/env.ts","../src/registry/parser.ts","../src/utils/compare.ts","../src/utils/env-helpers.ts","../src/utils/transformers/transform-css-vars.ts","../src/utils/icon-libraries.ts","../src/utils/transformers/transform-icons.ts","../src/utils/transformers/transform-import.ts","../src/utils/transformers/transform-jsx.ts","../src/utils/transformers/transform-rsc.ts","../src/utils/transformers/transform-tw-prefix.ts","../src/utils/transformers/index.ts","../src/utils/transformers/transform-next.ts","../src/utils/updaters/update-files.ts","../src/registry/utils.ts","../src/registry/config.ts","../src/registry/context.ts","../src/registry/validator.ts","../src/registry/builder.ts","../src/registry/fetcher.ts","../src/registry/resolver.ts","../src/registry/api.ts","../src/utils/is-safe-target.ts","../src/utils/updaters/update-css.ts","../src/utils/updaters/update-css-vars.ts","../src/utils/get-package-manager.ts","../src/utils/updaters/update-dependencies.ts","../src/utils/updaters/update-env-vars.ts","../src/utils/add-components.ts","../src/utils/create-project.ts","../src/utils/env-loader.ts","../src/utils/file-helper.ts","../src/registry/namespaces.ts","../src/utils/registries.ts","../src/commands/init.ts","../src/preflights/preflight-add.ts","../src/utils/update-app-index.ts","../src/commands/add.ts","../src/preflights/preflight-build.ts","../src/commands/build.ts","../src/index.ts"],"names":["package_default","highlighter","red","yellow","cyan","green","spinner","text","options","ora","updateTailwindConfig","tailwindConfig","config","tailwindFileRelativePath","path","tailwindSpinner","raw","fs","output","transformTailwindConfig","input","sourceFile","_createSourceFile","configObject","SyntaxKind","node","property","quoteChar","_getQuoteChar","addTailwindConfigProperty","plugin","addTailwindConfigPlugin","addTailwindConfigTheme","existingProperty","newProperty","initializer","newValue","initializerText","element","theme","nestSpreadProperties","themeInitializer","themeObjectString","themeObject","parseObjectLiteral","result","deepmerge","dst","src","resultString","objectToString","unnestSpreadProperties","existingPlugins","dir","tmpdir","resolvedPath","tempFile","Project","ScriptKind","QuoteKind","obj","properties","i","prop","spreadAssignment","spreadText","nestSpreadElements","arr","elements","j","propAssignment","value","unsetSpreadElements","spreadTest","objectLiteralString","statement","parseObjectLiteralExpression","name","parseArrayLiteralExpression","parseValue","buildTailwindThemeColorsFromCssVars","cssVars","key","parts","colorName","subType","updateTailwindContent","content","transformTailwindContent","addTailwindConfigContent","contentItem","FRAMEWORKS","REGISTRY_URL","FALLBACK_STYLE","BASE_COLORS","BUILTIN_REGISTRIES","DEPRECATED_COMPONENTS","resolveImport","importPath","createMatchPath","DEFAULT_COMPONENTS","DEFAULT_UTILS","DEFAULT_TAILWIND_CSS","DEFAULT_TAILWIND_CONFIG","explorer","cosmiconfig","getConfig","cwd","getRawConfig","resolveConfigPaths","tsConfig","loadConfig","configSchema","configResult","rawConfigSchema","registryName","error","componentPath","getWorkspaceConfig","resolvedAliases","isAliasKey","packageRoot","findPackageRoot","workspaceConfigSchema","commonRoot","findCommonRoot","relativePath","matchingPackageRoot","fg","pkgPath","pkgDir","parts1","parts2","commonParts","getTargetStyleFromConfig","fallback","getProjectInfo","createConfig","partial","defaultConfig","getPackageInfo","shouldThrow","packageJsonPath","PROJECT_SHARED_IGNORE","z","configFiles","isSrcDir","isTsx","tailwindConfigFile","tailwindCssFile","tailwindVersion","aliasPrefix","packageJson","isTypeScriptProject","getTailwindConfigFile","getTailwindCssFile","getTailwindVersion","getTsConfigAliasPrefix","isUsingAppDir","type","file","getFrameworkVersion","framework","version","versionMatch","rangeMatch","packageInfo","files","contents","alias","paths","getProjectConfig","defaultProjectInfo","existingConfig","projectInfo","getProjectTailwindVersionFromConfig","logger","args","preFlightInit","errors","projectSpinner","frameworkSpinner","tailwindSpinnerMessage","tsConfigSpinner","RegistryErrorCode","RegistryError","message","RegistryNotFoundError","url","cause","RegistryUnauthorizedError","RegistryForbiddenError","RegistryFetchError","statusCode","responseBody","baseMessage","suggestion","RegistryNotConfiguredError","RegistryLocalFileError","filePath","RegistryParseError","item","parseError","e","RegistryMissingEnvironmentVariablesError","missingVars","v","RegistriesIndexParseError","invalidNamespaces","handleError","expandEnvVars","_match","extractEnvVars","vars","regex","match","REGISTRY_PATTERN","parseRegistryAndItemFromString","isContentSame","existingContent","newContent","ignoreImports","normalizedExisting","normalizedNew","importRegex","normalizeImports","prefix","suffix","lastPart","existingNormalized","newNormalized","isEnvFile","fileName","findExistingEnvFile","targetDir","variants","variant","existsSync","parseEnvContent","lines","env","line","trimmed","equalIndex","getNewEnvKeys","existingEnv","newEnv","newKeys","mergeEnvContent","transformCssVars","baseColor","mapped","applyColorMapping","splitClassName","className","rest","alpha","split","PREFIXES","mapping","classNames","lightMode","darkMode","modifier","needle","ICON_LIBRARIES","SOURCE_LIBRARY","transformIcons","registryIcons","getRegistryIcons","sourceLibrary","targetLibrary","targetedIcons","importDeclaration","specifier","iconName","targetedIcon","iconImportDeclaration","icon","_useSemicolon","transformImport","isRemote","utilsAlias","utilsImport","updated","updateImportAliases","namedImport","moduleSpecifier","PARSE_OPTIONS","transformJsx","ast","code","parse","transformFromAstSync","transformTypescript","directiveRegex","transformRsc","first","transformTwPrefixes","defaultClassNames","applyPrefix","callExpression","arg","project","createTempSourceFile","filename","transform","opts","transformers","transformer","transformNext","func","variable","exportDecl","namedExport","updateFiles","filesCreatedSpinner","getRegistryBaseColor","filesCreated","filesUpdated","filesSkipped","envVarsAdded","envFile","index","resolveFilePath","f","basename","alternativeEnvFile","existingFile","statSync","_isNext16Middleware","existingFileContent","overwrite","prompts","mergedContent","allFiles","updatedFiles","resolveImports","target","resolvePageTarget","resolveFileTargetDirectory","resolveNestedFilePath","normalizedPaths","p","normalizedNeedle","needleDir","needleSegments","testPath","normalizedFilePath","normalizedTargetDir","fileSegments","targetSegments","lastTargetSegment","commonDirIndex","segment","filePaths","filepath","importDeclarations","probableImportFilePath","resolvedImportFilePath","resolveModuleByProbablePath","newImport","toAliasedImport","extensions","relativeFiles","fileSet","extInPath","hasExt","absBase","relBase","tryExts","candidates","absCand","relCand","absIdx","relIdx","a","b","aExt","bExt","ord","aStrong","bStrong","abs","matches","root","aliasKey","rootDir","rel","ext","keepExt","noExt","aliasBase","isRootMiddleware","isNextJs","majorVersion","isUrl","isLocalFile","isUniversalRegistryItem","registryItem","deduplicateFilesByTarget","filesArrays","canDeduplicateFiles","registryItemFileSchema","targetMap","resolveStyleFromConfig","configWithDefaults","baseConfig","context","setRegistryHeaders","headers","getRegistryHeadersFromContext","clearRegistryContext","extractEnvVarsFromRegistryConfig","validateRegistryConfig","missing","NAME_PLACEHOLDER","STYLE_PLACEHOLDER","ENV_VAR_PATTER","QUERY_PARAM_SEPARATOR","QUERY_PARAM_DELIMITER","buildUrlAndHeadersForRegistryItem","registry","registryConfig","buildUrlFromRegistryConfig","buildHeadersFromRegistryConfig","baseUrl","appendQueryParams","expandedValue","shouldIncludeHeader","params","urlParams","queryString","separator","originalValue","trimmedExpanded","templateWithoutVars","resolveRegistryUrl","pathOrUrl","agent","HttpsProxyAgent","registryCache","fetchRegistry","fetchPromise","response","fetch","messageFromServer","json","parsed","fetchRegistryLocal","expandedPath","homedir","registryItemSchema","resolveRegistryItemsFromRegistries","items","registryHeaders","resolvedItems","resolved","fetchRegistryItems","resolveRegistryTree","names","payload","allDependencyItems","allDependencyRegistryNames","uniqueNames","results","resultMap","sourceName","itemWithSource","resolvedDependencies","namespacedDeps","dep","registryNames","resolveDependenciesRecursively","uniqueRegistryNames","nonNamespacedItems","namespacedDepItems","depResults","getUidesuRegistryIndex","registryUrls","itemDependencies","resolveRegistryDependencies","uniqueUrls","registryPayload","registryGetTheme","sourceMap","source","topologicalSortRegistryItems","tailwind","css","docs","envVars","deduplicatedFiles","registryResolvedItemsTreeSchema","dependencies","visited","resolvedDeps","nested","style","urls","computeItemHash","identifier","hash","createHash","extractItemIdentifierFromDependency","dependency","pathname","itemMap","hashToItem","inDegree","adjacencyList","depToHashes","itemSource","itemHash","depHash","exactMatches","nameMatches","queue","sorted","degree","currentHash","dependentHash","newDegree","sortedHashes","getRegistryItems","useCache","registryIndexSchema","getRegistryStyles","stylesSchema","iconsSchema","getRegistryBaseColors","registryBaseColorSchema","getRegistriesIndex","data","registriesIndexSchema","isSafeTarget","targetPath","decodedPath","prevPath","normalizedTarget","normalizedRoot","hasPathTraversal","cleanPath","cleanTarget","cleanDecoded","pattern","updateCss","cssFilepath","cssFilepathRelative","cssSpinner","transformCss","plugins","updateCssPlugin","postcss","lastNode","selector","atRuleMatch","importRule","importNodes","lastImport","quotedParams","normalizeParams","pluginRule","pluginNodes","lastPlugin","newAtRule","themeInline","keyframesRule","step","stepProps","processRule","utilityAtRule","existingDecl","decl","atRule","processAtRule","childSelector","childProps","nestedMatch","nestedName","nestedParams","tempRule","rule","clone","parent","atRuleName","atRuleParams","nestedSelector","updateCssVars","cssVarsSpinner","updateCssVarsPlugin","cleanupDefaultNextStylesPlugin","addCustomImport","addCustomVariant","updateCssVarsPluginV4","updateThemePlugin","updateTailwindConfigPlugin","updateTailwindConfigAnimationPlugin","updateTailwindConfigKeyframesPlugin","updateBaseLayerPlugin","requiredRules","baseLayer","apply","applyRule","AtRule","addOrUpdateVars","removeConflictVars","rootRule","propsToRemove","bodyRule","darkRootRule","ruleNode","newDecl","themeNode","upsertThemeNode","isLocalHSLValue","variables","themeVarNodes","radiusVariables","cssVarNode","isColorValue","propValue","variantNode","customVariantNode","importNode","quote","getQuoteType","lastPluginNode","pluginName","pluginNode","existingKeyFrameNodes","keyframeValueSchema","keyframeName","keyframeValue","parsedKeyframeValue","keyframeNode","values","existingAnimationNodes","parsedAnimationValue","animationNode","chunks","chunk","getPackageManager","withFallback","packageManager","detect","userAgent","updateDependencies","devDependencies","dependenciesSpinner","getUpdateDependenciesPackageManager","flag","shouldPromptForNpmFlag","confirmation","installWithPackageManager","hasReact19","hasReactDayPicker8","installWithNpm","installWithDeno","installWithExpo","execa","updateEnvVars","envSpinner","projectRoot","envFilePath","existingEnvFile","envFileExists","envFileName","newEnvContent","envFileUpdated","envFileCreated","addComponents","components","workspaceConfig","addWorkspaceComponents","addProjectComponents","registrySpinner","tree","validateFilesTarget","overwriteCssVars","shouldOverwriteCssVars","component","MONOREPO_TEMPLATE_URL","TEMPLATES","createProject","template","projectName","nextVersion","isRemoteComponent","meta","projectPath","createViteProject","createNextProject","createMonorepoProject","createSpinner","installSpinner","templatePath","os","tarPath","extractedPath","packageJsonContent","loadEnvFiles","envFiles","envPath","join","FILE_BACKUP_SUFFIX","createFileBackup","fsExtra","backupPath","restoreFileBackup","deleteFileBackup","resolveRegistryNamespaces","discoveredNamespaces","visitedItems","itemsToProcess","currentItem","depRegistry","ensureRegistriesInConfig","missingRegistries","registryIndex","foundRegistries","existingRegistries","newConfigWithRegistries","resolvedPaths","configWithoutResolvedPaths","configSpinner","updatedConfig","initOptionsSchema","val","init","Command","shadowConfig","componentsJsonPath","runInit","newProjectTemplate","preflight","projectConfig","promptForMinimalConfig","promptForConfig","proceed","fullConfigForRegistry","configWithRegistries","componentSpinner","registries","merged","fullConfig","styles","baseColors","color","cssVariables","preFlightAdd","updateAppIndex","indexPath","addOptionsSchema","add","initialConfig","hasNewRegistries","newRegistries","itemType","confirm","promptForRegistryComponents","deprecatedComponents","initHasRun","shouldUpdateAppIndex","entry","c","preFlightBuild","resolvePaths","buildOptionsSchema","build","Ve","registrySchema","buildSpinner","main","program"],"mappings":"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","file":"index.js","sourcesContent":["{\r\n  \"name\": \"uidesu\",\r\n  \"version\": \"1.0.0\",\r\n  \"description\": \"Add components to your apps.\",\r\n  \"publishConfig\": {\r\n    \"access\": \"public\"\r\n  },\r\n  \"license\": \"MIT\",\r\n  \"author\": {\r\n    \"name\": \"sergiocortes-dll\",\r\n    \"url\": \"https://twitter.com/sergiocortes-dll\"\r\n  },\r\n  \"repository\": {\r\n    \"type\": \"git\",\r\n    \"url\": \"https://github.com/aodesu/ui-cli.git\",\r\n    \"directory\": \"packages/aodesu\"\r\n  },\r\n  \"files\": [\r\n    \"dist\"\r\n  ],\r\n  \"keywords\": [\r\n    \"components\",\r\n    \"ui\",\r\n    \"tailwind\",\r\n    \"radix-ui\",\r\n    \"uidesu\"\r\n  ],\r\n  \"type\": \"module\",\r\n  \"exports\": {\r\n    \".\": {\r\n      \"types\": \"./dist/index.d.ts\",\r\n      \"default\": \"./dist/index.js\"\r\n    },\r\n    \"./schema\": {\r\n      \"types\": \"./dist/schema/index.d.ts\",\r\n      \"default\": \"./dist/schema/index.js\"\r\n    }\r\n  },\r\n  \"bin\": \"./dist/index.js\",\r\n  \"scripts\": {\r\n    \"dev\": \"tsup --watch\",\r\n    \"start:dev\": \"cross-env REGISTRY_URL=http://localhost:4000/r node dist/index.js\"\r\n  },\r\n  \"dependencies\": {\r\n    \"@antfu/ni\": \"^25.0.0\",\r\n    \"@babel/core\": \"^7.28.0\",\r\n    \"@babel/parser\": \"^7.28.0\",\r\n    \"@babel/plugin-transform-typescript\": \"^7.28.0\",\r\n    \"@babel/preset-typescript\": \"^7.27.1\",\r\n    \"@dotenvx/dotenvx\": \"^1.48.4\",\r\n    \"commander\": \"^14.0.0\",\r\n    \"cosmiconfig\": \"^9.0.0\",\r\n    \"deepmerge\": \"^4.3.1\",\r\n    \"execa\": \"^9.6.0\",\r\n    \"fast-glob\": \"^3.3.3\",\r\n    \"fs-extra\": \"^11.3.1\",\r\n    \"https-proxy-agent\": \"^7.0.6\",\r\n    \"kleur\": \"^4.1.5\",\r\n    \"node-fetch\": \"^3.3.2\",\r\n    \"ora\": \"^8.2.0\",\r\n    \"postcss\": \"^8.5.6\",\r\n    \"prompts\": \"^2.4.2\",\r\n    \"recast\": \"^0.23.11\",\r\n    \"stringify-object\": \"^5.0.0\",\r\n    \"ts-morph\": \"^26.0.0\",\r\n    \"tsconfig-paths\": \"^4.2.0\",\r\n    \"zod\": \"^3.24.1\",\r\n    \"zod-to-json-schema\": \"3.24.6\"\r\n  },\r\n  \"devDependencies\": {\r\n    \"@types/babel__core\": \"^7.20.5\",\r\n    \"@types/fs-extra\": \"^11.0.4\",\r\n    \"@types/prompts\": \"^2.4.9\",\r\n    \"@types/stringify-object\": \"^4.0.5\",\r\n    \"rimraf\": \"^6.0.1\",\r\n    \"tsup\": \"^8.5.0\",\r\n    \"type-fest\": \"^4.41.0\",\r\n    \"typescript\": \"^5.9.2\"\r\n  }\r\n}\r\n","import { cyan, green, red, yellow } from \"kleur/colors\";\r\n\r\nexport const highlighter = {\r\n  error: red,\r\n  warn: yellow,\r\n  info: cyan,\r\n  success: green,\r\n};\r\n","import ora, { type Options } from \"ora\";\r\n\r\nexport function spinner(\r\n  text: Options[\"text\"],\r\n  options?: {\r\n    silent?: boolean\r\n  }\r\n) {\r\n  return ora({\r\n    text,\r\n    isSilent: options?.silent,\r\n  });\r\n}\r\n","import {\r\n  registryItemCssVarsSchema,\r\n  registryItemTailwindSchema,\r\n} from \"@/src/schema\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\nimport { TailwindVersion } from \"@/src/utils/get-project-info\"\r\nimport { highlighter } from \"@/src/utils/highlighter\"\r\nimport { spinner } from \"@/src/utils/spinner\"\r\nimport deepmerge from \"deepmerge\"\r\nimport { promises as fs } from \"fs\"\r\nimport { tmpdir } from \"os\"\r\nimport path from \"path\"\r\nimport objectToString from \"stringify-object\"\r\nimport { type Config as TailwindConfig } from \"tailwindcss\"\r\nimport {\r\n  ArrayLiteralExpression,\r\n  ObjectLiteralExpression,\r\n  Project,\r\n  PropertyAssignment,\r\n  QuoteKind,\r\n  ScriptKind,\r\n  SyntaxKind,\r\n  VariableStatement,\r\n} from \"ts-morph\"\r\nimport { z } from \"zod\"\r\n\r\nexport type UpdaterTailwindConfig = Omit<TailwindConfig, \"plugins\"> & {\r\n  // We only want string plugins for now.\r\n  plugins?: string[]\r\n}\r\n\r\nexport async function updateTailwindConfig(\r\n  tailwindConfig:\r\n    | z.infer<typeof registryItemTailwindSchema>[\"config\"]\r\n    | undefined,\r\n  config: Config,\r\n  options: {\r\n    silent?: boolean\r\n    tailwindVersion?: TailwindVersion\r\n  }\r\n) {\r\n  if (!tailwindConfig) {\r\n    return\r\n  }\r\n\r\n  options = {\r\n    silent: false,\r\n    tailwindVersion: \"v3\",\r\n    ...options,\r\n  }\r\n\r\n  // No tailwind config in v4.\r\n  if (options.tailwindVersion === \"v4\") {\r\n    return\r\n  }\r\n\r\n  const tailwindFileRelativePath = path.relative(\r\n    config.resolvedPaths.cwd,\r\n    config.resolvedPaths.tailwindConfig\r\n  )\r\n  const tailwindSpinner = spinner(\r\n    `Updating ${highlighter.info(tailwindFileRelativePath)}`,\r\n    {\r\n      silent: options.silent,\r\n    }\r\n  ).start()\r\n  const raw = await fs.readFile(config.resolvedPaths.tailwindConfig, \"utf8\")\r\n  const output = await transformTailwindConfig(raw, tailwindConfig, config)\r\n  await fs.writeFile(config.resolvedPaths.tailwindConfig, output, \"utf8\")\r\n  tailwindSpinner?.succeed()\r\n}\r\n\r\nexport async function transformTailwindConfig(\r\n  input: string,\r\n  tailwindConfig: UpdaterTailwindConfig,\r\n  config: Config\r\n) {\r\n  const sourceFile = await _createSourceFile(input, config)\r\n  // Find the object with content property.\r\n  // This is faster than traversing the default export.\r\n  // TODO: maybe we do need to traverse the default export?\r\n  const configObject = sourceFile\r\n    .getDescendantsOfKind(SyntaxKind.ObjectLiteralExpression)\r\n    .find((node) =>\r\n      node\r\n        .getProperties()\r\n        .some(\r\n          (property) =>\r\n            property.isKind(SyntaxKind.PropertyAssignment) &&\r\n            property.getName() === \"content\"\r\n        )\r\n    )\r\n\r\n  // We couldn't find the config object, so we return the input as is.\r\n  if (!configObject) {\r\n    return input\r\n  }\r\n\r\n  const quoteChar = _getQuoteChar(configObject)\r\n\r\n  // Add darkMode.\r\n  addTailwindConfigProperty(\r\n    configObject,\r\n    {\r\n      name: \"darkMode\",\r\n      value: \"class\",\r\n    },\r\n    { quoteChar }\r\n  )\r\n\r\n  // Add Tailwind config plugins.\r\n  tailwindConfig.plugins?.forEach((plugin) => {\r\n    addTailwindConfigPlugin(configObject, plugin)\r\n  })\r\n\r\n  // Add Tailwind config theme.\r\n  if (tailwindConfig.theme) {\r\n    await addTailwindConfigTheme(configObject, tailwindConfig.theme)\r\n  }\r\n\r\n  return sourceFile.getFullText()\r\n}\r\n\r\nfunction addTailwindConfigProperty(\r\n  configObject: ObjectLiteralExpression,\r\n  property: {\r\n    name: string\r\n    value: string\r\n  },\r\n  {\r\n    quoteChar,\r\n  }: {\r\n    quoteChar: string\r\n  }\r\n) {\r\n  const existingProperty = configObject.getProperty(\"darkMode\")\r\n\r\n  if (!existingProperty) {\r\n    const newProperty = {\r\n      name: property.name,\r\n      initializer: `[${quoteChar}${property.value}${quoteChar}]`,\r\n    }\r\n\r\n    // We need to add darkMode as the first property.\r\n    if (property.name === \"darkMode\") {\r\n      configObject.insertPropertyAssignment(0, newProperty)\r\n      return configObject\r\n    }\r\n\r\n    configObject.addPropertyAssignment(newProperty)\r\n\r\n    return configObject\r\n  }\r\n\r\n  if (existingProperty.isKind(SyntaxKind.PropertyAssignment)) {\r\n    const initializer = existingProperty.getInitializer()\r\n    const newValue = `${quoteChar}${property.value}${quoteChar}`\r\n\r\n    // If property is a string, change it to an array and append.\r\n    if (initializer?.isKind(SyntaxKind.StringLiteral)) {\r\n      const initializerText = initializer.getText()\r\n      initializer.replaceWithText(`[${initializerText}, ${newValue}]`)\r\n      return configObject\r\n    }\r\n\r\n    // If property is an array, append.\r\n    if (initializer?.isKind(SyntaxKind.ArrayLiteralExpression)) {\r\n      // Check if the array already contains the value.\r\n      if (\r\n        initializer\r\n          .getElements()\r\n          .map((element) => element.getText())\r\n          .includes(newValue)\r\n      ) {\r\n        return configObject\r\n      }\r\n      initializer.addElement(newValue)\r\n    }\r\n\r\n    return configObject\r\n  }\r\n\r\n  return configObject\r\n}\r\n\r\nasync function addTailwindConfigTheme(\r\n  configObject: ObjectLiteralExpression,\r\n  theme: UpdaterTailwindConfig[\"theme\"]\r\n) {\r\n  // Ensure there is a theme property.\r\n  if (!configObject.getProperty(\"theme\")) {\r\n    configObject.addPropertyAssignment({\r\n      name: \"theme\",\r\n      initializer: \"{}\",\r\n    })\r\n  }\r\n\r\n  // Nest all spread properties.\r\n  nestSpreadProperties(configObject)\r\n\r\n  const themeProperty = configObject\r\n    .getPropertyOrThrow(\"theme\")\r\n    ?.asKindOrThrow(SyntaxKind.PropertyAssignment)\r\n\r\n  const themeInitializer = themeProperty.getInitializer()\r\n  if (themeInitializer?.isKind(SyntaxKind.ObjectLiteralExpression)) {\r\n    const themeObjectString = themeInitializer.getText()\r\n    const themeObject = await parseObjectLiteral(themeObjectString)\r\n    const result = deepmerge(themeObject, theme, {\r\n      arrayMerge: (dst, src) => src,\r\n    })\r\n    const resultString = objectToString(result)\r\n      .replace(/\\'\\.\\.\\.(.*)\\'/g, \"...$1\") // Remove quote around spread element\r\n      .replace(/\\'\\\"/g, \"'\") // Replace `\\\" with \"\r\n      .replace(/\\\"\\'/g, \"'\") // Replace `\\\" with \"\r\n      .replace(/\\'\\[/g, \"[\") // Replace `[ with [\r\n      .replace(/\\]\\'/g, \"]\") // Replace `] with ]\r\n      .replace(/\\'\\\\\\'/g, \"'\") // Replace `\\' with '\r\n      .replace(/\\\\\\'/g, \"'\") // Replace \\' with '\r\n      .replace(/\\\\\\'\\'/g, \"'\")\r\n      .replace(/\\'\\'/g, \"'\")\r\n    themeInitializer.replaceWithText(resultString)\r\n  }\r\n\r\n  // Unnest all spread properties.\r\n  unnestSpreadProperties(configObject)\r\n}\r\n\r\nfunction addTailwindConfigPlugin(\r\n  configObject: ObjectLiteralExpression,\r\n  plugin: string\r\n) {\r\n  const existingPlugins = configObject.getProperty(\"plugins\")\r\n\r\n  if (!existingPlugins) {\r\n    configObject.addPropertyAssignment({\r\n      name: \"plugins\",\r\n      initializer: `[${plugin}]`,\r\n    })\r\n\r\n    return configObject\r\n  }\r\n\r\n  if (existingPlugins.isKind(SyntaxKind.PropertyAssignment)) {\r\n    const initializer = existingPlugins.getInitializer()\r\n\r\n    if (initializer?.isKind(SyntaxKind.ArrayLiteralExpression)) {\r\n      if (\r\n        initializer\r\n          .getElements()\r\n          .map((element) => {\r\n            return element.getText().replace(/[\"']/g, \"\")\r\n          })\r\n          .includes(plugin.replace(/[\"']/g, \"\"))\r\n      ) {\r\n        return configObject\r\n      }\r\n      initializer.addElement(plugin)\r\n    }\r\n\r\n    return configObject\r\n  }\r\n\r\n  return configObject\r\n}\r\n\r\nexport async function _createSourceFile(input: string, config: Config | null) {\r\n  const dir = await fs.mkdtemp(path.join(tmpdir(), \"uidesu-\"))\r\n  const resolvedPath =\r\n    config?.resolvedPaths?.tailwindConfig || \"tailwind.config.ts\"\r\n  const tempFile = path.join(dir, `uidesu-${path.basename(resolvedPath)}`)\r\n\r\n  const project = new Project({\r\n    compilerOptions: {},\r\n  })\r\n  const sourceFile = project.createSourceFile(tempFile, input, {\r\n    // Note: .js and .mjs can still be valid for TS projects.\r\n    // We can't infer TypeScript from config.tsx.\r\n    scriptKind:\r\n      path.extname(resolvedPath) === \".ts\" ? ScriptKind.TS : ScriptKind.JS,\r\n  })\r\n\r\n  return sourceFile\r\n}\r\n\r\nexport function _getQuoteChar(configObject: ObjectLiteralExpression) {\r\n  return configObject\r\n    .getFirstDescendantByKind(SyntaxKind.StringLiteral)\r\n    ?.getQuoteKind() === QuoteKind.Single\r\n    ? \"'\"\r\n    : '\"'\r\n}\r\n\r\nexport function nestSpreadProperties(obj: ObjectLiteralExpression) {\r\n  const properties = obj.getProperties()\r\n\r\n  for (let i = 0; i < properties.length; i++) {\r\n    const prop = properties[i]\r\n    if (prop.isKind(SyntaxKind.SpreadAssignment)) {\r\n      const spreadAssignment = prop.asKindOrThrow(SyntaxKind.SpreadAssignment)\r\n      const spreadText = spreadAssignment.getExpression().getText()\r\n\r\n      // Replace spread with a property assignment\r\n      obj.insertPropertyAssignment(i, {\r\n        // Need to escape the name with \" so that deepmerge doesn't mishandle the key\r\n        name: `\"___${spreadText.replace(/^\\.\\.\\./, \"\")}\"`,\r\n        initializer: `\"...${spreadText.replace(/^\\.\\.\\./, \"\")}\"`,\r\n      })\r\n\r\n      // Remove the original spread assignment\r\n      spreadAssignment.remove()\r\n    } else if (prop.isKind(SyntaxKind.PropertyAssignment)) {\r\n      const propAssignment = prop.asKindOrThrow(SyntaxKind.PropertyAssignment)\r\n      const initializer = propAssignment.getInitializer()\r\n\r\n      if (\r\n        initializer &&\r\n        initializer.isKind(SyntaxKind.ObjectLiteralExpression)\r\n      ) {\r\n        // Recursively process nested object literals\r\n        nestSpreadProperties(\r\n          initializer.asKindOrThrow(SyntaxKind.ObjectLiteralExpression)\r\n        )\r\n      } else if (\r\n        initializer &&\r\n        initializer.isKind(SyntaxKind.ArrayLiteralExpression)\r\n      ) {\r\n        nestSpreadElements(\r\n          initializer.asKindOrThrow(SyntaxKind.ArrayLiteralExpression)\r\n        )\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function nestSpreadElements(arr: ArrayLiteralExpression) {\r\n  const elements = arr.getElements()\r\n  for (let j = 0; j < elements.length; j++) {\r\n    const element = elements[j]\r\n    if (element.isKind(SyntaxKind.ObjectLiteralExpression)) {\r\n      // Recursive check on objects within arrays\r\n      nestSpreadProperties(\r\n        element.asKindOrThrow(SyntaxKind.ObjectLiteralExpression)\r\n      )\r\n    } else if (element.isKind(SyntaxKind.ArrayLiteralExpression)) {\r\n      // Recursive check on nested arrays\r\n      nestSpreadElements(\r\n        element.asKindOrThrow(SyntaxKind.ArrayLiteralExpression)\r\n      )\r\n    } else if (element.isKind(SyntaxKind.SpreadElement)) {\r\n      const spreadText = element.getText()\r\n      // Spread element within an array\r\n      arr.removeElement(j)\r\n      arr.insertElement(j, `\"${spreadText}\"`)\r\n    }\r\n  }\r\n}\r\n\r\nexport function unnestSpreadProperties(obj: ObjectLiteralExpression) {\r\n  const properties = obj.getProperties()\r\n\r\n  for (let i = 0; i < properties.length; i++) {\r\n    const prop = properties[i]\r\n    if (prop.isKind(SyntaxKind.PropertyAssignment)) {\r\n      const propAssignment = prop as PropertyAssignment\r\n      const initializer = propAssignment.getInitializer()\r\n\r\n      if (initializer && initializer.isKind(SyntaxKind.StringLiteral)) {\r\n        const value = initializer\r\n          .asKindOrThrow(SyntaxKind.StringLiteral)\r\n          .getLiteralValue()\r\n        if (value.startsWith(\"...\")) {\r\n          obj.insertSpreadAssignment(i, { expression: value.slice(3) })\r\n          propAssignment.remove()\r\n        }\r\n      } else if (initializer?.isKind(SyntaxKind.ObjectLiteralExpression)) {\r\n        unnestSpreadProperties(initializer as ObjectLiteralExpression)\r\n      } else if (\r\n        initializer &&\r\n        initializer.isKind(SyntaxKind.ArrayLiteralExpression)\r\n      ) {\r\n        unsetSpreadElements(\r\n          initializer.asKindOrThrow(SyntaxKind.ArrayLiteralExpression)\r\n        )\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function unsetSpreadElements(arr: ArrayLiteralExpression) {\r\n  const elements = arr.getElements()\r\n  for (let j = 0; j < elements.length; j++) {\r\n    const element = elements[j]\r\n    if (element.isKind(SyntaxKind.ObjectLiteralExpression)) {\r\n      // Recursive check on objects within arrays\r\n      unnestSpreadProperties(\r\n        element.asKindOrThrow(SyntaxKind.ObjectLiteralExpression)\r\n      )\r\n    } else if (element.isKind(SyntaxKind.ArrayLiteralExpression)) {\r\n      // Recursive check on nested arrays\r\n      unsetSpreadElements(\r\n        element.asKindOrThrow(SyntaxKind.ArrayLiteralExpression)\r\n      )\r\n    } else if (element.isKind(SyntaxKind.StringLiteral)) {\r\n      const spreadText = element.getText()\r\n      // check if spread element\r\n      const spreadTest = /(?:^['\"])(\\.\\.\\..*)(?:['\"]$)/g\r\n      if (spreadTest.test(spreadText)) {\r\n        arr.removeElement(j)\r\n        arr.insertElement(j, spreadText.replace(spreadTest, \"$1\"))\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nasync function parseObjectLiteral(objectLiteralString: string): Promise<any> {\r\n  const sourceFile = await _createSourceFile(\r\n    `const theme = ${objectLiteralString}`,\r\n    null\r\n  )\r\n\r\n  const statement = sourceFile.getStatements()[0]\r\n  if (statement?.getKind() === SyntaxKind.VariableStatement) {\r\n    const declaration = (statement as VariableStatement)\r\n      .getDeclarationList()\r\n      ?.getDeclarations()[0]\r\n    const initializer = declaration.getInitializer()\r\n    if (initializer?.isKind(SyntaxKind.ObjectLiteralExpression)) {\r\n      return await parseObjectLiteralExpression(initializer)\r\n    }\r\n  }\r\n\r\n  throw new Error(\"Invalid input: not an object literal\")\r\n}\r\n\r\nfunction parseObjectLiteralExpression(node: ObjectLiteralExpression): any {\r\n  const result: any = {}\r\n  for (const property of node.getProperties()) {\r\n    if (property.isKind(SyntaxKind.PropertyAssignment)) {\r\n      const name = property.getName().replace(/\\'/g, \"\")\r\n      if (\r\n        property.getInitializer()?.isKind(SyntaxKind.ObjectLiteralExpression)\r\n      ) {\r\n        result[name] = parseObjectLiteralExpression(\r\n          property.getInitializer() as ObjectLiteralExpression\r\n        )\r\n      } else if (\r\n        property.getInitializer()?.isKind(SyntaxKind.ArrayLiteralExpression)\r\n      ) {\r\n        result[name] = parseArrayLiteralExpression(\r\n          property.getInitializer() as ArrayLiteralExpression\r\n        )\r\n      } else {\r\n        result[name] = parseValue(property.getInitializer())\r\n      }\r\n    }\r\n  }\r\n  return result\r\n}\r\n\r\nfunction parseArrayLiteralExpression(node: ArrayLiteralExpression): any[] {\r\n  const result: any[] = []\r\n  for (const element of node.getElements()) {\r\n    if (element.isKind(SyntaxKind.ObjectLiteralExpression)) {\r\n      result.push(\r\n        parseObjectLiteralExpression(\r\n          element.asKindOrThrow(SyntaxKind.ObjectLiteralExpression)\r\n        )\r\n      )\r\n    } else if (element.isKind(SyntaxKind.ArrayLiteralExpression)) {\r\n      result.push(\r\n        parseArrayLiteralExpression(\r\n          element.asKindOrThrow(SyntaxKind.ArrayLiteralExpression)\r\n        )\r\n      )\r\n    } else {\r\n      result.push(parseValue(element))\r\n    }\r\n  }\r\n  return result\r\n}\r\n\r\nfunction parseValue(node: any): any {\r\n  switch (node.getKind()) {\r\n    case SyntaxKind.StringLiteral:\r\n      return node.getText()\r\n    case SyntaxKind.NumericLiteral:\r\n      return Number(node.getText())\r\n    case SyntaxKind.TrueKeyword:\r\n      return true\r\n    case SyntaxKind.FalseKeyword:\r\n      return false\r\n    case SyntaxKind.NullKeyword:\r\n      return null\r\n    case SyntaxKind.ArrayLiteralExpression:\r\n      return node.getElements().map(parseValue)\r\n    case SyntaxKind.ObjectLiteralExpression:\r\n      return parseObjectLiteralExpression(node)\r\n    default:\r\n      return node.getText()\r\n  }\r\n}\r\n\r\nexport function buildTailwindThemeColorsFromCssVars(\r\n  cssVars: z.infer<typeof registryItemCssVarsSchema>\r\n) {\r\n  const result: Record<string, any> = {}\r\n\r\n  for (const key of Object.keys(cssVars)) {\r\n    const parts = key.split(\"-\")\r\n    const colorName = parts[0]\r\n    const subType = parts.slice(1).join(\"-\")\r\n\r\n    if (subType === \"\") {\r\n      if (typeof result[colorName] === \"object\") {\r\n        result[colorName].DEFAULT = `hsl(var(--${key}))`\r\n      } else {\r\n        result[colorName] = `hsl(var(--${key}))`\r\n      }\r\n    } else {\r\n      if (typeof result[colorName] !== \"object\") {\r\n        result[colorName] = { DEFAULT: `hsl(var(--${colorName}))` }\r\n      }\r\n      result[colorName][subType] = `hsl(var(--${key}))`\r\n    }\r\n  }\r\n\r\n  // Remove DEFAULT if it's not in the original cssVars\r\n  for (const [colorName, value] of Object.entries(result)) {\r\n    if (\r\n      typeof value === \"object\" &&\r\n      value.DEFAULT === `hsl(var(--${colorName}))` &&\r\n      !(colorName in cssVars)\r\n    ) {\r\n      delete value.DEFAULT\r\n    }\r\n  }\r\n\r\n  return result\r\n}\r\n","import { promises as fs } from \"fs\"\r\nimport path from \"path\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\nimport { highlighter } from \"@/src/utils/highlighter\"\r\nimport { spinner } from \"@/src/utils/spinner\"\r\nimport {\r\n  _createSourceFile,\r\n  _getQuoteChar,\r\n} from \"@/src/utils/updaters/update-tailwind-config\"\r\nimport { ObjectLiteralExpression, SyntaxKind } from \"ts-morph\"\r\n\r\nexport async function updateTailwindContent(\r\n  content: string[],\r\n  config: Config,\r\n  options: {\r\n    silent?: boolean\r\n  }\r\n) {\r\n  if (!content) {\r\n    return\r\n  }\r\n\r\n  options = {\r\n    silent: false,\r\n    ...options,\r\n  }\r\n\r\n  const tailwindFileRelativePath = path.relative(\r\n    config.resolvedPaths.cwd,\r\n    config.resolvedPaths.tailwindConfig\r\n  )\r\n  const tailwindSpinner = spinner(\r\n    `Updating ${highlighter.info(tailwindFileRelativePath)}`,\r\n    {\r\n      silent: options.silent,\r\n    }\r\n  ).start()\r\n  const raw = await fs.readFile(config.resolvedPaths.tailwindConfig, \"utf8\")\r\n  const output = await transformTailwindContent(raw, content, config)\r\n  await fs.writeFile(config.resolvedPaths.tailwindConfig, output, \"utf8\")\r\n  tailwindSpinner?.succeed()\r\n}\r\n\r\nexport async function transformTailwindContent(\r\n  input: string,\r\n  content: string[],\r\n  config: Config\r\n) {\r\n  const sourceFile = await _createSourceFile(input, config)\r\n  // Find the object with content property.\r\n  // This is faster than traversing the default export.\r\n  // TODO: maybe we do need to traverse the default export?\r\n  const configObject = sourceFile\r\n    .getDescendantsOfKind(SyntaxKind.ObjectLiteralExpression)\r\n    .find((node) =>\r\n      node\r\n        .getProperties()\r\n        .some(\r\n          (property) =>\r\n            property.isKind(SyntaxKind.PropertyAssignment) &&\r\n            property.getName() === \"content\"\r\n        )\r\n    )\r\n\r\n  // We couldn't find the config object, so we return the input as is.\r\n  if (!configObject) {\r\n    return input\r\n  }\r\n\r\n  addTailwindConfigContent(configObject, content)\r\n\r\n  return sourceFile.getFullText()\r\n}\r\n\r\nasync function addTailwindConfigContent(\r\n  configObject: ObjectLiteralExpression,\r\n  content: string[]\r\n) {\r\n  const quoteChar = _getQuoteChar(configObject)\r\n\r\n  const existingProperty = configObject.getProperty(\"content\")\r\n\r\n  if (!existingProperty) {\r\n    const newProperty = {\r\n      name: \"content\",\r\n      initializer: `[${quoteChar}${content.join(\r\n        `${quoteChar}, ${quoteChar}`\r\n      )}${quoteChar}]`,\r\n    }\r\n    configObject.addPropertyAssignment(newProperty)\r\n\r\n    return configObject\r\n  }\r\n\r\n  if (existingProperty.isKind(SyntaxKind.PropertyAssignment)) {\r\n    const initializer = existingProperty.getInitializer()\r\n\r\n    // If property is an array, append.\r\n    if (initializer?.isKind(SyntaxKind.ArrayLiteralExpression)) {\r\n      for (const contentItem of content) {\r\n        const newValue = `${quoteChar}${contentItem}${quoteChar}`\r\n\r\n        // Check if the array already contains the value.\r\n        if (\r\n          initializer\r\n            .getElements()\r\n            .map((element) => element.getText())\r\n            .includes(newValue)\r\n        ) {\r\n          continue\r\n        }\r\n\r\n        initializer.addElement(newValue)\r\n      }\r\n    }\r\n\r\n    return configObject\r\n  }\r\n\r\n  return configObject\r\n}\r\n","export const FRAMEWORKS = {\r\n  \"next-app\": {\r\n    name: \"next-app\",\r\n    label: \"Next.js\",\r\n    links: {\r\n      installation: \"https://ui.aodesu.com/docs/installation/next\",\r\n      tailwind: \"https://tailwindcss.com/docs/guides/nextjs\",\r\n    },\r\n  },\r\n  \"next-pages\": {\r\n    name: \"next-pages\",\r\n    label: \"Next.js\",\r\n    links: {\r\n      installation: \"https://ui.aodesu.com/docs/installation/next\",\r\n      tailwind: \"https://tailwindcss.com/docs/guides/nextjs\",\r\n    },\r\n  },\r\n  vite: {\r\n    name: \"vite\",\r\n    label: \"vite\",\r\n    links: {\r\n      installation: \"https://ui.aodesu.com/docs/installation/vite\",\r\n      tailwind: \"https://tailwindcss.com/docs/guides/vite\",\r\n    },\r\n  },\r\n  manual: {\r\n    name: \"manual\",\r\n    label: \"Manual\",\r\n    links: {\r\n      installation: \"https://ui.aodesu.com/docs/installation/manual\",\r\n      tailwind: \"https://tailwindcss.com/docs/installation\",\r\n    },\r\n  },\r\n} as const;\r\n\r\nexport type Framework = (typeof FRAMEWORKS)[keyof typeof FRAMEWORKS];\r\n","import z from \"zod\";\r\nimport { registryConfigSchema } from \"./schema\";\r\n\r\nexport const REGISTRY_URL =\r\n  process.env.REGISTRY_URL ?? \"https://ui.aodesu.com/r\";\r\n\r\nexport const FALLBACK_STYLE = \"aodesu\";\r\n\r\nexport const BASE_COLORS = [\r\n  {\r\n    name: \"neutral\",\r\n    label: \"Neutral\"\r\n  }\r\n]\r\n\r\nexport const BUILTIN_REGISTRIES: z.infer<typeof registryConfigSchema> = {\r\n  \"@uidesu\": `${REGISTRY_URL}/styles/{style}/{name}.json`,\r\n}\r\n\r\n\r\nexport const DEPRECATED_COMPONENTS = [\r\n  {\r\n    name: \"toast\",\r\n    deprecatedBy: \"sonner\",\r\n    message:\r\n      \"The toast component is deprecated. Use the sonner component instead.\",\r\n  },\r\n  {\r\n    name: \"toaster\",\r\n    deprecatedBy: \"sonner\",\r\n    message:\r\n      \"The toaster component is deprecated. Use the sonner component instead.\",\r\n  },\r\n]\r\n","import { createMatchPath, type ConfigLoaderSuccessResult } from \"tsconfig-paths\";\r\n\r\nexport async function resolveImport(\r\n  importPath: string,\r\n  config: Pick<ConfigLoaderSuccessResult, \"absoluteBaseUrl\" | \"paths\">\r\n) {\r\n  return createMatchPath(config.absoluteBaseUrl, config.paths)(\r\n    importPath,\r\n    undefined,\r\n    () => true,\r\n    [\".ts\", \".tsx\", \".jsx\", \".js\", \".css\"]\r\n  )\r\n}\r\n","import { cosmiconfig } from \"cosmiconfig\";\r\nimport fg from \"fast-glob\";\r\nimport path from \"path\";\r\nimport { loadConfig } from \"tsconfig-paths\";\r\nimport { z } from \"zod\";\r\nimport { BUILTIN_REGISTRIES } from \"../registry/constants\";\r\nimport { configSchema, rawConfigSchema, workspaceConfigSchema } from \"../schema\";\r\nimport { getProjectInfo } from \"./get-project-info\";\r\nimport { highlighter } from \"./highlighter\";\r\nimport { resolveImport } from \"./resolve-import\";\r\n\r\nexport const DEFAULT_STYLE = \"default\"\r\nexport const DEFAULT_COMPONENTS = \"@/components\"\r\nexport const DEFAULT_UTILS = \"@/lib/utils\"\r\nexport const DEFAULT_TAILWIND_CSS = \"app/globals.css\"\r\nexport const DEFAULT_TAILWIND_CONFIG = \"tailwind.config.js\"\r\nexport const DEFAULT_TAILWIND_BASE_COLOR = \"slate\"\r\n\r\n// TODO: Figure out if we want to support all cosmiconfig formats.\r\n// A simple components.json file would be nice.\r\nexport const explorer = cosmiconfig(\"components\", {\r\n  searchPlaces: [\"components.json\"]\r\n});\r\n\r\nexport type Config = z.infer<typeof configSchema>\r\n\r\nexport async function getConfig(cwd: string) {\r\n  const config = await getRawConfig(cwd);\r\n\r\n  if (!config) {\r\n    return null;\r\n  }\r\n\r\n  // Set default icon library if not provided.\r\n  if (!config.iconLibrary) {\r\n    config.iconLibrary = config.style === \"aodesu\" ? \"radix\" : \"lucide\";\r\n  }\r\n\r\n  return await resolveConfigPaths(cwd, config);\r\n}\r\n\r\nexport async function resolveConfigPaths(\r\n  cwd: string,\r\n  config: z.infer<typeof rawConfigSchema>\r\n) {\r\n  // Merge built-in registries with user registries\r\n  config.registries = {\r\n    ...BUILTIN_REGISTRIES,\r\n    ...(config.registries || {}),\r\n  };\r\n\r\n  // Read tsconfig.json\r\n  const tsConfig = await loadConfig(cwd);\r\n\r\n  if (tsConfig.resultType === \"failed\") {\r\n    throw new Error(\r\n      `Failed to load ${config.tsx ? \"tsconfig\" : \"jsconfig\"}.json ${\r\n        tsConfig.message ?? \"\"\r\n      }`.trim()\r\n    );\r\n  }\r\n\r\n  return configSchema.parse({\r\n    ...config,\r\n    resolvedPaths: {\r\n      cwd,\r\n      tailwindConfig: config.tailwind.config\r\n        ? path.resolve(cwd, config.tailwind.config)\r\n        : \"\",\r\n      tailwindCss: path.resolve(cwd, config.tailwind.css),\r\n      utils: await resolveImport(config.aliases[\"utils\"], tsConfig),\r\n      components: await resolveImport(config.aliases[\"components\"], tsConfig),\r\n      ui: config.aliases[\"ui\"]\r\n        ? await resolveImport(config.aliases[\"ui\"], tsConfig)\r\n        : path.resolve(\r\n          (await resolveImport(config.aliases[\"components\"], tsConfig)) ??\r\n          cwd,\r\n          \"ui\"\r\n        ),\r\n      // TODO: Make this configurable\r\n      // For now, we assume the lib and hooks directories are one level up from the components directory.\r\n      lib: config.aliases[\"lib\"]\r\n        ? await resolveImport(config.aliases[\"lib\"], tsConfig)\r\n        : path.resolve(\r\n          (await resolveImport(config.aliases[\"utils\"], tsConfig)) ?? cwd,\r\n          \"..\"\r\n        ),\r\n      hooks: config.aliases[\"hooks\"]\r\n        ? await resolveImport(config.aliases[\"hooks\"], tsConfig)\r\n        : path.resolve(\r\n          (await resolveImport(config.aliases[\"components\"], tsConfig)) ??\r\n            cwd,\r\n          \"..\",\r\n          \"hooks\"\r\n        ),\r\n    },\r\n  })\r\n};\r\n\r\nexport async function getRawConfig(\r\n  cwd: string\r\n): Promise<z.infer<typeof rawConfigSchema> | null> {\r\n  try {\r\n    const configResult = await explorer.search(cwd);\r\n\r\n    if (!configResult) {\r\n      return null;\r\n    }\r\n\r\n    const config = rawConfigSchema.parse(configResult.config);\r\n\r\n    // Check if user is trying to override built-in registries\r\n    if (config.registries) {\r\n      for (const registryName of Object.keys(config.registries)) {\r\n        if (registryName in BUILTIN_REGISTRIES) {\r\n          throw new Error(\r\n            `\"${registryName}\" is a built-in registry and cannot be overriden.`\r\n          )\r\n        }\r\n      }\r\n    }\r\n\r\n    return config;\r\n  } catch (error) {\r\n    const componentPath = `${cwd}/components.json`;\r\n    if (error instanceof Error && error.message.includes(\"reserved registry\")) {\r\n      throw error;\r\n    }\r\n    throw new Error(\r\n      `Invalid configuration found in ${highlighter.info(componentPath)}`\r\n    );\r\n  }\r\n}\r\n\r\nexport async function getWorkspaceConfig(config: Config) {\r\n  let resolvedAliases: any = {};\r\n\r\n  for (const key of Object.keys(config.aliases)) {\r\n    if (!isAliasKey(key, config)) {\r\n      continue;\r\n    }\r\n\r\n    const resolvedPath = config.resolvedPaths[key];\r\n    const packageRoot = await findPackageRoot(\r\n      config.resolvedPaths.cwd,\r\n      resolvedPath\r\n    );\r\n\r\n    if (!packageRoot) {\r\n      resolvedAliases[key] = config;\r\n      continue;\r\n    }\r\n\r\n    resolvedAliases[key] = await getConfig(packageRoot);\r\n  }\r\n\r\n  const result = workspaceConfigSchema.safeParse(resolvedAliases)\r\n  if (!result.success) {\r\n    return null;\r\n  }\r\n\r\n  return result.data;\r\n}\r\n\r\nexport async function findPackageRoot(cwd: string, resolvedPath: string) {\r\n  const commonRoot = findCommonRoot(cwd, resolvedPath);\r\n  const relativePath = path.relative(commonRoot, resolvedPath);\r\n\r\n  const packageRoots = await fg.glob(\"**/package.json\", {\r\n    cwd: commonRoot,\r\n    deep: 3,\r\n    ignore: [\"**/node_modules/**\", \"**/dist/**\", \"**/build/**\", \"**/public/**\"],\r\n  });\r\n\r\n  const matchingPackageRoot = packageRoots\r\n    .map((pkgPath) => path.dirname(pkgPath))\r\n    .find((pkgDir) => relativePath.startsWith(pkgDir));\r\n\r\n  return matchingPackageRoot ? path.join(commonRoot, matchingPackageRoot) : null;\r\n}\r\n\r\nfunction isAliasKey(\r\n  key: string,\r\n  config: Config\r\n): key is keyof Config[\"aliases\"] {\r\n  return Object.keys(config.resolvedPaths)\r\n    .filter((key) => key !== \"utils\")\r\n    .includes(key);\r\n}\r\n\r\nexport function findCommonRoot(cwd: string, resolvedPath: string) {\r\n  const parts1 = cwd.split(path.sep);\r\n  const parts2 = resolvedPath.split(path.sep);\r\n  const commonParts = [];\r\n\r\n  for (let i = 0; i < Math.min(parts1.length, parts2.length); i++) {\r\n    if (parts1[i] !== parts2[i]) {\r\n      break\r\n    }\r\n    commonParts.push(parts1[i])\r\n  }\r\n\r\n  return commonParts.join(path.sep);\r\n}\r\n\r\n// TODO: Cache this call.\r\nexport async function getTargetStyleFromConfig(cwd: string, fallback: string) {\r\n  const projectInfo = await getProjectInfo(cwd)\r\n  return projectInfo?.tailwindVersion === \"v4\" ? \"aodesu\" : fallback\r\n}\r\n\r\ntype DeepPartial<T> = {\r\n  [P in keyof T]?: T[P] extends object ? DeepPartial<T[P]> : T[P]\r\n}\r\n\r\nexport function createConfig(partial?: DeepPartial<Config>): Config {\r\n  const defaultConfig: Config = {\r\n    resolvedPaths: {\r\n      cwd: process.cwd(),\r\n      tailwindConfig: \"\",\r\n      tailwindCss: \"\",\r\n      utils: \"\",\r\n      components: \"\",\r\n      ui: \"\",\r\n      lib: \"\",\r\n      hooks: \"\",\r\n    },\r\n    style: \"\",\r\n    tailwind: {\r\n      config: \"\",\r\n      css: \"\",\r\n      baseColor: \"\",\r\n      cssVariables: false,\r\n    },\r\n    rsc: false,\r\n    tsx: true,\r\n    aliases: {\r\n      components: \"\",\r\n      utils: \"\",\r\n    },\r\n    registries: {\r\n      ...BUILTIN_REGISTRIES,\r\n    },\r\n  }\r\n\r\n  // Deep merge the partial config with defaults\r\n  if (partial) {\r\n    return {\r\n      ...defaultConfig,\r\n      ...partial,\r\n      resolvedPaths: {\r\n        ...defaultConfig.resolvedPaths,\r\n        ...(partial.resolvedPaths|| {}),\r\n      },\r\n      tailwind: {\r\n        ...defaultConfig.tailwind,\r\n        ...(partial.tailwind || {}),\r\n      },\r\n      aliases: {\r\n        ...defaultConfig.aliases,\r\n        ...(partial.aliases || {}),\r\n      },\r\n      registries: {\r\n        ...defaultConfig.registries,\r\n        ...(partial.registries || {}),\r\n      },\r\n    }\r\n  }\r\n\r\n  return defaultConfig;\r\n}\r\n","import fs from \"fs-extra\";\r\nimport path from \"path\";\r\nimport { type PackageJson } from \"type-fest\";\r\n\r\nexport function getPackageInfo(\r\n  cwd: string = \"\",\r\n  shouldThrow: boolean = true\r\n): PackageJson | null {\r\n  const packageJsonPath = path.join(cwd, \"package.json\");\r\n\r\n  return fs.readJSONSync(packageJsonPath, {\r\n    throws: shouldThrow,\r\n  }) as PackageJson;\r\n}\r\n","import { Framework, FRAMEWORKS } from \"@/src/utils/frameworks\";\r\nimport { Config, getConfig, resolveConfigPaths } from \"@/src/utils/get-config\";\r\nimport { getPackageInfo } from \"@/src/utils/get-package-info\";\r\nimport fg from \"fast-glob\";\r\nimport fs from \"fs-extra\";\r\nimport path from \"path\";\r\nimport { loadConfig } from \"tsconfig-paths\";\r\nimport { z } from \"zod\";\r\nimport { rawConfigSchema } from \"../schema\";\r\n\r\nexport type TailwindVersion = \"v3\" | \"v4\" | null;\r\n\r\nexport type ProjectInfo = {\r\n  framework: Framework;\r\n  isSrcDir: boolean;\r\n  isRSC: boolean;\r\n  isTsx: boolean;\r\n  tailwindConfigFile: string | null;\r\n  tailwindCssFile: string | null;\r\n  tailwindVersion: TailwindVersion;\r\n  frameworkVersion: string | null;\r\n  aliasPrefix: string | null;\r\n}\r\n\r\nconst PROJECT_SHARED_IGNORE = [\r\n  \"**/node_modules/**\",\r\n  \".next\",\r\n  \"public\",\r\n  \"dist\",\r\n  \"build\",\r\n];\r\n\r\nconst TS_CONFIG_SCHEMA = z.object({\r\n  compilerOptions: z.object({\r\n    paths: z.record(z.string().or(z.array(z.string()))),\r\n  }),\r\n});\r\n\r\nexport async function getProjectInfo(cwd: string): Promise<ProjectInfo | null> {\r\n  const [\r\n    configFiles,\r\n    isSrcDir,\r\n    isTsx,\r\n    tailwindConfigFile,\r\n    tailwindCssFile,\r\n    tailwindVersion,\r\n    aliasPrefix,\r\n    packageJson,\r\n  ] = await Promise.all([\r\n    fg.glob(\r\n      \"**/{vite,app,next}.config.*|gatsby-config.*|composer.json|react-router.config.*\",\r\n      {\r\n        cwd,\r\n        deep: 3,\r\n        ignore: PROJECT_SHARED_IGNORE,\r\n      }\r\n    ),\r\n    fs.pathExists(path.resolve(cwd, \"src\")),\r\n    isTypeScriptProject(cwd),\r\n    getTailwindConfigFile(cwd),\r\n    getTailwindCssFile(cwd),\r\n    getTailwindVersion(cwd),\r\n    getTsConfigAliasPrefix(cwd),\r\n    getPackageInfo(cwd, false),\r\n  ]);\r\n\r\n  const isUsingAppDir = await fs.pathExists(\r\n    path.resolve(cwd, `${isSrcDir ? \"src/\" : \"\"}app`)\r\n  );\r\n\r\n  const type: ProjectInfo = {\r\n    framework: FRAMEWORKS[\"manual\"],\r\n    isSrcDir,\r\n    isRSC: false,\r\n    isTsx,\r\n    tailwindConfigFile,\r\n    tailwindCssFile,\r\n    tailwindVersion,\r\n    frameworkVersion: null,\r\n    aliasPrefix,\r\n  }\r\n\r\n  // Next.js.\r\n  if (configFiles.find((file) => file.startsWith(\"next.config.\"))?.length) {\r\n    type.framework = isUsingAppDir\r\n      ? FRAMEWORKS[\"next-app\"]\r\n      : FRAMEWORKS[\"next-pages\"];\r\n    type.isRSC = isUsingAppDir;\r\n    type.frameworkVersion = await getFrameworkVersion(\r\n      type.framework,\r\n      packageJson\r\n    );\r\n    return type;\r\n  }\r\n\r\n  // Vite.\r\n  if (configFiles.find((file) => file.startsWith(\"vite.config.\"))?.length) {\r\n    type.framework = FRAMEWORKS[\"vite\"];\r\n    return type;\r\n  }\r\n\r\n  return type;\r\n};\r\n\r\nexport async function getFrameworkVersion(\r\n  framework: Framework,\r\n  packageJson: ReturnType<typeof getPackageInfo>\r\n) {\r\n  if (!packageJson) {\r\n    return null;\r\n  }\r\n\r\n  // Only detect Next.js version for now.\r\n  if (![\"next-app\", \"next-pages\"].includes(framework.name)) {\r\n    return null;\r\n  }\r\n\r\n  const version =\r\n    packageJson.dependencies?.next || packageJson.devDependencies?.next;\r\n\r\n  if (!version) {\r\n    return null;\r\n  }\r\n\r\n  // Extract full semver (major.minor.patch), handling ^, ~, etc.\r\n  const versionMatch = version.match(/^[\\^~]?(\\d+\\.\\d+\\.\\d+)/)\r\n  if (versionMatch) {\r\n    return versionMatch[1] // e.g., \"16.0.0\"\r\n  }\r\n\r\n  // For ranges like \">=15.0.0 <16.0.0\", extract the first version.\r\n  const rangeMatch = version.match(/(\\d+\\.\\d+\\.\\d+)/)\r\n  if (rangeMatch) {\r\n    return rangeMatch[1]\r\n  }\r\n\r\n  // For \"latest\", \"canary\", \"rc\", etc., return the tag as-is.\r\n  return version\r\n}\r\n\r\nexport async function getTailwindVersion(\r\n  cwd: string\r\n): Promise<ProjectInfo[\"tailwindVersion\"]> {\r\n  const [packageInfo, config] = await Promise.all([\r\n    getPackageInfo(cwd, false),\r\n    getConfig(cwd),\r\n  ]);\r\n\r\n  // If the config file is empty, we can assume that it's a v4 project\r\n  if (config?.tailwind?.config === \"\") {\r\n    return \"v4\";\r\n  }\r\n\r\n  if (\r\n    !packageInfo?.dependencies?.tailwindcss &&\r\n    !packageInfo?.devDependencies?.tailwindcss\r\n  ) {\r\n    return null;\r\n  }\r\n\r\n  if (\r\n    /^(?:\\^|~)?3(?:\\.\\d+)*(?:-.*)?$/.test(\r\n      packageInfo?.dependencies?.tailwindcss ||\r\n        packageInfo?.devDependencies?.tailwindcss ||\r\n        \"\"\r\n    )\r\n  ) {\r\n    return \"v3\"\r\n  }\r\n\r\n  return \"v4\"\r\n}\r\n\r\nexport async function getTailwindCssFile(cwd: string) {\r\n  const [files, tailwindVersion] = await Promise.all([\r\n    fg.glob([\"**/*.css\", \"**/*.scss\"], {\r\n      cwd,\r\n      deep: 5,\r\n      ignore: PROJECT_SHARED_IGNORE,\r\n    }),\r\n    getTailwindVersion(cwd),\r\n  ]);\r\n\r\n  if (!files.length) {\r\n    return null;\r\n  }\r\n\r\n  for (const file of files) {\r\n    const contents = await fs.readFile(path.resolve(cwd, file), \"utf8\");\r\n    if (\r\n      contents.includes(`@import \"tailwindcss\"`) ||\r\n      contents.includes(`@import 'tailwindcss'`) ||\r\n      contents.includes(`@tailwind base`)\r\n    ) {\r\n      return file;\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nexport async function getTailwindConfigFile(cwd: string) {\r\n  const files = await fg.glob(\"tailwind.config.*\", {\r\n    cwd,\r\n    deep: 3,\r\n    ignore: PROJECT_SHARED_IGNORE,\r\n  });\r\n\r\n  if (!files.length) {\r\n    return null;\r\n  }\r\n\r\n  return files[0];\r\n}\r\n\r\nexport async function getTsConfigAliasPrefix(cwd: string) {\r\n  const tsConfig = await loadConfig(cwd);\r\n\r\n  if (\r\n    tsConfig?.resultType === \"failed\" ||\r\n    !Object.entries(tsConfig?.paths).length\r\n  ) {\r\n    return null;\r\n  }\r\n\r\n  // This assume that the first alias is the prefix.\r\n  for (const [alias, paths] of Object.entries(tsConfig.paths)) {\r\n    if (\r\n      paths.includes(\"./*\") ||\r\n      paths.includes(\"./src/*\") ||\r\n      paths.includes(\"./app/*\") ||\r\n      paths.includes(\"./resources/js/*\") // Laravel.\r\n    ) {\r\n      return alias.replace(/\\/\\*$/, \"\") ?? null\r\n    }\r\n  }\r\n\r\n  // Use the first alias as the prefix.\r\n  return Object.keys(tsConfig?.paths)?.[0].replace(/\\/\\*$/, \"\") ?? null;\r\n}\r\n\r\nexport async function isTypeScriptProject(cwd: string) {\r\n  const files = await fg.glob(\"tsconfig.*\", {\r\n    cwd,\r\n    deep: 1,\r\n    ignore: PROJECT_SHARED_IGNORE,\r\n  });\r\n\r\n  return files.length > 0;\r\n}\r\n\r\nexport async function getProjectConfig(\r\n  cwd: string,\r\n  defaultProjectInfo: ProjectInfo | null = null\r\n): Promise<Config | null> {\r\n  // Check for existing component file.\r\n  const [existingConfig, projectInfo] = await Promise.all([\r\n    getConfig(cwd),\r\n    !defaultProjectInfo\r\n      ? getProjectInfo(cwd)\r\n      : Promise.resolve(defaultProjectInfo)\r\n  ]);\r\n\r\n  if (existingConfig) {\r\n    return existingConfig;\r\n  }\r\n\r\n  if(\r\n    !projectInfo ||\r\n    !projectInfo.tailwindCssFile ||\r\n    (projectInfo.tailwindVersion === \"v3\" && !projectInfo.tailwindConfigFile)\r\n  ) {\r\n    return null;\r\n  }\r\n\r\n  const config: z.infer<typeof rawConfigSchema> = {\r\n    $schema: \"https://ui.aodesu.com/schema.json\",\r\n    rsc: projectInfo.isRSC,\r\n    tsx: projectInfo.isTsx,\r\n    style: \"aodesu\",\r\n    tailwind: {\r\n      config: projectInfo.tailwindConfigFile ?? \"\",\r\n      baseColor: \"zinc\",\r\n      css: projectInfo.tailwindCssFile,\r\n      cssVariables: true,\r\n      prefix: \"\",\r\n    },\r\n    iconLibrary: \"lucide\",\r\n    aliases: {\r\n      components: `${projectInfo.aliasPrefix}/components`,\r\n      ui: `${projectInfo.aliasPrefix}/components/ui`,\r\n      hooks: `${projectInfo.aliasPrefix}/hooks`,\r\n      lib: `${projectInfo.aliasPrefix}/lib`,\r\n      utils: `${projectInfo.aliasPrefix}/lib/utils`,\r\n    },\r\n  }\r\n\r\n  return await resolveConfigPaths(cwd, config)\r\n}\r\n\r\nexport async function getProjectTailwindVersionFromConfig(config: {\r\n  resolvedPaths: Pick<Config[\"resolvedPaths\"], \"cwd\">\r\n}): Promise<TailwindVersion> {\r\n  if (!config.resolvedPaths?.cwd) {\r\n    return \"v3\";\r\n  }\r\n\r\n  const projectInfo = await getProjectInfo(config.resolvedPaths.cwd);\r\n\r\n  if (!projectInfo?.tailwindVersion) {\r\n    return null;\r\n  }\r\n\r\n  return projectInfo.tailwindVersion;\r\n}\r\n","import { highlighter } from \"./highlighter\";\r\n\r\nexport const logger = {\r\n  error(...args: unknown[]) {\r\n    console.log(highlighter.error(args.join(\" \")))\r\n  },\r\n  warn(...args: unknown[]) {\r\n    console.log(highlighter.warn(args.join(\" \")))\r\n  },\r\n  info(...args: unknown[]) {\r\n    console.log(highlighter.info(args.join(\" \")))\r\n  },\r\n  success(...args: unknown[]) {\r\n    console.log(highlighter.success(args.join(\" \")))\r\n  },\r\n  log(...args: unknown[]) {\r\n    console.log(args.join(\" \"))\r\n  },\r\n  break() {\r\n    console.log(\"\")\r\n  },\r\n};\r\n","import { initOptionsSchema } from \"@/src/commands/init\";\r\nimport * as ERRORS from \"@/src/utils/errors\";\r\nimport { getProjectInfo } from \"@/src/utils/get-project-info\";\r\nimport { highlighter } from \"@/src/utils/highlighter\";\r\nimport { logger } from \"@/src/utils/logger\";\r\nimport { spinner } from \"@/src/utils/spinner\";\r\nimport fs from \"fs-extra\";\r\nimport path from \"path\";\r\nimport { z } from \"zod\";\r\n\r\nexport async function preFlightInit(\r\n  options: z.infer<typeof initOptionsSchema>\r\n) {\r\n  const errors: Record<string, boolean> = {};\r\n\r\n  // Ensure target directory exists.\r\n  // Check for empty project. We assume if no package.json exists, the project is empty.\r\n  if (\r\n    !fs.existsSync(options.cwd) ||\r\n    !fs.existsSync(path.resolve(options.cwd, \"package.json\"))\r\n  ) {\r\n    errors[ERRORS.MISSING_DIR_OR_EMPTY_PROJECT] = true;\r\n    return {\r\n      errors,\r\n      projectInfo: null,\r\n    }\r\n  }\r\n\r\n  const projectSpinner = spinner(\"Preflight checks.\", {\r\n    silent: options.silent,\r\n  }).start()\r\n\r\n  if (\r\n    fs.existsSync(path.resolve(options.cwd, \"components.json\")) &&\r\n    !options.force\r\n  ) {\r\n    projectSpinner?.fail();\r\n    logger.break();\r\n    logger.error(\r\n      `A ${highlighter.info(\r\n        \"components.json\"\r\n      )} file already exist at ${highlighter.info(\r\n        options.cwd\r\n      )}. \\nTo start over, remove the ${highlighter.info(\r\n        \"components.json\"\r\n      )} file and run ${highlighter.info(\"init\")} again.`\r\n    );\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  projectSpinner?.succeed();\r\n\r\n  const frameworkSpinner = spinner(\"Verifying framework.\", {\r\n    silent: options.silent,\r\n  }).start();\r\n  const projectInfo = await getProjectInfo(options.cwd);\r\n  if (!projectInfo || projectInfo?.framework.name === \"manual\") {\r\n    errors[ERRORS.UNSUPPORTED_FRAMEWORK] = true;\r\n    frameworkSpinner?.fail();\r\n    logger.break();\r\n    if (projectInfo?.framework.links.installation) {\r\n      logger.error(\r\n        `We could not detect a supported framework at ${highlighter.info(\r\n          options.cwd\r\n        )}.\\n` +\r\n          `Visit ${highlighter.info(\r\n            projectInfo?.framework.links.installation\r\n          )} to manually configure your project. \\nOnce configured, you can use the cli to add components.`\r\n      )\r\n    }\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n  frameworkSpinner?.succeed(\r\n    `Verifying framework. Found ${highlighter.info(\r\n      projectInfo.framework.label\r\n    )}.`\r\n  )\r\n\r\n  let tailwindSpinnerMessage = \"Validating Tailwind CSS.\";\r\n\r\n  if (projectInfo.tailwindVersion === \"v4\") {\r\n    tailwindSpinnerMessage = `Validating Tailwind CSS config. Found ${highlighter.info(\r\n      \"v4\"\r\n    )}.`\r\n  }\r\n\r\n  const tailwindSpinner = spinner(tailwindSpinnerMessage, {\r\n    silent: options.silent,\r\n  }).start();\r\n\r\n  if (\r\n    projectInfo.tailwindVersion === \"v3\" &&\r\n    (!projectInfo?.tailwindConfigFile || !projectInfo?.tailwindCssFile)\r\n  ) {\r\n    errors[ERRORS.TAILWIND_NOT_CONFIGURED] = true\r\n    tailwindSpinner?.fail()\r\n  } else if (\r\n    projectInfo.tailwindVersion === \"v4\" &&\r\n    !projectInfo?.tailwindCssFile\r\n  ) {\r\n    errors[ERRORS.TAILWIND_NOT_CONFIGURED] = true\r\n    tailwindSpinner?.fail()\r\n  } else if (!projectInfo.tailwindVersion) {\r\n    errors[ERRORS.TAILWIND_NOT_CONFIGURED] = true\r\n    tailwindSpinner?.fail()\r\n  } else {\r\n    tailwindSpinner?.succeed()\r\n  }\r\n\r\n  const tsConfigSpinner = spinner(`Validating import alias.`, {\r\n    silent: options.silent,\r\n  }).start();\r\n\r\n  if (!projectInfo?.aliasPrefix) {\r\n    errors[ERRORS.IMPORT_ALIAS_MISSING] = true\r\n    tsConfigSpinner?.fail()\r\n  } else {\r\n    tsConfigSpinner?.succeed()\r\n  }\r\n\r\n  if (Object.keys(errors).length > 0) {\r\n    if (errors[ERRORS.TAILWIND_NOT_CONFIGURED]) {\r\n      logger.break()\r\n      logger.error(\r\n        `No Tailwind CSS configuration found at ${highlighter.info(\r\n          options.cwd\r\n        )}.`\r\n      )\r\n      logger.error(\r\n        `It is likely you do not have Tailwind CSS installed or have an invalid configuration.`\r\n      )\r\n      logger.error(`Install Tailwind CSS then try again.`)\r\n      if (projectInfo?.framework.links.tailwind) {\r\n        logger.error(\r\n          `Visit ${highlighter.info(\r\n            projectInfo?.framework.links.tailwind\r\n          )} to get started.`\r\n        )\r\n      }\r\n    }\r\n\r\n    if (errors[ERRORS.IMPORT_ALIAS_MISSING]) {\r\n      logger.break()\r\n      logger.error(`No import alias found in your tsconfig.json file.`)\r\n      if (projectInfo?.framework.links.installation) {\r\n        logger.error(\r\n          `Visit ${highlighter.info(\r\n            projectInfo?.framework.links.installation\r\n          )} to learn how to set an import alias.`\r\n        )\r\n      }\r\n    }\r\n\r\n    logger.break()\r\n    process.exit(1)\r\n  }\r\n\r\n  return {\r\n    errors,\r\n    projectInfo\r\n  }\r\n}\r\n","import { z } from \"zod\"\r\n\r\n// Error codes for programmatic error handling\r\nexport const RegistryErrorCode = {\r\n  // Network errors\r\n  NETWORK_ERROR: \"NETWORK_ERROR\",\r\n  NOT_FOUND: \"NOT_FOUND\",\r\n  UNAUTHORIZED: \"UNAUTHORIZED\",\r\n  FORBIDDEN: \"FORBIDDEN\",\r\n  FETCH_ERROR: \"FETCH_ERROR\",\r\n\r\n  // Configuration errors\r\n  NOT_CONFIGURED: \"NOT_CONFIGURED\",\r\n  INVALID_CONFIG: \"INVALID_CONFIG\",\r\n  MISSING_ENV_VARS: \"MISSING_ENV_VARS\",\r\n\r\n  // File system errors\r\n  LOCAL_FILE_ERROR: \"LOCAL_FILE_ERROR\",\r\n\r\n  // Parsing errors\r\n  PARSE_ERROR: \"PARSE_ERROR\",\r\n  VALIDATION_ERROR: \"VALIDATION_ERROR\",\r\n\r\n  // Generic errors\r\n  UNKNOWN_ERROR: \"UNKNOWN_ERROR\",\r\n} as const\r\n\r\nexport type RegistryErrorCode =\r\n  (typeof RegistryErrorCode)[keyof typeof RegistryErrorCode]\r\n\r\nexport class RegistryError extends Error {\r\n  public readonly code: RegistryErrorCode\r\n  public readonly statusCode?: number\r\n  public readonly context?: Record<string, unknown>\r\n  public readonly suggestion?: string\r\n  public readonly timestamp: Date\r\n  public readonly cause?: unknown\r\n\r\n  constructor(\r\n    message: string,\r\n    options: {\r\n      code?: RegistryErrorCode\r\n      statusCode?: number\r\n      cause?: unknown\r\n      context?: Record<string, unknown>\r\n      suggestion?: string\r\n    } = {}\r\n  ) {\r\n    super(message)\r\n    this.name = \"RegistryError\"\r\n    this.code = options.code || RegistryErrorCode.UNKNOWN_ERROR\r\n    this.statusCode = options.statusCode\r\n    this.cause = options.cause\r\n    this.context = options.context\r\n    this.suggestion = options.suggestion\r\n    this.timestamp = new Date()\r\n\r\n    if (Error.captureStackTrace) {\r\n      Error.captureStackTrace(this, this.constructor)\r\n    }\r\n  }\r\n\r\n  toJSON() {\r\n    return {\r\n      name: this.name,\r\n      message: this.message,\r\n      code: this.code,\r\n      statusCode: this.statusCode,\r\n      context: this.context,\r\n      suggestion: this.suggestion,\r\n      timestamp: this.timestamp,\r\n      stack: this.stack,\r\n    }\r\n  }\r\n}\r\n\r\nexport class RegistryNotFoundError extends RegistryError {\r\n  constructor(public readonly url: string, cause?: unknown) {\r\n    const message = `The item at ${url} was not found. It may not exist at the registry.`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.NOT_FOUND,\r\n      statusCode: 404,\r\n      cause,\r\n      context: { url },\r\n      suggestion:\r\n        \"Check if the item name is correct and the registry URL is accessible.\",\r\n    })\r\n    this.name = \"RegistryNotFoundError\"\r\n  }\r\n}\r\n\r\nexport class RegistryUnauthorizedError extends RegistryError {\r\n  constructor(public readonly url: string, cause?: unknown) {\r\n    const message = `You are not authorized to access the item at ${url}. If this is a remote registry, you may need to authenticate.`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.UNAUTHORIZED,\r\n      statusCode: 401,\r\n      cause,\r\n      context: { url },\r\n      suggestion:\r\n        \"Check your authentication credentials and environment variables.\",\r\n    })\r\n    this.name = \"RegistryUnauthorizedError\"\r\n  }\r\n}\r\n\r\nexport class RegistryForbiddenError extends RegistryError {\r\n  constructor(public readonly url: string, cause?: unknown) {\r\n    const message = `You are not authorized to access the item at ${url}. If this is a remote registry, you may need to authenticate.`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.FORBIDDEN,\r\n      statusCode: 403,\r\n      cause,\r\n      context: { url },\r\n      suggestion:\r\n        \"Check your authentication credentials and environment variables.\",\r\n    })\r\n    this.name = \"RegistryForbiddenError\"\r\n  }\r\n}\r\n\r\nexport class RegistryFetchError extends RegistryError {\r\n  constructor(\r\n    public readonly url: string,\r\n    statusCode?: number,\r\n    public readonly responseBody?: string,\r\n    cause?: unknown\r\n  ) {\r\n    // Use the error detail from the server if available\r\n    const baseMessage = statusCode\r\n      ? `Failed to fetch from registry (${statusCode}): ${url}`\r\n      : `Failed to fetch from registry: ${url}`\r\n\r\n    const message =\r\n      typeof cause === \"string\" && cause\r\n        ? `${baseMessage} - ${cause}`\r\n        : baseMessage\r\n\r\n    let suggestion = \"Check your network connection and try again.\"\r\n    if (statusCode === 404) {\r\n      suggestion =\r\n        \"The requested resource was not found. Check the URL or item name.\"\r\n    } else if (statusCode === 500) {\r\n      suggestion = \"The registry server encountered an error. Try again later.\"\r\n    } else if (statusCode && statusCode >= 400 && statusCode < 500) {\r\n      suggestion = \"There was a client error. Check your request parameters.\"\r\n    }\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.FETCH_ERROR,\r\n      statusCode,\r\n      cause,\r\n      context: { url, responseBody },\r\n      suggestion,\r\n    })\r\n    this.name = \"RegistryFetchError\"\r\n  }\r\n}\r\n\r\nexport class RegistryNotConfiguredError extends RegistryError {\r\n  constructor(public readonly registryName: string | null) {\r\n    const message = registryName\r\n      ? `Unknown registry \"${registryName}\". Make sure it is defined in components.json as follows:\r\n{\r\n  \"registries\": {\r\n    \"${registryName}\": \"[URL_TO_REGISTRY]\"\r\n  }\r\n}`\r\n      : `Unknown registry. Make sure it is defined in components.json under \"registries\".`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.NOT_CONFIGURED,\r\n      context: { registryName },\r\n      suggestion:\r\n        \"Add the registry configuration to your components.json file. Consult the registry documentation for the correct format.\",\r\n    })\r\n    this.name = \"RegistryNotConfiguredError\"\r\n  }\r\n}\r\n\r\nexport class RegistryLocalFileError extends RegistryError {\r\n  constructor(public readonly filePath: string, cause?: unknown) {\r\n    super(`Failed to read local registry file: ${filePath}`, {\r\n      code: RegistryErrorCode.LOCAL_FILE_ERROR,\r\n      cause,\r\n      context: { filePath },\r\n      suggestion: \"Check if the file exists and you have read permissions.\",\r\n    })\r\n    this.name = \"RegistryLocalFileError\"\r\n  }\r\n}\r\n\r\nexport class RegistryParseError extends RegistryError {\r\n  public readonly parseError: unknown\r\n\r\n  constructor(public readonly item: string, parseError: unknown) {\r\n    let message = `Failed to parse registry item: ${item}`\r\n\r\n    if (parseError instanceof z.ZodError) {\r\n      message = `Failed to parse registry item: ${item}\\n${parseError.errors\r\n        .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\r\n        .join(\"\\n\")}`\r\n    }\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.PARSE_ERROR,\r\n      cause: parseError,\r\n      context: { item },\r\n      suggestion:\r\n        \"The registry item may be corrupted or have an invalid format. Please make sure it returns a valid JSON object. See https://ui.aodesu.com/schema/registry-item.json.\",\r\n    })\r\n\r\n    this.parseError = parseError\r\n    this.name = \"RegistryParseError\"\r\n  }\r\n}\r\n\r\nexport class RegistryMissingEnvironmentVariablesError extends RegistryError {\r\n  constructor(\r\n    public readonly registryName: string,\r\n    public readonly missingVars: string[]\r\n  ) {\r\n    const message =\r\n      `Registry \"${registryName}\" requires the following environment variables:\\n\\n` +\r\n      missingVars.map((v) => `   ${v}`).join(\"\\n\")\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.MISSING_ENV_VARS,\r\n      context: { registryName, missingVars },\r\n      suggestion:\r\n        \"Set the required environment variables to your .env or .env.local file.\",\r\n    })\r\n    this.name = \"RegistryMissingEnvironmentVariablesError\"\r\n  }\r\n}\r\n\r\nexport class RegistryInvalidNamespaceError extends RegistryError {\r\n  constructor(public readonly name: string) {\r\n    const message = `Invalid registry namespace: \"${name}\". Registry names must start with @ (e.g., @aodesu, @v0).`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.VALIDATION_ERROR,\r\n      context: { name },\r\n      suggestion:\r\n        \"Use a valid registry name starting with @ or provide a direct URL to the registry.\",\r\n    })\r\n    this.name = \"RegistryInvalidNamespaceError\"\r\n  }\r\n}\r\n\r\nexport class ConfigMissingError extends RegistryError {\r\n  constructor(public readonly cwd: string) {\r\n    const message = `No components.json found in ${cwd} or parent directories.`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.NOT_CONFIGURED,\r\n      context: { cwd },\r\n      suggestion:\r\n        \"Run 'npx aodesu@latest init' to create a components.json file, or check that you're in the correct directory.\",\r\n    })\r\n    this.name = \"ConfigMissingError\"\r\n  }\r\n}\r\n\r\nexport class ConfigParseError extends RegistryError {\r\n  constructor(public readonly cwd: string, parseError: unknown) {\r\n    let message = `Invalid components.json configuration in ${cwd}.`\r\n\r\n    if (parseError instanceof z.ZodError) {\r\n      message = `Invalid components.json configuration in ${cwd}:\\n${parseError.errors\r\n        .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\r\n        .join(\"\\n\")}`\r\n    }\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.INVALID_CONFIG,\r\n      cause: parseError,\r\n      context: { cwd },\r\n      suggestion:\r\n        \"Check your components.json file for syntax errors or invalid configuration. Run 'npx aodesu@latest init' to regenerate a valid configuration.\",\r\n    })\r\n    this.name = \"ConfigParseError\"\r\n  }\r\n}\r\n\r\nexport class RegistriesIndexParseError extends RegistryError {\r\n  public readonly parseError: unknown\r\n\r\n  constructor(parseError: unknown) {\r\n    let message = \"Failed to parse registries index\"\r\n\r\n    if (parseError instanceof z.ZodError) {\r\n      const invalidNamespaces = parseError.errors\r\n        .filter((e) => e.path.length > 0)\r\n        .map((e) => `\"${e.path[0]}\"`)\r\n        .filter((v, i, arr) => arr.indexOf(v) === i) // remove duplicates\r\n\r\n      if (invalidNamespaces.length > 0) {\r\n        message = `Failed to parse registries index. Invalid registry namespace(s): ${invalidNamespaces.join(\r\n          \", \"\r\n        )}\\n${parseError.errors\r\n          .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\r\n          .join(\"\\n\")}`\r\n      } else {\r\n        message = `Failed to parse registries index:\\n${parseError.errors\r\n          .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\r\n          .join(\"\\n\")}`\r\n      }\r\n    }\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.PARSE_ERROR,\r\n      cause: parseError,\r\n      context: { parseError },\r\n      suggestion:\r\n        \"The registries index may be corrupted or have invalid registry namespace format. Registry names must start with @ (e.g., @aodesu, @example).\",\r\n    })\r\n\r\n    this.parseError = parseError\r\n    this.name = \"RegistriesIndexParseError\"\r\n  }\r\n}\r\n","import z from \"zod\";\r\nimport { RegistryError } from \"../registry/errors\";\r\nimport { highlighter } from \"./highlighter\";\r\nimport { logger } from \"./logger\";\r\n\r\nexport function handleError(error: unknown) {\r\n  logger.break();\r\n  logger.error(\"Something went wrong. Please check the error below for more details.\");\r\n  logger.error(\"If the problem persist, please open an issue on GitHub.\");\r\n  logger.error(\"\");\r\n\r\n  if (typeof error === \"string\") {\r\n    logger.error(error);\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  if (error instanceof RegistryError) {\r\n    if (error.message) {\r\n      logger.error(error.cause ? \"Error\" : \"Message:\");\r\n      logger.error(error.message);\r\n    }\r\n\r\n    if (error.cause) {\r\n      logger.error(\"\\nMessage:\");\r\n      logger.error(error.cause);\r\n    }\r\n\r\n    if (error.suggestion) {\r\n      logger.error(\"\\nSuggestion:\");\r\n      logger.error(error.suggestion);\r\n    }\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  if (error instanceof z.ZodError) {\r\n    logger.error(\"Validation failed:\");\r\n    for (const [key, value] of Object.entries(error.flatten().fieldErrors)) {\r\n      logger.error(`- ${highlighter.info(key)}: ${value}`);\r\n    }\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  if (error instanceof Error) {\r\n    logger.error(error.message);\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  logger.break();\r\n  process.exit(1);\r\n}\r\n","export function expandEnvVars(value: string) {\r\n  return value.replace(/\\${(\\w+)}/g, (_match, key) => process.env[key] || \"\")\r\n}\r\n\r\nexport function extractEnvVars(value: string) {\r\n  const vars: string[] = []\r\n  const regex = /\\${(\\w+)}/g\r\n  let match: RegExpExecArray | null\r\n\r\n  while ((match = regex.exec(value)) !== null) {\r\n    vars.push(match[1])\r\n  }\r\n\r\n  return vars\r\n}\r\n","// Valid registry name pattern: @namespace where namespace is alphanumeric with hyphens/underscores\r\nconst REGISTRY_PATTERN = /^(@[a-zA-Z0-9](?:[a-zA-Z0-9-_]*[a-zA-Z0-9])?)\\/(.+)$/\r\n\r\nexport function parseRegistryAndItemFromString(name: string) {\r\n  if (!name.startsWith(\"@\")) {\r\n    return {\r\n      registry: null,\r\n      item: name,\r\n    }\r\n  }\r\n\r\n  const match = name.match(REGISTRY_PATTERN)\r\n  if (match) {\r\n    return {\r\n      registry: match[1],\r\n      item: match[2],\r\n    }\r\n  }\r\n\r\n  return {\r\n    registry: null,\r\n    item: name,\r\n  }\r\n}\r\n","export function isContentSame(\r\n  existingContent: string,\r\n  newContent: string,\r\n  options: {\r\n    ignoreImports?: boolean\r\n  } = {}\r\n) {\r\n  const { ignoreImports = false } = options\r\n\r\n  // Normalize line endings and whitespace.\r\n  const normalizedExisting = existingContent.replace(/\\r\\n/g, \"\\n\").trim()\r\n  const normalizedNew = newContent.replace(/\\r\\n/g, \"\\n\").trim()\r\n\r\n  // First, try exact match after normalization.\r\n  if (normalizedExisting === normalizedNew) {\r\n    return true\r\n  }\r\n\r\n  // If not ignoring imports or exact match failed, return false\r\n  if (!ignoreImports) {\r\n    return false\r\n  }\r\n\r\n  // Compare with import statements normalized.\r\n  // This regex matches various import patterns including:\r\n  // - import defaultExport from \"module\"\r\n  // - import * as name from \"module\"\r\n  // - import { export1, export2 } from \"module\"\r\n  // - import { export1 as alias1 } from \"module\"\r\n  // - import defaultExport, { export1 } from \"module\"\r\n  // - import type { Type } from \"module\"\r\n  // - This Regex written by Claude Code.\r\n  const importRegex =\r\n    /^(import\\s+(?:type\\s+)?(?:\\*\\s+as\\s+\\w+|\\{[^}]*\\}|\\w+)?(?:\\s*,\\s*(?:\\{[^}]*\\}|\\w+))?\\s+from\\s+[\"'])([^\"']+)([\"'])/gm\r\n\r\n  // Function to normalize import paths - remove alias differences.\r\n  const normalizeImports = (content: string) => {\r\n    return content.replace(\r\n      importRegex,\r\n      (_match, prefix, importPath, suffix) => {\r\n        // Keep relative imports as-is.\r\n        if (importPath.startsWith(\".\")) {\r\n          return `${prefix}${importPath}${suffix}`\r\n        }\r\n\r\n        // For aliased imports, normalize to a common format.\r\n        // Extract the last meaningful part of the path.\r\n        const parts = importPath.split(\"/\")\r\n        const lastPart = parts[parts.length - 1]\r\n\r\n        // Normalize to a consistent format.\r\n        return `${prefix}@normalized/${lastPart}${suffix}`\r\n      }\r\n    )\r\n  }\r\n\r\n  const existingNormalized = normalizeImports(normalizedExisting)\r\n  const newNormalized = normalizeImports(normalizedNew)\r\n\r\n  return existingNormalized === newNormalized\r\n}\r\n","import { existsSync } from \"fs\"\r\nimport path from \"path\"\r\n\r\nexport function isEnvFile(filePath: string) {\r\n  const fileName = path.basename(filePath)\r\n  return /^\\.env(\\.|$)/.test(fileName)\r\n}\r\n\r\n/**\r\n * Finds a file variant in the project.\r\n * TODO: abstract this to a more generic function.\r\n */\r\nexport function findExistingEnvFile(targetDir: string) {\r\n  const variants = [\r\n    \".env.local\",\r\n    \".env\",\r\n    \".env.development.local\",\r\n    \".env.development\",\r\n  ]\r\n\r\n  for (const variant of variants) {\r\n    const filePath = path.join(targetDir, variant)\r\n    if (existsSync(filePath)) {\r\n      return filePath\r\n    }\r\n  }\r\n\r\n  return null\r\n}\r\n\r\n/**\r\n * Parse .env content into key-value pairs.\r\n */\r\nexport function parseEnvContent(content: string) {\r\n  const lines = content.split(\"\\n\")\r\n  const env: Record<string, string> = {}\r\n\r\n  for (const line of lines) {\r\n    const trimmed = line.trim()\r\n\r\n    if (!trimmed || trimmed.startsWith(\"#\")) {\r\n      continue\r\n    }\r\n\r\n    // Find the first = and split there\r\n    const equalIndex = trimmed.indexOf(\"=\")\r\n    if (equalIndex === -1) {\r\n      continue\r\n    }\r\n\r\n    const key = trimmed.substring(0, equalIndex).trim()\r\n    const value = trimmed.substring(equalIndex + 1).trim()\r\n\r\n    if (key) {\r\n      env[key] = value.replace(/^[\"']|[\"']$/g, \"\")\r\n    }\r\n  }\r\n\r\n  return env\r\n}\r\n\r\n/**\r\n * Get the list of new keys that would be added when merging env content.\r\n */\r\nexport function getNewEnvKeys(existingContent: string, newContent: string) {\r\n  const existingEnv = parseEnvContent(existingContent)\r\n  const newEnv = parseEnvContent(newContent)\r\n\r\n  const newKeys = []\r\n  for (const key of Object.keys(newEnv)) {\r\n    if (!(key in existingEnv)) {\r\n      newKeys.push(key)\r\n    }\r\n  }\r\n\r\n  return newKeys\r\n}\r\n\r\n/**\r\n * Merge env content by appending ONLY new keys that don't exist in the existing content.\r\n * Existing keys are preserved with their original values.\r\n */\r\nexport function mergeEnvContent(existingContent: string, newContent: string) {\r\n  const existingEnv = parseEnvContent(existingContent)\r\n  const newEnv = parseEnvContent(newContent)\r\n\r\n  let result = existingContent.trimEnd()\r\n  if (result && !result.endsWith(\"\\n\")) {\r\n    result += \"\\n\"\r\n  }\r\n\r\n  const newKeys: string[] = []\r\n  for (const [key, value] of Object.entries(newEnv)) {\r\n    if (!(key in existingEnv)) {\r\n      newKeys.push(`${key}=${value}`)\r\n    }\r\n  }\r\n\r\n  if (newKeys.length > 0) {\r\n    if (result) {\r\n      result += \"\\n\"\r\n    }\r\n    result += newKeys.join(\"\\n\")\r\n    return result + \"\\n\"\r\n  }\r\n\r\n  // Ensure existing content ends with newline.\r\n  if (result && !result.endsWith(\"\\n\")) {\r\n    return result + \"\\n\"\r\n  }\r\n\r\n  return result\r\n}\r\n","import { registryBaseColorSchema } from \"@/src/schema\"\r\nimport { Transformer } from \"@/src/utils/transformers\"\r\nimport { ScriptKind, SyntaxKind } from \"ts-morph\"\r\nimport { z } from \"zod\"\r\n\r\nexport const transformCssVars: Transformer = async ({\r\n  sourceFile,\r\n  config,\r\n  baseColor,\r\n}) => {\r\n  // No transform if using css variables.\r\n  if (config.tailwind?.cssVariables || !baseColor?.inlineColors) {\r\n    return sourceFile\r\n  }\r\n\r\n  // Find jsx attributes with the name className.\r\n  // const openingElements = sourceFile.getDescendantsOfKind(SyntaxKind.JsxElement)\r\n  // console.log(openingElements)\r\n  // const jsxAttributes = sourceFile\r\n  //   .getDescendantsOfKind(SyntaxKind.JsxAttribute)\r\n  //   .filter((node) => node.getName() === \"className\")\r\n\r\n  // for (const jsxAttribute of jsxAttributes) {\r\n  //   const value = jsxAttribute.getInitializer()?.getText()\r\n  //   if (value) {\r\n  //     const valueWithColorMapping = applyColorMapping(\r\n  //       value.replace(/\"/g, \"\"),\r\n  //       baseColor.inlineColors\r\n  //     )\r\n  //     jsxAttribute.setInitializer(`\"${valueWithColorMapping}\"`)\r\n  //   }\r\n  // }\r\n  sourceFile.getDescendantsOfKind(SyntaxKind.StringLiteral).forEach((node) => {\r\n    const raw = node.getLiteralText()\r\n    const mapped = applyColorMapping(raw, baseColor.inlineColors).trim()\r\n    if (mapped !== raw) {\r\n      node.setLiteralValue(mapped)\r\n    }\r\n  })\r\n\r\n  return sourceFile\r\n}\r\n\r\n// export default function transformer(file: FileInfo, api: API) {\r\n//   const j = api.jscodeshift.withParser(\"tsx\")\r\n\r\n//   // Replace bg-background with \"bg-white dark:bg-slate-950\"\r\n//   const $j = j(file.source)\r\n//   return $j\r\n//     .find(j.JSXAttribute, {\r\n//       name: {\r\n//         name: \"className\",\r\n//       },\r\n//     })\r\n//     .forEach((path) => {\r\n//       const { node } = path\r\n//       if (node?.value?.type) {\r\n//         if (node.value.type === \"StringLiteral\") {\r\n//           node.value.value = applyColorMapping(node.value.value)\r\n//           console.log(node.value.value)\r\n//         }\r\n\r\n//         if (\r\n//           node.value.type === \"JSXExpressionContainer\" &&\r\n//           node.value.expression.type === \"CallExpression\"\r\n//         ) {\r\n//           const callee = node.value.expression.callee\r\n//           if (callee.type === \"Identifier\" && callee.name === \"cn\") {\r\n//             node.value.expression.arguments.forEach((arg) => {\r\n//               if (arg.type === \"StringLiteral\") {\r\n//                 arg.value = applyColorMapping(arg.value)\r\n//               }\r\n\r\n//               if (\r\n//                 arg.type === \"LogicalExpression\" &&\r\n//                 arg.right.type === \"StringLiteral\"\r\n//               ) {\r\n//                 arg.right.value = applyColorMapping(arg.right.value)\r\n//               }\r\n//             })\r\n//           }\r\n//         }\r\n//       }\r\n//     })\r\n//     .toSource()\r\n// }\r\n\r\n// // export function splitClassName(input: string): (string | null)[] {\r\n// //   const parts = input.split(\":\")\r\n// //   const classNames = parts.map((part) => {\r\n// //     const match = part.match(/^\\[?(.+)\\]$/)\r\n// //     if (match) {\r\n// //       return match[1]\r\n// //     } else {\r\n// //       return null\r\n// //     }\r\n// //   })\r\n\r\n// //   return classNames\r\n// // }\r\n\r\n// Splits a className into variant-name-alpha.\r\n// eg. hover:bg-primary-100 -> [hover, bg-primary, 100]\r\nexport function splitClassName(className: string): (string | null)[] {\r\n  if (!className.includes(\"/\") && !className.includes(\":\")) {\r\n    return [null, className, null]\r\n  }\r\n\r\n  const parts: (string | null)[] = []\r\n  // First we split to find the alpha.\r\n  let [rest, alpha] = className.split(\"/\")\r\n\r\n  // Check if rest has a colon.\r\n  if (!rest.includes(\":\")) {\r\n    return [null, rest, alpha]\r\n  }\r\n\r\n  // Next we split the rest by the colon.\r\n  const split = rest.split(\":\")\r\n\r\n  // We take the last item from the split as the name.\r\n  const name = split.pop()\r\n\r\n  // We glue back the rest of the split.\r\n  const variant = split.join(\":\")\r\n\r\n  // Finally we push the variant, name and alpha.\r\n  parts.push(variant ?? null, name ?? null, alpha ?? null)\r\n\r\n  return parts\r\n}\r\n\r\nconst PREFIXES = [\"bg-\", \"text-\", \"border-\", \"ring-offset-\", \"ring-\"]\r\n\r\nexport function applyColorMapping(\r\n  input: string,\r\n  mapping: z.infer<typeof registryBaseColorSchema>[\"inlineColors\"]\r\n) {\r\n  // Handle border classes.\r\n  if (input.includes(\" border \")) {\r\n    input = input.replace(\" border \", \" border border-border \")\r\n  }\r\n\r\n  // Build color mappings.\r\n  const classNames = input.split(\" \")\r\n  const lightMode = new Set<string>()\r\n  const darkMode = new Set<string>()\r\n  for (let className of classNames) {\r\n    const [variant, value, modifier] = splitClassName(className)\r\n    const prefix = PREFIXES.find((prefix) => value?.startsWith(prefix))\r\n    if (!prefix) {\r\n      if (!lightMode.has(className)) {\r\n        lightMode.add(className)\r\n      }\r\n      continue\r\n    }\r\n\r\n    const needle = value?.replace(prefix, \"\")\r\n    if (needle && needle in mapping.light) {\r\n      lightMode.add(\r\n        [variant, `${prefix}${mapping.light[needle]}`]\r\n          .filter(Boolean)\r\n          .join(\":\") + (modifier ? `/${modifier}` : \"\")\r\n      )\r\n\r\n      darkMode.add(\r\n        [\"dark\", variant, `${prefix}${mapping.dark[needle]}`]\r\n          .filter(Boolean)\r\n          .join(\":\") + (modifier ? `/${modifier}` : \"\")\r\n      )\r\n      continue\r\n    }\r\n\r\n    if (!lightMode.has(className)) {\r\n      lightMode.add(className)\r\n    }\r\n  }\r\n\r\n  return [...Array.from(lightMode), ...Array.from(darkMode)].join(\" \").trim()\r\n}\r\n","export const ICON_LIBRARIES = {\r\n  lucide: {\r\n    name: \"lucide-react\",\r\n    package: \"lucide-react\",\r\n    import: \"lucide-react\",\r\n  },\r\n  radix: {\r\n    name: \"@radix-ui/react-icons\",\r\n    package: \"@radix-ui/react-icons\",\r\n    import: \"@radix-ui/react-icons\",\r\n  },\r\n}\r\n","import { getRegistryIcons } from \"@/src/registry/api\"\r\nimport { ICON_LIBRARIES } from \"@/src/utils/icon-libraries\"\r\nimport { Transformer } from \"@/src/utils/transformers\"\r\nimport { SourceFile, SyntaxKind } from \"ts-morph\"\r\n\r\n// Lucide is the default icon library in the registry.\r\nconst SOURCE_LIBRARY = \"lucide\"\r\n\r\nexport const transformIcons: Transformer = async ({ sourceFile, config }) => {\r\n  // No transform if we cannot read the icon library.\r\n  if (!config.iconLibrary || !(config.iconLibrary in ICON_LIBRARIES)) {\r\n    return sourceFile\r\n  }\r\n\r\n  const registryIcons = await getRegistryIcons()\r\n  const sourceLibrary = SOURCE_LIBRARY\r\n  const targetLibrary = config.iconLibrary\r\n\r\n  if (sourceLibrary === targetLibrary) {\r\n    return sourceFile\r\n  }\r\n\r\n  let targetedIcons: string[] = []\r\n  for (const importDeclaration of sourceFile.getImportDeclarations() ?? []) {\r\n    if (\r\n      importDeclaration.getModuleSpecifier()?.getText() !==\r\n      `\"${ICON_LIBRARIES[SOURCE_LIBRARY].import}\"`\r\n    ) {\r\n      continue\r\n    }\r\n\r\n    for (const specifier of importDeclaration.getNamedImports() ?? []) {\r\n      const iconName = specifier.getName()\r\n\r\n      const targetedIcon = registryIcons[iconName]?.[targetLibrary]\r\n\r\n      if (!targetedIcon || targetedIcons.includes(targetedIcon)) {\r\n        continue\r\n      }\r\n\r\n      targetedIcons.push(targetedIcon)\r\n\r\n      // Remove the named import.\r\n      specifier.remove()\r\n\r\n      // Replace with the targeted icon.\r\n      sourceFile\r\n        .getDescendantsOfKind(SyntaxKind.JsxSelfClosingElement)\r\n        .filter((node) => node.getTagNameNode()?.getText() === iconName)\r\n        .forEach((node) => node.getTagNameNode()?.replaceWithText(targetedIcon))\r\n    }\r\n\r\n    // If the named import is empty, remove the import declaration.\r\n    if (importDeclaration.getNamedImports()?.length === 0) {\r\n      importDeclaration.remove()\r\n    }\r\n  }\r\n\r\n  if (targetedIcons.length > 0) {\r\n    const iconImportDeclaration = sourceFile.addImportDeclaration({\r\n      moduleSpecifier:\r\n        ICON_LIBRARIES[targetLibrary as keyof typeof ICON_LIBRARIES]?.import,\r\n      namedImports: targetedIcons.map((icon) => ({\r\n        name: icon,\r\n      })),\r\n    })\r\n\r\n    if (!_useSemicolon(sourceFile)) {\r\n      iconImportDeclaration.replaceWithText(\r\n        iconImportDeclaration.getText().replace(\";\", \"\")\r\n      )\r\n    }\r\n  }\r\n\r\n  return sourceFile\r\n}\r\n\r\nfunction _useSemicolon(sourceFile: SourceFile) {\r\n  return (\r\n    sourceFile.getImportDeclarations()?.[0]?.getText().endsWith(\";\") ?? false\r\n  )\r\n}\r\n","import { Config } from \"@/src/utils/get-config\"\r\nimport { Transformer } from \"@/src/utils/transformers\"\r\nimport { SyntaxKind } from \"ts-morph\"\r\n\r\nexport const transformImport: Transformer = async ({\r\n  sourceFile,\r\n  config,\r\n  isRemote,\r\n}) => {\r\n  const utilsAlias = config.aliases?.utils\r\n  const workspaceAlias =\r\n    typeof utilsAlias === \"string\" && utilsAlias.includes(\"/\")\r\n      ? utilsAlias.split(\"/\")[0]\r\n      : \"@\"\r\n  const utilsImport = `${workspaceAlias}/lib/utils`\r\n\r\n  if (![\".tsx\", \".ts\", \".jsx\", \".js\"].includes(sourceFile.getExtension())) {\r\n    return sourceFile\r\n  }\r\n\r\n  for (const specifier of sourceFile.getImportStringLiterals()) {\r\n    const updated = updateImportAliases(\r\n      specifier.getLiteralValue(),\r\n      config,\r\n      isRemote\r\n    )\r\n    specifier.setLiteralValue(updated)\r\n\r\n    // Replace `import { cn } from \"@/lib/utils\"`\r\n    if (utilsImport === updated || updated === \"@/lib/utils\") {\r\n      const importDeclaration = specifier.getFirstAncestorByKind(\r\n        SyntaxKind.ImportDeclaration\r\n      )\r\n      const isCnImport = importDeclaration\r\n        ?.getNamedImports()\r\n        .some((namedImport) => namedImport.getName() === \"cn\")\r\n\r\n      if (!isCnImport || !config.aliases.utils) {\r\n        continue\r\n      }\r\n\r\n      specifier.setLiteralValue(\r\n        utilsImport === updated\r\n          ? updated.replace(utilsImport, config.aliases.utils)\r\n          : config.aliases.utils\r\n      )\r\n    }\r\n  }\r\n\r\n  return sourceFile\r\n}\r\n\r\nfunction updateImportAliases(\r\n  moduleSpecifier: string,\r\n  config: Config,\r\n  isRemote: boolean = false\r\n) {\r\n  // Not a local import.\r\n  if (!moduleSpecifier.startsWith(\"@/\") && !isRemote) {\r\n    return moduleSpecifier\r\n  }\r\n\r\n  // This treats the remote as coming from a faux registry.\r\n  if (isRemote && moduleSpecifier.startsWith(\"@/\")) {\r\n    moduleSpecifier = moduleSpecifier.replace(/^@\\//, `@/registry/aodesu/`)\r\n  }\r\n\r\n  // Not a registry import.\r\n  if (!moduleSpecifier.startsWith(\"@/registry/\")) {\r\n    // We fix the alias and return.\r\n    const alias = config.aliases.components.split(\"/\")[0]\r\n    return moduleSpecifier.replace(/^@\\//, `${alias}/`)\r\n  }\r\n\r\n  if (moduleSpecifier.match(/^@\\/registry\\/(.+)\\/ui/)) {\r\n    return moduleSpecifier.replace(\r\n      /^@\\/registry\\/(.+)\\/ui/,\r\n      config.aliases.ui ?? `${config.aliases.components}/ui`\r\n    )\r\n  }\r\n\r\n  if (\r\n    config.aliases.components &&\r\n    moduleSpecifier.match(/^@\\/registry\\/(.+)\\/components/)\r\n  ) {\r\n    return moduleSpecifier.replace(\r\n      /^@\\/registry\\/(.+)\\/components/,\r\n      config.aliases.components\r\n    )\r\n  }\r\n\r\n  if (config.aliases.lib && moduleSpecifier.match(/^@\\/registry\\/(.+)\\/lib/)) {\r\n    return moduleSpecifier.replace(\r\n      /^@\\/registry\\/(.+)\\/lib/,\r\n      config.aliases.lib\r\n    )\r\n  }\r\n\r\n  if (\r\n    config.aliases.hooks &&\r\n    moduleSpecifier.match(/^@\\/registry\\/(.+)\\/hooks/)\r\n  ) {\r\n    return moduleSpecifier.replace(\r\n      /^@\\/registry\\/(.+)\\/hooks/,\r\n      config.aliases.hooks\r\n    )\r\n  }\r\n\r\n  return moduleSpecifier.replace(\r\n    /^@\\/registry\\/[^/]+/,\r\n    config.aliases.components\r\n  )\r\n}\r\n","import { type Transformer } from \"@/src/utils/transformers\"\r\nimport { transformFromAstSync } from \"@babel/core\"\r\nimport { ParserOptions, parse } from \"@babel/parser\"\r\n// @ts-ignore\r\nimport transformTypescript from \"@babel/plugin-transform-typescript\"\r\nimport * as recast from \"recast\"\r\n\r\n// TODO.\r\n// I'm using recast for the AST here.\r\n// Figure out if ts-morph AST is compatible with Babel.\r\n\r\n// This is a copy of the babel options from recast/parser.\r\n// The goal here is to tolerate as much syntax as possible.\r\n// We want to be able to parse any valid tsx code.\r\n// See https://github.com/benjamn/recast/blob/master/parsers/_babel_options.ts.\r\nconst PARSE_OPTIONS: ParserOptions = {\r\n  sourceType: \"module\",\r\n  allowImportExportEverywhere: true,\r\n  allowReturnOutsideFunction: true,\r\n  startLine: 1,\r\n  tokens: true,\r\n  plugins: [\r\n    \"asyncGenerators\",\r\n    \"bigInt\",\r\n    \"classPrivateMethods\",\r\n    \"classPrivateProperties\",\r\n    \"classProperties\",\r\n    \"classStaticBlock\",\r\n    \"decimal\",\r\n    \"decorators-legacy\",\r\n    \"doExpressions\",\r\n    \"dynamicImport\",\r\n    \"exportDefaultFrom\",\r\n    \"exportNamespaceFrom\",\r\n    \"functionBind\",\r\n    \"functionSent\",\r\n    \"importAssertions\",\r\n    \"importMeta\",\r\n    \"nullishCoalescingOperator\",\r\n    \"numericSeparator\",\r\n    \"objectRestSpread\",\r\n    \"optionalCatchBinding\",\r\n    \"optionalChaining\",\r\n    [\r\n      \"pipelineOperator\",\r\n      {\r\n        proposal: \"minimal\",\r\n      },\r\n    ],\r\n    [\r\n      \"recordAndTuple\",\r\n      {\r\n        syntaxType: \"hash\",\r\n      },\r\n    ],\r\n    \"throwExpressions\",\r\n    \"topLevelAwait\",\r\n    \"v8intrinsic\",\r\n    \"typescript\",\r\n    \"jsx\",\r\n  ],\r\n}\r\n\r\nexport const transformJsx: Transformer<string> = async ({\r\n  sourceFile,\r\n  config,\r\n}) => {\r\n  const output = sourceFile.getFullText()\r\n\r\n  if (config.tsx) {\r\n    return output\r\n  }\r\n\r\n  const ast = recast.parse(output, {\r\n    parser: {\r\n      parse: (code: string) => {\r\n        return parse(code, PARSE_OPTIONS)\r\n      },\r\n    },\r\n  })\r\n\r\n  const result = transformFromAstSync(ast, output, {\r\n    cloneInputAst: false,\r\n    code: false,\r\n    ast: true,\r\n    plugins: [transformTypescript],\r\n    configFile: false,\r\n  })\r\n\r\n  if (!result || !result.ast) {\r\n    throw new Error(\"Failed to transform JSX\")\r\n  }\r\n\r\n  return recast.print(result.ast).code\r\n}\r\n","import { Transformer } from \"@/src/utils/transformers\"\r\nimport { SyntaxKind } from \"ts-morph\"\r\n\r\nconst directiveRegex = /^[\"']use client[\"']$/g\r\n\r\nexport const transformRsc: Transformer = async ({ sourceFile, config }) => {\r\n  if (config.rsc) {\r\n    return sourceFile\r\n  }\r\n\r\n  // Remove \"use client\" from the top of the file.\r\n  const first = sourceFile.getFirstChildByKind(SyntaxKind.ExpressionStatement)\r\n  if (first && directiveRegex.test(first.getText())) {\r\n    first.remove()\r\n  }\r\n\r\n  return sourceFile\r\n}\r\n","import { Transformer } from \"@/src/utils/transformers\"\r\nimport { SyntaxKind } from \"ts-morph\"\r\n\r\nimport {\r\n  TailwindVersion,\r\n  getProjectTailwindVersionFromConfig,\r\n} from \"../get-project-info\"\r\nimport { splitClassName } from \"./transform-css-vars\"\r\n\r\nexport const transformTwPrefixes: Transformer = async ({\r\n  sourceFile,\r\n  config,\r\n}) => {\r\n  if (!config.tailwind?.prefix) {\r\n    return sourceFile\r\n  }\r\n  const tailwindVersion = await getProjectTailwindVersionFromConfig(config)\r\n\r\n  // Find the cva function calls.\r\n  sourceFile\r\n    .getDescendantsOfKind(SyntaxKind.CallExpression)\r\n    .filter((node) => node.getExpression().getText() === \"cva\")\r\n    .forEach((node) => {\r\n      // cva(base, ...)\r\n      if (node.getArguments()[0]?.isKind(SyntaxKind.StringLiteral)) {\r\n        const defaultClassNames = node.getArguments()[0]\r\n        if (defaultClassNames) {\r\n          defaultClassNames.replaceWithText(\r\n            `\"${applyPrefix(\r\n              defaultClassNames.getText()?.replace(/\"|'/g, \"\"),\r\n              config.tailwind.prefix,\r\n              tailwindVersion\r\n            )}\"`\r\n          )\r\n        }\r\n      }\r\n\r\n      // cva(..., { variants: { ... } })\r\n      if (node.getArguments()[1]?.isKind(SyntaxKind.ObjectLiteralExpression)) {\r\n        node\r\n          .getArguments()[1]\r\n          ?.getDescendantsOfKind(SyntaxKind.PropertyAssignment)\r\n          .find((node) => node.getName() === \"variants\")\r\n          ?.getDescendantsOfKind(SyntaxKind.PropertyAssignment)\r\n          .forEach((node) => {\r\n            node\r\n              .getDescendantsOfKind(SyntaxKind.PropertyAssignment)\r\n              .forEach((node) => {\r\n                const classNames = node.getInitializerIfKind(\r\n                  SyntaxKind.StringLiteral\r\n                )\r\n                if (classNames) {\r\n                  classNames?.replaceWithText(\r\n                    `\"${applyPrefix(\r\n                      classNames.getText()?.replace(/\"|'/g, \"\"),\r\n                      config.tailwind.prefix,\r\n                      tailwindVersion\r\n                    )}\"`\r\n                  )\r\n                }\r\n              })\r\n          })\r\n      }\r\n    })\r\n\r\n  // Find all jsx attributes with the name className.\r\n  sourceFile.getDescendantsOfKind(SyntaxKind.JsxAttribute).forEach((node) => {\r\n    if (node.getNameNode().getText() === \"className\") {\r\n      // className=\"...\"\r\n      if (node.getInitializer()?.isKind(SyntaxKind.StringLiteral)) {\r\n        const value = node.getInitializer()\r\n        if (value) {\r\n          value.replaceWithText(\r\n            `\"${applyPrefix(\r\n              value.getText()?.replace(/\"|'/g, \"\"),\r\n              config.tailwind.prefix,\r\n              tailwindVersion\r\n            )}\"`\r\n          )\r\n        }\r\n      }\r\n\r\n      // className={...}\r\n      if (node.getInitializer()?.isKind(SyntaxKind.JsxExpression)) {\r\n        // Check if it's a call to cn().\r\n        const callExpression = node\r\n          .getInitializer()\r\n          ?.getDescendantsOfKind(SyntaxKind.CallExpression)\r\n          .find((node) => node.getExpression().getText() === \"cn\")\r\n        if (callExpression) {\r\n          // Loop through the arguments.\r\n          callExpression.getArguments().forEach((node) => {\r\n            if (\r\n              node.isKind(SyntaxKind.ConditionalExpression) ||\r\n              node.isKind(SyntaxKind.BinaryExpression)\r\n            ) {\r\n              node\r\n                .getChildrenOfKind(SyntaxKind.StringLiteral)\r\n                .forEach((node) => {\r\n                  node.replaceWithText(\r\n                    `\"${applyPrefix(\r\n                      node.getText()?.replace(/\"|'/g, \"\"),\r\n                      config.tailwind.prefix,\r\n                      tailwindVersion\r\n                    )}\"`\r\n                  )\r\n                })\r\n            }\r\n\r\n            if (node.isKind(SyntaxKind.StringLiteral)) {\r\n              node.replaceWithText(\r\n                `\"${applyPrefix(\r\n                  node.getText()?.replace(/\"|'/g, \"\"),\r\n                  config.tailwind.prefix,\r\n                  tailwindVersion\r\n                )}\"`\r\n              )\r\n            }\r\n          })\r\n        }\r\n      }\r\n    }\r\n\r\n    // classNames={...}\r\n    if (node.getNameNode().getText() === \"classNames\") {\r\n      if (node.getInitializer()?.isKind(SyntaxKind.JsxExpression)) {\r\n        node\r\n          .getDescendantsOfKind(SyntaxKind.PropertyAssignment)\r\n          .forEach((node) => {\r\n            if (node.getInitializer()?.isKind(SyntaxKind.CallExpression)) {\r\n              const callExpression = node.getInitializerIfKind(\r\n                SyntaxKind.CallExpression\r\n              )\r\n              if (callExpression) {\r\n                // Loop through the arguments.\r\n                callExpression.getArguments().forEach((arg) => {\r\n                  if (arg.isKind(SyntaxKind.ConditionalExpression)) {\r\n                    arg\r\n                      .getChildrenOfKind(SyntaxKind.StringLiteral)\r\n                      .forEach((node) => {\r\n                        node.replaceWithText(\r\n                          `\"${applyPrefix(\r\n                            node.getText()?.replace(/\"|'/g, \"\"),\r\n                            config.tailwind.prefix,\r\n                            tailwindVersion\r\n                          )}\"`\r\n                        )\r\n                      })\r\n                  }\r\n\r\n                  if (arg.isKind(SyntaxKind.StringLiteral)) {\r\n                    arg.replaceWithText(\r\n                      `\"${applyPrefix(\r\n                        arg.getText()?.replace(/\"|'/g, \"\"),\r\n                        config.tailwind.prefix,\r\n                        tailwindVersion\r\n                      )}\"`\r\n                    )\r\n                  }\r\n                })\r\n              }\r\n            }\r\n\r\n            if (node.getInitializer()?.isKind(SyntaxKind.StringLiteral)) {\r\n              if (node.getNameNode().getText() !== \"variant\") {\r\n                const classNames = node.getInitializer()\r\n                if (classNames) {\r\n                  classNames.replaceWithText(\r\n                    `\"${applyPrefix(\r\n                      classNames.getText()?.replace(/\"|'/g, \"\"),\r\n                      config.tailwind.prefix,\r\n                      tailwindVersion\r\n                    )}\"`\r\n                  )\r\n                }\r\n              }\r\n            }\r\n          })\r\n      }\r\n    }\r\n  })\r\n\r\n  return sourceFile\r\n}\r\n\r\nexport function applyPrefix(\r\n  input: string,\r\n  prefix: string = \"\",\r\n  tailwindVersion: TailwindVersion\r\n) {\r\n  if (tailwindVersion === \"v3\") {\r\n    return input\r\n      .split(\" \")\r\n      .map((className) => {\r\n        const [variant, value, modifier] = splitClassName(className)\r\n        if (variant) {\r\n          return modifier\r\n            ? `${variant}:${prefix}${value}/${modifier}`\r\n            : `${variant}:${prefix}${value}`\r\n        } else {\r\n          return modifier\r\n            ? `${prefix}${value}/${modifier}`\r\n            : `${prefix}${value}`\r\n        }\r\n      })\r\n      .join(\" \")\r\n  }\r\n\r\n  return input\r\n    .split(\" \")\r\n    .map((className) =>\r\n      className.indexOf(`${prefix}:`) === 0\r\n        ? className\r\n        : `${prefix}:${className.trim()}`\r\n    )\r\n    .join(\" \")\r\n}\r\n\r\nexport function applyPrefixesCss(\r\n  css: string,\r\n  prefix: string,\r\n  tailwindVersion: TailwindVersion\r\n) {\r\n  const lines = css.split(\"\\n\")\r\n  for (let line of lines) {\r\n    if (line.includes(\"@apply\")) {\r\n      const originalTWCls = line.replace(\"@apply\", \"\").trim()\r\n      const prefixedTwCls = applyPrefix(originalTWCls, prefix, tailwindVersion)\r\n      css = css.replace(originalTWCls, prefixedTwCls)\r\n    }\r\n  }\r\n  return css\r\n}\r\n","import { registryBaseColorSchema } from \"@/src/schema\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\nimport { transformCssVars } from \"@/src/utils/transformers/transform-css-vars\"\r\nimport { transformIcons } from \"@/src/utils/transformers/transform-icons\"\r\nimport { transformImport } from \"@/src/utils/transformers/transform-import\"\r\nimport { transformJsx } from \"@/src/utils/transformers/transform-jsx\"\r\nimport { transformRsc } from \"@/src/utils/transformers/transform-rsc\"\r\nimport { promises as fs } from \"fs\"\r\nimport { tmpdir } from \"os\"\r\nimport path from \"path\"\r\nimport { Project, ScriptKind, type SourceFile } from \"ts-morph\"\r\nimport { z } from \"zod\"\r\n\r\nimport { transformTwPrefixes } from \"./transform-tw-prefix\"\r\n\r\nexport type TransformOpts = {\r\n  filename: string\r\n  raw: string\r\n  config: Config\r\n  baseColor?: z.infer<typeof registryBaseColorSchema>\r\n  transformJsx?: boolean\r\n  isRemote?: boolean\r\n}\r\n\r\nexport type Transformer<Output = SourceFile> = (\r\n  opts: TransformOpts & {\r\n    sourceFile: SourceFile\r\n  }\r\n) => Promise<Output>\r\n\r\nconst project = new Project({\r\n  compilerOptions: {},\r\n})\r\n\r\nasync function createTempSourceFile(filename: string) {\r\n  const dir = await fs.mkdtemp(path.join(tmpdir(), \"uidesu-\"))\r\n  return path.join(dir, filename)\r\n}\r\n\r\nexport async function transform(\r\n  opts: TransformOpts,\r\n  transformers: Transformer[] = [\r\n    transformImport,\r\n    transformRsc,\r\n    transformCssVars,\r\n    transformTwPrefixes,\r\n    transformIcons,\r\n  ]\r\n) {\r\n  const tempFile = await createTempSourceFile(opts.filename)\r\n  const sourceFile = project.createSourceFile(tempFile, opts.raw, {\r\n    scriptKind: ScriptKind.TSX,\r\n  })\r\n\r\n  for (const transformer of transformers) {\r\n    await transformer({ sourceFile, ...opts })\r\n  }\r\n\r\n  if (opts.transformJsx) {\r\n    return await transformJsx({\r\n      sourceFile,\r\n      ...opts,\r\n    })\r\n  }\r\n\r\n  return sourceFile.getText()\r\n}\r\n","import { Transformer } from \"@/src/utils/transformers\"\r\n\r\nexport const transformNext: Transformer = async ({ sourceFile }) => {\r\n  // export function middleware.\r\n  sourceFile.getFunctions().forEach((func) => {\r\n    if (func.getName() === \"middleware\") {\r\n      func.rename(\"proxy\")\r\n    }\r\n  })\r\n\r\n  // export const middleware.\r\n  sourceFile.getVariableDeclarations().forEach((variable) => {\r\n    if (variable.getName() === \"middleware\") {\r\n      variable.rename(\"proxy\")\r\n    }\r\n  })\r\n\r\n  // export { handler as middleware }.\r\n  sourceFile.getExportDeclarations().forEach((exportDecl) => {\r\n    const namedExports = exportDecl.getNamedExports()\r\n    namedExports.forEach((namedExport) => {\r\n      if (namedExport.getName() === \"middleware\") {\r\n        namedExport.setName(\"proxy\")\r\n      }\r\n      const aliasNode = namedExport.getAliasNode()\r\n      if (aliasNode?.getText() === \"middleware\") {\r\n        namedExport.setAlias(\"proxy\")\r\n      }\r\n    })\r\n  })\r\n\r\n  return sourceFile\r\n}\r\n","import { getRegistryBaseColor } from \"@/src/registry/api\"\r\nimport { RegistryItem, registryItemFileSchema } from \"@/src/schema\"\r\nimport { isContentSame } from \"@/src/utils/compare\"\r\nimport {\r\n  findExistingEnvFile,\r\n  getNewEnvKeys,\r\n  isEnvFile,\r\n  mergeEnvContent,\r\n  parseEnvContent,\r\n} from \"@/src/utils/env-helpers\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\nimport { ProjectInfo, getProjectInfo } from \"@/src/utils/get-project-info\"\r\nimport { highlighter } from \"@/src/utils/highlighter\"\r\nimport { logger } from \"@/src/utils/logger\"\r\nimport { resolveImport } from \"@/src/utils/resolve-import\"\r\nimport { spinner } from \"@/src/utils/spinner\"\r\nimport { transform } from \"@/src/utils/transformers\"\r\nimport { transformCssVars } from \"@/src/utils/transformers/transform-css-vars\"\r\nimport { transformIcons } from \"@/src/utils/transformers/transform-icons\"\r\nimport { transformImport } from \"@/src/utils/transformers/transform-import\"\r\nimport { transformNext } from \"@/src/utils/transformers/transform-next\"\r\nimport { transformRsc } from \"@/src/utils/transformers/transform-rsc\"\r\nimport { transformTwPrefixes } from \"@/src/utils/transformers/transform-tw-prefix\"\r\nimport { existsSync, promises as fs, statSync } from \"fs\"\r\nimport { tmpdir } from \"os\"\r\nimport path, { basename } from \"path\"\r\nimport prompts from \"prompts\"\r\nimport { Project, ScriptKind } from \"ts-morph\"\r\nimport { loadConfig } from \"tsconfig-paths\"\r\nimport { z } from \"zod\"\r\n\r\nexport async function updateFiles(\r\n  files: RegistryItem[\"files\"],\r\n  config: Config,\r\n  options: {\r\n    overwrite?: boolean\r\n    force?: boolean\r\n    silent?: boolean\r\n    rootSpinner?: ReturnType<typeof spinner>\r\n    isRemote?: boolean\r\n    isWorkspace?: boolean\r\n    path?: string\r\n  }\r\n) {\r\n  if (!files?.length) {\r\n    return {\r\n      filesCreated: [],\r\n      filesUpdated: [],\r\n      filesSkipped: [],\r\n    }\r\n  }\r\n  options = {\r\n    overwrite: false,\r\n    force: false,\r\n    silent: false,\r\n    isRemote: false,\r\n    isWorkspace: false,\r\n    ...options,\r\n  }\r\n  const filesCreatedSpinner = spinner(`Updating files.`, {\r\n    silent: options.silent,\r\n  })?.start()\r\n\r\n  const [projectInfo, baseColor] = await Promise.all([\r\n    getProjectInfo(config.resolvedPaths.cwd),\r\n    config.tailwind.baseColor\r\n      ? getRegistryBaseColor(config.tailwind.baseColor)\r\n      : Promise.resolve(undefined),\r\n  ])\r\n\r\n  let filesCreated: string[] = []\r\n  let filesUpdated: string[] = []\r\n  let filesSkipped: string[] = []\r\n  let envVarsAdded: string[] = []\r\n  let envFile: string | null = null\r\n\r\n  for (let index = 0; index < files.length; index++) {\r\n    const file = files[index]\r\n    if (!file.content) {\r\n      continue\r\n    }\r\n\r\n    let filePath = resolveFilePath(file, config, {\r\n      isSrcDir: projectInfo?.isSrcDir,\r\n      framework: projectInfo?.framework.name,\r\n      commonRoot: findCommonRoot(\r\n        files.map((f) => f.path),\r\n        file.path\r\n      ),\r\n      path: options.path,\r\n      fileIndex: index,\r\n    })\r\n\r\n    if (!filePath) {\r\n      continue\r\n    }\r\n\r\n    const fileName = basename(file.path)\r\n    const targetDir = path.dirname(filePath)\r\n\r\n    if (!config.tsx) {\r\n      filePath = filePath.replace(/\\.tsx?$/, (match) =>\r\n        match === \".tsx\" ? \".jsx\" : \".js\"\r\n      )\r\n    }\r\n\r\n    if (isEnvFile(filePath) && !existsSync(filePath)) {\r\n      const alternativeEnvFile = findExistingEnvFile(targetDir)\r\n      if (alternativeEnvFile) {\r\n        filePath = alternativeEnvFile\r\n      }\r\n    }\r\n\r\n    const existingFile = existsSync(filePath)\r\n\r\n    // Check if the path exists and is a directory - we can't write to directories.\r\n    if (existingFile && statSync(filePath).isDirectory()) {\r\n      throw new Error(\r\n        `Cannot write to ${filePath}: path exists and is a directory. Please provide a file path instead.`\r\n      )\r\n    }\r\n\r\n    // Run our transformers.\r\n    // Skip transformers for .env files to preserve exact content\r\n    const content = isEnvFile(filePath)\r\n      ? file.content\r\n      : await transform(\r\n          {\r\n            filename: file.path,\r\n            raw: file.content,\r\n            config,\r\n            baseColor,\r\n            transformJsx: !config.tsx,\r\n            isRemote: options.isRemote,\r\n          },\r\n          [\r\n            transformImport,\r\n            transformRsc,\r\n            transformCssVars,\r\n            transformTwPrefixes,\r\n            transformIcons,\r\n            ...(_isNext16Middleware(filePath, projectInfo, config)\r\n              ? [transformNext]\r\n              : []),\r\n          ]\r\n        )\r\n\r\n    // Skip the file if it already exists and the content is the same.\r\n    // Exception: Don't skip .env files as we merge content instead of replacing\r\n    if (existingFile && !isEnvFile(filePath)) {\r\n      const existingFileContent = await fs.readFile(filePath, \"utf-8\")\r\n\r\n      if (\r\n        isContentSame(existingFileContent, content, {\r\n          // Ignore import differences for workspace components.\r\n          // TODO: figure out if we always want this.\r\n          ignoreImports: options.isWorkspace,\r\n        })\r\n      ) {\r\n        filesSkipped.push(path.relative(config.resolvedPaths.cwd, filePath))\r\n        continue\r\n      }\r\n    }\r\n\r\n    // Skip overwrite prompt for .env files - we'll handle them specially\r\n    if (existingFile && !options.overwrite && !isEnvFile(filePath)) {\r\n      filesCreatedSpinner.stop()\r\n      if (options.rootSpinner) {\r\n        options.rootSpinner.stop()\r\n      }\r\n      const { overwrite } = await prompts({\r\n        type: \"confirm\",\r\n        name: \"overwrite\",\r\n        message: `The file ${highlighter.info(\r\n          fileName\r\n        )} already exists. Would you like to overwrite?`,\r\n        initial: false,\r\n      })\r\n\r\n      if (!overwrite) {\r\n        filesSkipped.push(path.relative(config.resolvedPaths.cwd, filePath))\r\n        if (options.rootSpinner) {\r\n          options.rootSpinner.start()\r\n        }\r\n        continue\r\n      }\r\n      filesCreatedSpinner?.start()\r\n      if (options.rootSpinner) {\r\n        options.rootSpinner.start()\r\n      }\r\n    }\r\n\r\n    // Rename middleware.ts to proxy.ts for Next.js 16+.\r\n    if (_isNext16Middleware(filePath, projectInfo, config)) {\r\n      filePath = filePath.replace(/middleware\\.(ts|js)$/, \"proxy.$1\")\r\n    }\r\n\r\n    // Create the target directory if it doesn't exist.\r\n    if (!existsSync(targetDir)) {\r\n      await fs.mkdir(targetDir, { recursive: true })\r\n    }\r\n\r\n    // Special handling for .env files - append only new keys\r\n    if (isEnvFile(filePath) && existingFile) {\r\n      const existingFileContent = await fs.readFile(filePath, \"utf-8\")\r\n      const mergedContent = mergeEnvContent(existingFileContent, content)\r\n      envVarsAdded = getNewEnvKeys(existingFileContent, content)\r\n      envFile = path.relative(config.resolvedPaths.cwd, filePath)\r\n\r\n      if (!envVarsAdded.length) {\r\n        filesSkipped.push(path.relative(config.resolvedPaths.cwd, filePath))\r\n        continue\r\n      }\r\n\r\n      await fs.writeFile(filePath, mergedContent, \"utf-8\")\r\n      filesUpdated.push(path.relative(config.resolvedPaths.cwd, filePath))\r\n      continue\r\n    }\r\n\r\n    await fs.writeFile(filePath, content, \"utf-8\")\r\n\r\n    // Handle file creation logging\r\n    if (!existingFile) {\r\n      filesCreated.push(path.relative(config.resolvedPaths.cwd, filePath))\r\n\r\n      if (isEnvFile(filePath)) {\r\n        envVarsAdded = Object.keys(parseEnvContent(content))\r\n        envFile = path.relative(config.resolvedPaths.cwd, filePath)\r\n      }\r\n    } else {\r\n      filesUpdated.push(path.relative(config.resolvedPaths.cwd, filePath))\r\n    }\r\n  }\r\n\r\n  const allFiles = [...filesCreated, ...filesUpdated, ...filesSkipped]\r\n  const updatedFiles = await resolveImports(allFiles, config)\r\n\r\n  // Let's update filesUpdated with the updated files.\r\n  filesUpdated.push(...updatedFiles)\r\n\r\n  // If a file is in filesCreated and filesUpdated, we should remove it from filesUpdated.\r\n  filesUpdated = filesUpdated.filter((file) => !filesCreated.includes(file))\r\n\r\n  const hasUpdatedFiles = filesCreated.length || filesUpdated.length\r\n  if (!hasUpdatedFiles && !filesSkipped.length) {\r\n    filesCreatedSpinner?.info(\"No files updated.\")\r\n  }\r\n\r\n  // Remove duplicates.\r\n  filesCreated = Array.from(new Set(filesCreated))\r\n  filesUpdated = Array.from(new Set(filesUpdated))\r\n  filesSkipped = Array.from(new Set(filesSkipped))\r\n\r\n  if (filesCreated.length) {\r\n    filesCreatedSpinner?.succeed(\r\n      `Created ${filesCreated.length} ${\r\n        filesCreated.length === 1 ? \"file\" : \"files\"\r\n      }:`\r\n    )\r\n    if (!options.silent) {\r\n      for (const file of filesCreated) {\r\n        logger.log(`  - ${file}`)\r\n      }\r\n    }\r\n  } else {\r\n    filesCreatedSpinner?.stop()\r\n  }\r\n\r\n  if (filesUpdated.length) {\r\n    spinner(\r\n      `Updated ${filesUpdated.length} ${\r\n        filesUpdated.length === 1 ? \"file\" : \"files\"\r\n      }:`,\r\n      {\r\n        silent: options.silent,\r\n      }\r\n    )?.info()\r\n    if (!options.silent) {\r\n      for (const file of filesUpdated) {\r\n        logger.log(`  - ${file}`)\r\n      }\r\n    }\r\n  }\r\n\r\n  if (filesSkipped.length) {\r\n    spinner(\r\n      `Skipped ${filesSkipped.length} ${\r\n        filesUpdated.length === 1 ? \"file\" : \"files\"\r\n      }: (files might be identical, use --overwrite to overwrite)`,\r\n      {\r\n        silent: options.silent,\r\n      }\r\n    )?.info()\r\n    if (!options.silent) {\r\n      for (const file of filesSkipped) {\r\n        logger.log(`  - ${file}`)\r\n      }\r\n    }\r\n  }\r\n\r\n  if (envVarsAdded.length && envFile) {\r\n    spinner(\r\n      `Added the following variables to ${highlighter.info(envFile)}:`\r\n    )?.info()\r\n    if (!options.silent) {\r\n      for (const key of envVarsAdded) {\r\n        logger.log(`  ${highlighter.success(\"+\")} ${key}`)\r\n      }\r\n    }\r\n  }\r\n\r\n  if (!options.silent) {\r\n    logger.break()\r\n  }\r\n\r\n  return {\r\n    filesCreated,\r\n    filesUpdated,\r\n    filesSkipped,\r\n  }\r\n}\r\n\r\nexport function resolveFilePath(\r\n  file: z.infer<typeof registryItemFileSchema>,\r\n  config: Config,\r\n  options: {\r\n    isSrcDir?: boolean\r\n    commonRoot?: string\r\n    framework?: ProjectInfo[\"framework\"][\"name\"]\r\n    path?: string\r\n    fileIndex?: number\r\n  }\r\n) {\r\n  // Handle custom path if provided.\r\n  if (options.path) {\r\n    const resolvedPath = path.isAbsolute(options.path)\r\n      ? options.path\r\n      : path.join(config.resolvedPaths.cwd, options.path)\r\n\r\n    const isFilePath = /\\.[^/\\\\]+$/.test(resolvedPath)\r\n\r\n    if (isFilePath) {\r\n      // We'll only use the custom path for the first file.\r\n      // This is for registry items with multiple files.\r\n      if (options.fileIndex === 0) {\r\n        return resolvedPath\r\n      }\r\n    } else {\r\n      // If the custom path is a directory,\r\n      // We'll place all files in the directory.\r\n      const fileName = path.basename(file.path)\r\n      return path.join(resolvedPath, fileName)\r\n    }\r\n  }\r\n\r\n  if (file.target) {\r\n    if (file.target.startsWith(\"~/\")) {\r\n      return path.join(config.resolvedPaths.cwd, file.target.replace(\"~/\", \"\"))\r\n    }\r\n\r\n    let target = file.target\r\n\r\n    if (file.type === \"registry:page\") {\r\n      target = resolvePageTarget(target, options.framework)\r\n      if (!target) {\r\n        return \"\"\r\n      }\r\n    }\r\n\r\n    return options.isSrcDir\r\n      ? path.join(config.resolvedPaths.cwd, \"src\", target.replace(\"src/\", \"\"))\r\n      : path.join(config.resolvedPaths.cwd, target.replace(\"src/\", \"\"))\r\n  }\r\n\r\n  const targetDir = resolveFileTargetDirectory(file, config)\r\n\r\n  const relativePath = resolveNestedFilePath(file.path, targetDir)\r\n  return path.join(targetDir, relativePath)\r\n}\r\n\r\nfunction resolveFileTargetDirectory(\r\n  file: z.infer<typeof registryItemFileSchema>,\r\n  config: Config\r\n) {\r\n  if (file.type === \"registry:ui\") {\r\n    return config.resolvedPaths.ui\r\n  }\r\n\r\n  if (file.type === \"registry:lib\") {\r\n    return config.resolvedPaths.lib\r\n  }\r\n\r\n  if (file.type === \"registry:block\" || file.type === \"registry:component\") {\r\n    return config.resolvedPaths.components\r\n  }\r\n\r\n  if (file.type === \"registry:hook\") {\r\n    return config.resolvedPaths.hooks\r\n  }\r\n\r\n  return config.resolvedPaths.components\r\n}\r\n\r\nexport function findCommonRoot(paths: string[], needle: string): string {\r\n  // Remove leading slashes for consistent handling\r\n  const normalizedPaths = paths.map((p) => p.replace(/^\\//, \"\"))\r\n  const normalizedNeedle = needle.replace(/^\\//, \"\")\r\n\r\n  // Get the directory path of the needle by removing the file name\r\n  const needleDir = normalizedNeedle.split(\"/\").slice(0, -1).join(\"/\")\r\n\r\n  // If needle is at root level, return empty string\r\n  if (!needleDir) {\r\n    return \"\"\r\n  }\r\n\r\n  // Split the needle directory into segments\r\n  const needleSegments = needleDir.split(\"/\")\r\n\r\n  // Start from the full path and work backwards\r\n  for (let i = needleSegments.length; i > 0; i--) {\r\n    const testPath = needleSegments.slice(0, i).join(\"/\")\r\n    // Check if this is a common root by verifying if any other paths start with it\r\n    const hasRelatedPaths = normalizedPaths.some(\r\n      (path) => path !== normalizedNeedle && path.startsWith(testPath + \"/\")\r\n    )\r\n    if (hasRelatedPaths) {\r\n      return \"/\" + testPath // Add leading slash back for the result\r\n    }\r\n  }\r\n\r\n  // If no common root found with other files, return the parent directory of the needle\r\n  return \"/\" + needleDir // Add leading slash back for the result\r\n}\r\n\r\nexport function resolveNestedFilePath(\r\n  filePath: string,\r\n  targetDir: string\r\n): string {\r\n  // Normalize paths by removing leading/trailing slashes\r\n  const normalizedFilePath = filePath.replace(/^\\/|\\/$/g, \"\")\r\n  const normalizedTargetDir = targetDir.replace(/^\\/|\\/$/g, \"\")\r\n\r\n  // Split paths into segments\r\n  const fileSegments = normalizedFilePath.split(\"/\")\r\n  const targetSegments = normalizedTargetDir.split(\"/\")\r\n\r\n  // Find the last matching segment from targetDir in filePath\r\n  const lastTargetSegment = targetSegments[targetSegments.length - 1]\r\n  const commonDirIndex = fileSegments.findIndex(\r\n    (segment) => segment === lastTargetSegment\r\n  )\r\n\r\n  if (commonDirIndex === -1) {\r\n    // Return just the filename if no common directory is found\r\n    return fileSegments[fileSegments.length - 1]\r\n  }\r\n\r\n  // Return everything after the common directory\r\n  return fileSegments.slice(commonDirIndex + 1).join(\"/\")\r\n}\r\n\r\nexport function resolvePageTarget(\r\n  target: string,\r\n  framework?: ProjectInfo[\"framework\"][\"name\"]\r\n) {\r\n  if (!framework) {\r\n    return \"\"\r\n  }\r\n\r\n  if (framework === \"next-app\") {\r\n    return target\r\n  }\r\n\r\n  if (framework === \"next-pages\") {\r\n    let result = target.replace(/^app\\//, \"pages/\")\r\n    result = result.replace(/\\/page(\\.[jt]sx?)$/, \"$1\")\r\n\r\n    return result\r\n  }\r\n\r\n  return \"\"\r\n}\r\n\r\nasync function resolveImports(filePaths: string[], config: Config) {\r\n  const project = new Project({\r\n    compilerOptions: {},\r\n  })\r\n  const projectInfo = await getProjectInfo(config.resolvedPaths.cwd)\r\n  const tsConfig = loadConfig(config.resolvedPaths.cwd)\r\n  const updatedFiles = []\r\n\r\n  if (!projectInfo || tsConfig.resultType === \"failed\") {\r\n    return []\r\n  }\r\n\r\n  for (const filepath of filePaths) {\r\n    const resolvedPath = path.resolve(config.resolvedPaths.cwd, filepath)\r\n\r\n    // Check if the file exists.\r\n    if (!existsSync(resolvedPath)) {\r\n      continue\r\n    }\r\n\r\n    const content = await fs.readFile(resolvedPath, \"utf-8\")\r\n\r\n    const dir = await fs.mkdtemp(path.join(tmpdir(), \"shadcn-\"))\r\n    const sourceFile = project.createSourceFile(\r\n      path.join(dir, basename(resolvedPath)),\r\n      content,\r\n      {\r\n        scriptKind: ScriptKind.TSX,\r\n      }\r\n    )\r\n\r\n    // Skip if the file extension is not one of the supported extensions.\r\n    if (![\".tsx\", \".ts\", \".jsx\", \".js\"].includes(sourceFile.getExtension())) {\r\n      continue\r\n    }\r\n\r\n    const importDeclarations = sourceFile.getImportDeclarations()\r\n    for (const importDeclaration of importDeclarations) {\r\n      const moduleSpecifier = importDeclaration.getModuleSpecifierValue()\r\n\r\n      // Filter out non-local imports.\r\n      if (\r\n        projectInfo?.aliasPrefix &&\r\n        !moduleSpecifier.startsWith(`${projectInfo.aliasPrefix}/`)\r\n      ) {\r\n        continue\r\n      }\r\n\r\n      // Find the probable import file path.\r\n      // This is where we expect to find the file on disk.\r\n      const probableImportFilePath = await resolveImport(\r\n        moduleSpecifier,\r\n        tsConfig\r\n      )\r\n\r\n      if (!probableImportFilePath) {\r\n        continue\r\n      }\r\n\r\n      // Find the actual import file path.\r\n      // This is the path where the file has been installed.\r\n      const resolvedImportFilePath = resolveModuleByProbablePath(\r\n        probableImportFilePath,\r\n        filePaths,\r\n        config\r\n      )\r\n\r\n      if (!resolvedImportFilePath) {\r\n        continue\r\n      }\r\n\r\n      // Convert the resolved import file path to an aliased import.\r\n      const newImport = toAliasedImport(\r\n        resolvedImportFilePath,\r\n        config,\r\n        projectInfo\r\n      )\r\n\r\n      if (!newImport || newImport === moduleSpecifier) {\r\n        continue\r\n      }\r\n\r\n      importDeclaration.setModuleSpecifier(newImport)\r\n\r\n      // Write the updated content to the file.\r\n      await fs.writeFile(resolvedPath, sourceFile.getFullText(), \"utf-8\")\r\n\r\n      // Track the updated file.\r\n      updatedFiles.push(filepath)\r\n    }\r\n  }\r\n\r\n  return updatedFiles\r\n}\r\n\r\n/**\r\n * Given an absolute \"probable\" import path (no ext),\r\n * plus an array of absolute file paths you already know about,\r\n * return 0N matches (best match first), and also check disk for any missing ones.\r\n */\r\nexport function resolveModuleByProbablePath(\r\n  probableImportFilePath: string,\r\n  files: string[],\r\n  config: Config,\r\n  extensions: string[] = [\".tsx\", \".ts\", \".js\", \".jsx\", \".css\"]\r\n) {\r\n  const cwd = path.normalize(config.resolvedPaths.cwd)\r\n\r\n  // 1) Build a set of POSIX-normalized, project-relative files\r\n  const relativeFiles = files.map((f) => f.split(path.sep).join(path.posix.sep))\r\n  const fileSet = new Set(relativeFiles)\r\n\r\n  // 2) Strip any existing extension off the absolute base path\r\n  const extInPath = path.extname(probableImportFilePath)\r\n  const hasExt = extInPath !== \"\"\r\n  const absBase = hasExt\r\n    ? probableImportFilePath.slice(0, -extInPath.length)\r\n    : probableImportFilePath\r\n\r\n  // 3) Compute the project-relative \"base\" directory for strong matching\r\n  const relBaseRaw = path.relative(cwd, absBase)\r\n  const relBase = relBaseRaw.split(path.sep).join(path.posix.sep)\r\n\r\n  // 4) Decide which extensions to try\r\n  const tryExts = hasExt ? [extInPath] : extensions\r\n\r\n  // 5) Collect candidates\r\n  const candidates = new Set<string>()\r\n\r\n  // 5a) Fastpath: [base + ext] and [base/index + ext]\r\n  for (const e of tryExts) {\r\n    const absCand = absBase + e\r\n    const relCand = path.posix.normalize(path.relative(cwd, absCand))\r\n    if (fileSet.has(relCand) || existsSync(absCand)) {\r\n      candidates.add(relCand)\r\n    }\r\n\r\n    const absIdx = path.join(absBase, `index${e}`)\r\n    const relIdx = path.posix.normalize(path.relative(cwd, absIdx))\r\n    if (fileSet.has(relIdx) || existsSync(absIdx)) {\r\n      candidates.add(relIdx)\r\n    }\r\n  }\r\n\r\n  // 5b) Fallback: scan known files by basename\r\n  const name = path.basename(absBase)\r\n  for (const f of relativeFiles) {\r\n    if (tryExts.some((e) => f.endsWith(`/${name}${e}`))) {\r\n      candidates.add(f)\r\n    }\r\n  }\r\n\r\n  // 6) If no matches, bail\r\n  if (candidates.size === 0) return null\r\n\r\n  // 7) Sort by (1) extension priority, then (2) \"strong\" base match\r\n  const sorted = Array.from(candidates).sort((a, b) => {\r\n    // a) extension order\r\n    const aExt = path.posix.extname(a)\r\n    const bExt = path.posix.extname(b)\r\n    const ord = tryExts.indexOf(aExt) - tryExts.indexOf(bExt)\r\n    if (ord !== 0) return ord\r\n    // b) strong match if path starts with relBase\r\n    const aStrong = relBase && a.startsWith(relBase) ? -1 : 1\r\n    const bStrong = relBase && b.startsWith(relBase) ? -1 : 1\r\n    return aStrong - bStrong\r\n  })\r\n\r\n  // 8) Return the first (best) candidate\r\n  return sorted[0]\r\n}\r\n\r\nexport function toAliasedImport(\r\n  filePath: string,\r\n  config: Config,\r\n  projectInfo: ProjectInfo\r\n): string | null {\r\n  const abs = path.normalize(path.join(config.resolvedPaths.cwd, filePath))\r\n\r\n  // 1 Find the longest matching alias root in resolvedPaths\r\n  //    e.g. key=\"ui\", root=\"//components/ui\" beats key=\"components\"\r\n  const matches = Object.entries(config.resolvedPaths)\r\n    .filter(\r\n      ([, root]) => root && abs.startsWith(path.normalize(root + path.sep))\r\n    )\r\n    .sort((a, b) => b[1].length - a[1].length)\r\n\r\n  if (matches.length === 0) {\r\n    return null\r\n  }\r\n  const [aliasKey, rootDir] = matches[0]\r\n\r\n  // 2 Compute the path UNDER that root\r\n  let rel = path.relative(rootDir, abs)\r\n  // force POSIX-style separators\r\n  rel = rel.split(path.sep).join(\"/\") // e.g. \"button/index.tsx\"\r\n\r\n  // 3 Strip code-file extensions, keep others (css, json, etc.)\r\n  const ext = path.posix.extname(rel)\r\n  const codeExts = [\".ts\", \".tsx\", \".js\", \".jsx\"]\r\n  const keepExt = codeExts.includes(ext) ? \"\" : ext\r\n  let noExt = rel.slice(0, rel.length - ext.length)\r\n\r\n  // 4 Collapse \"/index\" to its directory\r\n  if (noExt.endsWith(\"/index\")) {\r\n    noExt = noExt.slice(0, -\"/index\".length)\r\n  }\r\n\r\n  // 5 Build the aliased path\r\n  //    config.aliases[aliasKey] is e.g. \"@/components/ui\"\r\n  const aliasBase =\r\n    aliasKey === \"cwd\"\r\n      ? projectInfo.aliasPrefix\r\n      : config.aliases[aliasKey as keyof typeof config.aliases]\r\n  if (!aliasBase) {\r\n    return null\r\n  }\r\n  // if noExt is empty (i.e. file was exactly at the root), we import the root\r\n  let suffix = noExt === \"\" ? \"\" : `/${noExt}`\r\n\r\n  // Remove /src from suffix.\r\n  // Alias will handle this.\r\n  suffix = suffix.replace(\"/src\", \"\")\r\n\r\n  // 6 Prepend the prefix from projectInfo (e.g. \"@\") if needed\r\n  //    but usually config.aliases already include it.\r\n  return `${aliasBase}${suffix}${keepExt}`\r\n}\r\n\r\nfunction _isNext16Middleware(\r\n  filePath: string,\r\n  projectInfo: ProjectInfo | null,\r\n  config: Config\r\n) {\r\n  const isRootMiddleware =\r\n    filePath === path.join(config.resolvedPaths.cwd, \"middleware.ts\") ||\r\n    filePath === path.join(config.resolvedPaths.cwd, \"middleware.js\")\r\n\r\n  const isNextJs =\r\n    projectInfo?.framework.name === \"next-app\" ||\r\n    projectInfo?.framework.name === \"next-pages\"\r\n\r\n  if (!isRootMiddleware || !isNextJs || !projectInfo?.frameworkVersion) {\r\n    return false\r\n  }\r\n\r\n  const majorVersion = parseInt(projectInfo.frameworkVersion.split(\".\")[0])\r\n  const isNext16Plus = !isNaN(majorVersion) && majorVersion >= 16\r\n\r\n  return isNext16Plus\r\n}\r\n","import z from \"zod\";\r\nimport { Config } from \"../utils/get-config\";\r\nimport { getProjectInfo } from \"../utils/get-project-info\";\r\nimport { findCommonRoot, resolveFilePath } from \"../utils/updaters/update-files\";\r\nimport { registryItemFileSchema, registryItemSchema } from \"./schema\";\r\n\r\nexport function isUrl(path: string) {\r\n  try {\r\n    new URL(path);\r\n    return true;\r\n  } catch (error) {\r\n    return false;\r\n  }\r\n}\r\n\r\nexport function isLocalFile(path: string) {\r\n  return path.endsWith(\".json\") && !isUrl(path);\r\n}\r\n\r\nexport function isUniversalRegistryItem(\r\n  registryItem:\r\n    | Pick<z.infer<typeof registryItemSchema>, \"files\" | \"type\">\r\n    | null\r\n    | undefined\r\n): boolean {\r\n  if (!registryItem) {\r\n    return false;\r\n  }\r\n\r\n  if (\r\n    registryItem.type !== \"registry:item\" &&\r\n    registryItem.type !== \"registry:file\"\r\n  ) {\r\n    return false;\r\n  }\r\n\r\n  const files = registryItem.files ?? [];\r\n\r\n  return files.every(\r\n    (file) =>\r\n      !!file.target &&\r\n    (file.type === \"registry:file\" || file.type === \"registry:item\")\r\n  );\r\n}\r\n\r\n// Deduplicates files based on their resolved target paths.\r\n// When multiple files resolve to the same target path, the last one wins.\r\nexport async function deduplicateFilesByTarget(\r\n  filesArrays: Array<z.infer<typeof registryItemFileSchema>[] | undefined>,\r\n  config: Config\r\n) {\r\n  // Fallback to simple concatenation when we don't have complete config.\r\n  if (!canDeduplicateFiles(config)) {\r\n    return z\r\n      .array(registryItemFileSchema)\r\n      .parse(filesArrays.flat().filter(Boolean))\r\n  }\r\n\r\n  // Get project info for file resolution.\r\n  const projectInfo = await getProjectInfo(config.resolvedPaths.cwd)\r\n  const targetMap = new Map<string, z.infer<typeof registryItemFileSchema>>()\r\n  const allFiles = z\r\n    .array(registryItemFileSchema)\r\n    .parse(filesArrays.flat().filter(Boolean))\r\n\r\n  allFiles.forEach((file) => {\r\n    const resolvedPath = resolveFilePath(file, config, {\r\n      isSrcDir: projectInfo?.isSrcDir,\r\n      framework: projectInfo?.framework.name,\r\n      commonRoot: findCommonRoot(\r\n        allFiles.map((f) => f.path),\r\n        file.path\r\n      ),\r\n    })\r\n\r\n    if (resolvedPath) {\r\n      // Last one wins - overwrites previous entry.\r\n      targetMap.set(resolvedPath, file)\r\n    }\r\n  })\r\n\r\n  return Array.from(targetMap.values())\r\n}\r\n\r\n// Checks if the config has the minimum required paths for file deduplication.\r\nexport function canDeduplicateFiles(config: Config) {\r\n  return !!(\r\n    config?.resolvedPaths?.cwd &&\r\n    (config?.resolvedPaths?.ui ||\r\n      config?.resolvedPaths?.lib ||\r\n      config?.resolvedPaths?.components ||\r\n      config?.resolvedPaths?.hooks)\r\n  )\r\n}\r\n","import deepmerge from \"deepmerge\";\r\nimport { Config, createConfig } from \"../utils/get-config\";\r\nimport { BUILTIN_REGISTRIES, FALLBACK_STYLE } from \"./constants\";\r\nimport { configSchema } from \"./schema\";\r\n\r\nfunction resolveStyleFromConfig(config: Partial<Config> | Config) {\r\n  if (!config.style) {\r\n    return FALLBACK_STYLE;\r\n  }\r\n\r\n  // Check if we should use aodesu for tailwind\r\n  // We assume that if tailwind.config is empty, we're using tailwind v4.\r\n  if (config.style === \"aodesu\" && config.tailwind?.config === \"\") {\r\n    return FALLBACK_STYLE;\r\n  }\r\n\r\n  return config.style;\r\n}\r\n\r\nexport function configWithDefaults(config?: Partial<Config> | Config) {\r\n  const baseConfig = createConfig({\r\n    style: FALLBACK_STYLE,\r\n    registries: BUILTIN_REGISTRIES,\r\n  });\r\n\r\n  if (!config) {\r\n    return baseConfig;\r\n  }\r\n\r\n  return configSchema.parse(\r\n    deepmerge(baseConfig, {\r\n      ...config,\r\n      style: resolveStyleFromConfig(config),\r\n      registries: { ...BUILTIN_REGISTRIES, ...config.registries },\r\n    })\r\n  )\r\n};\r\n","interface RegistryContext {\r\n  headers: Record<string, Record<string, string>>\r\n}\r\n\r\nlet context: RegistryContext = {\r\n  headers: {},\r\n}\r\n\r\nexport function setRegistryHeaders(\r\n  headers: Record<string, Record<string, string>>\r\n) {\r\n  // Merge new headers with existing ones to preserve headers for nested dependencies\r\n  context.headers = { ...context.headers, ...headers };\r\n}\r\n\r\nexport function getRegistryHeadersFromContext(\r\n  url: string\r\n): Record<string, string> {\r\n  return context.headers[url] || {}\r\n};\r\n\r\nexport function clearRegistryContext() {\r\n  context.headers = {};\r\n}\r\n","import z from \"zod\";\r\nimport { Config } from \"../utils/get-config\";\r\nimport { buildUrlAndHeadersForRegistryItem } from \"./builder\";\r\nimport { configWithDefaults } from \"./config\";\r\nimport { clearRegistryContext } from \"./context\";\r\nimport { extractEnvVars } from \"./env\";\r\nimport { RegistryMissingEnvironmentVariablesError } from \"./errors\";\r\nimport { registryConfigItemSchema } from \"./schema\";\r\n\r\nexport function extractEnvVarsFromRegistryConfig(\r\n  config: z.infer<typeof registryConfigItemSchema>\r\n): string[] {\r\n  const vars = new Set<string>();\r\n\r\n  if (typeof config === \"string\") {\r\n    extractEnvVars(config).forEach((v) => vars.add(v));\r\n  } else {\r\n    extractEnvVars(config.url).forEach((v) => vars.add(v));\r\n\r\n    if (config.params) {\r\n      Object.values(config.params).forEach((value) => {\r\n        extractEnvVars(value).forEach((v) => vars.add(v));\r\n      })\r\n    }\r\n\r\n    if (config.headers) {\r\n      Object.values(config.headers).forEach((value) => {\r\n        extractEnvVars(value).forEach((v) => vars.add(v));\r\n      })\r\n    }\r\n  }\r\n\r\n  return Array.from(vars);\r\n}\r\n\r\nexport function validateRegistryConfig(\r\n  registryName: string,\r\n  config: z.infer<typeof registryConfigItemSchema>\r\n): void {\r\n  const requiredVars = extractEnvVarsFromRegistryConfig(config);\r\n  const missing = requiredVars.filter((v) => !process.env[v]);\r\n\r\n  if (missing.length > 0) {\r\n    throw new RegistryMissingEnvironmentVariablesError(registryName, missing);\r\n  }\r\n}\r\n\r\nexport function validateRegistryConfigForItems(\r\n  items: string[],\r\n  config?: Config\r\n): void {\r\n  for (const item of items) {\r\n    buildUrlAndHeadersForRegistryItem(item, configWithDefaults(config));\r\n  }\r\n\r\n  // Clear registry context after validation.\r\n  clearRegistryContext();\r\n}\r\n","import z from \"zod\";\r\nimport { Config } from \"../utils/get-config\";\r\nimport { REGISTRY_URL } from \"./constants\";\r\nimport { expandEnvVars } from \"./env\";\r\nimport { RegistryNotConfiguredError } from \"./errors\";\r\nimport { parseRegistryAndItemFromString } from \"./parser\";\r\nimport { registryConfigItemSchema } from \"./schema\";\r\nimport { isUrl } from \"./utils\";\r\nimport { validateRegistryConfig } from \"./validator\";\r\n\r\nconst NAME_PLACEHOLDER = \"{name}\";\r\nconst STYLE_PLACEHOLDER = \"{style}\";\r\nconst ENV_VAR_PATTER = /\\${(\\w+)}/g\r\nconst QUERY_PARAM_SEPARATOR = \"?\";\r\nconst QUERY_PARAM_DELIMITER = \"&\";\r\n\r\nexport function buildUrlAndHeadersForRegistryItem(\r\n  name: string,\r\n  config?: Config\r\n) {\r\n  const { registry, item } = parseRegistryAndItemFromString(name);\r\n\r\n  if (!registry) {\r\n    return null;\r\n  }\r\n\r\n  const registries = config?.registries || {};\r\n  const registryConfig = registries[registry];\r\n  if (!registryConfig) {\r\n    throw new RegistryNotConfiguredError(registry);\r\n  }\r\n\r\n  validateRegistryConfig(registry, registryConfig);\r\n\r\n  return {\r\n    url: buildUrlFromRegistryConfig(item, registryConfig, config),\r\n    headers: buildHeadersFromRegistryConfig(registryConfig),\r\n  }\r\n}\r\n\r\nexport function buildUrlFromRegistryConfig(\r\n  item: string,\r\n  registryConfig: z.infer<typeof registryConfigItemSchema>,\r\n  config?: Config\r\n) {\r\n  if (typeof registryConfig === \"string\") {\r\n    let url = registryConfig.replace(NAME_PLACEHOLDER, item);\r\n    if (config?.style && url.includes(STYLE_PLACEHOLDER)) {\r\n      url = url.replace(STYLE_PLACEHOLDER, config.style);\r\n    }\r\n    return expandEnvVars(url);\r\n  }\r\n\r\n  let baseUrl = registryConfig.url.replace(NAME_PLACEHOLDER, item);\r\n  if (config?.style && baseUrl.includes(STYLE_PLACEHOLDER)) {\r\n    baseUrl = baseUrl.replace(STYLE_PLACEHOLDER, config.style);\r\n  }\r\n  baseUrl = expandEnvVars(baseUrl);\r\n\r\n  if (!registryConfig.params) {\r\n    return baseUrl;\r\n  }\r\n\r\n  return appendQueryParams(baseUrl, registryConfig.params);\r\n}\r\n\r\nexport function buildHeadersFromRegistryConfig(\r\n  config: z.infer<typeof registryConfigItemSchema>\r\n) {\r\n  if (typeof config === \"string\" || !config.headers) {\r\n    return {}\r\n  }\r\n\r\n  const headers: Record<string, string> = {};\r\n\r\n  for (const [key, value] of Object.entries(config.headers)) {\r\n    const expandedValue = expandEnvVars(value);\r\n\r\n    if (shouldIncludeHeader(value, expandedValue)) {\r\n      headers[key] = expandedValue;\r\n    }\r\n  }\r\n\r\n  return headers;\r\n}\r\n\r\nfunction appendQueryParams(baseUrl: string, params: Record<string, string>) {\r\n  const urlParams = new URLSearchParams();\r\n\r\n  for (const [key, value] of Object.entries(params)) {\r\n    const expandedValue = expandEnvVars(value);\r\n    if (expandedValue) {\r\n      urlParams.append(key, expandedValue);\r\n    }\r\n  }\r\n\r\n  const queryString = urlParams.toString();\r\n  if (!queryString) {\r\n    return baseUrl;\r\n  }\r\n\r\n  const separator = baseUrl.includes(QUERY_PARAM_SEPARATOR)\r\n    ? QUERY_PARAM_DELIMITER\r\n    : QUERY_PARAM_SEPARATOR;\r\n\r\n  return `${baseUrl}${separator}${queryString}`;\r\n}\r\n\r\nfunction shouldIncludeHeader(originalValue: string, expandedValue: string) {\r\n  const trimmedExpanded = expandedValue.trim();\r\n\r\n  if (!trimmedExpanded) {\r\n    return false;\r\n  }\r\n\r\n  // If the original value contains valid en vars, only include if expansion changed the value.\r\n  if (originalValue.includes(\"${\")) {\r\n    // Check if there are actual en vars in the string\r\n    const envVars = originalValue.match(ENV_VAR_PATTER);\r\n    if (envVars) {\r\n      const templateWithoutVars = originalValue\r\n        .replace(ENV_VAR_PATTER, \"\")\r\n        .trim();\r\n\r\n      return trimmedExpanded !== templateWithoutVars;\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nexport function resolveRegistryUrl(pathOrUrl: string) {\r\n  if (isUrl(pathOrUrl)) {\r\n    // If the url contains /chat/b, we assume it's the v0 registry.\r\n    // We need to add the /json suffix if it's missing.\r\n    const url = new URL(pathOrUrl);\r\n    if (url.pathname.match(/\\/chat\\/b\\//) && !url.pathname.endsWith(\"/json\")) {\r\n      url.pathname = `${url.pathname}/json`\r\n    }\r\n\r\n    return url.toString();\r\n  }\r\n\r\n  return `${REGISTRY_URL}/${pathOrUrl}`;\r\n}\r\n","import { resolveRegistryUrl } from \"@/src/registry/builder\"\r\nimport { getRegistryHeadersFromContext } from \"@/src/registry/context\"\r\nimport {\r\n  RegistryFetchError,\r\n  RegistryForbiddenError,\r\n  RegistryLocalFileError,\r\n  RegistryNotFoundError,\r\n  RegistryParseError,\r\n  RegistryUnauthorizedError,\r\n} from \"@/src/registry/errors\"\r\nimport { registryItemSchema } from \"@/src/schema\"\r\nimport { promises as fs } from \"fs\"\r\nimport { HttpsProxyAgent } from \"https-proxy-agent\"\r\nimport fetch from \"node-fetch\"\r\nimport { homedir } from \"os\"\r\nimport path from \"path\"\r\nimport { z } from \"zod\"\r\n\r\nconst agent = process.env.https_proxy\r\n  ? new HttpsProxyAgent(process.env.https_proxy)\r\n  : undefined\r\n\r\nconst registryCache = new Map<string, Promise<any>>()\r\n\r\nexport function clearRegistryCache() {\r\n  registryCache.clear()\r\n}\r\n\r\nexport async function fetchRegistry(\r\n  paths: string[],\r\n  options: { useCache?: boolean } = {}\r\n) {\r\n  options = {\r\n    useCache: true,\r\n    ...options,\r\n  }\r\n\r\n  try {\r\n    const results = await Promise.all(\r\n      paths.map(async (path) => {\r\n        const url = resolveRegistryUrl(path)\r\n\r\n        // Check cache first if caching is enabled\r\n        if (options.useCache && registryCache.has(url)) {\r\n          return registryCache.get(url)\r\n        }\r\n\r\n        // Store the promise in the cache before awaiting if caching is enabled.\r\n        const fetchPromise = (async () => {\r\n          // Get headers from context for this URL.\r\n          const headers = getRegistryHeadersFromContext(url)\r\n\r\n          const response = await fetch(url, {\r\n            agent,\r\n            headers: {\r\n              ...headers,\r\n            },\r\n          })\r\n\r\n          if (!response.ok) {\r\n            let messageFromServer = undefined\r\n\r\n            if (\r\n              response.headers.get(\"content-type\")?.includes(\"application/json\")\r\n            ) {\r\n              const json = await response.json()\r\n              const parsed = z\r\n                .object({\r\n                  // RFC 7807.\r\n                  detail: z.string().optional(),\r\n                  title: z.string().optional(),\r\n                  // Standard error response.\r\n                  message: z.string().optional(),\r\n                  error: z.string().optional(),\r\n                })\r\n                .safeParse(json)\r\n\r\n              if (parsed.success) {\r\n                // Prefer RFC 7807 detail field, then message field.\r\n                messageFromServer = parsed.data.detail || parsed.data.message\r\n\r\n                if (parsed.data.error) {\r\n                  messageFromServer = `[${parsed.data.error}] ${messageFromServer}`\r\n                }\r\n              }\r\n            }\r\n\r\n            if (response.status === 401) {\r\n              throw new RegistryUnauthorizedError(url, messageFromServer)\r\n            }\r\n\r\n            if (response.status === 404) {\r\n              throw new RegistryNotFoundError(url, messageFromServer)\r\n            }\r\n\r\n            if (response.status === 403) {\r\n              throw new RegistryForbiddenError(url, messageFromServer)\r\n            }\r\n\r\n            throw new RegistryFetchError(\r\n              url,\r\n              response.status,\r\n              messageFromServer\r\n            )\r\n          }\r\n\r\n          return response.json()\r\n        })()\r\n\r\n        if (options.useCache) {\r\n          registryCache.set(url, fetchPromise)\r\n        }\r\n        return fetchPromise\r\n      })\r\n    )\r\n\r\n    return results\r\n  } catch (error) {\r\n    throw error\r\n  }\r\n}\r\n\r\nexport async function fetchRegistryLocal(filePath: string) {\r\n  try {\r\n    // Handle tilde expansion for home directory\r\n    let expandedPath = filePath\r\n    if (filePath.startsWith(\"~/\")) {\r\n      expandedPath = path.join(homedir(), filePath.slice(2))\r\n    }\r\n\r\n    const resolvedPath = path.resolve(expandedPath)\r\n    const content = await fs.readFile(resolvedPath, \"utf8\")\r\n    const parsed = JSON.parse(content)\r\n\r\n    try {\r\n      return registryItemSchema.parse(parsed)\r\n    } catch (error) {\r\n      throw new RegistryParseError(filePath, error)\r\n    }\r\n  } catch (error) {\r\n    // Check if this is a file not found error\r\n    if (\r\n      error instanceof Error &&\r\n      (error.message.includes(\"ENOENT\") ||\r\n        error.message.includes(\"no such file\"))\r\n    ) {\r\n      throw new RegistryLocalFileError(filePath, error)\r\n    }\r\n    // Re-throw parse errors as-is\r\n    if (error instanceof RegistryParseError) {\r\n      throw error\r\n    }\r\n    // For other errors (like JSON parse errors), throw as local file error\r\n    throw new RegistryLocalFileError(filePath, error)\r\n  }\r\n}\r\n","// Internal function that fetches registry items without clearing context.\r\nimport { Config, getTargetStyleFromConfig } from \"@/src/utils/get-config\";\r\nimport { getProjectTailwindVersionFromConfig } from \"@/src/utils/get-project-info\";\r\nimport { buildTailwindThemeColorsFromCssVars } from \"@/src/utils/updaters/update-tailwind-config\";\r\nimport { createHash } from \"crypto\";\r\nimport deepmerge from \"deepmerge\";\r\nimport path from \"path\";\r\nimport z from \"zod\";\r\nimport { getRegistryBaseColor, getUidesuRegistryIndex } from \"./api\";\r\nimport { buildUrlAndHeadersForRegistryItem, resolveRegistryUrl } from \"./builder\";\r\nimport { setRegistryHeaders } from \"./context\";\r\nimport { RegistryNotConfiguredError, RegistryParseError } from \"./errors\";\r\nimport { fetchRegistry, fetchRegistryLocal } from \"./fetcher\";\r\nimport { parseRegistryAndItemFromString } from \"./parser\";\r\nimport { registryItemSchema, registryResolvedItemsTreeSchema } from \"./schema\";\r\nimport { deduplicateFilesByTarget, isLocalFile, isUrl } from \"./utils\";\r\n\r\nexport function resolveRegistryItemsFromRegistries(\r\n  items: string[],\r\n  config: Config\r\n) {\r\n  const registryHeaders: Record<string, Record<string, string>> = {};\r\n  const resolvedItems = [...items];\r\n\r\n  if (!config?.registries) {\r\n    setRegistryHeaders({});\r\n    return resolvedItems;\r\n  }\r\n\r\n  for (let i = 0; i < resolvedItems.length; i++) {\r\n    const resolved = buildUrlAndHeadersForRegistryItem(resolvedItems[i], config);\r\n\r\n    if (resolved) {\r\n      resolvedItems[i] = resolved.url;\r\n\r\n      if (Object.keys(resolved.headers).length > 0) {\r\n        registryHeaders[resolved.url] = resolved.headers;\r\n      }\r\n    }\r\n  }\r\n\r\n  setRegistryHeaders(registryHeaders);\r\n\r\n  return resolvedItems;\r\n}\r\n\r\n// This is used for recursive dependecy resolution.\r\nexport async function fetchRegistryItems(\r\n  items: string[],\r\n  config: Config,\r\n  options: { useCache?: boolean } = {}\r\n) {\r\n  const results = await Promise.all(\r\n    items.map(async (item) => {\r\n      if (isLocalFile(item)) {\r\n        return fetchRegistryLocal(item);\r\n      }\r\n\r\n      if (isUrl(item)) {\r\n        const [result] = await fetchRegistry([item], options);\r\n        try {\r\n          return registryItemSchema.parse(result);\r\n        } catch (error) {\r\n          throw new RegistryParseError(item, error);\r\n        }\r\n      }\r\n\r\n      if (item.startsWith(\"@\") && config?.registries) {\r\n        const paths = resolveRegistryItemsFromRegistries([item], config);\r\n        const [result] = await fetchRegistry(paths, options);\r\n        try {\r\n          return registryItemSchema.parse(result);\r\n        } catch (error) {\r\n          throw new RegistryParseError(item, error);\r\n        }\r\n      }\r\n\r\n\r\n      const path = `styles/${config?.style ?? \"aodesu\"}/${item}.json`;\r\n      const [result] = await fetchRegistry([path], options);\r\n      try {\r\n        return registryItemSchema.parse(result);\r\n      } catch (error) {\r\n        throw new RegistryParseError(item, error);\r\n      }\r\n    })\r\n  )\r\n\r\n  return results;\r\n}\r\n\r\n// Helper schema for items with source tracking\r\nconst registryItemWithSourceSchema = registryItemSchema.extend({\r\n  _source: z.string().optional(),\r\n});\r\n\r\n\r\n// Resolves a list of registry items with all their dependencies and returns\r\n// a complete installation bundle with merged configuration.\r\nexport async function resolveRegistryTree(\r\n  names: z.infer<typeof registryItemSchema>[\"name\"][],\r\n  config: Config,\r\n  options: { useCache?: boolean } = {}\r\n) {\r\n  options = {\r\n    useCache: true,\r\n    ...options,\r\n  }\r\n\r\n  let payload: z.infer<typeof registryItemWithSourceSchema>[] = []\r\n  let allDependencyItems: z.infer<typeof registryItemWithSourceSchema>[] = []\r\n  let allDependencyRegistryNames: string[] = []\r\n\r\n  const uniqueNames = Array.from(new Set(names))\r\n\r\n  const results = await fetchRegistryItems(uniqueNames, config, options)\r\n\r\n  const resultMap = new Map<string, z.infer<typeof registryItemSchema>>()\r\n  for (let i = 0; i < results.length; i++) {\r\n    if (results[i]) {\r\n      resultMap.set(uniqueNames[i], results[i])\r\n    }\r\n  }\r\n\r\n  for (const [sourceName, item] of Array.from(resultMap.entries())) {\r\n    // Add source tracking\r\n    const itemWithSource: z.infer<typeof registryItemWithSourceSchema> = {\r\n      ...item,\r\n      _source: sourceName,\r\n    }\r\n    payload.push(itemWithSource)\r\n\r\n    if (item.registryDependencies) {\r\n      // Resolve namespace syntax and set headers for dependencies\r\n      let resolvedDependencies = item.registryDependencies\r\n\r\n      // Check for namespaced dependencies when no registries are configured\r\n      if (!config?.registries) {\r\n        const namespacedDeps = item.registryDependencies.filter((dep: string) =>\r\n          dep.startsWith(\"@\")\r\n        )\r\n        if (namespacedDeps.length > 0) {\r\n          const { registry } = parseRegistryAndItemFromString(namespacedDeps[0])\r\n          throw new RegistryNotConfiguredError(registry)\r\n        }\r\n      } else {\r\n        resolvedDependencies = resolveRegistryItemsFromRegistries(\r\n          item.registryDependencies,\r\n          config\r\n        )\r\n      }\r\n\r\n      const { items, registryNames } = await resolveDependenciesRecursively(\r\n        resolvedDependencies,\r\n        config,\r\n        options,\r\n        new Set(uniqueNames)\r\n      )\r\n      allDependencyItems.push(...items)\r\n      allDependencyRegistryNames.push(...registryNames)\r\n    }\r\n  }\r\n\r\n  payload.push(...allDependencyItems)\r\n\r\n  // Handle any remaining registry names that need index resolution\r\n  if (allDependencyRegistryNames.length > 0) {\r\n    // Remove duplicates from registry names\r\n    const uniqueRegistryNames = Array.from(new Set(allDependencyRegistryNames))\r\n\r\n    // Separate namespaced and non-namespaced items\r\n    const nonNamespacedItems = uniqueRegistryNames.filter(\r\n      (name) => !name.startsWith(\"@\")\r\n    )\r\n    const namespacedDepItems = uniqueRegistryNames.filter((name) =>\r\n      name.startsWith(\"@\")\r\n    )\r\n\r\n    // Handle namespaced dependency items\r\n    if (namespacedDepItems.length > 0) {\r\n      // This will now throw specific errors on failure\r\n      const depResults = await fetchRegistryItems(\r\n        namespacedDepItems,\r\n        config,\r\n        options\r\n      )\r\n\r\n      for (let i = 0; i < depResults.length; i++) {\r\n        const item = depResults[i]\r\n        const itemWithSource: z.infer<typeof registryItemWithSourceSchema> = {\r\n          ...item,\r\n          _source: namespacedDepItems[i],\r\n        }\r\n        payload.push(itemWithSource)\r\n      }\r\n    }\r\n\r\n    // For non-namespaced items, we need the index and style resolution\r\n    if (nonNamespacedItems.length > 0) {\r\n      const index = await getUidesuRegistryIndex()\r\n      if (!index && payload.length === 0) {\r\n        return null\r\n      }\r\n\r\n      if (index) {\r\n        // If we're resolving the index, we want it to go first\r\n        if (nonNamespacedItems.includes(\"index\")) {\r\n          nonNamespacedItems.unshift(\"index\")\r\n        }\r\n\r\n        // Resolve non-namespaced items through the existing flow\r\n        // Get URLs for all registry items including their dependencies\r\n        const registryUrls: string[] = []\r\n        for (const name of nonNamespacedItems) {\r\n          const itemDependencies = await resolveRegistryDependencies(\r\n            name,\r\n            config,\r\n            options\r\n          )\r\n          registryUrls.push(...itemDependencies)\r\n        }\r\n\r\n        // Deduplicate URLs\r\n        const uniqueUrls = Array.from(new Set(registryUrls))\r\n        let result = await fetchRegistry(uniqueUrls, options)\r\n        const registryPayload = z.array(registryItemSchema).parse(result)\r\n        payload.push(...registryPayload)\r\n      }\r\n    }\r\n  }\r\n\r\n  if (!payload.length) {\r\n    return null\r\n  }\r\n\r\n  // No deduplication - we want to support multiple items with the same name from different sources\r\n\r\n  // If we're resolving the index, we want to fetch\r\n  // the theme item if a base color is provided.\r\n  // We do this for index only.\r\n  // Other components will ship with their theme tokens.\r\n  if (\r\n    uniqueNames.includes(\"index\") ||\r\n    allDependencyRegistryNames.includes(\"index\")\r\n  ) {\r\n    if (config.tailwind.baseColor) {\r\n      const theme = await registryGetTheme(config.tailwind.baseColor, config)\r\n      if (theme) {\r\n        payload.unshift(theme)\r\n      }\r\n    }\r\n  }\r\n\r\n  // Build source map for topological sort\r\n  const sourceMap = new Map<z.infer<typeof registryItemSchema>, string>()\r\n  payload.forEach((item) => {\r\n    // Use the _source property if it was added, otherwise use the name\r\n    const source = item._source || item.name\r\n    sourceMap.set(item, source)\r\n  })\r\n\r\n  // Apply topological sort to ensure dependencies come before dependents\r\n  payload = topologicalSortRegistryItems(payload, sourceMap)\r\n\r\n  // Sort the payload so that registry:theme items come first,\r\n  // while maintaining the relative order of all items.\r\n  payload.sort((a, b) => {\r\n    if (a.type === \"registry:theme\" && b.type !== \"registry:theme\") {\r\n      return -1\r\n    }\r\n    if (a.type !== \"registry:theme\" && b.type === \"registry:theme\") {\r\n      return 1\r\n    }\r\n    return 0\r\n  })\r\n\r\n  let tailwind = {}\r\n  payload.forEach((item) => {\r\n    tailwind = deepmerge(tailwind, item.tailwind ?? {})\r\n  })\r\n\r\n  let cssVars = {}\r\n  payload.forEach((item) => {\r\n    cssVars = deepmerge(cssVars, item.cssVars ?? {})\r\n  })\r\n\r\n  let css = {}\r\n  payload.forEach((item) => {\r\n    css = deepmerge(css, item.css ?? {})\r\n  })\r\n\r\n  let docs = \"\"\r\n  payload.forEach((item) => {\r\n    if (item.docs) {\r\n      docs += `${item.docs}\\n`\r\n    }\r\n  })\r\n\r\n  let envVars = {}\r\n  payload.forEach((item) => {\r\n    envVars = deepmerge(envVars, item.envVars ?? {})\r\n  })\r\n\r\n  // Deduplicate files based on resolved target paths.\r\n  const deduplicatedFiles = await deduplicateFilesByTarget(\r\n    payload.map((item) => item.files ?? []),\r\n    config\r\n  )\r\n\r\n  const parsed = registryResolvedItemsTreeSchema.parse({\r\n    dependencies: deepmerge.all(payload.map((item) => item.dependencies ?? [])),\r\n    devDependencies: deepmerge.all(\r\n      payload.map((item) => item.devDependencies ?? [])\r\n    ),\r\n    files: deduplicatedFiles,\r\n    tailwind,\r\n    cssVars,\r\n    css,\r\n    docs,\r\n  })\r\n\r\n  if (Object.keys(envVars).length > 0) {\r\n    parsed.envVars = envVars\r\n  }\r\n\r\n  return parsed\r\n}\r\n\r\nasync function resolveDependenciesRecursively(\r\n  dependencies: string[],\r\n  config: Config,\r\n  options: { useCache?: boolean } = {},\r\n  visited: Set<string> = new Set()\r\n) {\r\n  const items: z.infer<typeof registryItemSchema>[] = []\r\n  const registryNames: string[] = []\r\n\r\n  for (const dep of dependencies) {\r\n    if (visited.has(dep)) {\r\n      continue\r\n    }\r\n    visited.add(dep)\r\n\r\n    // Handle URLs and local files directly.\r\n    if (isUrl(dep) || isLocalFile(dep)) {\r\n      const [item] = await fetchRegistryItems([dep], config, options)\r\n      if (item) {\r\n        items.push(item)\r\n        if (item.registryDependencies) {\r\n          // Resolve namespaced dependencies to set proper headers.\r\n          const resolvedDeps = config?.registries\r\n            ? resolveRegistryItemsFromRegistries(\r\n                item.registryDependencies,\r\n                config\r\n              )\r\n            : item.registryDependencies\r\n\r\n          const nested = await resolveDependenciesRecursively(\r\n            resolvedDeps,\r\n            config,\r\n            options,\r\n            visited\r\n          )\r\n          items.push(...nested.items)\r\n          registryNames.push(...nested.registryNames)\r\n        }\r\n      }\r\n    }\r\n    // Handle namespaced items (e.g., @one/foo, @two/bar).\r\n    else if (dep.startsWith(\"@\") && config?.registries) {\r\n      // Check if the registry exists.\r\n      const { registry } = parseRegistryAndItemFromString(dep)\r\n      if (registry && !(registry in config.registries)) {\r\n        throw new RegistryNotConfiguredError(registry)\r\n      }\r\n\r\n      // Let getRegistryItem handle the namespaced item with config\r\n      // This ensures proper authentication headers are used\r\n      const [item] = await fetchRegistryItems([dep], config, options)\r\n      if (item) {\r\n        items.push(item)\r\n        if (item.registryDependencies) {\r\n          // Resolve namespaced dependencies to set proper headers.\r\n          const resolvedDeps = config?.registries\r\n            ? resolveRegistryItemsFromRegistries(\r\n                item.registryDependencies,\r\n                config\r\n              )\r\n            : item.registryDependencies\r\n\r\n          const nested = await resolveDependenciesRecursively(\r\n            resolvedDeps,\r\n            config,\r\n            options,\r\n            visited\r\n          )\r\n          items.push(...nested.items)\r\n          registryNames.push(...nested.registryNames)\r\n        }\r\n      }\r\n    }\r\n    // Handle regular component names.\r\n    else {\r\n      registryNames.push(dep)\r\n\r\n      if (config) {\r\n        try {\r\n          const [item] = await fetchRegistryItems([dep], config, options)\r\n          if (item && item.registryDependencies) {\r\n            // Resolve namespaced dependencies to set proper headers.\r\n            const resolvedDeps = config?.registries\r\n              ? resolveRegistryItemsFromRegistries(\r\n                  item.registryDependencies,\r\n                  config\r\n                )\r\n              : item.registryDependencies\r\n\r\n            const nested = await resolveDependenciesRecursively(\r\n              resolvedDeps,\r\n              config,\r\n              options,\r\n              visited\r\n            )\r\n            items.push(...nested.items)\r\n            registryNames.push(...nested.registryNames)\r\n          }\r\n        } catch (error) {\r\n          // If we can't fetch the registry item, that's okay - we'll still\r\n          // include the name.\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  return { items, registryNames }\r\n}\r\n\r\nasync function resolveRegistryDependencies(\r\n  url: string,\r\n  config: Config,\r\n  options: { useCache?: boolean } = {}\r\n) {\r\n  if (isUrl(url)) {\r\n    return [url]\r\n  }\r\n\r\n  const { registryNames } = await resolveDependenciesRecursively(\r\n    [url],\r\n    config,\r\n    options,\r\n    new Set()\r\n  )\r\n\r\n  const style = config.resolvedPaths?.cwd\r\n    ? await getTargetStyleFromConfig(config.resolvedPaths.cwd, config.style)\r\n    : config.style\r\n\r\n  const urls = registryNames.map((name) =>\r\n    resolveRegistryUrl(isUrl(name) ? name : `styles/${style}/${name}.json`)\r\n  )\r\n\r\n  return Array.from(new Set(urls))\r\n}\r\n\r\nasync function registryGetTheme(name: string, config: Config) {\r\n  const [baseColor, tailwindVersion] = await Promise.all([\r\n    getRegistryBaseColor(name),\r\n    getProjectTailwindVersionFromConfig(config),\r\n  ])\r\n  if (!baseColor) {\r\n    return null\r\n  }\r\n\r\n  // TODO: Move this to the registry i.e registry:theme.\r\n  const theme = {\r\n    name,\r\n    type: \"registry:theme\",\r\n    tailwind: {\r\n      config: {\r\n        theme: {\r\n          extend: {\r\n            borderRadius: {\r\n              lg: \"var(--radius)\",\r\n              md: \"calc(var(--radius) - 2px)\",\r\n              sm: \"calc(var(--radius) - 4px)\",\r\n            },\r\n            colors: {},\r\n          },\r\n        },\r\n      },\r\n    },\r\n    cssVars: {\r\n      theme: {},\r\n      light: {\r\n        radius: \"0.5rem\",\r\n      },\r\n      dark: {},\r\n    },\r\n  } satisfies z.infer<typeof registryItemSchema>\r\n\r\n  if (config.tailwind.cssVariables) {\r\n    theme.tailwind.config.theme.extend.colors = {\r\n      ...theme.tailwind.config.theme.extend.colors,\r\n      ...buildTailwindThemeColorsFromCssVars(baseColor.cssVars.dark ?? {}),\r\n    }\r\n    theme.cssVars = {\r\n      theme: {\r\n        ...baseColor.cssVars.theme,\r\n        ...theme.cssVars.theme,\r\n      },\r\n      light: {\r\n        ...baseColor.cssVars.light,\r\n        ...theme.cssVars.light,\r\n      },\r\n      dark: {\r\n        ...baseColor.cssVars.dark,\r\n        ...theme.cssVars.dark,\r\n      },\r\n    }\r\n\r\n    if (tailwindVersion === \"v4\" && baseColor.cssVarsV4) {\r\n      theme.cssVars = {\r\n        theme: {\r\n          ...baseColor.cssVarsV4.theme,\r\n          ...theme.cssVars.theme,\r\n        },\r\n        light: {\r\n          radius: \"0.625rem\",\r\n          ...baseColor.cssVarsV4.light,\r\n        },\r\n        dark: {\r\n          ...baseColor.cssVarsV4.dark,\r\n        },\r\n      }\r\n    }\r\n  }\r\n\r\n  return theme\r\n}\r\n\r\nfunction computeItemHash(\r\n  item: Pick<z.infer<typeof registryItemSchema>, \"name\">,\r\n  source?: string\r\n) {\r\n  const identifier = source || item.name\r\n\r\n  const hash = createHash(\"sha256\")\r\n    .update(identifier)\r\n    .digest(\"hex\")\r\n    .substring(0, 8)\r\n\r\n  return `${item.name}::${hash}`\r\n}\r\n\r\nfunction extractItemIdentifierFromDependency(dependency: string) {\r\n  if (isUrl(dependency)) {\r\n    const url = new URL(dependency)\r\n    const pathname = url.pathname\r\n    const match = pathname.match(/\\/([^/]+)\\.json$/)\r\n    const name = match ? match[1] : path.basename(pathname, \".json\")\r\n\r\n    return {\r\n      name,\r\n      hash: computeItemHash({ name }, dependency),\r\n    }\r\n  }\r\n\r\n  if (isLocalFile(dependency)) {\r\n    const match = dependency.match(/\\/([^/]+)\\.json$/)\r\n    const name = match ? match[1] : path.basename(dependency, \".json\")\r\n\r\n    return {\r\n      name,\r\n      hash: computeItemHash({ name }, dependency),\r\n    }\r\n  }\r\n\r\n  const { item } = parseRegistryAndItemFromString(dependency)\r\n  return {\r\n    name: item,\r\n    hash: computeItemHash({ name: item }, dependency),\r\n  }\r\n}\r\n\r\nfunction topologicalSortRegistryItems(\r\n  items: z.infer<typeof registryItemSchema>[],\r\n  sourceMap: Map<z.infer<typeof registryItemSchema>, string>\r\n) {\r\n  const itemMap = new Map<string, z.infer<typeof registryItemSchema>>()\r\n  const hashToItem = new Map<string, z.infer<typeof registryItemSchema>>()\r\n  const inDegree = new Map<string, number>()\r\n  const adjacencyList = new Map<string, string[]>()\r\n\r\n  items.forEach((item) => {\r\n    const source = sourceMap.get(item) || item.name\r\n    const hash = computeItemHash(item, source)\r\n\r\n    itemMap.set(hash, item)\r\n    hashToItem.set(hash, item)\r\n    inDegree.set(hash, 0)\r\n    adjacencyList.set(hash, [])\r\n  })\r\n\r\n  // Build a map of dependency to possible items.\r\n  const depToHashes = new Map<string, string[]>()\r\n  items.forEach((item) => {\r\n    const source = sourceMap.get(item) || item.name\r\n    const hash = computeItemHash(item, source)\r\n\r\n    if (!depToHashes.has(item.name)) {\r\n      depToHashes.set(item.name, [])\r\n    }\r\n    depToHashes.get(item.name)!.push(hash)\r\n\r\n    if (source !== item.name) {\r\n      if (!depToHashes.has(source)) {\r\n        depToHashes.set(source, [])\r\n      }\r\n      depToHashes.get(source)!.push(hash)\r\n    }\r\n  })\r\n\r\n  items.forEach((item) => {\r\n    const itemSource = sourceMap.get(item) || item.name\r\n    const itemHash = computeItemHash(item, itemSource)\r\n\r\n    if (item.registryDependencies) {\r\n      item.registryDependencies.forEach((dep) => {\r\n        let depHash: string | undefined\r\n\r\n        const exactMatches = depToHashes.get(dep) || []\r\n        if (exactMatches.length === 1) {\r\n          depHash = exactMatches[0]\r\n        } else if (exactMatches.length > 1) {\r\n          // Multiple matches - try to disambiguate.\r\n          // For now, just use the first one and warn.\r\n          depHash = exactMatches[0]\r\n        } else {\r\n          const { name } = extractItemIdentifierFromDependency(dep)\r\n          const nameMatches = depToHashes.get(name) || []\r\n          if (nameMatches.length > 0) {\r\n            depHash = nameMatches[0]\r\n          }\r\n        }\r\n\r\n        if (depHash && itemMap.has(depHash)) {\r\n          adjacencyList.get(depHash)!.push(itemHash)\r\n          inDegree.set(itemHash, inDegree.get(itemHash)! + 1)\r\n        }\r\n      })\r\n    }\r\n  })\r\n\r\n  // Implements Kahn's algorithm.\r\n  const queue: string[] = []\r\n  const sorted: z.infer<typeof registryItemSchema>[] = []\r\n\r\n  inDegree.forEach((degree, hash) => {\r\n    if (degree === 0) {\r\n      queue.push(hash)\r\n    }\r\n  })\r\n\r\n  while (queue.length > 0) {\r\n    const currentHash = queue.shift()!\r\n    const item = itemMap.get(currentHash)!\r\n    sorted.push(item)\r\n\r\n    adjacencyList.get(currentHash)!.forEach((dependentHash) => {\r\n      const newDegree = inDegree.get(dependentHash)! - 1\r\n      inDegree.set(dependentHash, newDegree)\r\n\r\n      if (newDegree === 0) {\r\n        queue.push(dependentHash)\r\n      }\r\n    })\r\n  }\r\n\r\n  if (sorted.length !== items.length) {\r\n    console.warn(\"Circular dependency detected in registry items\")\r\n    // Return all items even if there are circular dependencies\r\n    // Items not in sorted are part of circular dependencies\r\n    const sortedHashes = new Set(\r\n      sorted.map((item) => {\r\n        const source = sourceMap.get(item) || item.name\r\n        return computeItemHash(item, source)\r\n      })\r\n    )\r\n\r\n    items.forEach((item) => {\r\n      const source = sourceMap.get(item) || item.name\r\n      const hash = computeItemHash(item, source)\r\n      if (!sortedHashes.has(hash)) {\r\n        sorted.push(item)\r\n      }\r\n    })\r\n  }\r\n\r\n  return sorted\r\n}\r\n","import z from \"zod\";\r\nimport { Config } from \"../utils/get-config\";\r\nimport { handleError } from \"../utils/handle-error\";\r\nimport { logger } from \"../utils/logger\";\r\nimport { buildUrlAndHeadersForRegistryItem } from \"./builder\";\r\nimport { configWithDefaults } from \"./config\";\r\nimport { BASE_COLORS, REGISTRY_URL } from \"./constants\";\r\nimport { clearRegistryContext, setRegistryHeaders } from \"./context\";\r\nimport { RegistriesIndexParseError, RegistryInvalidNamespaceError, RegistryNotFoundError, RegistryParseError } from \"./errors\";\r\nimport { fetchRegistry } from \"./fetcher\";\r\nimport { fetchRegistryItems } from \"./resolver\";\r\nimport { iconsSchema, registriesIndexSchema, registryBaseColorSchema, registryIndexSchema, registrySchema, stylesSchema } from \"./schema\";\r\nimport { isUrl } from \"./utils\";\r\n\r\nexport async function getRegistry(\r\n  name: string,\r\n  options?: {\r\n    config?: Partial<Config>\r\n    useCache?: boolean\r\n  }\r\n) {\r\n  const { config, useCache } = options || {};\r\n\r\n  if (isUrl(name)) {\r\n    const [result] = await fetchRegistry([name], { useCache });\r\n    try {\r\n      return registrySchema.parse(result);\r\n    } catch (error) {\r\n      throw new RegistryParseError(name, error);\r\n    }\r\n  }\r\n\r\n  if (!name.startsWith(\"@\")) {\r\n    throw new RegistryInvalidNamespaceError(name);\r\n  }\r\n\r\n  let registryName = name;\r\n  if (!registryName.endsWith(\"/registry\")) {\r\n    registryName = `${registryName}/registry`\r\n  }\r\n\r\n  const urlAndHeaders = buildUrlAndHeadersForRegistryItem(\r\n    registryName as `@${string}`,\r\n    configWithDefaults(config)\r\n  );\r\n\r\n  if (!urlAndHeaders?.url) {\r\n    throw new RegistryNotFoundError(registryName);\r\n  }\r\n\r\n  if (urlAndHeaders.headers && Object.keys(urlAndHeaders.headers).length > 0) {\r\n    setRegistryHeaders({\r\n      [urlAndHeaders.url]: urlAndHeaders.headers,\r\n    })\r\n  }\r\n\r\n  const [result] = await fetchRegistry([urlAndHeaders.url], { useCache });\r\n\r\n  try {\r\n    return registrySchema.parse(result);\r\n  } catch (error) {\r\n    throw new RegistryParseError(registryName, error);\r\n  }\r\n}\r\n\r\nexport async function getRegistryItems(\r\n  items: string[],\r\n  options?: {\r\n    config?: Partial<Config>\r\n    useCache?: boolean\r\n  }\r\n) {\r\n  const { config, useCache } = options || {};\r\n\r\n  clearRegistryContext();\r\n\r\n  return fetchRegistryItems(items, configWithDefaults(config), { useCache })\r\n}\r\n\r\nexport async function getUidesuRegistryIndex() {\r\n  try {\r\n    const [result] = await fetchRegistry([\"index.json\"])\r\n\r\n    return registryIndexSchema.parse(result)\r\n  } catch (error) {\r\n    logger.error(\"\\n\")\r\n    handleError(error)\r\n  }\r\n}\r\n\r\nexport async function getRegistryStyles() {\r\n  try {\r\n    const [result] = await fetchRegistry([\"styles/index.json\"]);\r\n\r\n    return stylesSchema.parse(result);\r\n  } catch (error) {\r\n    logger.error(\"\\n\");\r\n    handleError(error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getRegistryIcons() {\r\n  try {\r\n    const [result] = await fetchRegistry([\"icons/index.json\"])\r\n    return iconsSchema.parse(result)\r\n  } catch (error) {\r\n    handleError(error)\r\n    return {}\r\n  }\r\n}\r\n\r\nexport async function getRegistryBaseColors() {\r\n  return BASE_COLORS\r\n}\r\n\r\nexport async function getRegistryBaseColor(baseColor: string) {\r\n  try {\r\n    const [result] = await fetchRegistry([`colors/${baseColor}.json`])\r\n\r\n    return registryBaseColorSchema.parse(result)\r\n  } catch (error) {\r\n    handleError(error)\r\n  }\r\n}\r\n\r\nexport async function getRegistriesIndex(options?: { useCache?: boolean }) {\r\n  options = {\r\n    useCache: true,\r\n    ...options,\r\n  }\r\n\r\n  const url = `${REGISTRY_URL}/registries.json`\r\n  const [data] = await fetchRegistry([url], {\r\n    useCache: options.useCache,\r\n  })\r\n\r\n  try {\r\n    return registriesIndexSchema.parse(data)\r\n  } catch (error) {\r\n    if (error instanceof z.ZodError) {\r\n      throw new RegistriesIndexParseError(error)\r\n    }\r\n\r\n    throw error\r\n  }\r\n}\r\n","import path from \"path\"\r\n\r\nexport function isSafeTarget(targetPath: string, cwd: string): boolean {\r\n  // Check for null bytes which can be used to bypass validations.\r\n  if (targetPath.includes(\"\\0\")) {\r\n    return false\r\n  }\r\n\r\n  // Decode URL-encoded sequences to catch encoded traversal attempts.\r\n  let decodedPath: string\r\n  try {\r\n    // Decode multiple times to catch double-encoded sequences.\r\n    decodedPath = targetPath\r\n    let prevPath = \"\"\r\n    while (decodedPath !== prevPath && decodedPath.includes(\"%\")) {\r\n      prevPath = decodedPath\r\n      decodedPath = decodeURIComponent(decodedPath)\r\n    }\r\n  } catch {\r\n    // If decoding fails, treat as unsafe.\r\n    return false\r\n  }\r\n\r\n  // Normalize both paths to handle different path separators.\r\n  // Convert Windows backslashes to forward slashes for consistent handling.\r\n  const normalizedTarget = path.normalize(decodedPath.replace(/\\\\/g, \"/\"))\r\n  const normalizedRoot = path.normalize(cwd)\r\n\r\n  // Check for explicit path traversal sequences in both encoded and decoded forms.\r\n  // Allow [...] pattern which is common in framework routing (e.g., [...slug])\r\n  const hasPathTraversal = (path: string) => {\r\n    // Remove [...] patterns before checking for ..\r\n    const withoutBrackets = path.replace(/\\[\\.\\.\\..*?\\]/g, \"\")\r\n    return withoutBrackets.includes(\"..\")\r\n  }\r\n\r\n  if (\r\n    hasPathTraversal(normalizedTarget) ||\r\n    hasPathTraversal(decodedPath) ||\r\n    hasPathTraversal(targetPath)\r\n  ) {\r\n    return false\r\n  }\r\n\r\n  // Check for current directory references that might be used in traversal.\r\n  // First, remove [...] patterns to avoid false positives\r\n  const cleanPath = (path: string) => path.replace(/\\[\\.\\.\\..*?\\]/g, \"\")\r\n  const cleanTarget = cleanPath(targetPath)\r\n  const cleanDecoded = cleanPath(decodedPath)\r\n\r\n  const suspiciousPatterns = [\r\n    /\\.\\.[\\/\\\\]/, // ../ or ..\\\r\n    /[\\/\\\\]\\.\\./, // /.. or \\..\r\n    /\\.\\./, // .. anywhere\r\n    /\\.\\.%/, // URL encoded traversal\r\n    /\\x00/, // null byte\r\n    /[\\x01-\\x1f]/, // control characters\r\n  ]\r\n\r\n  if (\r\n    suspiciousPatterns.some(\r\n      (pattern) => pattern.test(cleanTarget) || pattern.test(cleanDecoded)\r\n    )\r\n  ) {\r\n    return false\r\n  }\r\n\r\n  // Allow ~/ at the start (home directory expansion within project) but reject ~/../ patterns.\r\n  if (\r\n    (targetPath.includes(\"~\") || decodedPath.includes(\"~\")) &&\r\n    (targetPath.includes(\"../\") || decodedPath.includes(\"../\"))\r\n  ) {\r\n    return false\r\n  }\r\n\r\n  // Check for Windows drive letters (even on non-Windows systems for safety).\r\n  const driveLetterRegex = /^[a-zA-Z]:[\\/\\\\]/\r\n  if (driveLetterRegex.test(decodedPath)) {\r\n    // On Windows, check if it starts with the project root.\r\n    if (process.platform === \"win32\") {\r\n      return decodedPath.toLowerCase().startsWith(cwd.toLowerCase())\r\n    }\r\n    // On non-Windows systems, reject all Windows absolute paths.\r\n    return false\r\n  }\r\n\r\n  // If it's an absolute path, ensure it's within the project root.\r\n  if (path.isAbsolute(normalizedTarget)) {\r\n    return normalizedTarget.startsWith(normalizedRoot + path.sep)\r\n  }\r\n\r\n  // For relative paths, resolve and check if within project bounds.\r\n  const resolvedPath = path.resolve(normalizedRoot, normalizedTarget)\r\n  return (\r\n    resolvedPath.startsWith(normalizedRoot + path.sep) ||\r\n    resolvedPath === normalizedRoot\r\n  )\r\n}\r\n","import { registryItemCssSchema } from \"@/src/schema\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\nimport { highlighter } from \"@/src/utils/highlighter\"\r\nimport { spinner } from \"@/src/utils/spinner\"\r\nimport { promises as fs } from \"fs\"\r\nimport path from \"path\"\r\nimport postcss from \"postcss\"\r\nimport AtRule from \"postcss/lib/at-rule\"\r\nimport Declaration from \"postcss/lib/declaration\"\r\nimport Root from \"postcss/lib/root\"\r\nimport Rule from \"postcss/lib/rule\"\r\nimport { z } from \"zod\"\r\n\r\nexport async function updateCss(\r\n  css: z.infer<typeof registryItemCssSchema> | undefined,\r\n  config: Config,\r\n  options: {\r\n    silent?: boolean\r\n  }\r\n) {\r\n  if (\r\n    !config.resolvedPaths.tailwindCss ||\r\n    !css ||\r\n    Object.keys(css).length === 0\r\n  ) {\r\n    return\r\n  }\r\n\r\n  options = {\r\n    silent: false,\r\n    ...options,\r\n  }\r\n\r\n  const cssFilepath = config.resolvedPaths.tailwindCss\r\n  const cssFilepathRelative = path.relative(\r\n    config.resolvedPaths.cwd,\r\n    cssFilepath\r\n  )\r\n  const cssSpinner = spinner(\r\n    `Updating ${highlighter.info(cssFilepathRelative)}`,\r\n    {\r\n      silent: options.silent,\r\n    }\r\n  ).start()\r\n\r\n  const raw = await fs.readFile(cssFilepath, \"utf8\")\r\n  let output = await transformCss(raw, css)\r\n  await fs.writeFile(cssFilepath, output, \"utf8\")\r\n  cssSpinner.succeed()\r\n}\r\n\r\nexport async function transformCss(\r\n  input: string,\r\n  css: z.infer<typeof registryItemCssSchema>\r\n) {\r\n  const plugins = [updateCssPlugin(css)]\r\n\r\n  const result = await postcss(plugins).process(input, {\r\n    from: undefined,\r\n  })\r\n\r\n  let output = result.css\r\n\r\n  // PostCSS doesn't add semicolons to at-rules without bodies when they're the last node.\r\n  // We need to manually ensure they have semicolons.\r\n  const root = result.root\r\n  if (root.nodes && root.nodes.length > 0) {\r\n    const lastNode = root.nodes[root.nodes.length - 1]\r\n    if (\r\n      lastNode.type === \"atrule\" &&\r\n      !lastNode.nodes &&\r\n      !output.trimEnd().endsWith(\";\")\r\n    ) {\r\n      output = output.trimEnd() + \";\"\r\n    }\r\n  }\r\n\r\n  output = output.replace(/\\/\\* ---break--- \\*\\//g, \"\")\r\n  output = output.replace(/(\\n\\s*\\n)+/g, \"\\n\\n\")\r\n  output = output.trimEnd()\r\n\r\n  return output\r\n}\r\n\r\nfunction updateCssPlugin(css: z.infer<typeof registryItemCssSchema>) {\r\n  return {\r\n    postcssPlugin: \"update-css\",\r\n    Once(root: Root) {\r\n      for (const [selector, properties] of Object.entries(css)) {\r\n        if (selector.startsWith(\"@\")) {\r\n          // Handle at-rules (@layer, @utility, etc.)\r\n          const atRuleMatch = selector.match(/@([a-zA-Z-]+)\\s*(.*)/)\r\n          if (!atRuleMatch) continue\r\n\r\n          const [, name, params] = atRuleMatch\r\n\r\n          // Special handling for imports - place them at the top.\r\n          if (name === \"import\") {\r\n            // Check if this import already exists.\r\n            const existingImport = root.nodes?.find(\r\n              (node): node is AtRule =>\r\n                node.type === \"atrule\" &&\r\n                node.name === \"import\" &&\r\n                node.params === params\r\n            )\r\n\r\n            if (!existingImport) {\r\n              const importRule = postcss.atRule({\r\n                name: \"import\",\r\n                params,\r\n                raws: { semicolon: true },\r\n              })\r\n\r\n              // Find the last import to insert after, or insert at beginning.\r\n              const importNodes = root.nodes?.filter(\r\n                (node): node is AtRule =>\r\n                  node.type === \"atrule\" && node.name === \"import\"\r\n              )\r\n\r\n              if (importNodes && importNodes.length > 0) {\r\n                // Insert after the last existing import.\r\n                const lastImport = importNodes[importNodes.length - 1]\r\n                importRule.raws.before = \"\\n\"\r\n                root.insertAfter(lastImport, importRule)\r\n              } else {\r\n                // No imports exist, insert at the very beginning.\r\n                // Check if the file is empty.\r\n                if (!root.nodes || root.nodes.length === 0) {\r\n                  importRule.raws.before = \"\"\r\n                } else {\r\n                  importRule.raws.before = \"\"\r\n                }\r\n                root.prepend(importRule)\r\n              }\r\n            }\r\n          }\r\n          // Special handling for plugins - place them after imports.\r\n          else if (name === \"plugin\") {\r\n            // Ensure plugin name is quoted if not already.\r\n            let quotedParams = params\r\n            if (params && !params.startsWith('\"') && !params.startsWith(\"'\")) {\r\n              quotedParams = `\"${params}\"`\r\n            }\r\n\r\n            // Normalize params for comparison (remove quotes).\r\n            const normalizeParams = (p: string) => {\r\n              if (p.startsWith('\"') && p.endsWith('\"')) {\r\n                return p.slice(1, -1)\r\n              }\r\n              if (p.startsWith(\"'\") && p.endsWith(\"'\")) {\r\n                return p.slice(1, -1)\r\n              }\r\n              return p\r\n            }\r\n\r\n            // Find existing plugin with same normalized params.\r\n            const existingPlugin = root.nodes?.find((node): node is AtRule => {\r\n              if (node.type !== \"atrule\" || node.name !== \"plugin\") {\r\n                return false\r\n              }\r\n              return normalizeParams(node.params) === normalizeParams(params)\r\n            })\r\n\r\n            if (!existingPlugin) {\r\n              const pluginRule = postcss.atRule({\r\n                name: \"plugin\",\r\n                params: quotedParams,\r\n                raws: { semicolon: true, before: \"\\n\" },\r\n              })\r\n\r\n              // Find the last import or plugin node to insert after\r\n              const importNodes = root.nodes?.filter(\r\n                (node): node is AtRule =>\r\n                  node.type === \"atrule\" && node.name === \"import\"\r\n              )\r\n\r\n              const pluginNodes = root.nodes?.filter(\r\n                (node): node is AtRule =>\r\n                  node.type === \"atrule\" && node.name === \"plugin\"\r\n              )\r\n\r\n              if (pluginNodes && pluginNodes.length > 0) {\r\n                // Insert after the last existing plugin\r\n                const lastPlugin = pluginNodes[pluginNodes.length - 1]\r\n                root.insertAfter(lastPlugin, pluginRule)\r\n              } else if (importNodes && importNodes.length > 0) {\r\n                // Insert after the last import if no plugins exist\r\n                const lastImport = importNodes[importNodes.length - 1]\r\n                root.insertAfter(lastImport, pluginRule)\r\n                // Add a break comment before the first plugin to create spacing\r\n                root.insertBefore(\r\n                  pluginRule,\r\n                  postcss.comment({ text: \"---break---\" })\r\n                )\r\n                // Add a break comment after the plugin for spacing from other content\r\n                root.insertAfter(\r\n                  pluginRule,\r\n                  postcss.comment({ text: \"---break---\" })\r\n                )\r\n              } else {\r\n                // If no imports or plugins, insert at the beginning\r\n                root.prepend(pluginRule)\r\n                // Add a break comment before the first plugin for spacing\r\n                root.insertBefore(\r\n                  pluginRule,\r\n                  postcss.comment({ text: \"---break---\" })\r\n                )\r\n                // Add a break comment after the plugin for spacing from other content\r\n                root.insertAfter(\r\n                  pluginRule,\r\n                  postcss.comment({ text: \"---break---\" })\r\n                )\r\n              }\r\n            }\r\n          }\r\n          // Check if this is any at-rule with no body (empty object).\r\n          else if (\r\n            typeof properties === \"object\" &&\r\n            Object.keys(properties).length === 0\r\n          ) {\r\n            // Handle any at-rule with no body (e.g., @apply, @tailwind, etc.).\r\n            const atRule = root.nodes?.find(\r\n              (node): node is AtRule =>\r\n                node.type === \"atrule\" &&\r\n                node.name === name &&\r\n                node.params === params\r\n            ) as AtRule | undefined\r\n\r\n            if (!atRule) {\r\n              const newAtRule = postcss.atRule({\r\n                name,\r\n                params,\r\n                raws: { semicolon: true },\r\n              })\r\n\r\n              root.append(newAtRule)\r\n              root.insertBefore(\r\n                newAtRule,\r\n                postcss.comment({ text: \"---break---\" })\r\n              )\r\n            }\r\n          }\r\n          // Special handling for keyframes - place them under @theme inline.\r\n          else if (name === \"keyframes\") {\r\n            let themeInline = root.nodes?.find(\r\n              (node): node is AtRule =>\r\n                node.type === \"atrule\" &&\r\n                node.name === \"theme\" &&\r\n                node.params === \"inline\"\r\n            ) as AtRule | undefined\r\n\r\n            if (!themeInline) {\r\n              themeInline = postcss.atRule({\r\n                name: \"theme\",\r\n                params: \"inline\",\r\n                raws: { semicolon: true, between: \" \", before: \"\\n\" },\r\n              })\r\n              root.append(themeInline)\r\n              root.insertBefore(\r\n                themeInline,\r\n                postcss.comment({ text: \"---break---\" })\r\n              )\r\n            }\r\n\r\n            const keyframesRule = postcss.atRule({\r\n              name: \"keyframes\",\r\n              params,\r\n              raws: { semicolon: true, between: \" \", before: \"\\n  \" },\r\n            })\r\n\r\n            themeInline.append(keyframesRule)\r\n\r\n            if (typeof properties === \"object\") {\r\n              for (const [step, stepProps] of Object.entries(properties)) {\r\n                processRule(keyframesRule, step, stepProps)\r\n              }\r\n            }\r\n          }\r\n          // Special handling for utility classes to preserve property values\r\n          else if (name === \"utility\") {\r\n            const utilityAtRule = root.nodes?.find(\r\n              (node): node is AtRule =>\r\n                node.type === \"atrule\" &&\r\n                node.name === name &&\r\n                node.params === params\r\n            ) as AtRule | undefined\r\n\r\n            if (!utilityAtRule) {\r\n              const atRule = postcss.atRule({\r\n                name,\r\n                params,\r\n                raws: { semicolon: true, between: \" \", before: \"\\n\" },\r\n              })\r\n\r\n              root.append(atRule)\r\n              root.insertBefore(\r\n                atRule,\r\n                postcss.comment({ text: \"---break---\" })\r\n              )\r\n\r\n              // Add declarations with their values preserved\r\n              if (typeof properties === \"object\") {\r\n                for (const [prop, value] of Object.entries(properties)) {\r\n                  if (typeof value === \"string\") {\r\n                    const decl = postcss.decl({\r\n                      prop,\r\n                      value: value,\r\n                      raws: { semicolon: true, before: \"\\n    \" },\r\n                    })\r\n                    atRule.append(decl)\r\n                  } else if (typeof value === \"object\") {\r\n                    processRule(atRule, prop, value)\r\n                  }\r\n                }\r\n              }\r\n            } else {\r\n              // Update existing utility class\r\n              if (typeof properties === \"object\") {\r\n                for (const [prop, value] of Object.entries(properties)) {\r\n                  if (typeof value === \"string\") {\r\n                    const existingDecl = utilityAtRule.nodes?.find(\r\n                      (node): node is Declaration =>\r\n                        node.type === \"decl\" && node.prop === prop\r\n                    )\r\n\r\n                    const decl = postcss.decl({\r\n                      prop,\r\n                      value: value,\r\n                      raws: { semicolon: true, before: \"\\n    \" },\r\n                    })\r\n\r\n                    existingDecl\r\n                      ? existingDecl.replaceWith(decl)\r\n                      : utilityAtRule.append(decl)\r\n                  } else if (typeof value === \"object\") {\r\n                    processRule(utilityAtRule, prop, value)\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n          // Handle at-property as regular CSS rules\r\n          else if (name === \"property\") {\r\n            processRule(root, selector, properties)\r\n          } else {\r\n            // Handle other at-rules normally\r\n            processAtRule(root, name, params, properties)\r\n          }\r\n        } else {\r\n          // Handle regular CSS rules\r\n          processRule(root, selector, properties)\r\n        }\r\n      }\r\n    },\r\n  }\r\n}\r\n\r\nfunction processAtRule(\r\n  root: Root | AtRule,\r\n  name: string,\r\n  params: string,\r\n  properties: any\r\n) {\r\n  // Find or create the at-rule\r\n  let atRule = root.nodes?.find(\r\n    (node): node is AtRule =>\r\n      node.type === \"atrule\" && node.name === name && node.params === params\r\n  ) as AtRule | undefined\r\n\r\n  if (!atRule) {\r\n    atRule = postcss.atRule({\r\n      name,\r\n      params,\r\n      raws: { semicolon: true, between: \" \", before: \"\\n\" },\r\n    })\r\n    root.append(atRule)\r\n    root.insertBefore(atRule, postcss.comment({ text: \"---break---\" }))\r\n  }\r\n\r\n  // Process children of this at-rule\r\n  if (typeof properties === \"object\") {\r\n    for (const [childSelector, childProps] of Object.entries(properties)) {\r\n      if (childSelector.startsWith(\"@\")) {\r\n        // Nested at-rule\r\n        const nestedMatch = childSelector.match(/@([a-zA-Z-]+)\\s*(.*)/)\r\n        if (nestedMatch) {\r\n          const [, nestedName, nestedParams] = nestedMatch\r\n          processAtRule(atRule, nestedName, nestedParams, childProps)\r\n        }\r\n      } else {\r\n        // CSS rule within at-rule\r\n        processRule(atRule, childSelector, childProps)\r\n      }\r\n    }\r\n  } else if (typeof properties === \"string\") {\r\n    // Direct string content for the at-rule\r\n    try {\r\n      // Parse the CSS string with PostCSS\r\n      const parsed = postcss.parse(`.temp{${properties}}`)\r\n      const tempRule = parsed.first as Rule\r\n\r\n      if (tempRule && tempRule.nodes) {\r\n        // Create a rule for the at-rule if needed\r\n        const rule = postcss.rule({\r\n          selector: \"temp\",\r\n          raws: { semicolon: true, between: \" \", before: \"\\n  \" },\r\n        })\r\n\r\n        // Copy all declarations from the temp rule to our actual rule\r\n        tempRule.nodes.forEach((node) => {\r\n          if (node.type === \"decl\") {\r\n            const clone = node.clone()\r\n            clone.raws.before = \"\\n    \"\r\n            rule.append(clone)\r\n          }\r\n        })\r\n\r\n        // Only add the rule if it has declarations\r\n        if (rule.nodes?.length) {\r\n          atRule.append(rule)\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error parsing at-rule content:\", properties, error)\r\n      throw error\r\n    }\r\n  }\r\n}\r\n\r\nfunction processRule(parent: Root | AtRule, selector: string, properties: any) {\r\n  let rule = parent.nodes?.find(\r\n    (node): node is Rule => node.type === \"rule\" && node.selector === selector\r\n  ) as Rule | undefined\r\n\r\n  if (!rule) {\r\n    rule = postcss.rule({\r\n      selector,\r\n      raws: { semicolon: true, between: \" \", before: \"\\n  \" },\r\n    })\r\n    parent.append(rule)\r\n  }\r\n\r\n  if (typeof properties === \"object\") {\r\n    for (const [prop, value] of Object.entries(properties)) {\r\n      // Check if this is any at-rule with empty object (no body).\r\n      if (\r\n        prop.startsWith(\"@\") &&\r\n        typeof value === \"object\" &&\r\n        value !== null &&\r\n        Object.keys(value).length === 0\r\n      ) {\r\n        // Parse the at-rule.\r\n        const atRuleMatch = prop.match(/@([a-zA-Z-]+)\\s*(.*)/)\r\n        if (atRuleMatch) {\r\n          const [, atRuleName, atRuleParams] = atRuleMatch\r\n          const atRule = postcss.atRule({\r\n            name: atRuleName,\r\n            params: atRuleParams,\r\n            raws: { semicolon: true, before: \"\\n    \" },\r\n          })\r\n          rule.append(atRule)\r\n        }\r\n      } else if (typeof value === \"string\") {\r\n        const decl = postcss.decl({\r\n          prop,\r\n          value: value,\r\n          raws: { semicolon: true, before: \"\\n    \" },\r\n        })\r\n\r\n        // Replace existing property or add new one.\r\n        const existingDecl = rule.nodes?.find(\r\n          (node): node is Declaration =>\r\n            node.type === \"decl\" && node.prop === prop\r\n        )\r\n\r\n        existingDecl ? existingDecl.replaceWith(decl) : rule.append(decl)\r\n      } else if (typeof value === \"object\") {\r\n        // Nested selector (including & selectors).\r\n        const nestedSelector = prop.startsWith(\"&\")\r\n          ? selector.replace(/^([^:]+)/, `$1${prop.substring(1)}`)\r\n          : prop // Use the original selector for other nested elements.\r\n        processRule(parent, nestedSelector, value)\r\n      }\r\n    }\r\n  } else if (typeof properties === \"string\") {\r\n    // Direct string content for the rule\r\n    try {\r\n      // Parse the CSS string with PostCSS\r\n      const parsed = postcss.parse(`.temp{${properties}}`)\r\n      const tempRule = parsed.first as Rule\r\n\r\n      if (tempRule && tempRule.nodes) {\r\n        // Copy all declarations from the temp rule to our actual rule\r\n        tempRule.nodes.forEach((node) => {\r\n          if (node.type === \"decl\") {\r\n            const clone = node.clone()\r\n            clone.raws.before = \"\\n    \"\r\n            rule?.append(clone)\r\n          }\r\n        })\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error parsing rule content:\", selector, properties, error)\r\n      throw error\r\n    }\r\n  }\r\n}\r\n","import {\r\n  registryItemCssVarsSchema,\r\n  registryItemTailwindSchema,\r\n} from \"@/src/schema\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\nimport { getPackageInfo } from \"@/src/utils/get-package-info\"\r\nimport { TailwindVersion } from \"@/src/utils/get-project-info\"\r\nimport { highlighter } from \"@/src/utils/highlighter\"\r\nimport { spinner } from \"@/src/utils/spinner\"\r\nimport { promises as fs } from \"fs\"\r\nimport path from \"path\"\r\nimport postcss from \"postcss\"\r\nimport AtRule from \"postcss/lib/at-rule\"\r\nimport Root from \"postcss/lib/root\"\r\nimport Rule from \"postcss/lib/rule\"\r\nimport { z } from \"zod\"\r\n\r\nexport async function updateCssVars(\r\n  cssVars: z.infer<typeof registryItemCssVarsSchema> | undefined,\r\n  config: Config,\r\n  options: {\r\n    cleanupDefaultNextStyles?: boolean\r\n    overwriteCssVars?: boolean\r\n    initIndex?: boolean\r\n    silent?: boolean\r\n    tailwindVersion?: TailwindVersion\r\n    tailwindConfig?: z.infer<typeof registryItemTailwindSchema>[\"config\"]\r\n  }\r\n) {\r\n  if (!config.resolvedPaths.tailwindCss || !Object.keys(cssVars ?? {}).length) {\r\n    return\r\n  }\r\n\r\n  options = {\r\n    cleanupDefaultNextStyles: false,\r\n    silent: false,\r\n    tailwindVersion: \"v3\",\r\n    overwriteCssVars: false,\r\n    initIndex: true,\r\n    ...options,\r\n  }\r\n  const cssFilepath = config.resolvedPaths.tailwindCss\r\n  const cssFilepathRelative = path.relative(\r\n    config.resolvedPaths.cwd,\r\n    cssFilepath\r\n  )\r\n  const cssVarsSpinner = spinner(\r\n    `Updating CSS variables in ${highlighter.info(cssFilepathRelative)}`,\r\n    {\r\n      silent: options.silent,\r\n    }\r\n  ).start()\r\n  const raw = await fs.readFile(cssFilepath, \"utf8\")\r\n  let output = await transformCssVars(raw, cssVars ?? {}, config, {\r\n    cleanupDefaultNextStyles: options.cleanupDefaultNextStyles,\r\n    tailwindVersion: options.tailwindVersion,\r\n    tailwindConfig: options.tailwindConfig,\r\n    overwriteCssVars: options.overwriteCssVars,\r\n    initIndex: options.initIndex,\r\n  })\r\n  await fs.writeFile(cssFilepath, output, \"utf8\")\r\n  cssVarsSpinner.succeed()\r\n}\r\n\r\nexport async function transformCssVars(\r\n  input: string,\r\n  cssVars: z.infer<typeof registryItemCssVarsSchema>,\r\n  config: Config,\r\n  options: {\r\n    cleanupDefaultNextStyles?: boolean\r\n    tailwindVersion?: TailwindVersion\r\n    tailwindConfig?: z.infer<typeof registryItemTailwindSchema>[\"config\"]\r\n    overwriteCssVars?: boolean\r\n    initIndex?: boolean\r\n  } = {\r\n    cleanupDefaultNextStyles: false,\r\n    tailwindVersion: \"v3\",\r\n    tailwindConfig: undefined,\r\n    overwriteCssVars: false,\r\n    initIndex: true,\r\n  }\r\n) {\r\n  options = {\r\n    cleanupDefaultNextStyles: false,\r\n    tailwindVersion: \"v3\",\r\n    tailwindConfig: undefined,\r\n    overwriteCssVars: false,\r\n    initIndex: true,\r\n    ...options,\r\n  }\r\n\r\n  let plugins = [updateCssVarsPlugin(cssVars)]\r\n\r\n  if (options.cleanupDefaultNextStyles) {\r\n    plugins.push(cleanupDefaultNextStylesPlugin())\r\n  }\r\n\r\n  if (options.tailwindVersion === \"v4\") {\r\n    plugins = []\r\n\r\n    // Only add tw-animate-css if project does not have tailwindcss-animate\r\n    if (config.resolvedPaths?.cwd) {\r\n      const packageInfo = getPackageInfo(config.resolvedPaths.cwd)\r\n      if (\r\n        !packageInfo?.dependencies?.[\"tailwindcss-animate\"] &&\r\n        !packageInfo?.devDependencies?.[\"tailwindcss-animate\"] &&\r\n        options.initIndex\r\n      ) {\r\n        plugins.push(addCustomImport({ params: \"tw-animate-css\" }))\r\n      }\r\n    }\r\n\r\n    plugins.push(addCustomVariant({ params: \"dark (&:is(.dark *))\" }))\r\n\r\n    if (options.cleanupDefaultNextStyles) {\r\n      plugins.push(cleanupDefaultNextStylesPlugin())\r\n    }\r\n\r\n    plugins.push(\r\n      updateCssVarsPluginV4(cssVars, {\r\n        overwriteCssVars: options.overwriteCssVars,\r\n      })\r\n    )\r\n    plugins.push(updateThemePlugin(cssVars))\r\n\r\n    if (options.tailwindConfig) {\r\n      plugins.push(updateTailwindConfigPlugin(options.tailwindConfig))\r\n      plugins.push(updateTailwindConfigAnimationPlugin(options.tailwindConfig))\r\n      plugins.push(updateTailwindConfigKeyframesPlugin(options.tailwindConfig))\r\n    }\r\n  }\r\n\r\n  if (config.tailwind.cssVariables && options.initIndex) {\r\n    plugins.push(\r\n      updateBaseLayerPlugin({ tailwindVersion: options.tailwindVersion })\r\n    )\r\n  }\r\n\r\n  const result = await postcss(plugins).process(input, {\r\n    from: undefined,\r\n  })\r\n\r\n  let output = result.css\r\n\r\n  output = output.replace(/\\/\\* ---break--- \\*\\//g, \"\")\r\n\r\n  if (options.tailwindVersion === \"v4\") {\r\n    output = output.replace(/(\\n\\s*\\n)+/g, \"\\n\\n\")\r\n  }\r\n\r\n  return output\r\n}\r\n\r\nfunction updateBaseLayerPlugin({\r\n  tailwindVersion,\r\n}: {\r\n  tailwindVersion?: TailwindVersion\r\n}) {\r\n  return {\r\n    postcssPlugin: \"update-base-layer\",\r\n    Once(root: Root) {\r\n      const requiredRules = [\r\n        {\r\n          selector: \"*\",\r\n          apply:\r\n            tailwindVersion === \"v4\"\r\n              ? \"border-border outline-ring/50\"\r\n              : \"border-border\",\r\n        },\r\n        { selector: \"body\", apply: \"bg-background text-foreground\" },\r\n      ]\r\n\r\n      let baseLayer = root.nodes.find(\r\n        (node): node is AtRule =>\r\n          node.type === \"atrule\" &&\r\n          node.name === \"layer\" &&\r\n          node.params === \"base\" &&\r\n          requiredRules.every(({ selector, apply }) =>\r\n            node.nodes?.some(\r\n              (rule): rule is Rule =>\r\n                rule.type === \"rule\" &&\r\n                rule.selector === selector &&\r\n                rule.nodes.some(\r\n                  (applyRule): applyRule is AtRule =>\r\n                    applyRule.type === \"atrule\" &&\r\n                    applyRule.name === \"apply\" &&\r\n                    applyRule.params === apply\r\n                )\r\n            )\r\n          )\r\n      ) as AtRule | undefined\r\n\r\n      if (!baseLayer) {\r\n        baseLayer = postcss.atRule({\r\n          name: \"layer\",\r\n          params: \"base\",\r\n          raws: { semicolon: true, between: \" \", before: \"\\n\" },\r\n        })\r\n        root.append(baseLayer)\r\n        root.insertBefore(baseLayer, postcss.comment({ text: \"---break---\" }))\r\n      }\r\n\r\n      requiredRules.forEach(({ selector, apply }) => {\r\n        const existingRule = baseLayer?.nodes?.find(\r\n          (node): node is Rule =>\r\n            node.type === \"rule\" && node.selector === selector\r\n        )\r\n\r\n        if (!existingRule) {\r\n          baseLayer?.append(\r\n            postcss.rule({\r\n              selector,\r\n              nodes: [\r\n                postcss.atRule({\r\n                  name: \"apply\",\r\n                  params: apply,\r\n                  raws: { semicolon: true, before: \"\\n    \" },\r\n                }),\r\n              ],\r\n              raws: { semicolon: true, between: \" \", before: \"\\n  \" },\r\n            })\r\n          )\r\n        }\r\n      })\r\n    },\r\n  }\r\n}\r\n\r\nfunction updateCssVarsPlugin(\r\n  cssVars: z.infer<typeof registryItemCssVarsSchema>\r\n) {\r\n  return {\r\n    postcssPlugin: \"update-css-vars\",\r\n    Once(root: Root) {\r\n      let baseLayer = root.nodes.find(\r\n        (node) =>\r\n          node.type === \"atrule\" &&\r\n          node.name === \"layer\" &&\r\n          node.params === \"base\"\r\n      ) as AtRule | undefined\r\n\r\n      if (!(baseLayer instanceof AtRule)) {\r\n        baseLayer = postcss.atRule({\r\n          name: \"layer\",\r\n          params: \"base\",\r\n          nodes: [],\r\n          raws: {\r\n            semicolon: true,\r\n            before: \"\\n\",\r\n            between: \" \",\r\n          },\r\n        })\r\n        root.append(baseLayer)\r\n        root.insertBefore(baseLayer, postcss.comment({ text: \"---break---\" }))\r\n      }\r\n\r\n      if (baseLayer !== undefined) {\r\n        // Add variables for each key in cssVars\r\n        Object.entries(cssVars).forEach(([key, vars]) => {\r\n          const selector = key === \"light\" ? \":root\" : `.${key}`\r\n          // TODO: Fix typecheck.\r\n          addOrUpdateVars(baseLayer as AtRule, selector, vars)\r\n        })\r\n      }\r\n    },\r\n  }\r\n}\r\n\r\nfunction removeConflictVars(root: Rule | Root) {\r\n  const rootRule = root.nodes.find(\r\n    (node): node is Rule => node.type === \"rule\" && node.selector === \":root\"\r\n  )\r\n\r\n  if (rootRule) {\r\n    const propsToRemove = [\"--background\", \"--foreground\"]\r\n\r\n    rootRule.nodes\r\n      .filter(\r\n        (node): node is postcss.Declaration =>\r\n          node.type === \"decl\" && propsToRemove.includes(node.prop)\r\n      )\r\n      .forEach((node) => node.remove())\r\n\r\n    if (rootRule.nodes.length === 0) {\r\n      rootRule.remove()\r\n    }\r\n  }\r\n}\r\n\r\nfunction cleanupDefaultNextStylesPlugin() {\r\n  return {\r\n    postcssPlugin: \"cleanup-default-next-styles\",\r\n    Once(root: Root) {\r\n      const bodyRule = root.nodes.find(\r\n        (node): node is Rule => node.type === \"rule\" && node.selector === \"body\"\r\n      )\r\n      if (bodyRule) {\r\n        // Remove color from the body node.\r\n        bodyRule.nodes\r\n          .find(\r\n            (node): node is postcss.Declaration =>\r\n              node.type === \"decl\" &&\r\n              node.prop === \"color\" &&\r\n              [\"rgb(var(--foreground-rgb))\", \"var(--foreground)\"].includes(\r\n                node.value\r\n              )\r\n          )\r\n          ?.remove()\r\n\r\n        // Remove background: linear-gradient.\r\n        bodyRule.nodes\r\n          .find((node): node is postcss.Declaration => {\r\n            return (\r\n              node.type === \"decl\" &&\r\n              node.prop === \"background\" &&\r\n              // This is only going to run on create project, so all good.\r\n              (node.value.startsWith(\"linear-gradient\") ||\r\n                node.value === \"var(--background)\")\r\n            )\r\n          })\r\n          ?.remove()\r\n\r\n        // Remove font-family: Arial, Helvetica, sans-serif;\r\n        bodyRule.nodes\r\n          .find(\r\n            (node): node is postcss.Declaration =>\r\n              node.type === \"decl\" &&\r\n              node.prop === \"font-family\" &&\r\n              node.value === \"Arial, Helvetica, sans-serif\"\r\n          )\r\n          ?.remove()\r\n\r\n        // If the body rule is empty, remove it.\r\n        if (bodyRule.nodes.length === 0) {\r\n          bodyRule.remove()\r\n        }\r\n      }\r\n\r\n      removeConflictVars(root)\r\n\r\n      const darkRootRule = root.nodes.find(\r\n        (node): node is Rule =>\r\n          node.type === \"atrule\" &&\r\n          node.params === \"(prefers-color-scheme: dark)\"\r\n      )\r\n\r\n      if (darkRootRule) {\r\n        removeConflictVars(darkRootRule)\r\n        if (darkRootRule.nodes.length === 0) {\r\n          darkRootRule.remove()\r\n        }\r\n      }\r\n    },\r\n  }\r\n}\r\n\r\nfunction addOrUpdateVars(\r\n  baseLayer: AtRule,\r\n  selector: string,\r\n  vars: Record<string, string>\r\n) {\r\n  let ruleNode = baseLayer.nodes?.find(\r\n    (node): node is Rule => node.type === \"rule\" && node.selector === selector\r\n  )\r\n\r\n  if (!ruleNode) {\r\n    if (Object.keys(vars).length > 0) {\r\n      ruleNode = postcss.rule({\r\n        selector,\r\n        raws: { between: \" \", before: \"\\n  \" },\r\n      })\r\n      baseLayer.append(ruleNode)\r\n    }\r\n  }\r\n\r\n  Object.entries(vars).forEach(([key, value]) => {\r\n    const prop = `--${key.replace(/^--/, \"\")}`\r\n    const newDecl = postcss.decl({\r\n      prop,\r\n      value,\r\n      raws: { semicolon: true },\r\n    })\r\n\r\n    const existingDecl = ruleNode?.nodes.find(\r\n      (node): node is postcss.Declaration =>\r\n        node.type === \"decl\" && node.prop === prop\r\n    )\r\n\r\n    existingDecl ? existingDecl.replaceWith(newDecl) : ruleNode?.append(newDecl)\r\n  })\r\n}\r\n\r\nfunction updateCssVarsPluginV4(\r\n  cssVars: z.infer<typeof registryItemCssVarsSchema>,\r\n  options: {\r\n    overwriteCssVars?: boolean\r\n  }\r\n) {\r\n  return {\r\n    postcssPlugin: \"update-css-vars-v4\",\r\n    Once(root: Root) {\r\n      Object.entries(cssVars).forEach(([key, vars]) => {\r\n        let selector = key === \"light\" ? \":root\" : `.${key}`\r\n\r\n        if (key === \"theme\") {\r\n          selector = \"@theme\"\r\n          const themeNode = upsertThemeNode(root)\r\n          Object.entries(vars).forEach(([key, value]) => {\r\n            const prop = `--${key.replace(/^--/, \"\")}`\r\n            const newDecl = postcss.decl({\r\n              prop,\r\n              value,\r\n              raws: { semicolon: true },\r\n            })\r\n\r\n            const existingDecl = themeNode?.nodes?.find(\r\n              (node): node is postcss.Declaration =>\r\n                node.type === \"decl\" && node.prop === prop\r\n            )\r\n\r\n            // Only overwrite if overwriteCssVars is true\r\n            // i.e for registry:theme and registry:style\r\n            // We do not want new components to overwrite existing vars.\r\n            // Keep user defined vars.\r\n            if (options.overwriteCssVars) {\r\n              if (existingDecl) {\r\n                existingDecl.replaceWith(newDecl)\r\n              } else {\r\n                themeNode?.append(newDecl)\r\n              }\r\n            } else {\r\n              if (!existingDecl) {\r\n                themeNode?.append(newDecl)\r\n              }\r\n            }\r\n          })\r\n          return\r\n        }\r\n\r\n        let ruleNode = root.nodes?.find(\r\n          (node): node is Rule =>\r\n            node.type === \"rule\" && node.selector === selector\r\n        )\r\n\r\n        if (!ruleNode && Object.keys(vars).length > 0) {\r\n          ruleNode = postcss.rule({\r\n            selector,\r\n            nodes: [],\r\n            raws: { semicolon: true, between: \" \", before: \"\\n\" },\r\n          })\r\n          root.append(ruleNode)\r\n          root.insertBefore(ruleNode, postcss.comment({ text: \"---break---\" }))\r\n        }\r\n\r\n        Object.entries(vars).forEach(([key, value]) => {\r\n          let prop = `--${key.replace(/^--/, \"\")}`\r\n\r\n          // Special case for sidebar-background.\r\n          if (prop === \"--sidebar-background\") {\r\n            prop = \"--sidebar\"\r\n          }\r\n\r\n          if (isLocalHSLValue(value)) {\r\n            value = `hsl(${value})`\r\n          }\r\n\r\n          const newDecl = postcss.decl({\r\n            prop,\r\n            value,\r\n            raws: { semicolon: true },\r\n          })\r\n          const existingDecl = ruleNode?.nodes.find(\r\n            (node): node is postcss.Declaration =>\r\n              node.type === \"decl\" && node.prop === prop\r\n          )\r\n\r\n          // Only overwrite if overwriteCssVars is true\r\n          // i.e for registry:theme and registry:style\r\n          // We do not want new components to overwrite existing vars.\r\n          // Keep user defined vars.\r\n          if (options.overwriteCssVars) {\r\n            if (existingDecl) {\r\n              existingDecl.replaceWith(newDecl)\r\n            } else {\r\n              ruleNode?.append(newDecl)\r\n            }\r\n          } else {\r\n            if (!existingDecl) {\r\n              ruleNode?.append(newDecl)\r\n            }\r\n          }\r\n        })\r\n      })\r\n    },\r\n  }\r\n}\r\n\r\nfunction updateThemePlugin(cssVars: z.infer<typeof registryItemCssVarsSchema>) {\r\n  return {\r\n    postcssPlugin: \"update-theme\",\r\n    Once(root: Root) {\r\n      // Find unique color names from light and dark.\r\n      const variables = Array.from(\r\n        new Set(\r\n          Object.keys(cssVars).flatMap((key) =>\r\n            Object.keys(cssVars[key as keyof typeof cssVars] || {})\r\n          )\r\n        )\r\n      )\r\n\r\n      if (!variables.length) {\r\n        return\r\n      }\r\n\r\n      const themeNode = upsertThemeNode(root)\r\n\r\n      const themeVarNodes = themeNode.nodes?.filter(\r\n        (node): node is postcss.Declaration =>\r\n          node.type === \"decl\" && node.prop.startsWith(\"--\")\r\n      )\r\n\r\n      for (const variable of variables) {\r\n        const value = Object.values(cssVars).find((vars) => vars[variable])?.[\r\n          variable\r\n        ]\r\n\r\n        if (!value) {\r\n          continue\r\n        }\r\n\r\n        if (variable === \"radius\") {\r\n          const radiusVariables = {\r\n            sm: \"calc(var(--radius) - 4px)\",\r\n            md: \"calc(var(--radius) - 2px)\",\r\n            lg: \"var(--radius)\",\r\n            xl: \"calc(var(--radius) + 4px)\",\r\n          }\r\n          for (const [key, value] of Object.entries(radiusVariables)) {\r\n            const cssVarNode = postcss.decl({\r\n              prop: `--radius-${key}`,\r\n              value,\r\n              raws: { semicolon: true },\r\n            })\r\n            if (\r\n              themeNode?.nodes?.find(\r\n                (node): node is postcss.Declaration =>\r\n                  node.type === \"decl\" && node.prop === cssVarNode.prop\r\n              )\r\n            ) {\r\n              continue\r\n            }\r\n            themeNode?.append(cssVarNode)\r\n          }\r\n          continue\r\n        }\r\n\r\n        let prop =\r\n          isLocalHSLValue(value) || isColorValue(value)\r\n            ? `--color-${variable.replace(/^--/, \"\")}`\r\n            : `--${variable.replace(/^--/, \"\")}`\r\n        if (prop === \"--color-sidebar-background\") {\r\n          prop = \"--color-sidebar\"\r\n        }\r\n\r\n        let propValue = `var(--${variable})`\r\n        if (prop === \"--color-sidebar\") {\r\n          propValue = \"var(--sidebar)\"\r\n        }\r\n\r\n        const cssVarNode = postcss.decl({\r\n          prop,\r\n          value: propValue,\r\n          raws: { semicolon: true },\r\n        })\r\n        const existingDecl = themeNode?.nodes?.find(\r\n          (node): node is postcss.Declaration =>\r\n            node.type === \"decl\" && node.prop === cssVarNode.prop\r\n        )\r\n        if (!existingDecl) {\r\n          if (themeVarNodes?.length) {\r\n            themeNode?.insertAfter(\r\n              themeVarNodes[themeVarNodes.length - 1],\r\n              cssVarNode\r\n            )\r\n          } else {\r\n            themeNode?.append(cssVarNode)\r\n          }\r\n        }\r\n      }\r\n    },\r\n  }\r\n}\r\n\r\nfunction upsertThemeNode(root: Root): AtRule {\r\n  let themeNode = root.nodes.find(\r\n    (node): node is AtRule =>\r\n      node.type === \"atrule\" &&\r\n      node.name === \"theme\" &&\r\n      node.params === \"inline\"\r\n  )\r\n\r\n  if (!themeNode) {\r\n    themeNode = postcss.atRule({\r\n      name: \"theme\",\r\n      params: \"inline\",\r\n      nodes: [],\r\n      raws: { semicolon: true, between: \" \", before: \"\\n\" },\r\n    })\r\n    root.append(themeNode)\r\n    root.insertBefore(themeNode, postcss.comment({ text: \"---break---\" }))\r\n  }\r\n\r\n  return themeNode\r\n}\r\n\r\nfunction addCustomVariant({ params }: { params: string }) {\r\n  return {\r\n    postcssPlugin: \"add-custom-variant\",\r\n    Once(root: Root) {\r\n      const customVariant = root.nodes.find(\r\n        (node): node is AtRule =>\r\n          node.type === \"atrule\" && node.name === \"custom-variant\"\r\n      )\r\n\r\n      if (!customVariant) {\r\n        // Find all import nodes\r\n        const importNodes = root.nodes.filter(\r\n          (node): node is AtRule =>\r\n            node.type === \"atrule\" && node.name === \"import\"\r\n        )\r\n\r\n        const variantNode = postcss.atRule({\r\n          name: \"custom-variant\",\r\n          params,\r\n          raws: { semicolon: true, before: \"\\n\" },\r\n        })\r\n\r\n        if (importNodes.length > 0) {\r\n          // Insert after the last import\r\n          const lastImport = importNodes[importNodes.length - 1]\r\n          root.insertAfter(lastImport, variantNode)\r\n        } else {\r\n          // If no imports, insert after the first node\r\n          root.insertAfter(root.nodes[0], variantNode)\r\n        }\r\n\r\n        root.insertBefore(variantNode, postcss.comment({ text: \"---break---\" }))\r\n      }\r\n    },\r\n  }\r\n}\r\n\r\nfunction addCustomImport({ params }: { params: string }) {\r\n  return {\r\n    postcssPlugin: \"add-custom-import\",\r\n    Once(root: Root) {\r\n      const importNodes = root.nodes.filter(\r\n        (node): node is AtRule =>\r\n          node.type === \"atrule\" && node.name === \"import\"\r\n      )\r\n\r\n      // Find custom variant node (to ensure we insert before it)\r\n      const customVariantNode = root.nodes.find(\r\n        (node): node is AtRule =>\r\n          node.type === \"atrule\" && node.name === \"custom-variant\"\r\n      )\r\n\r\n      // Check if our specific import already exists\r\n      const hasImport = importNodes.some(\r\n        (node) => node.params.replace(/[\"']/g, \"\") === params\r\n      )\r\n\r\n      if (!hasImport) {\r\n        const importNode = postcss.atRule({\r\n          name: \"import\",\r\n          params: `\"${params}\"`,\r\n          raws: { semicolon: true, before: \"\\n\" },\r\n        })\r\n\r\n        if (importNodes.length > 0) {\r\n          // If there are existing imports, add after the last import\r\n          const lastImport = importNodes[importNodes.length - 1]\r\n          root.insertAfter(lastImport, importNode)\r\n        } else if (customVariantNode) {\r\n          // If no imports but has custom-variant, insert before it\r\n          root.insertBefore(customVariantNode, importNode)\r\n          root.insertBefore(\r\n            customVariantNode,\r\n            postcss.comment({ text: \"---break---\" })\r\n          )\r\n        } else {\r\n          // If no imports and no custom-variant, insert at the start\r\n          root.prepend(importNode)\r\n          root.insertAfter(importNode, postcss.comment({ text: \"---break---\" }))\r\n        }\r\n      }\r\n    },\r\n  }\r\n}\r\n\r\nfunction updateTailwindConfigPlugin(\r\n  tailwindConfig: z.infer<typeof registryItemTailwindSchema>[\"config\"]\r\n) {\r\n  return {\r\n    postcssPlugin: \"update-tailwind-config\",\r\n    Once(root: Root) {\r\n      if (!tailwindConfig?.plugins) {\r\n        return\r\n      }\r\n\r\n      const quoteType = getQuoteType(root)\r\n      const quote = quoteType === \"single\" ? \"'\" : '\"'\r\n\r\n      const pluginNodes = root.nodes.filter(\r\n        (node): node is AtRule =>\r\n          node.type === \"atrule\" && node.name === \"plugin\"\r\n      )\r\n\r\n      const lastPluginNode =\r\n        pluginNodes[pluginNodes.length - 1] || root.nodes[0]\r\n\r\n      for (const plugin of tailwindConfig.plugins) {\r\n        const pluginName = plugin.replace(/^require\\([\"']|[\"']\\)$/g, \"\")\r\n\r\n        // Check if the plugin is already present.\r\n        if (\r\n          pluginNodes.some((node) => {\r\n            return node.params.replace(/[\"']/g, \"\") === pluginName\r\n          })\r\n        ) {\r\n          continue\r\n        }\r\n\r\n        const pluginNode = postcss.atRule({\r\n          name: \"plugin\",\r\n          params: `${quote}${pluginName}${quote}`,\r\n          raws: { semicolon: true, before: \"\\n\" },\r\n        })\r\n        root.insertAfter(lastPluginNode, pluginNode)\r\n        root.insertBefore(pluginNode, postcss.comment({ text: \"---break---\" }))\r\n      }\r\n    },\r\n  }\r\n}\r\n\r\nfunction updateTailwindConfigKeyframesPlugin(\r\n  tailwindConfig: z.infer<typeof registryItemTailwindSchema>[\"config\"]\r\n) {\r\n  return {\r\n    postcssPlugin: \"update-tailwind-config-keyframes\",\r\n    Once(root: Root) {\r\n      if (!tailwindConfig?.theme?.extend?.keyframes) {\r\n        return\r\n      }\r\n\r\n      const themeNode = upsertThemeNode(root)\r\n      const existingKeyFrameNodes = themeNode.nodes?.filter(\r\n        (node): node is AtRule =>\r\n          node.type === \"atrule\" && node.name === \"keyframes\"\r\n      )\r\n\r\n      const keyframeValueSchema = z.record(\r\n        z.string(),\r\n        z.record(z.string(), z.string())\r\n      )\r\n\r\n      for (const [keyframeName, keyframeValue] of Object.entries(\r\n        tailwindConfig.theme.extend.keyframes\r\n      )) {\r\n        if (typeof keyframeName !== \"string\") {\r\n          continue\r\n        }\r\n\r\n        const parsedKeyframeValue = keyframeValueSchema.safeParse(keyframeValue)\r\n\r\n        if (!parsedKeyframeValue.success) {\r\n          continue\r\n        }\r\n\r\n        if (\r\n          existingKeyFrameNodes?.find(\r\n            (node): node is postcss.AtRule =>\r\n              node.type === \"atrule\" &&\r\n              node.name === \"keyframes\" &&\r\n              node.params === keyframeName\r\n          )\r\n        ) {\r\n          continue\r\n        }\r\n\r\n        const keyframeNode = postcss.atRule({\r\n          name: \"keyframes\",\r\n          params: keyframeName,\r\n          nodes: [],\r\n          raws: { semicolon: true, between: \" \", before: \"\\n  \" },\r\n        })\r\n\r\n        for (const [key, values] of Object.entries(parsedKeyframeValue.data)) {\r\n          const rule = postcss.rule({\r\n            selector: key,\r\n            nodes: Object.entries(values).map(([key, value]) =>\r\n              postcss.decl({\r\n                prop: key,\r\n                value,\r\n                raws: { semicolon: true, before: \"\\n      \", between: \": \" },\r\n              })\r\n            ),\r\n            raws: { semicolon: true, between: \" \", before: \"\\n    \" },\r\n          })\r\n          keyframeNode.append(rule)\r\n        }\r\n\r\n        themeNode.append(keyframeNode)\r\n        themeNode.insertBefore(\r\n          keyframeNode,\r\n          postcss.comment({ text: \"---break---\" })\r\n        )\r\n      }\r\n    },\r\n  }\r\n}\r\n\r\nfunction updateTailwindConfigAnimationPlugin(\r\n  tailwindConfig: z.infer<typeof registryItemTailwindSchema>[\"config\"]\r\n) {\r\n  return {\r\n    postcssPlugin: \"update-tailwind-config-animation\",\r\n    Once(root: Root) {\r\n      if (!tailwindConfig?.theme?.extend?.animation) {\r\n        return\r\n      }\r\n\r\n      const themeNode = upsertThemeNode(root)\r\n      const existingAnimationNodes = themeNode.nodes?.filter(\r\n        (node): node is postcss.Declaration =>\r\n          node.type === \"decl\" && node.prop.startsWith(\"--animate-\")\r\n      )\r\n\r\n      const parsedAnimationValue = z\r\n        .record(z.string(), z.string())\r\n        .safeParse(tailwindConfig.theme.extend.animation)\r\n      if (!parsedAnimationValue.success) {\r\n        return\r\n      }\r\n\r\n      for (const [key, value] of Object.entries(parsedAnimationValue.data)) {\r\n        const prop = `--animate-${key}`\r\n        if (\r\n          existingAnimationNodes?.find(\r\n            (node): node is postcss.Declaration => node.prop === prop\r\n          )\r\n        ) {\r\n          continue\r\n        }\r\n\r\n        const animationNode = postcss.decl({\r\n          prop,\r\n          value,\r\n          raws: { semicolon: true, between: \": \", before: \"\\n  \" },\r\n        })\r\n        themeNode.append(animationNode)\r\n      }\r\n    },\r\n  }\r\n}\r\n\r\nfunction getQuoteType(root: Root): \"single\" | \"double\" {\r\n  const firstNode = root.nodes[0]\r\n  const raw = firstNode.toString()\r\n\r\n  if (raw.includes(\"'\")) {\r\n    return \"single\"\r\n  }\r\n  return \"double\"\r\n}\r\n\r\nexport function isLocalHSLValue(value: string) {\r\n  if (\r\n    value.startsWith(\"hsl\") ||\r\n    value.startsWith(\"rgb\") ||\r\n    value.startsWith(\"#\") ||\r\n    value.startsWith(\"oklch\")\r\n  ) {\r\n    return false\r\n  }\r\n\r\n  const chunks = value.split(\" \")\r\n\r\n  return (\r\n    chunks.length === 3 &&\r\n    chunks.slice(1, 3).every((chunk) => chunk.includes(\"%\"))\r\n  )\r\n}\r\n\r\nexport function isColorValue(value: string) {\r\n  return (\r\n    value.startsWith(\"hsl\") ||\r\n    value.startsWith(\"rgb\") ||\r\n    value.startsWith(\"#\") ||\r\n    value.startsWith(\"oklch\") ||\r\n    value.startsWith(\"var(--color-\")\r\n  )\r\n}\r\n","import { detect } from \"@antfu/ni\"\r\n\r\nexport async function getPackageManager(\r\n  targetDir: string,\r\n  { withFallback }: { withFallback?: boolean } = {\r\n    withFallback: false,\r\n  }\r\n): Promise<\"yarn\" | \"pnpm\" | \"bun\" | \"npm\" | \"deno\"> {\r\n  const packageManager = await detect({ programmatic: true, cwd: targetDir })\r\n\r\n  if (packageManager === \"yarn@berry\") return \"yarn\"\r\n  if (packageManager === \"pnpm@6\") return \"pnpm\"\r\n  if (packageManager === \"bun\") return \"bun\"\r\n  if (packageManager === \"deno\") return \"deno\"\r\n  if (!withFallback) {\r\n    return packageManager ?? \"npm\"\r\n  }\r\n\r\n  // Fallback to user agent if not detected.\r\n  const userAgent = process.env.npm_config_user_agent || \"\"\r\n\r\n  if (userAgent.startsWith(\"yarn\")) {\r\n    return \"yarn\"\r\n  }\r\n\r\n  if (userAgent.startsWith(\"pnpm\")) {\r\n    return \"pnpm\"\r\n  }\r\n\r\n  if (userAgent.startsWith(\"bun\")) {\r\n    return \"bun\"\r\n  }\r\n\r\n  return \"npm\"\r\n}\r\n\r\nexport async function getPackageRunner(cwd: string) {\r\n  const packageManager = await getPackageManager(cwd)\r\n\r\n  if (packageManager === \"pnpm\") return \"pnpm dlx\"\r\n\r\n  if (packageManager === \"bun\") return \"bunx\"\r\n\r\n  return \"npx\"\r\n}\r\n","import { RegistryItem } from \"@/src/schema\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\nimport { getPackageInfo } from \"@/src/utils/get-package-info\"\r\nimport { getPackageManager } from \"@/src/utils/get-package-manager\"\r\nimport { logger } from \"@/src/utils/logger\"\r\nimport { spinner } from \"@/src/utils/spinner\"\r\nimport { execa } from \"execa\"\r\nimport prompts from \"prompts\"\r\n\r\nexport async function updateDependencies(\r\n  dependencies: RegistryItem[\"dependencies\"],\r\n  devDependencies: RegistryItem[\"devDependencies\"],\r\n  config: Config,\r\n  options: {\r\n    silent?: boolean\r\n  }\r\n) {\r\n  dependencies = Array.from(new Set(dependencies))\r\n  devDependencies = Array.from(new Set(devDependencies))\r\n\r\n  if (!dependencies?.length && !devDependencies?.length) {\r\n    return\r\n  }\r\n\r\n  options = {\r\n    silent: false,\r\n    ...options,\r\n  }\r\n\r\n  const dependenciesSpinner = spinner(`Installing dependencies.`, {\r\n    silent: options.silent,\r\n  })?.start()\r\n  const packageManager = await getUpdateDependenciesPackageManager(config)\r\n\r\n  // Offer to use --force or --legacy-peer-deps if using React 19 with npm.\r\n  let flag = \"\"\r\n  if (shouldPromptForNpmFlag(config) && packageManager === \"npm\") {\r\n    if (options.silent) {\r\n      flag = \"force\"\r\n    } else {\r\n      dependenciesSpinner.stopAndPersist()\r\n      logger.warn(\r\n        \"\\nIt looks like you are using React 19. \\nSome packages may fail to install due to peer dependency issues in npm (see https://ui.aodesu.com/react-19).\\n\"\r\n      )\r\n      const confirmation = await prompts([\r\n        {\r\n          type: \"select\",\r\n          name: \"flag\",\r\n          message: \"How would you like to proceed?\",\r\n          choices: [\r\n            { title: \"Use --force\", value: \"force\" },\r\n            { title: \"Use --legacy-peer-deps\", value: \"legacy-peer-deps\" },\r\n          ],\r\n        },\r\n      ])\r\n\r\n      if (confirmation) {\r\n        flag = confirmation.flag\r\n      }\r\n    }\r\n  }\r\n\r\n  dependenciesSpinner?.start()\r\n\r\n  await installWithPackageManager(\r\n    packageManager,\r\n    dependencies,\r\n    devDependencies,\r\n    config.resolvedPaths.cwd,\r\n    flag\r\n  )\r\n\r\n  dependenciesSpinner?.succeed()\r\n}\r\n\r\nfunction shouldPromptForNpmFlag(config: Config) {\r\n  const packageInfo = getPackageInfo(config.resolvedPaths.cwd, false)\r\n\r\n  if (!packageInfo?.dependencies?.react) {\r\n    return false\r\n  }\r\n\r\n  const hasReact19 = /^(?:\\^|~)?19(?:\\.\\d+)*(?:-.*)?$/.test(\r\n    packageInfo.dependencies.react\r\n  )\r\n  const hasReactDayPicker8 =\r\n    packageInfo.dependencies[\"react-day-picker\"]?.startsWith(\"8\")\r\n\r\n  return hasReact19 && hasReactDayPicker8\r\n}\r\n\r\nasync function getUpdateDependenciesPackageManager(config: Config) {\r\n  const expoVersion = getPackageInfo(config.resolvedPaths.cwd, false)\r\n    ?.dependencies?.expo\r\n\r\n  if (expoVersion) {\r\n    // Ensures package versions match the React Native version.\r\n    // https://docs.expo.dev/more/expo-cli/#install\r\n    return \"expo\"\r\n  }\r\n\r\n  return getPackageManager(config.resolvedPaths.cwd)\r\n}\r\n\r\nasync function installWithPackageManager(\r\n  packageManager: Awaited<\r\n    ReturnType<typeof getUpdateDependenciesPackageManager>\r\n  >,\r\n  dependencies: string[],\r\n  devDependencies: string[],\r\n  cwd: string,\r\n  flag?: string\r\n) {\r\n  if (packageManager === \"npm\") {\r\n    return installWithNpm(dependencies, devDependencies, cwd, flag)\r\n  }\r\n\r\n  if (packageManager === \"deno\") {\r\n    return installWithDeno(dependencies, devDependencies, cwd)\r\n  }\r\n\r\n  if (packageManager === \"expo\") {\r\n    return installWithExpo(dependencies, devDependencies, cwd)\r\n  }\r\n\r\n  if (dependencies?.length) {\r\n    await execa(packageManager, [\"add\", ...dependencies], {\r\n      cwd,\r\n    })\r\n  }\r\n\r\n  if (devDependencies?.length) {\r\n    await execa(packageManager, [\"add\", \"-D\", ...devDependencies], { cwd })\r\n  }\r\n}\r\n\r\nasync function installWithNpm(\r\n  dependencies: string[],\r\n  devDependencies: string[],\r\n  cwd: string,\r\n  flag?: string\r\n) {\r\n  if (dependencies.length) {\r\n    await execa(\r\n      \"npm\",\r\n      [\"install\", ...(flag ? [`--${flag}`] : []), ...dependencies],\r\n      { cwd }\r\n    )\r\n  }\r\n\r\n  if (devDependencies.length) {\r\n    await execa(\r\n      \"npm\",\r\n      [\"install\", ...(flag ? [`--${flag}`] : []), \"-D\", ...devDependencies],\r\n      { cwd }\r\n    )\r\n  }\r\n}\r\n\r\nasync function installWithDeno(\r\n  dependencies: string[],\r\n  devDependencies: string[],\r\n  cwd: string\r\n) {\r\n  if (dependencies?.length) {\r\n    await execa(\"deno\", [\"add\", ...dependencies.map((dep) => `npm:${dep}`)], {\r\n      cwd,\r\n    })\r\n  }\r\n\r\n  if (devDependencies?.length) {\r\n    await execa(\r\n      \"deno\",\r\n      [\"add\", \"-D\", ...devDependencies.map((dep) => `npm:${dep}`)],\r\n      { cwd }\r\n    )\r\n  }\r\n}\r\n\r\nasync function installWithExpo(\r\n  dependencies: string[],\r\n  devDependencies: string[],\r\n  cwd: string\r\n) {\r\n  if (dependencies.length) {\r\n    await execa(\"npx\", [\"expo\", \"install\", ...dependencies], { cwd })\r\n  }\r\n\r\n  if (devDependencies.length) {\r\n    await execa(\"npx\", [\"expo\", \"install\", \"-- -D\", ...devDependencies], {\r\n      cwd,\r\n    })\r\n  }\r\n}\r\n","import { registryItemEnvVarsSchema } from \"@/src/schema\"\r\nimport {\r\n  findExistingEnvFile,\r\n  getNewEnvKeys,\r\n  mergeEnvContent,\r\n} from \"@/src/utils/env-helpers\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\nimport { highlighter } from \"@/src/utils/highlighter\"\r\nimport { logger } from \"@/src/utils/logger\"\r\nimport { spinner } from \"@/src/utils/spinner\"\r\nimport { existsSync, promises as fs } from \"fs\"\r\nimport path from \"path\"\r\nimport { z } from \"zod\"\r\n\r\nexport async function updateEnvVars(\r\n  envVars: z.infer<typeof registryItemEnvVarsSchema> | undefined,\r\n  config: Config,\r\n  options: {\r\n    silent?: boolean\r\n  }\r\n) {\r\n  if (!envVars || Object.keys(envVars).length === 0) {\r\n    return {\r\n      envVarsAdded: [],\r\n      envFileUpdated: null,\r\n      envFileCreated: null,\r\n    }\r\n  }\r\n\r\n  options = {\r\n    silent: false,\r\n    ...options,\r\n  }\r\n\r\n  const envSpinner = spinner(`Adding environment variables.`, {\r\n    silent: options.silent,\r\n  })?.start()\r\n\r\n  const projectRoot = config.resolvedPaths.cwd\r\n\r\n  // Find existing env file or use .env.local as default.\r\n  let envFilePath = path.join(projectRoot, \".env.local\")\r\n  const existingEnvFile = findExistingEnvFile(projectRoot)\r\n\r\n  if (existingEnvFile) {\r\n    envFilePath = existingEnvFile\r\n  }\r\n\r\n  const envFileExists = existsSync(envFilePath)\r\n  const envFileName = path.basename(envFilePath)\r\n\r\n  // Convert envVars object to env file format\r\n  const newEnvContent = Object.entries(envVars)\r\n    .map(([key, value]) => `${key}=${value}`)\r\n    .join(\"\\n\")\r\n\r\n  let envVarsAdded: string[] = []\r\n  let envFileUpdated: string | null = null\r\n  let envFileCreated: string | null = null\r\n\r\n  if (envFileExists) {\r\n    const existingContent = await fs.readFile(envFilePath, \"utf-8\")\r\n    const mergedContent = mergeEnvContent(existingContent, newEnvContent)\r\n    envVarsAdded = getNewEnvKeys(existingContent, newEnvContent)\r\n\r\n    if (envVarsAdded.length > 0) {\r\n      await fs.writeFile(envFilePath, mergedContent, \"utf-8\")\r\n      envFileUpdated = path.relative(projectRoot, envFilePath)\r\n\r\n      envSpinner?.succeed(\r\n        `Added the following variables to ${highlighter.info(envFileName)}:`\r\n      )\r\n\r\n      if (!options.silent) {\r\n        for (const key of envVarsAdded) {\r\n          logger.log(`  ${highlighter.success(\"+\")} ${key}`)\r\n        }\r\n      }\r\n    } else {\r\n      envSpinner?.stop()\r\n    }\r\n  } else {\r\n    // Create new env file\r\n    await fs.writeFile(envFilePath, newEnvContent + \"\\n\", \"utf-8\")\r\n    envFileCreated = path.relative(projectRoot, envFilePath)\r\n    envVarsAdded = Object.keys(envVars)\r\n\r\n    envSpinner?.succeed(\r\n      `Added the following variables to ${highlighter.info(envFileName)}:`\r\n    )\r\n\r\n    if (!options.silent) {\r\n      for (const key of envVarsAdded) {\r\n        logger.log(`  ${highlighter.success(\"+\")} ${key}`)\r\n      }\r\n    }\r\n  }\r\n\r\n  if (!options.silent && envVarsAdded.length > 0) {\r\n    logger.break()\r\n  }\r\n\r\n  return {\r\n    envVarsAdded,\r\n    envFileUpdated,\r\n    envFileCreated,\r\n  }\r\n}\r\n","import z from \"zod\";\r\nimport { getRegistryItems } from \"../registry/api\";\r\nimport { configWithDefaults } from \"../registry/config\";\r\nimport { resolveRegistryTree } from \"../registry/resolver\";\r\nimport { configSchema, registryItemFileSchema, registryItemSchema, workspaceConfigSchema } from \"../schema\";\r\nimport { Config, getWorkspaceConfig } from \"./get-config\";\r\nimport { getProjectTailwindVersionFromConfig } from \"./get-project-info\";\r\nimport { handleError } from \"./handle-error\";\r\nimport { isSafeTarget } from \"./is-safe-target\";\r\nimport { logger } from \"./logger\";\r\nimport { spinner } from \"./spinner\";\r\nimport { updateCss } from \"./updaters/update-css\";\r\nimport { updateCssVars } from \"./updaters/update-css-vars\";\r\nimport { updateDependencies } from \"./updaters/update-dependencies\";\r\nimport { updateEnvVars } from \"./updaters/update-env-vars\";\r\nimport { updateFiles } from \"./updaters/update-files\";\r\nimport { updateTailwindConfig } from \"./updaters/update-tailwind-config\";\r\n\r\nexport async function addComponents(\r\n  components: string[],\r\n  config: Config,\r\n  options: {\r\n    overwrite?: boolean;\r\n    silent?: boolean;\r\n    isNewProject?: boolean;\r\n    baseStyle?: boolean;\r\n    registryHeaders?: Record<string, Record<string, string>>;\r\n    path?: string;\r\n  }\r\n) {\r\n  options = {\r\n    overwrite: false,\r\n    silent: false,\r\n    isNewProject: false,\r\n    baseStyle: true,\r\n    ...options,\r\n  }\r\n\r\n  const workspaceConfig = await getWorkspaceConfig(config);\r\n  if (\r\n    workspaceConfig &&\r\n    workspaceConfig.ui &&\r\n    workspaceConfig.ui.resolvedPaths.cwd !== config.resolvedPaths.cwd\r\n  ) {\r\n    return await addWorkspaceComponents(components, config, workspaceConfig, {\r\n      ...options,\r\n      isRemote:\r\n        components?.length === 1 && !!components[0].match(/\\/chat\\/b\\//),\r\n    });\r\n  }\r\n\r\n  return await addProjectComponents(components, config, options)\r\n}\r\n\r\nasync function addProjectComponents(\r\n  components: string[],\r\n  config: z.infer<typeof configSchema>,\r\n  options: {\r\n    overwrite?: boolean\r\n    silent?: boolean\r\n    isNewProject?: boolean\r\n    baseStyle?: boolean\r\n    path?: string\r\n  }\r\n) {\r\n  if (!options.baseStyle && !components.length) {\r\n    return;\r\n  }\r\n\r\n  const registrySpinner = spinner(`Checking registry.`, {\r\n    silent: options.silent,\r\n  })?.start();\r\n  const tree = await resolveRegistryTree(components, configWithDefaults(config));\r\n\r\n  if (!tree) {\r\n    registrySpinner?.fail();\r\n    return handleError(new Error(\"Failed to fetch components from registry.\"));\r\n  }\r\n\r\n  try {\r\n    validateFilesTarget(tree.files ?? [], config.resolvedPaths.cwd)\r\n  } catch (error) {\r\n    registrySpinner?.fail();\r\n    return handleError(error);\r\n  }\r\n\r\n  registrySpinner?.succeed();\r\n\r\n  const tailwindVersion = await getProjectTailwindVersionFromConfig(config);\r\n\r\n  await updateTailwindConfig(tree.tailwind?.config, config, {\r\n    silent: options.silent,\r\n    tailwindVersion,\r\n  });\r\n\r\n  const overwriteCssVars = await shouldOverwriteCssVars(components, config)\r\n  await updateCssVars(tree.cssVars, config, {\r\n    cleanupDefaultNextStyles: options.isNewProject,\r\n    silent: options.silent,\r\n    tailwindVersion,\r\n    tailwindConfig: tree.tailwind?.config,\r\n    overwriteCssVars,\r\n    initIndex: options.baseStyle,\r\n  })\r\n\r\n  // Add CSS updater\r\n  await updateCss(tree.css, config, {\r\n    silent: options.silent,\r\n  })\r\n\r\n  await updateEnvVars(tree.envVars, config, {\r\n    silent: options.silent,\r\n  })\r\n\r\n  await updateDependencies(tree.dependencies, tree.devDependencies, config, {\r\n    silent: options.silent,\r\n  })\r\n  await updateFiles(tree.files, config, {\r\n    overwrite: options.overwrite,\r\n    silent: options.silent,\r\n    path: options.path,\r\n  })\r\n\r\n  if (tree.docs) {\r\n    logger.info(tree.docs)\r\n  }\r\n}\r\n\r\nasync function addWorkspaceComponents(\r\n  components: string[],\r\n  config: z.infer<typeof configSchema>,\r\n  workspaceConfig: z.infer<typeof workspaceConfigSchema>,\r\n  options: {\r\n    overwrite?: boolean;\r\n    silent?: boolean;\r\n    isNewProject?: boolean;\r\n    isRemote?: boolean;\r\n    baseStyle?: boolean;\r\n    path?: string;\r\n  }\r\n) {\r\n  if (!options.baseStyle && !components.length) {\r\n    return;\r\n  }\r\n\r\n  const registrySpinner = spinner(`Checking registry.`, {\r\n    silent: options.silent,\r\n  })?.start();\r\n  const tree = await resolveRegistryTree(components, configWithDefaults(config));\r\n\r\n  if (!tree) {\r\n    registrySpinner?.fail();\r\n    return handleError(new Error(\"Failed to fetch components from registry.\"))\r\n  }\r\n}\r\n\r\nasync function shouldOverwriteCssVars(\r\n  components: z.infer<typeof registryItemSchema>[\"name\"][],\r\n  config: z.infer<typeof configSchema>\r\n) {\r\n  const result = await getRegistryItems(components, { config })\r\n  const payload = z.array(registryItemSchema).parse(result)\r\n\r\n  return payload.some(\r\n    (component) =>\r\n      component.type === \"registry:theme\" || component.type === \"registry:style\"\r\n  )\r\n}\r\n\r\nfunction validateFilesTarget(\r\n  files: z.infer<typeof registryItemFileSchema>[],\r\n  cwd: string\r\n) {\r\n  for (const file of files) {\r\n    if (!file?.target) {\r\n      continue\r\n    }\r\n\r\n    if (!isSafeTarget(file.target, cwd)) {\r\n      throw new Error(\r\n        `We found an unsafe file path \"${file.target} in the registry item. Installation aborted.`\r\n      )\r\n    }\r\n  }\r\n}\r\n","import { initOptionsSchema } from \"@/src/commands/init\";\r\nimport { fetchRegistry } from \"@/src/registry/fetcher\";\r\nimport { getPackageManager } from \"@/src/utils/get-package-manager\";\r\nimport { handleError } from \"@/src/utils/handle-error\";\r\nimport { highlighter } from \"@/src/utils/highlighter\";\r\nimport { logger } from \"@/src/utils/logger\";\r\nimport { spinner } from \"@/src/utils/spinner\";\r\nimport { execa } from \"execa\";\r\nimport fs from \"fs-extra\";\r\nimport os from \"os\";\r\nimport path from \"path\";\r\nimport prompts from \"prompts\";\r\nimport z from \"zod\";\r\n\r\nconst MONOREPO_TEMPLATE_URL = \"https://codeload.github.com/aodesu-ui/ui/tar.gz/main\";\r\n\r\nexport const TEMPLATES = {\r\n  next: \"next\",\r\n  \"next-16\": \"next-16\",\r\n  \"next-monorepo\": \"next-monorepo\",\r\n  vite: \"vite\"\r\n} as const;\r\n\r\nexport async function createProject(\r\n  options: Pick<\r\n    z.infer<typeof initOptionsSchema>,\r\n    \"cwd\" | \"force\" | \"srcDir\" | \"components\" | \"template\"\r\n  >\r\n) {\r\n  options = {\r\n    srcDir: false,\r\n    ...options,\r\n  };\r\n\r\n  let template: keyof typeof TEMPLATES =\r\n    options.template && TEMPLATES[options.template as keyof typeof TEMPLATES]\r\n    ? (options.template as keyof typeof TEMPLATES)\r\n    : \"next\";\r\n\r\n  let projectName: string =\r\n    template === TEMPLATES.next ? \"my-app\" : \"my-monorepo\";\r\n\r\n  let nextVersion = \"15\";\r\n\r\n  const isRemoteComponent =\r\n    options.components?.length === 1 &&\r\n    !!options.components[0].match(/\\/chat\\/b\\//);\r\n\r\n  if (options.components && isRemoteComponent) {\r\n    try {\r\n      const [result] = await fetchRegistry(options.components);\r\n      const { meta } = z\r\n        .object({\r\n          meta: z.object({\r\n            nextVersion: z.string(),\r\n          }),\r\n        })\r\n        .parse(result);\r\n      nextVersion = meta.nextVersion;\r\n\r\n      // Force template to next for remote components.\r\n      template = TEMPLATES.next;\r\n    } catch (error) {\r\n      logger.break();\r\n      handleError(error);\r\n    }\r\n  }\r\n\r\n  if (!options.force) {\r\n    const { type, name } = await prompts([\r\n      {\r\n        type: options.template || isRemoteComponent ? null : \"select\",\r\n        name: \"type\",\r\n        message: `The path ${highlighter.info(\r\n          options.cwd\r\n        )} does not contain a package.json file.\\n  Would you like to start a new project?`,\r\n        choices: [\r\n          { title: \"Vite\", value: \"vite\" },\r\n          { title: \"Next.js 15\", value: \"next\" },\r\n          { title: \"Next.js 16\", value: \"next-16\" },\r\n          { title: \"Next.js (Monorepo)\", value: \"next-monorepo\" },\r\n        ],\r\n        initial: 0,\r\n      },\r\n      {\r\n        type: \"text\",\r\n        name: \"name\",\r\n        message: \"What is your project named?\",\r\n        initial: projectName,\r\n        format: (value: string) => value.trim(),\r\n        validate: (value: string) =>\r\n          value.length > 128\r\n            ? `Name should be less than 128 characters.`\r\n            : true,\r\n      },\r\n    ])\r\n\r\n    template = type ?? template;\r\n    projectName = name;\r\n\r\n    if (type === \"next-16\") {\r\n      nextVersion = \"latest\"\r\n    }\r\n  }\r\n\r\n  const packageManager = await getPackageManager(options.cwd, {\r\n    withFallback: true,\r\n  });\r\n\r\n  const projectPath = `${options.cwd}/${projectName}`;\r\n\r\n  // Check if path is writable.\r\n  try {\r\n    await fs.access(options.cwd, fs.constants.W_OK);\r\n  } catch (error) {\r\n    logger.break()\r\n    logger.error(`The path ${highlighter.info(options.cwd)} is not writable.`)\r\n    logger.error(\r\n      `It is likely you do not have write permissions for this folder or the path ${highlighter.info(\r\n        options.cwd\r\n      )} does not exist.`\r\n    )\r\n    logger.break()\r\n    process.exit(1)\r\n  }\r\n\r\n  if (fs.existsSync(path.resolve(options.cwd, projectName, \"package.json\"))) {\r\n    logger.break()\r\n    logger.error(\r\n      `A project with the name ${highlighter.info(projectName)} already exists.`\r\n    )\r\n    logger.error(`Please choose a different name and try again.`)\r\n    logger.break()\r\n    process.exit(1)\r\n  }\r\n\r\n  if (template === TEMPLATES.vite) {\r\n    await createViteProject(projectPath, {\r\n      packageManager\r\n    })\r\n  }\r\n\r\n  if (template === TEMPLATES.next || template === TEMPLATES[\"next-16\"]) {\r\n    await createNextProject(projectPath, {\r\n      version: nextVersion,\r\n      cwd: options.cwd,\r\n      packageManager,\r\n      srcDir: !!options.srcDir,\r\n    })\r\n  }\r\n\r\n  if (template === TEMPLATES[\"next-monorepo\"]) {\r\n    await createMonorepoProject(projectPath, {\r\n      packageManager,\r\n    })\r\n  }\r\n\r\n  return {\r\n    projectPath,\r\n    projectName,\r\n    template,\r\n  }\r\n}\r\n\r\nasync function createViteProject(\r\n  projectPath: string,\r\n  options: {\r\n    packageManager: string\r\n  }\r\n) {\r\n  const createSpinner = spinner(\r\n    `Creating a new Vite project. This may take a few minutes.`\r\n  ).start();\r\n\r\n  try {\r\n    const args = [\r\n      \"create\",\r\n      \"vite@latest\",\r\n      path.basename(projectPath),\r\n      \"--template\",\r\n      \"react-ts\",\r\n      \"--yes\"\r\n    ]\r\n\r\n    await execa(options.packageManager, args, {\r\n      cwd: path.dirname(projectPath),\r\n    });\r\n\r\n    const installSpinner = spinner(`Installing dependencies with ${options.packageManager}.`).start();\r\n\r\n    await execa(options.packageManager, [\"install\"], {\r\n      cwd: projectPath,\r\n    });\r\n\r\n    installSpinner?.succeed(`Installed dependencies with ${options.packageManager}.`);\r\n\r\n    try {\r\n      await execa(\"git\", [\"init\"], { cwd: projectPath })\r\n      await execa(\"git\", [\"add\", \"-A\"], { cwd: projectPath })\r\n      await execa(\"git\", [\"commit\", \"-m\", \"Initial commit from aodesu-ui\"], {\r\n        cwd: projectPath,\r\n      })\r\n    } catch (gitError) {\r\n      logger.warn(\"Git initialization skipped (git not available)\")\r\n    }\r\n\r\n    createSpinner?.succeed(\"Creating a new Vite project.\");\r\n  } catch (error) {\r\n    createSpinner?.fail(\"Something went worng creating a new Vite project.\");\r\n    handleError(error);\r\n  }\r\n}\r\n\r\nasync function createNextProject(\r\n  projectPath: string,\r\n  options: {\r\n    version: string\r\n    cwd: string\r\n    packageManager: string\r\n    srcDir: boolean\r\n  }\r\n) {\r\n  const createSpinner = spinner(\r\n    `Creating a new Next.js ${\r\n      options.version.startsWith(\"latest\") ? \"16\" : \"15\"\r\n    } project. This may take a few minutes.`\r\n  ).start()\r\n\r\n  // Note: pnpm fails here. Fallback to npx with --use-PACKAGE-MANAGER.\r\n  const args = [\r\n    \"--tailwind\",\r\n    \"--eslint\",\r\n    \"--typescript\",\r\n    \"--app\",\r\n    options.srcDir ? \"--src-dir\" : \"--no-src-dir\",\r\n    \"--no-import-alias\",\r\n    `--use-${options.packageManager}`,\r\n  ]\r\n\r\n  if (\r\n    options.version.startsWith(\"15\") ||\r\n    options.version.startsWith(\"latest\") ||\r\n    options.version.startsWith(\"canary\")\r\n  ) {\r\n    args.push(\"--turbopack\")\r\n  }\r\n\r\n  if (\r\n    options.version.startsWith(\"latest\") ||\r\n    options.version.startsWith(\"canary\")\r\n  ) {\r\n    args.push(\"--no-react-compiler\")\r\n  }\r\n\r\n  try {\r\n    await execa(\r\n      \"npx\",\r\n      [`create-next-app@${options.version}`, projectPath, \"--silent\", ...args],\r\n      {\r\n        cwd: options.cwd,\r\n      }\r\n    )\r\n  } catch (error) {\r\n    logger.break()\r\n    logger.error(\r\n      `Something went wrong creating a new Next.js project. Please try again.`\r\n    )\r\n    process.exit(1)\r\n  }\r\n\r\n  createSpinner?.succeed(\r\n    `Creating a new Next.js ${\r\n      options.version.startsWith(\"latest\") ? \"16\" : \"15\"\r\n    } project.`\r\n  )\r\n}\r\n\r\nasync function createMonorepoProject(\r\n  projectPath: string,\r\n  options: {\r\n    packageManager: string\r\n  }\r\n) {\r\n  const createSpinner = spinner(\r\n    `Creating a new Next.js monorepo. This may take a few minutes.`\r\n  ).start()\r\n\r\n  try {\r\n    // Get the template.\r\n    const templatePath = path.join(os.tmpdir(), `aodesu-template-${Date.now()}`)\r\n    await fs.ensureDir(templatePath)\r\n    const response = await fetch(MONOREPO_TEMPLATE_URL)\r\n    if (!response.ok) {\r\n      throw new Error(`Failed to download template: ${response.statusText}`)\r\n    }\r\n\r\n    // Write the tar file\r\n    const tarPath = path.resolve(templatePath, \"template.tar.gz\")\r\n    await fs.writeFile(tarPath, Buffer.from(await response.arrayBuffer()))\r\n    await execa(\"tar\", [\r\n      \"-xzf\",\r\n      tarPath,\r\n      \"-C\",\r\n      templatePath,\r\n      \"--strip-components=2\",\r\n      \"ui-main/templates/monorepo-next\",\r\n    ])\r\n    const extractedPath = path.resolve(templatePath, \"monorepo-next\")\r\n    await fs.move(extractedPath, projectPath)\r\n    await fs.remove(templatePath)\r\n\r\n    // Run install.\r\n    await execa(options.packageManager, [\"install\"], {\r\n      cwd: projectPath,\r\n    })\r\n    // await execa(\"cd\", [cwd])\r\n\r\n    // Write project name to the package.json\r\n    const packageJsonPath = path.join(projectPath, \"package.json\")\r\n    if (fs.existsSync(packageJsonPath)) {\r\n      const packageJsonContent = await fs.readFile(packageJsonPath, \"utf8\")\r\n      const packageJson = JSON.parse(packageJsonContent)\r\n      packageJson.name = projectPath.split(\"/\").pop()\r\n      await fs.writeFile(packageJsonPath, JSON.stringify(packageJson, null, 2))\r\n    }\r\n\r\n    // Try git init.\r\n    const cwd = process.cwd()\r\n    await execa(\"git\", [\"--version\"], { cwd: projectPath })\r\n    await execa(\"git\", [\"init\"], { cwd: projectPath })\r\n    await execa(\"git\", [\"add\", \"-A\"], { cwd: projectPath })\r\n    await execa(\"git\", [\"commit\", \"-m\", \"Initial commit\"], {\r\n      cwd: projectPath,\r\n    })\r\n\r\n    createSpinner?.succeed(\"Creating a new Next.js monorepo.\")\r\n  } catch (error) {\r\n    createSpinner?.fail(\"Something went wrong creating a new Next.js monorepo.\")\r\n    handleError(error)\r\n  }\r\n}\r\n","import { existsSync } from \"fs\";\r\nimport { join } from \"path\";\r\nimport { logger } from \"./logger\";\r\n\r\nexport async function loadEnvFiles(cwd: string = process.cwd()): Promise<void> {\r\n  try {\r\n    const { config } = await import(\"@dotenvx/dotenvx\");\r\n    const envFiles = [\r\n      \".env.local\",\r\n      \".env.development.local\",\r\n      \".env.development\",\r\n      \".env\"\r\n    ];\r\n\r\n    for (const envFile of envFiles) {\r\n      const envPath = join(cwd, envFile);\r\n      if (existsSync(envPath)) {\r\n        config({\r\n          path: envPath,\r\n          overload: false,\r\n          quiet: true\r\n        })\r\n      }\r\n    }\r\n  } catch (error) {\r\n    logger.warn(\"Failed to load env files:\", error);\r\n  }\r\n}\r\n","import fsExtra from \"fs-extra\"\r\n\r\nexport const FILE_BACKUP_SUFFIX = \".bak\"\r\n\r\nexport function createFileBackup(filePath: string): string | null {\r\n  if (!fsExtra.existsSync(filePath)) {\r\n    return null\r\n  }\r\n\r\n  const backupPath = `${filePath}${FILE_BACKUP_SUFFIX}`\r\n  try {\r\n    fsExtra.renameSync(filePath, backupPath)\r\n    return backupPath\r\n  } catch (error) {\r\n    console.error(`Failed to create backup of ${filePath}: ${error}`)\r\n    return null\r\n  }\r\n}\r\n\r\nexport function restoreFileBackup(filePath: string): boolean {\r\n  const backupPath = `${filePath}${FILE_BACKUP_SUFFIX}`\r\n\r\n  if (!fsExtra.existsSync(backupPath)) {\r\n    return false\r\n  }\r\n\r\n  try {\r\n    fsExtra.renameSync(backupPath, filePath)\r\n    return true\r\n  } catch (error) {\r\n    console.error(\r\n      `Warning: Could not restore backup file ${backupPath}: ${error}`\r\n    )\r\n    return false\r\n  }\r\n}\r\n\r\nexport function deleteFileBackup(filePath: string): boolean {\r\n  const backupPath = `${filePath}${FILE_BACKUP_SUFFIX}`\r\n\r\n  if (!fsExtra.existsSync(backupPath)) {\r\n    return false\r\n  }\r\n\r\n  try {\r\n    fsExtra.unlinkSync(backupPath)\r\n    return true\r\n  } catch (error) {\r\n    // Best effort - don't log as this is just cleanup\r\n    return false\r\n  }\r\n}\r\n","import { BUILTIN_REGISTRIES } from \"@/src/registry/constants\"\r\nimport { RegistryNotConfiguredError } from \"@/src/registry/errors\"\r\nimport { parseRegistryAndItemFromString } from \"@/src/registry/parser\"\r\nimport { fetchRegistryItems } from \"@/src/registry/resolver\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\n\r\n// Recursively discovers all registry namespaces including nested ones.\r\nexport async function resolveRegistryNamespaces(\r\n  components: string[],\r\n  config: Config\r\n) {\r\n  const discoveredNamespaces = new Set<string>()\r\n  const visitedItems = new Set<string>()\r\n  const itemsToProcess = [...components]\r\n\r\n  while (itemsToProcess.length > 0) {\r\n    const currentItem = itemsToProcess.shift()!\r\n\r\n    if (visitedItems.has(currentItem)) {\r\n      continue\r\n    }\r\n    visitedItems.add(currentItem)\r\n\r\n    const { registry } = parseRegistryAndItemFromString(currentItem)\r\n    if (registry && !BUILTIN_REGISTRIES[registry]) {\r\n      discoveredNamespaces.add(registry)\r\n    }\r\n\r\n    try {\r\n      const [item] = await fetchRegistryItems([currentItem], config, {\r\n        useCache: true,\r\n      })\r\n\r\n      if (item?.registryDependencies) {\r\n        for (const dep of item.registryDependencies) {\r\n          const { registry: depRegistry } = parseRegistryAndItemFromString(dep)\r\n          if (depRegistry && !BUILTIN_REGISTRIES[depRegistry]) {\r\n            discoveredNamespaces.add(depRegistry)\r\n          }\r\n\r\n          if (!visitedItems.has(dep)) {\r\n            itemsToProcess.push(dep)\r\n          }\r\n        }\r\n      }\r\n    } catch (error) {\r\n      // If a registry is not configured, we still track it.\r\n      if (error instanceof RegistryNotConfiguredError) {\r\n        const { registry } = parseRegistryAndItemFromString(currentItem)\r\n        if (registry && !BUILTIN_REGISTRIES[registry]) {\r\n          discoveredNamespaces.add(registry)\r\n        }\r\n        continue\r\n      }\r\n\r\n      // For other errors (network, parsing, etc.), we skip this item\r\n      // but continue processing others to discover as many namespaces as possible.\r\n      continue\r\n    }\r\n  }\r\n\r\n  return Array.from(discoveredNamespaces)\r\n}\r\n","import { getRegistriesIndex } from \"@/src/registry/api\"\r\nimport { BUILTIN_REGISTRIES } from \"@/src/registry/constants\"\r\nimport { resolveRegistryNamespaces } from \"@/src/registry/namespaces\"\r\nimport { rawConfigSchema } from \"@/src/registry/schema\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\nimport { spinner } from \"@/src/utils/spinner\"\r\nimport fs from \"fs-extra\"\r\nimport path from \"path\"\r\n\r\nexport async function ensureRegistriesInConfig(\r\n  components: string[],\r\n  config: Config,\r\n  options: {\r\n    silent?: boolean\r\n    writeFile?: boolean\r\n  } = {}\r\n) {\r\n  options = {\r\n    silent: false,\r\n    writeFile: true,\r\n    ...options,\r\n  }\r\n\r\n  // Use resolveRegistryNamespaces to discover all namespaces including dependencies.\r\n  const registryNames = await resolveRegistryNamespaces(components, config)\r\n\r\n  const missingRegistries = registryNames.filter(\r\n    (registry) =>\r\n      !config.registries?.[registry] &&\r\n      !Object.keys(BUILTIN_REGISTRIES).includes(registry)\r\n  )\r\n\r\n  if (missingRegistries.length === 0) {\r\n    return {\r\n      config,\r\n      newRegistries: [],\r\n    }\r\n  }\r\n\r\n  // We'll fail silently if we can't fetch the registry index.\r\n  // The error handling by caller will guide user to add the missing registries.\r\n  const registryIndex = await getRegistriesIndex({\r\n    useCache: process.env.NODE_ENV !== \"development\",\r\n  })\r\n\r\n  if (!registryIndex) {\r\n    return {\r\n      config,\r\n      newRegistries: [],\r\n    }\r\n  }\r\n\r\n  const foundRegistries: Record<string, string> = {}\r\n  for (const registry of missingRegistries) {\r\n    if (registryIndex[registry]) {\r\n      foundRegistries[registry] = registryIndex[registry]\r\n    }\r\n  }\r\n\r\n  if (Object.keys(foundRegistries).length === 0) {\r\n    return {\r\n      config,\r\n      newRegistries: [],\r\n    }\r\n  }\r\n\r\n  // Filter out built-in registries from existing config before merging\r\n  const existingRegistries = Object.fromEntries(\r\n    Object.entries(config.registries || {}).filter(\r\n      ([key]) => !Object.keys(BUILTIN_REGISTRIES).includes(key)\r\n    )\r\n  )\r\n\r\n  const newConfigWithRegistries = {\r\n    ...config,\r\n    registries: {\r\n      ...existingRegistries,\r\n      ...foundRegistries,\r\n    },\r\n  }\r\n\r\n  if (options.writeFile) {\r\n    const { resolvedPaths, ...configWithoutResolvedPaths } =\r\n      newConfigWithRegistries\r\n    const configSpinner = spinner(\"Updating components.json.\", {\r\n      silent: options.silent,\r\n    }).start()\r\n    const updatedConfig = rawConfigSchema.parse(configWithoutResolvedPaths)\r\n    await fs.writeFile(\r\n      path.resolve(config.resolvedPaths.cwd, \"components.json\"),\r\n      JSON.stringify(updatedConfig, null, 2) + \"\\n\",\r\n      \"utf-8\"\r\n    )\r\n    configSpinner.succeed()\r\n  }\r\n\r\n  return {\r\n    config: newConfigWithRegistries,\r\n    newRegistries: Object.keys(foundRegistries),\r\n  }\r\n}\r\n","import { promises as fs } from \"fs\";\r\n\r\nimport * as ERRORS from \"@/src/utils/errors\";\r\nimport { updateTailwindContent } from \"@/src/utils/updaters/update-tailwind-content\";\r\nimport { Command } from 'commander';\r\nimport deepmerge from \"deepmerge\";\r\nimport fsExtra from 'fs-extra';\r\nimport path from 'path';\r\nimport prompts from \"prompts\";\r\nimport { z } from \"zod\";\r\nimport { preFlightInit } from '../preflights/preflight-init';\r\nimport { getRegistryBaseColors, getRegistryItems, getRegistryStyles } from '../registry/api';\r\nimport { buildUrlAndHeadersForRegistryItem } from '../registry/builder';\r\nimport { configWithDefaults } from '../registry/config';\r\nimport { BUILTIN_REGISTRIES } from \"../registry/constants\";\r\nimport { clearRegistryContext } from '../registry/context';\r\nimport { rawConfigSchema } from \"../schema\";\r\nimport { addComponents } from \"../utils/add-components\";\r\nimport { createProject } from \"../utils/create-project\";\r\nimport { loadEnvFiles } from '../utils/env-loader';\r\nimport { createFileBackup, deleteFileBackup, FILE_BACKUP_SUFFIX, restoreFileBackup } from '../utils/file-helper';\r\nimport { Config, DEFAULT_COMPONENTS, DEFAULT_TAILWIND_CONFIG, DEFAULT_TAILWIND_CSS, DEFAULT_UTILS, getConfig, resolveConfigPaths } from \"../utils/get-config\";\r\nimport { getProjectConfig, getProjectInfo, getProjectTailwindVersionFromConfig } from \"../utils/get-project-info\";\r\nimport { handleError } from '../utils/handle-error';\r\nimport { highlighter } from '../utils/highlighter';\r\nimport { logger } from '../utils/logger';\r\nimport { ensureRegistriesInConfig } from '../utils/registries';\r\nimport { spinner } from \"../utils/spinner\";\r\n\r\nprocess.on(\"exit\", (code) => {\r\n  const filePath = path.resolve(process.cwd(), \"components.json\")\r\n\r\n  if (code === 0) {\r\n    return deleteFileBackup(filePath);\r\n  }\r\n\r\n  return restoreFileBackup(filePath);\r\n});\r\n\r\nexport const initOptionsSchema = z.object({\r\n  cwd: z.string(),\r\n  components: z.array(z.string()).optional(),\r\n  yes: z.boolean(),\r\n  defaults: z.boolean(),\r\n  force: z.boolean(),\r\n  silent: z.boolean(),\r\n  isNewProject: z.boolean(),\r\n  srcDir: z.boolean().optional(),\r\n  cssVariables: z.boolean(),\r\n  template: z\r\n    .string()\r\n    .optional()\r\n    .refine(\r\n      (val) => {\r\n        if (val) {\r\n          return \"TEMPLATES\"\r\n        }\r\n        return true\r\n      },\r\n      {\r\n        message: \"Invalid template. Please use 'next', 'next-16' or 'next-monorepo'.\",\r\n      }\r\n    ),\r\n  baseColor: z\r\n    .string()\r\n    .optional(),\r\n  baseStyle: z.boolean(),\r\n});\r\n\r\nexport const init = new Command()\r\n  .name(\"init\")\r\n  .description(\"initialize your project and install dependencies\")\r\n  .argument(\"[components...]\", \"names, url or local path to component\")\r\n  .option(\r\n    \"-t, --template <template>\",\r\n    \"the template to use. (next, next-16, next-monorepo)\"\r\n  )\r\n  .option(\"-b, --base-color <base-color>\", \"The base color to use. (neutral)\", undefined)\r\n  .option(\"-y, --yes\", \"Skip de confirmation prompt\", true)\r\n  .option(\"-d, --defaults\", \"Use default configuration.\", false)\r\n  .option(\"-f, --force\", \"Force overwrite of existing configuration\", false)\r\n  .option(\r\n    \"-c, --cwd <cwd>\",\r\n    \"the working directory. defaults to the current directory.\",\r\n    process.cwd()\r\n  )\r\n  .option(\"-s, --silent\", \"Mute output\", false)\r\n  .option(\"--src-dir\", \"Use the src directory when creating a new project.\", false)\r\n  .option(\"--no-src-dir\", \"Do not use the src directory when creating a new project.\")\r\n  .option(\"--css-variables\", \"Use css variables for theming.\", true)\r\n  .option(\"--no-base-style\", \"Do not install the base aodesu style.\")\r\n  .action(async (components, opts) => {\r\n    try {\r\n      if (opts.defaults) {\r\n        opts.template = opts.template || \"next\"\r\n        opts.baseColor = opts.baseColor || \"neutral\"\r\n      }\r\n\r\n      const options = initOptionsSchema.parse({\r\n        cwd: path.resolve(opts.cwd),\r\n        isNewProject: false,\r\n        components,\r\n        ...opts\r\n      });\r\n\r\n      await loadEnvFiles(options.cwd);\r\n\r\n      // We need check if we're initializing with a new style\r\n      // This will allow us to determine if we need to install the base style.\r\n      // And if we should prompt the user for a base color.\r\n      if (components.length > 0) {\r\n        // We don't know the full config at this point.\r\n        // So we'll use a shadow config to fetch the first item,\r\n        let shadowConfig = configWithDefaults({});\r\n\r\n        // Check if there's a components.json file.\r\n        // If so, we'll merge with our shadow config.\r\n        const componentsJsonPath = path.resolve(options.cwd, \"components.json\");\r\n        if (fsExtra.existsSync(componentsJsonPath)) {\r\n          const existingConfig = await fsExtra.readJson(componentsJsonPath);\r\n          const config = rawConfigSchema.partial().parse(existingConfig);\r\n          shadowConfig = configWithDefaults(config);\r\n\r\n          // Since components.json might not be valid at this point.\r\n          // Temporaly rename components.json to allow preflight to run.\r\n          // We'll rename it back after preflight.\r\n          createFileBackup(componentsJsonPath);\r\n        }\r\n\r\n        // Ensure all registries used in componentes are configured.\r\n        const { config: updatedConfig } = await ensureRegistriesInConfig(\r\n          components,\r\n          shadowConfig,\r\n          {\r\n            silent: true,\r\n          }\r\n        )\r\n        shadowConfig = updatedConfig;\r\n\r\n\r\n        // This forces a shadowConfig validation early in the process.\r\n        buildUrlAndHeadersForRegistryItem(components[0], shadowConfig);\r\n\r\n\r\n        const [item] = await getRegistryItems([components[0]], {\r\n          config: shadowConfig\r\n        });\r\n        if (item?.type == \"registry:style\") {\r\n          // Set a default base color so we're not prompted.\r\n          // The style will extend or override it.\r\n          options.baseColor = \"neutral\";\r\n\r\n          // If the style extends none, we don't want to install the base style.\r\n          options.baseStyle =\r\n            item.extends === \"none\" ? false : options.baseStyle;\r\n        }\r\n      }\r\n\r\n      // If --no-base-style, we don't want to prompt for a base color either\r\n      if (!options.baseStyle) {\r\n        options.baseColor = \"neutral\";\r\n      }\r\n\r\n      await runInit(options);\r\n\r\n      logger.log(\r\n        `${highlighter.success(\r\n          \"Success!\"\r\n        )} Project initialization completed. \\nYou may now add components.`\r\n      )\r\n\r\n\r\n      // We need when runninng with custom cwd.\r\n      deleteFileBackup(path.resolve(options.cwd, \"components.json\"))\r\n      logger.break()\r\n    } catch (error) {\r\n      logger.break();\r\n      handleError(error);\r\n    } finally {\r\n      clearRegistryContext();\r\n    }\r\n  })\r\n\r\n\r\nexport async function runInit(\r\n  options: z.infer<typeof initOptionsSchema> & {\r\n    skipPreflight?: boolean\r\n  }\r\n) {\r\n  let projectInfo;\r\n  let newProjectTemplate;\r\n  if (!options.skipPreflight) {\r\n    const preflight = await preFlightInit(options);\r\n    if (preflight.errors[ERRORS.MISSING_DIR_OR_EMPTY_PROJECT]) {\r\n      const { projectPath, template } = await createProject(options);\r\n      if (!projectPath) {\r\n        process.exit(1);\r\n      }\r\n      options.cwd = projectPath;\r\n      options.isNewProject = true;\r\n      newProjectTemplate = template;\r\n    }\r\n    projectInfo = preflight.projectInfo;\r\n  } else {\r\n    projectInfo = await getProjectInfo(options.cwd);\r\n  }\r\n\r\n  if (newProjectTemplate === \"next-monorepo\") {\r\n    options.cwd = path.resolve(options.cwd, \"apps/web\");\r\n    return await getConfig(options.cwd);\r\n  }\r\n\r\n  const projectConfig = await getProjectConfig(options.cwd, projectInfo);\r\n\r\n  let config = projectConfig\r\n    ? await promptForMinimalConfig(projectConfig, options)\r\n    : await promptForConfig(await getConfig(options.cwd));\r\n\r\n  if (!options.yes) {\r\n    const { proceed } = await prompts({\r\n      type: \"confirm\",\r\n      name: \"proceed\",\r\n      message: `Write configuration to ${highlighter.info(\r\n        \"components.json\"\r\n      )}. Proceed?`,\r\n      initial: true,\r\n    })\r\n\r\n    if (!proceed) {\r\n      process.exit(0)\r\n    }\r\n  }\r\n\r\n  // Prepare the list of components to be added.\r\n  const components = [\r\n    // \"index\" is the default shadcn style.\r\n    // Why index? Because when style is true, we read style from components.json and fetch that.\r\n    // i.e aodesu from components.json then fetch /styles/aodesu/index.\r\n    // TODO: Fix this so that we can extend any style i.e --style=aodesu.\r\n    ...(options.baseStyle ? [\"index\"] : []),\r\n    ...(options.components ?? []),\r\n  ]\r\n\r\n  // Ensure registries are configured for the components we're about to add.\r\n  const fullConfigForRegistry = await resolveConfigPaths(options.cwd, config)\r\n  const { config: configWithRegistries } = await ensureRegistriesInConfig(\r\n    components,\r\n    fullConfigForRegistry,\r\n    {\r\n      silent: true,\r\n    }\r\n  )\r\n\r\n  // Update config with any new registries found.\r\n  if (configWithRegistries.registries) {\r\n    config.registries = configWithRegistries.registries\r\n  }\r\n\r\n  const componentSpinner = spinner(`Writing components.json.`).start()\r\n  const targetPath = path.resolve(options.cwd, \"components.json\")\r\n  const backupPath = `${targetPath}${FILE_BACKUP_SUFFIX}`\r\n\r\n  // Merge with backup config if it exists and not using --force\r\n  if (!options.force && fsExtra.existsSync(backupPath)) {\r\n    const existingConfig = await fsExtra.readJson(backupPath)\r\n\r\n    // Move registries at the end of the config.\r\n    const { registries, ...merged } = deepmerge(existingConfig, config)\r\n    config = { ...merged, registries }\r\n  }\r\n\r\n  // Make sure to filter out built-in registries.\r\n  // TODO: fix this in ensureRegistriesInConfig.\r\n  config.registries = Object.fromEntries(\r\n    Object.entries(config.registries || {}).filter(\r\n      ([key]) => !Object.keys(BUILTIN_REGISTRIES).includes(key)\r\n    )\r\n  )\r\n\r\n  // Write components.json.\r\n  await fs.writeFile(targetPath, `${JSON.stringify(config, null, 2)}\\n`, \"utf8\")\r\n  componentSpinner.succeed()\r\n\r\n  // Add components.\r\n  const fullConfig = await resolveConfigPaths(options.cwd, config)\r\n  await addComponents(components, fullConfig, {\r\n    // Init will always overwrite files.\r\n    overwrite: true,\r\n    silent: options.silent,\r\n    baseStyle: options.baseStyle,\r\n    isNewProject:\r\n      options.isNewProject || projectInfo?.framework.name === \"next-app\",\r\n  })\r\n\r\n  // If a new project is using src dir, let's update the tailwind content config.\r\n  // TODO: Handle this per framework.\r\n  if (options.isNewProject && options.srcDir) {\r\n    await updateTailwindContent(\r\n      [\"./src/**/*.{js,ts,jsx,tsx,mdx}\"],\r\n      fullConfig,\r\n      {\r\n        silent: options.silent,\r\n      }\r\n    )\r\n  }\r\n\r\n  return fullConfig\r\n}\r\n\r\nasync function promptForConfig(defaultConfig: Config | null = null) {\r\n  const [styles, baseColors] = await Promise.all([\r\n    getRegistryStyles(),\r\n    getRegistryBaseColors(),\r\n  ])\r\n\r\n  logger.info(\"\")\r\n  const options = await prompts([\r\n    {\r\n      type: \"toggle\",\r\n      name: \"typescript\",\r\n      message: `Would you like to use ${highlighter.info(\r\n        \"TypeScript\"\r\n      )} (recommended)?`,\r\n      initial: defaultConfig?.tsx ?? true,\r\n      active: \"yes\",\r\n      inactive: \"no\",\r\n    },\r\n    {\r\n      type: \"select\",\r\n      name: \"style\",\r\n      message: `Which ${highlighter.info(\"style\")} would you like to use?`,\r\n      choices: styles.map((style) => ({\r\n        title: style.label,\r\n        value: style.name,\r\n      })),\r\n    },\r\n    {\r\n      type: \"select\",\r\n      name: \"tailwindBaseColor\",\r\n      message: `Which color would you like to use as the ${highlighter.info(\r\n        \"base color\"\r\n      )}?`,\r\n      choices: baseColors.map((color) => ({\r\n        title: color.label,\r\n        value: color.name,\r\n      })),\r\n    },\r\n    {\r\n      type: \"text\",\r\n      name: \"tailwindCss\",\r\n      message: `Where is your ${highlighter.info(\"global CSS\")} file?`,\r\n      initial: defaultConfig?.tailwind.css ?? DEFAULT_TAILWIND_CSS,\r\n    },\r\n    {\r\n      type: \"toggle\",\r\n      name: \"tailwindCssVariables\",\r\n      message: `Would you like to use ${highlighter.info(\r\n        \"CSS variables\"\r\n      )} for theming?`,\r\n      initial: defaultConfig?.tailwind.cssVariables ?? true,\r\n      active: \"yes\",\r\n      inactive: \"no\",\r\n    },\r\n    {\r\n      type: \"text\",\r\n      name: \"tailwindPrefix\",\r\n      message: `Are you using a custom ${highlighter.info(\r\n        \"tailwind prefix eg. tw-\"\r\n      )}? (Leave blank if not)`,\r\n      initial: \"\",\r\n    },\r\n    {\r\n      type: \"text\",\r\n      name: \"tailwindConfig\",\r\n      message: `Where is your ${highlighter.info(\r\n        \"tailwind.config.js\"\r\n      )} located?`,\r\n      initial: defaultConfig?.tailwind.config ?? DEFAULT_TAILWIND_CONFIG,\r\n    },\r\n    {\r\n      type: \"text\",\r\n      name: \"components\",\r\n      message: `Configure the import alias for ${highlighter.info(\r\n        \"components\"\r\n      )}:`,\r\n      initial: defaultConfig?.aliases[\"components\"] ?? DEFAULT_COMPONENTS,\r\n    },\r\n    {\r\n      type: \"text\",\r\n      name: \"utils\",\r\n      message: `Configure the import alias for ${highlighter.info(\"utils\")}:`,\r\n      initial: defaultConfig?.aliases[\"utils\"] ?? DEFAULT_UTILS,\r\n    },\r\n    {\r\n      type: \"toggle\",\r\n      name: \"rsc\",\r\n      message: `Are you using ${highlighter.info(\"React Server Components\")}?`,\r\n      initial: defaultConfig?.rsc ?? true,\r\n      active: \"yes\",\r\n      inactive: \"no\",\r\n    },\r\n  ])\r\n\r\n  return rawConfigSchema.parse({\r\n    $schema: \"https://ui.aodesu.com/schema.json\",\r\n    style: options.style,\r\n    tailwind: {\r\n      config: options.tailwindConfig,\r\n      css: options.tailwindCss,\r\n      baseColor: options.tailwindBaseColor,\r\n      cssVariables: options.tailwindCssVariables,\r\n      prefix: options.tailwindPrefix,\r\n    },\r\n    rsc: options.rsc,\r\n    tsx: options.typescript,\r\n    aliases: {\r\n      utils: options.utils,\r\n      components: options.components,\r\n      // TODO: fix this.\r\n      lib: options.components.replace(/\\/components$/, \"lib\"),\r\n      hooks: options.components.replace(/\\/components$/, \"hooks\"),\r\n    },\r\n  })\r\n}\r\n\r\nasync function promptForMinimalConfig(\r\n  defaultConfig: Config,\r\n  opts: z.infer<typeof initOptionsSchema>\r\n) {\r\n  let style = defaultConfig.style;\r\n  let baseColor = opts.baseColor;\r\n  let cssVariables = defaultConfig.tailwind.cssVariables;\r\n\r\n  if (!opts.defaults) {\r\n    const [styles, baseColors, tailwindVersion] = await Promise.all([\r\n      getRegistryStyles(),\r\n      getRegistryBaseColors(),\r\n      getProjectTailwindVersionFromConfig(defaultConfig),\r\n    ]);\r\n\r\n    const options = await prompts([\r\n      {\r\n        type: tailwindVersion === \"v4\" ? null : \"select\",\r\n        name: \"style\",\r\n        message: `Which ${highlighter.info(\"style\")} would you like to use?`,\r\n        choices: styles.map((style) => ({\r\n          title:\r\n            style.name === \"aodesu\" ? \"aodesu (Recommended)\" : style.label,\r\n          value: style.name,\r\n        })),\r\n        initial: 0,\r\n      },\r\n      {\r\n        type: opts.baseColor ? null : \"select\",\r\n        name: \"tailwindBaseColor\",\r\n        message: `Which color would you like to use as the ${highlighter.info(\"base color\")}?`,\r\n        choices: baseColors.map((color) => ({\r\n          title: color.label,\r\n          value: color.name,\r\n        })),\r\n      },\r\n    ]);\r\n\r\n    style = options.style ?? \"aodesu\";\r\n    baseColor = options.tailwindBaseColor ?? baseColor;\r\n    cssVariables = opts.cssVariables;\r\n  }\r\n\r\n  return rawConfigSchema.parse({\r\n    $schema: defaultConfig?.$schema,\r\n    style,\r\n    tailwind: {\r\n      ...defaultConfig?.tailwind,\r\n      baseColor,\r\n      cssVariables,\r\n    },\r\n    rsc: defaultConfig?.rsc,\r\n    tsx: defaultConfig?.tsx,\r\n    iconLibrary: defaultConfig?.iconLibrary,\r\n    aliases: defaultConfig?.aliases,\r\n  });\r\n}\r\n","import path from \"path\"\r\nimport { addOptionsSchema } from \"@/src/commands/add\"\r\nimport * as ERRORS from \"@/src/utils/errors\"\r\nimport { getConfig } from \"@/src/utils/get-config\"\r\nimport { highlighter } from \"@/src/utils/highlighter\"\r\nimport { logger } from \"@/src/utils/logger\"\r\nimport fs from \"fs-extra\"\r\nimport { z } from \"zod\"\r\n\r\nexport async function preFlightAdd(options: z.infer<typeof addOptionsSchema>) {\r\n  const errors: Record<string, boolean> = {}\r\n\r\n  // Ensure target directory exists.\r\n  // Check for empty project. We assume if no package.json exists, the project is empty.\r\n  if (\r\n    !fs.existsSync(options.cwd) ||\r\n    !fs.existsSync(path.resolve(options.cwd, \"package.json\"))\r\n  ) {\r\n    errors[ERRORS.MISSING_DIR_OR_EMPTY_PROJECT] = true\r\n    return {\r\n      errors,\r\n      config: null,\r\n    }\r\n  }\r\n\r\n  // Check for existing components.json file.\r\n  if (!fs.existsSync(path.resolve(options.cwd, \"components.json\"))) {\r\n    errors[ERRORS.MISSING_CONFIG] = true\r\n    return {\r\n      errors,\r\n      config: null,\r\n    }\r\n  }\r\n\r\n  try {\r\n    const config = await getConfig(options.cwd)\r\n\r\n    return {\r\n      errors,\r\n      config: config!,\r\n    }\r\n  } catch (error) {\r\n    logger.break()\r\n    logger.error(\r\n      `An invalid ${highlighter.info(\r\n        \"components.json\"\r\n      )} file was found at ${highlighter.info(\r\n        options.cwd\r\n      )}.\\nBefore you can add components, you must create a valid ${highlighter.info(\r\n        \"components.json\"\r\n      )} file by running the ${highlighter.info(\"init\")} command.`\r\n    )\r\n    logger.error(\r\n      `Learn more at ${highlighter.info(\r\n        \"https://ui.shadcn.com/docs/components-json\"\r\n      )}.`\r\n    )\r\n    logger.break()\r\n    process.exit(1)\r\n  }\r\n}\r\n","import fs from \"fs/promises\"\r\nimport path from \"path\"\r\nimport { getRegistryItems } from \"@/src/registry/api\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\n\r\nexport async function updateAppIndex(component: string, config: Config) {\r\n  const indexPath = path.join(config.resolvedPaths.cwd, \"app/page.tsx\")\r\n\r\n  if (!(await fs.stat(indexPath)).isFile()) {\r\n    return\r\n  }\r\n\r\n  const [registryItem] = await getRegistryItems([component], { config })\r\n  if (\r\n    !registryItem?.meta?.importSpecifier ||\r\n    !registryItem?.meta?.moduleSpecifier\r\n  ) {\r\n    return\r\n  }\r\n\r\n  // Overwrite the index file with the new import.\r\n  const content = `import { ${registryItem?.meta?.importSpecifier} } from \"${registryItem.meta.moduleSpecifier}\"\\n\\nexport default function Page() {\\n  return <${registryItem?.meta?.importSpecifier} />\\n}`\r\n  await fs.writeFile(indexPath, content, \"utf8\")\r\n}\r\n","import { runInit } from \"@/src/commands/init\"\r\nimport { preFlightAdd } from \"@/src/preflights/preflight-add\"\r\nimport { getRegistryItems, getUidesuRegistryIndex } from \"@/src/registry/api\"\r\nimport { DEPRECATED_COMPONENTS } from \"@/src/registry/constants\"\r\nimport { clearRegistryContext } from \"@/src/registry/context\"\r\nimport { isUniversalRegistryItem } from \"@/src/registry/utils\"\r\nimport { addComponents } from \"@/src/utils/add-components\"\r\nimport { createProject } from \"@/src/utils/create-project\"\r\nimport { loadEnvFiles } from \"@/src/utils/env-loader\"\r\nimport * as ERRORS from \"@/src/utils/errors\"\r\nimport { createConfig, getConfig } from \"@/src/utils/get-config\"\r\nimport { getProjectInfo } from \"@/src/utils/get-project-info\"\r\nimport { handleError } from \"@/src/utils/handle-error\"\r\nimport { highlighter } from \"@/src/utils/highlighter\"\r\nimport { logger } from \"@/src/utils/logger\"\r\nimport { ensureRegistriesInConfig } from \"@/src/utils/registries\"\r\nimport { updateAppIndex } from \"@/src/utils/update-app-index\"\r\nimport { Command } from \"commander\"\r\nimport path from \"path\"\r\nimport prompts from \"prompts\"\r\nimport { z } from \"zod\"\r\n\r\nexport const addOptionsSchema = z.object({\r\n  components: z.array(z.string()).optional(),\r\n  yes: z.boolean(),\r\n  overwrite: z.boolean(),\r\n  cwd: z.string(),\r\n  all: z.boolean(),\r\n  path: z.string().optional(),\r\n  silent: z.boolean(),\r\n  srcDir: z.boolean().optional(),\r\n  cssVariables: z.boolean(),\r\n})\r\n\r\nexport const add = new Command()\r\n  .name(\"add\")\r\n  .description(\"add a component to your project.\")\r\n  .argument(\"[components...]\", \"names, url or local path to component.\")\r\n  .option(\"-y, --yes\", \"skip confirmation prompt.\", false)\r\n  .option(\"-o, --overwrite\", \"overwrite existing files.\", false)\r\n  .option(\r\n    \"-c, --cwd <cwd>\",\r\n    \"the working directory. defaults to the current directory.\",\r\n    process.cwd()\r\n  )\r\n  .option(\"-a, --all\", \"add all available components\", false)\r\n  .option(\"-p, --path <path>\", \"the path to add the component to.\")\r\n  .option(\"-s, --silent\", \"mute output.\", false)\r\n  .option(\r\n    \"--src-dir\",\r\n    \"use the src directory when creating a new project.\",\r\n    false\r\n  )\r\n  .option(\r\n    \"--no-src-dir\",\r\n    \"do not use the src directory when creating a new project.\"\r\n  )\r\n  .option(\"--css-variables\", \"use css variables for theming.\", true)\r\n  .option(\"--no-css-variables\", \"do not use css variables for theming.\")\r\n  .action(async (components, opts) => {\r\n    try{\r\n      const options = addOptionsSchema.parse({\r\n        components,\r\n        cwd: path.resolve(opts.cwd),\r\n        ...opts,\r\n      });\r\n\r\n      await loadEnvFiles(options.cwd);\r\n\r\n      let initialConfig = await getConfig(options.cwd);\r\n      if (!initialConfig) {\r\n        initialConfig = createConfig({\r\n          style: \"aodesu\",\r\n          resolvedPaths: {\r\n            cwd: options.cwd,\r\n          },\r\n        })\r\n      }\r\n\r\n      let hasNewRegistries = false;\r\n      if (components.length > 0) {\r\n        const { config: updatedConfig, newRegistries } =\r\n          await ensureRegistriesInConfig(components, initialConfig, {\r\n            silent: options.silent,\r\n            writeFile: false,\r\n          });\r\n        initialConfig = updatedConfig;\r\n        hasNewRegistries = newRegistries.length > 0;\r\n      }\r\n\r\n      if (components.length > 0) {\r\n        const [registryItem] = await getRegistryItems([components[0]], {\r\n          config: initialConfig,\r\n        })\r\n        const itemType = registryItem?.type\r\n\r\n        if (isUniversalRegistryItem(registryItem)) {\r\n          await addComponents(components, initialConfig, options)\r\n          return\r\n        }\r\n\r\n        if (\r\n          !options.yes &&\r\n          (itemType === \"registry:style\" || itemType === \"registry:theme\")\r\n        ) {\r\n          logger.break()\r\n          const { confirm } = await prompts({\r\n            type: \"confirm\",\r\n            name: \"confirm\",\r\n            message: highlighter.warn(\r\n              `You are about to install a new ${itemType.replace(\r\n                \"registry:\",\r\n                \"\"\r\n              )}. \\nExisting CSS variables and components will be overwritten. Continue?`\r\n            ),\r\n          })\r\n          if (!confirm) {\r\n            logger.break()\r\n            logger.log(`Installation cancelled.`)\r\n            logger.break()\r\n            process.exit(1)\r\n          }\r\n        }\r\n      }\r\n\r\n      if (!options.components?.length) {\r\n        options.components = await promptForRegistryComponents(options);\r\n      }\r\n\r\n      const projectInfo = await getProjectInfo(options.cwd);\r\n      if (projectInfo?.tailwindVersion === \"v4\") {\r\n        const deprecatedComponents = DEPRECATED_COMPONENTS.filter((component) =>\r\n          options.components?.includes(component.name)\r\n        )\r\n\r\n        if (deprecatedComponents?.length) {\r\n          logger.break()\r\n          deprecatedComponents.forEach((component) => {\r\n            logger.warn(highlighter.warn(component.message))\r\n          })\r\n          logger.break()\r\n          process.exit(1)\r\n        }\r\n      }\r\n\r\n      let { errors, config } = await preFlightAdd(options)\r\n\r\n      // No components.json file. Prompt the user to run init.\r\n      let initHasRun = false;\r\n      if (errors[ERRORS.MISSING_CONFIG]) {\r\n        const { proceed } = await prompts({\r\n          type: \"confirm\",\r\n          name: \"proceed\",\r\n          message: `You need to create a ${highlighter.info(\r\n            \"components.json\"\r\n          )} file to add components. Proceed?`,\r\n          initial: true,\r\n        })\r\n\r\n        if (!proceed) {\r\n          logger.break()\r\n          process.exit(1)\r\n        }\r\n\r\n        config = await runInit({\r\n          cwd: options.cwd,\r\n          yes: true,\r\n          force: true,\r\n          defaults: false,\r\n          skipPreflight: false,\r\n          silent: options.silent || !hasNewRegistries,\r\n          isNewProject: false,\r\n          srcDir: options.srcDir,\r\n          cssVariables: options.cssVariables,\r\n          baseStyle: true,\r\n          components: options.components,\r\n        })\r\n        initHasRun = true;\r\n      }\r\n\r\n      let shouldUpdateAppIndex = false;\r\n\r\n      if (errors[ERRORS.MISSING_DIR_OR_EMPTY_PROJECT]) {\r\n        const { projectPath, template } = await createProject({\r\n          cwd: options.cwd,\r\n          force: options.overwrite,\r\n          srcDir: options.srcDir,\r\n          components: options.components,\r\n        });\r\n        if (!projectPath) {\r\n          logger.break();\r\n          process.exit(1);\r\n        }\r\n        options.cwd = projectPath;\r\n\r\n        if (template === \"next-monorepo\") {\r\n          options.cwd = path.resolve(options.cwd, \"apps/web\");\r\n          config = await getConfig(options.cwd);\r\n        } else {\r\n          config = await runInit({\r\n            cwd: options.cwd,\r\n            yes: true,\r\n            force: true,\r\n            defaults: false,\r\n            skipPreflight: true,\r\n            silent: !hasNewRegistries && options.silent,\r\n            isNewProject: true,\r\n            srcDir: options.srcDir,\r\n            cssVariables: options.cssVariables,\r\n            baseStyle: true,\r\n            components: options.components,\r\n          })\r\n          initHasRun = true\r\n\r\n          shouldUpdateAppIndex =\r\n            options.components?.length === 1 &&\r\n            !!options.components[0].match(/\\/chat\\/b\\//)\r\n        }\r\n      }\r\n\r\n      if (!config) {\r\n        throw new Error(`Failed to read config at ${highlighter.info(options.cwd)}.`)\r\n      }\r\n\r\n      const { config: updatedConfig } = await ensureRegistriesInConfig(\r\n        options.components,\r\n        config,\r\n        {\r\n          silent: options.silent || hasNewRegistries,\r\n        }\r\n      )\r\n      config = updatedConfig;\r\n\r\n      if (!initHasRun) {\r\n        await addComponents(options.components, config, options)\r\n      }\r\n\r\n      // If we're adding a single component and it's from the v0 registry,\r\n      // let's update the app/page.tsx file to import the component.\r\n      if (shouldUpdateAppIndex) {\r\n        await updateAppIndex(options.components[0], config)\r\n      }\r\n    } catch (error) {\r\n      logger.break();\r\n      handleError(error);\r\n    } finally {\r\n      clearRegistryContext();\r\n    }\r\n  })\r\n\r\nasync function promptForRegistryComponents(\r\n  options: z.infer<typeof addOptionsSchema>\r\n) {\r\n  const registryIndex = await getUidesuRegistryIndex();\r\n  if (!registryIndex) {\r\n    logger.break();\r\n    handleError(new Error(\"Failed to fetch registry index.\"))\r\n    return [];\r\n  }\r\n\r\n  if (options.all) {\r\n    return registryIndex\r\n      .map((entry) => entry.name)\r\n      .filter(\r\n        (component) => !DEPRECATED_COMPONENTS.some((c) => c.name === component)\r\n      )\r\n  }\r\n\r\n  if (options.components?.length) {\r\n    return options.components;\r\n  }\r\n\r\n  const { components } = await prompts({\r\n    type: \"multiselect\",\r\n    name: \"components\",\r\n    message: \"Which components do you want to add?\",\r\n    hint: \"Space to select. A toggle all. Enter to submit.\",\r\n    instructions: false,\r\n    choices: registryIndex\r\n      .filter(\r\n        (entry) =>\r\n          entry.type === \"registry:ui\" &&\r\n          !DEPRECATED_COMPONENTS.some(\r\n            (component) => component.name === entry.name\r\n          )\r\n      )\r\n      .map((entry) => ({\r\n        title: entry.name,\r\n        value: entry.name,\r\n        selected: options.all ? true : options.components?.includes(entry.name),\r\n      })),\r\n  })\r\n\r\n  if (!components?.length) {\r\n    logger.warn(\"No components selected. Exiting.\");\r\n    logger.info(\"\");\r\n    process.exit(1);\r\n  }\r\n\r\n  const result = z.array(z.string()).safeParse(components);\r\n  if (!result.success) {\r\n    logger.error(\"\");\r\n    handleError(new Error(\"Invalid components selected.\"));\r\n    return [];\r\n  }\r\n  return result.data;\r\n}\r\n","import * as ERRORS from \"@/src/utils/errors\";\r\nimport fs from \"fs-extra\";\r\nimport path from \"path\";\r\nimport z from \"zod\";\r\nimport { buildOptionsSchema } from \"../commands/build\";\r\nimport { highlighter } from \"../utils/highlighter\";\r\nimport { logger } from \"../utils/logger\";\r\n\r\nexport async function preFlightBuild(\r\n  options: z.infer<typeof buildOptionsSchema>\r\n) {\r\n  const errors: Record<string, boolean> = {};\r\n\r\n  const resolvePaths = {\r\n    cwd: options.cwd,\r\n    registryFile: path.resolve(options.cwd, options.registryFile),\r\n    outputDir: path.resolve(options.cwd, options.outputDir),\r\n  };\r\n\r\n  // Ensure registry file exist.\r\n  if (!fs.existsSync(resolvePaths.registryFile)) {\r\n    errors[ERRORS.BUILD_MISSING_REGISTRY_FILE] = true;\r\n  }\r\n\r\n  // Create output directory if it doesn't exist.\r\n  await fs.mkdir(resolvePaths.outputDir, { recursive: true });\r\n\r\n  if (Object.keys(errors).length > 0) {\r\n    if (errors[ERRORS.BUILD_MISSING_REGISTRY_FILE]) {\r\n      logger.break();\r\n      logger.error(\r\n        `The path ${highlighter.info(\r\n          resolvePaths.registryFile\r\n        )} does not exist.`\r\n      );\r\n    }\r\n\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  return {\r\n    errors,\r\n    resolvePaths\r\n  };\r\n}\r\n","import { Command } from \"commander\";\r\nimport * as fs from \"fs/promises\";\r\nimport * as path from \"path\";\r\nimport z from \"zod\";\r\nimport { preFlightBuild } from \"../preflights/preflight-build\";\r\nimport { registryItemSchema, registrySchema } from \"../schema\";\r\nimport { handleError } from \"../utils/handle-error\";\r\nimport { highlighter } from \"../utils/highlighter\";\r\nimport { logger } from \"../utils/logger\";\r\nimport { spinner } from \"../utils/spinner\";\r\n\r\nexport const buildOptionsSchema = z.object({\r\n  cwd: z.string(),\r\n  registryFile: z.string(),\r\n  outputDir: z.string(),\r\n});\r\n\r\nexport const build = new Command()\r\n  .name(\"build\")\r\n  .description(\"build components for a aodesu registry\")\r\n  .argument(\"[registry]\", \"path to registry.json file\", \"./registry.json\")\r\n  .option(\r\n    \"-o, --output <path>\",\r\n    \"destination directory for json files\",\r\n    \"./public/r\"\r\n  )\r\n  .option(\r\n    \"-c, --cwd <cwd>\",\r\n    \"the working directory. defaults to the current directory.\",\r\n    process.cwd()\r\n  )\r\n  .action(async (registry: string, opts) => {\r\n    try {\r\n      const options = buildOptionsSchema.parse({\r\n        cwd: path.resolve(opts.cwd),\r\n        registryFile: registry,\r\n        outputDir: opts.output,\r\n      });\r\n\r\n      const { resolvePaths } = await preFlightBuild(options);\r\n      const content = await fs.readFile(resolvePaths.registryFile, \"utf-8\");\r\n\r\n      const result = registrySchema.safeParse(JSON.parse(content));\r\n\r\n      if (!result.success) {\r\n        logger.error(\r\n          `Invalid registry file found at ${highlighter.info(\r\n            resolvePaths.registryFile\r\n          )}.`\r\n        );\r\n        process.exit(1);\r\n      }\r\n\r\n      const buildSpinner = spinner(\"Building registry...\");\r\n      for (const registryItem of result.data.items) {\r\n        buildSpinner.start(`Building ${registryItem.name}...`);\r\n\r\n        // Add the schema to the registry item.\r\n        registryItem[\"$schema\"] =\r\n          \"https://ui.aodesu.com/schema/registry-item.json\";\r\n\r\n        // Loop through each file in the files array.\r\n        for (const file of registryItem.files ?? []) {\r\n          file[\"content\"] = await fs.readFile(\r\n            path.resolve(resolvePaths.cwd, file.path),\r\n            \"utf-8\"\r\n          );\r\n        };\r\n\r\n        // Validate the registry item.\r\n        const result = registryItemSchema.safeParse(registryItem);\r\n        if (!result.success) {\r\n          logger.error(\r\n            `Invalid registry item found for ${highlighter.info(\r\n              registryItem.name\r\n            )}.`\r\n          );\r\n          continue;\r\n        }\r\n\r\n        logger.info(`Registry item found for ${registryItem.name}`)\r\n\r\n        // Write the registry item to the output directory.\r\n        await fs.writeFile(\r\n          path.resolve(resolvePaths.outputDir, `${result.data.name}.json`),\r\n          JSON.stringify(result.data, null, 2)\r\n        );\r\n      }\r\n\r\n      // Copy registry.json to the output directory.\r\n      await fs.copyFile(\r\n        resolvePaths.registryFile,\r\n        path.resolve(resolvePaths.outputDir, \"registry.json\")\r\n      );\r\n\r\n      buildSpinner.succeed(\"Building registry.\");\r\n    } catch (error) {\r\n      logger.break();\r\n      handleError(error);\r\n    }\r\n  });\r\n","#!/usr/bin/env node\r\nimport { Command } from \"commander\";\r\nimport packageJson from \"../package.json\";\r\nimport { add } from \"./commands/add\";\r\nimport { build } from \"./commands/build\";\r\nimport { init } from \"./commands/init\";\r\n\r\nprocess.on(\"SIGNINT\", () => process.exit(0));\r\nprocess.on(\"SIGTERM\", () => process.exit(0));\r\n\r\nasync function main() {\r\n  const program = new Command()\r\n    .name(\"uidesu\")\r\n    .description(\"add items from registry to your project\")\r\n    .version(\r\n      packageJson.version || \"1.0.0\",\r\n      \"-v, --version\",\r\n      \"display the version number\"\r\n    )\r\n\r\n  program\r\n    .addCommand(init)\r\n    .addCommand(add)\r\n    .addCommand(build)\r\n\r\n  program.parse()\r\n}\r\n\r\nmain()\r\n\r\n// export * from './registry/api';\r\n"]}